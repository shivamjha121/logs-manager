import e from"stream";import t from"events";import n from"util";import r from"crypto";import o from"fs";import i from"http";import s from"timers";import u from"url";import a from"dns";import c from"os";import l from"process";import h from"zlib";import p from"net";import d from"fs/promises";import f from"tls";import m from"child_process";import y from"timers/promises";import g from"assert";import E from"tty";import A from"node:async_hooks";var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function O(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var C,w,S={exports:{}},v={},D={},M={},T={};function B(){if(C)return T;C=1;const e=(()=>{const e=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Uint8Array.prototype),Symbol.toStringTag).get;return t=>e.call(t)})();function t(t){return"Uint8Array"===e(t)}function n(e){return"object"==typeof e&&null!=e&&Symbol.toStringTag in e&&("ArrayBuffer"===e[Symbol.toStringTag]||"SharedArrayBuffer"===e[Symbol.toStringTag])}function r(e){return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)}function o(e){return"object"==typeof e&&null!=e&&Symbol.toStringTag in e&&"Map"===e[Symbol.toStringTag]}function i(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function s(e,t){return JSON.stringify(e,((e,t)=>"bigint"==typeof t?{$numberLong:`${t}`}:o(t)?Object.fromEntries(t):t))}const u=Symbol.for("@@mdb.bson.version"),a=2147483647,c=-2147483648,l=Math.pow(2,63)-1,h=-Math.pow(2,63),p=Math.pow(2,53),d=-Math.pow(2,53),f=Object.freeze({double:1,string:2,object:3,array:4,binData:5,undefined:6,objectId:7,bool:8,date:9,null:10,regex:11,dbPointer:12,javascript:13,symbol:14,javascriptWithScope:15,int:16,timestamp:17,long:18,decimal:19,minKey:-1,maxKey:127});class m extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(e,t){super(e,t)}static isBSONError(e){return null!=e&&"object"==typeof e&&"bsonError"in e&&!0===e.bsonError&&"name"in e&&"message"in e&&"stack"in e}}class y extends m{get name(){return"BSONVersionError"}constructor(){super("Unsupported BSON version, bson types must be from bson 6.x.x")}}class g extends m{get name(){return"BSONRuntimeError"}constructor(e){super(e)}}class E extends m{get name(){return"BSONOffsetError"}constructor(e,t,n){super(`${e}. offset: ${t}`,n),this.offset=t}}let A,b;function _(e,t,n,r){if(r){A??=new TextDecoder("utf8",{fatal:!0});try{return A.decode(e.subarray(t,n))}catch(e){throw new m("Invalid UTF-8 string in BSON document",{cause:e})}}return b??=new TextDecoder("utf8",{fatal:!1}),b.decode(e.subarray(t,n))}function O(e,t,n){if(0===e.length)return"";const r=n-t;if(0===r)return"";if(r>20)return null;if(1===r&&e[t]<128)return String.fromCharCode(e[t]);if(2===r&&e[t]<128&&e[t+1]<128)return String.fromCharCode(e[t])+String.fromCharCode(e[t+1]);if(3===r&&e[t]<128&&e[t+1]<128&&e[t+2]<128)return String.fromCharCode(e[t])+String.fromCharCode(e[t+1])+String.fromCharCode(e[t+2]);const o=[];for(let r=t;r<n;r++){const t=e[r];if(t>127)return null;o.push(t)}return String.fromCharCode(...o)}function w(e){return v.fromNumberArray(Array.from({length:e},(()=>Math.floor(256*Math.random()))))}const S=(()=>{try{return require("crypto").randomBytes}catch{return w}})(),v={toLocalBufferType(e){if(Buffer.isBuffer(e))return e;if(ArrayBuffer.isView(e))return Buffer.from(e.buffer,e.byteOffset,e.byteLength);const t=e?.[Symbol.toStringTag]??Object.prototype.toString.call(e);if("ArrayBuffer"===t||"SharedArrayBuffer"===t||"[object ArrayBuffer]"===t||"[object SharedArrayBuffer]"===t)return Buffer.from(e);throw new m("Cannot create Buffer from the passed potentialBuffer.")},allocate:e=>Buffer.alloc(e),allocateUnsafe:e=>Buffer.allocUnsafe(e),equals:(e,t)=>v.toLocalBufferType(e).equals(t),fromNumberArray:e=>Buffer.from(e),fromBase64:e=>Buffer.from(e,"base64"),toBase64:e=>v.toLocalBufferType(e).toString("base64"),fromISO88591:e=>Buffer.from(e,"binary"),toISO88591:e=>v.toLocalBufferType(e).toString("binary"),fromHex:e=>Buffer.from(e,"hex"),toHex:e=>v.toLocalBufferType(e).toString("hex"),toUTF8(e,t,n,r){const o=n-t<=20?O(e,t,n):null;if(null!=o)return o;const i=v.toLocalBufferType(e).toString("utf8",t,n);if(r)for(let r=0;r<i.length;r++)if(65533===i.charCodeAt(r)){_(e,t,n,!0);break}return i},utf8ByteLength:e=>Buffer.byteLength(e,"utf8"),encodeUTF8Into(e,t,n){const r=function(e,t,n){if(0===t.length)return 0;if(t.length>25)return null;if(e.length-n<t.length)return null;for(let r=0,o=n;r<t.length;r++,o++){const n=t.charCodeAt(r);if(n>127)return null;e[o]=n}return t.length}(e,t,n);return null!=r?r:v.toLocalBufferType(e).write(t,n,void 0,"utf8")},randomBytes:S,swap32:e=>v.toLocalBufferType(e).swap32()};function D(e){if(e<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${e}`);return F.fromNumberArray(Array.from({length:e},(()=>Math.floor(256*Math.random()))))}const M=(()=>{const{crypto:e}=globalThis;if(null!=e&&"function"==typeof e.getRandomValues)return t=>e.getRandomValues(F.allocate(t));if(function(){const{navigator:e}=globalThis;return"object"==typeof e&&"ReactNative"===e.product}()){const{console:e}=globalThis;e?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return D})(),B=/(\d|[a-f])/i,F={toLocalBufferType(e){const t=e?.[Symbol.toStringTag]??Object.prototype.toString.call(e);if("Uint8Array"===t)return e;if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength));if("ArrayBuffer"===t||"SharedArrayBuffer"===t||"[object ArrayBuffer]"===t||"[object SharedArrayBuffer]"===t)return new Uint8Array(e);throw new m("Cannot make a Uint8Array from passed potentialBuffer.")},allocate(e){if("number"!=typeof e)throw new TypeError(`The "size" argument must be of type number. Received ${String(e)}`);return new Uint8Array(e)},allocateUnsafe:e=>F.allocate(e),equals(e,t){if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},fromNumberArray:e=>Uint8Array.from(e),fromBase64:e=>Uint8Array.from(atob(e),(e=>e.charCodeAt(0))),toBase64:e=>btoa(F.toISO88591(e)),fromISO88591:e=>Uint8Array.from(e,(e=>255&e.charCodeAt(0))),toISO88591:e=>Array.from(Uint16Array.from(e),(e=>String.fromCharCode(e))).join(""),fromHex(e){const t=e.length%2==0?e:e.slice(0,e.length-1),n=[];for(let e=0;e<t.length;e+=2){const r=t[e],o=t[e+1];if(!B.test(r))break;if(!B.test(o))break;const i=Number.parseInt(`${r}${o}`,16);n.push(i)}return Uint8Array.from(n)},toHex:e=>Array.from(e,(e=>e.toString(16).padStart(2,"0"))).join(""),toUTF8(e,t,n,r){const o=n-t<=20?O(e,t,n):null;return null!=o?o:_(e,t,n,r)},utf8ByteLength:e=>(new TextEncoder).encode(e).byteLength,encodeUTF8Into(e,t,n){const r=(new TextEncoder).encode(t);return e.set(r,n),r.byteLength},randomBytes:M,swap32(e){if(e.length%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e.length;t+=4){const n=e[t],r=e[t+1],o=e[t+2],i=e[t+3];e[t]=i,e[t+1]=o,e[t+2]=r,e[t+3]=n}return e}},$="function"==typeof Buffer&&!0!==Buffer.prototype?._isBuffer?v:F;class x{get[u](){return 6}[Symbol.for("nodejs.util.inspect.custom")](e,t,n){return this.inspect(e,t,n)}}const P=new Float64Array(1),N=new Uint8Array(P.buffer,0,8);P[0]=-1;const I=0===N[7],R={isBigEndian:I,getNonnegativeInt32LE(e,t){if(e[t+3]>127)throw new RangeError(`Size cannot be negative at offset: ${t}`);return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24},getInt32LE:(e,t)=>e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,getUint32LE:(e,t)=>e[t]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3],getUint32BE:(e,t)=>e[t+3]+256*e[t+2]+65536*e[t+1]+16777216*e[t],getBigInt64LE(e,t){const n=BigInt(e[t+4]+256*e[t+5]+65536*e[t+6]+(e[t+7]<<24)),r=BigInt(e[t]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]);return(n<<BigInt(32))+r},getFloat64LE:I?(e,t)=>(N[7]=e[t],N[6]=e[t+1],N[5]=e[t+2],N[4]=e[t+3],N[3]=e[t+4],N[2]=e[t+5],N[1]=e[t+6],N[0]=e[t+7],P[0]):(e,t)=>(N[0]=e[t],N[1]=e[t+1],N[2]=e[t+2],N[3]=e[t+3],N[4]=e[t+4],N[5]=e[t+5],N[6]=e[t+6],N[7]=e[t+7],P[0]),setInt32BE:(e,t,n)=>(e[t+3]=n,n>>>=8,e[t+2]=n,n>>>=8,e[t+1]=n,n>>>=8,e[t]=n,4),setInt32LE:(e,t,n)=>(e[t]=n,n>>>=8,e[t+1]=n,n>>>=8,e[t+2]=n,n>>>=8,e[t+3]=n,4),setBigInt64LE(e,t,n){const r=BigInt(4294967295);let o=Number(n&r);e[t]=o,o>>=8,e[t+1]=o,o>>=8,e[t+2]=o,o>>=8,e[t+3]=o;let i=Number(n>>BigInt(32)&r);return e[t+4]=i,i>>=8,e[t+5]=i,i>>=8,e[t+6]=i,i>>=8,e[t+7]=i,8},setFloat64LE:I?(e,t,n)=>(P[0]=n,e[t]=N[7],e[t+1]=N[6],e[t+2]=N[5],e[t+3]=N[4],e[t+4]=N[3],e[t+5]=N[2],e[t+6]=N[1],e[t+7]=N[0],8):(e,t,n)=>(P[0]=n,e[t]=N[0],e[t+1]=N[1],e[t+2]=N[2],e[t+3]=N[3],e[t+4]=N[4],e[t+5]=N[5],e[t+6]=N[6],e[t+7]=N[7],8)};class k extends x{get _bsontype(){return"Binary"}constructor(e,t){if(super(),null!=e&&"string"==typeof e&&!ArrayBuffer.isView(e)&&!n(e)&&!Array.isArray(e))throw new m("Binary can only be constructed from Uint8Array or number[]");this.sub_type=t??k.BSON_BINARY_SUBTYPE_DEFAULT,null==e?(this.buffer=$.allocate(k.BUFFER_SIZE),this.position=0):(this.buffer=Array.isArray(e)?$.fromNumberArray(e):$.toLocalBufferType(e),this.position=this.buffer.byteLength)}put(e){if("string"==typeof e&&1!==e.length)throw new m("only accepts single character String");if("number"!=typeof e&&1!==e.length)throw new m("only accepts single character Uint8Array or Array");let t;if(t="string"==typeof e?e.charCodeAt(0):"number"==typeof e?e:e[0],t<0||t>255)throw new m("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=t;else{const e=$.allocate(k.BUFFER_SIZE+this.buffer.length);e.set(this.buffer,0),this.buffer=e,this.buffer[this.position++]=t}}write(e,t){if(t="number"==typeof t?t:this.position,this.buffer.byteLength<t+e.length){const t=$.allocate(this.buffer.byteLength+e.length);t.set(this.buffer,0),this.buffer=t}if(ArrayBuffer.isView(e))this.buffer.set($.toLocalBufferType(e),t),this.position=t+e.byteLength>this.position?t+e.length:this.position;else if("string"==typeof e)throw new m("input cannot be string")}read(e,t){const n=e+(t=t&&t>0?t:this.position);return this.buffer.subarray(e,n>this.position?this.position:n)}value(){return this.buffer.length===this.position?this.buffer:this.buffer.subarray(0,this.position)}length(){return this.position}toJSON(){return $.toBase64(this.buffer.subarray(0,this.position))}toString(e){return"hex"===e?$.toHex(this.buffer.subarray(0,this.position)):"base64"===e?$.toBase64(this.buffer.subarray(0,this.position)):$.toUTF8(this.buffer,0,this.position,!1)}toExtendedJSON(e){e=e||{},this.sub_type===k.SUBTYPE_VECTOR&&j(this);const t=$.toBase64(this.buffer),n=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:1===n.length?"0"+n:n}:{$binary:{base64:t,subType:1===n.length?"0"+n:n}}}toUUID(){if(this.sub_type===k.SUBTYPE_UUID)return new V(this.buffer.subarray(0,this.position));throw new m(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${k.SUBTYPE_UUID}" is currently supported.`)}static createFromHexString(e,t){return new k($.fromHex(e),t)}static createFromBase64(e,t){return new k($.fromBase64(e),t)}static fromExtendedJSON(e,t){let n,r;if(t=t||{},"$binary"in e?t.legacy&&"string"==typeof e.$binary&&"$type"in e?(r=e.$type?parseInt(e.$type,16):0,n=$.fromBase64(e.$binary)):"string"!=typeof e.$binary&&(r=e.$binary.subType?parseInt(e.$binary.subType,16):0,n=$.fromBase64(e.$binary.base64)):"$uuid"in e&&(r=4,n=V.bytesFromString(e.$uuid)),!n)throw new m(`Unexpected Binary Extended JSON format ${JSON.stringify(e)}`);return 4===r?new V(n):new k(n,r)}inspect(e,t,n){n??=s;return`Binary.createFromBase64(${n($.toBase64(this.buffer.subarray(0,this.position)),t)}, ${n(this.sub_type,t)})`}toInt8Array(){if(this.sub_type!==k.SUBTYPE_VECTOR)throw new m("Binary sub_type is not Vector");if(this.buffer[0]!==k.VECTOR_TYPE.Int8)throw new m("Binary datatype field is not Int8");return new Int8Array(this.buffer.buffer.slice(this.buffer.byteOffset+2,this.buffer.byteOffset+this.position))}toFloat32Array(){if(this.sub_type!==k.SUBTYPE_VECTOR)throw new m("Binary sub_type is not Vector");if(this.buffer[0]!==k.VECTOR_TYPE.Float32)throw new m("Binary datatype field is not Float32");const e=new Uint8Array(this.buffer.buffer.slice(this.buffer.byteOffset+2,this.buffer.byteOffset+this.position));return R.isBigEndian&&$.swap32(e),new Float32Array(e.buffer)}toPackedBits(){if(this.sub_type!==k.SUBTYPE_VECTOR)throw new m("Binary sub_type is not Vector");if(this.buffer[0]!==k.VECTOR_TYPE.PackedBit)throw new m("Binary datatype field is not packed bit");return new Uint8Array(this.buffer.buffer.slice(this.buffer.byteOffset+2,this.buffer.byteOffset+this.position))}toBits(){if(this.sub_type!==k.SUBTYPE_VECTOR)throw new m("Binary sub_type is not Vector");if(this.buffer[0]!==k.VECTOR_TYPE.PackedBit)throw new m("Binary datatype field is not packed bit");const e=8*(this.length()-2)-this.buffer[1],t=new Int8Array(e);for(let e=0;e<t.length;e++){const n=e/8|0,r=this.buffer[n+2]>>7-e%8&1;t[e]=r}return t}static fromInt8Array(e){const t=$.allocate(e.byteLength+2);t[0]=k.VECTOR_TYPE.Int8,t[1]=0;const n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return t.set(n,2),new this(t,this.SUBTYPE_VECTOR)}static fromFloat32Array(e){const t=$.allocate(e.byteLength+2);t[0]=k.VECTOR_TYPE.Float32,t[1]=0;const n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return t.set(n,2),R.isBigEndian&&$.swap32(new Uint8Array(t.buffer,2)),new this(t,this.SUBTYPE_VECTOR)}static fromPackedBits(e,t=0){const n=$.allocate(e.byteLength+2);return n[0]=k.VECTOR_TYPE.PackedBit,n[1]=t,n.set(e,2),new this(n,this.SUBTYPE_VECTOR)}static fromBits(e){const t=e.length+7>>>3,n=new Uint8Array(t+2);n[0]=k.VECTOR_TYPE.PackedBit;const r=e.length%8;n[1]=0===r?0:8-r;for(let t=0;t<e.length;t++){const r=t>>>3,o=e[t];if(0!==o&&1!==o)throw new m(`Invalid bit value at ${t}: must be 0 or 1, found ${e[t]}`);if(0===o)continue;const i=7-t%8;n[r+2]|=o<<i}return new this(n,k.SUBTYPE_VECTOR)}}function j(e){if(e.sub_type!==k.SUBTYPE_VECTOR)return;const t=e.position,n=e.buffer[0],r=e.buffer[1];if((n===k.VECTOR_TYPE.Float32||n===k.VECTOR_TYPE.Int8)&&0!==r)throw new m("Invalid Vector: padding must be zero for int8 and float32 vectors");if(n===k.VECTOR_TYPE.PackedBit&&0!==r&&2===t)throw new m("Invalid Vector: padding must be zero for packed bit vectors that are empty");if(n===k.VECTOR_TYPE.PackedBit&&r>7)throw new m(`Invalid Vector: padding must be a value between 0 and 7. found: ${r}`)}k.BSON_BINARY_SUBTYPE_DEFAULT=0,k.BUFFER_SIZE=256,k.SUBTYPE_DEFAULT=0,k.SUBTYPE_FUNCTION=1,k.SUBTYPE_BYTE_ARRAY=2,k.SUBTYPE_UUID_OLD=3,k.SUBTYPE_UUID=4,k.SUBTYPE_MD5=5,k.SUBTYPE_ENCRYPTED=6,k.SUBTYPE_COLUMN=7,k.SUBTYPE_SENSITIVE=8,k.SUBTYPE_VECTOR=9,k.SUBTYPE_USER_DEFINED=128,k.VECTOR_TYPE=Object.freeze({Int8:3,Float32:39,PackedBit:16});const L=/^[0-9A-F]{32}$/i,U=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;class V extends k{constructor(e){let t;if(null==e)t=V.generate();else if(e instanceof V)t=$.toLocalBufferType(new Uint8Array(e.buffer));else if(ArrayBuffer.isView(e)&&16===e.byteLength)t=$.toLocalBufferType(e);else{if("string"!=typeof e)throw new m("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");t=V.bytesFromString(e)}super(t,4)}get id(){return this.buffer}set id(e){this.buffer=e}toHexString(e=!0){return e?[$.toHex(this.buffer.subarray(0,4)),$.toHex(this.buffer.subarray(4,6)),$.toHex(this.buffer.subarray(6,8)),$.toHex(this.buffer.subarray(8,10)),$.toHex(this.buffer.subarray(10,16))].join("-"):$.toHex(this.buffer)}toString(e){return"hex"===e?$.toHex(this.id):"base64"===e?$.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(e){if(!e)return!1;if(e instanceof V)return $.equals(e.id,this.id);try{return $.equals(new V(e).id,this.id)}catch{return!1}}toBinary(){return new k(this.id,k.SUBTYPE_UUID)}static generate(){const e=$.randomBytes(16);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,e}static isValid(e){return!!e&&("string"==typeof e?V.isValidUUIDString(e):t(e)?16===e.byteLength:"Binary"===e._bsontype&&e.sub_type===this.SUBTYPE_UUID&&16===e.buffer.byteLength)}static createFromHexString(e){const t=V.bytesFromString(e);return new V(t)}static createFromBase64(e){return new V($.fromBase64(e))}static bytesFromString(e){if(!V.isValidUUIDString(e))throw new m("UUID string representation must be 32 hex digits or canonical hyphenated representation");return $.fromHex(e.replace(/-/g,""))}static isValidUUIDString(e){return L.test(e)||U.test(e)}inspect(e,t,n){return n??=s,`new UUID(${n(this.toHexString(),t)})`}}class z extends x{get _bsontype(){return"Code"}constructor(e,t){super(),this.code=e.toString(),this.scope=t??null}toJSON(){return null!=this.scope?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(e){return new z(e.$code,e.$scope)}inspect(e,t,n){n??=s;let r=n(this.code,t);const o=r.includes("\n");null!=this.scope&&(r+=`,${o?"\n":" "}${n(this.scope,t)}`);return`new Code(${o?"\n":""}${r}${o&&null===this.scope?"\n":""})`}}function W(e){return null!=e&&"object"==typeof e&&"$id"in e&&null!=e.$id&&"$ref"in e&&"string"==typeof e.$ref&&(!("$db"in e)||"$db"in e&&"string"==typeof e.$db)}class q extends x{get _bsontype(){return"DBRef"}constructor(e,t,n,r){super();const o=e.split(".");2===o.length&&(n=o.shift(),e=o.shift()),this.collection=e,this.oid=t,this.db=n,this.fields=r||{}}get namespace(){return this.collection}set namespace(e){this.collection=e}toJSON(){const e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e}toExtendedJSON(e){e=e||{};let t={$ref:this.collection,$id:this.oid};return e.legacy||(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields)),t}static fromExtendedJSON(e){const t=Object.assign({},e);return delete t.$ref,delete t.$id,delete t.$db,new q(e.$ref,e.$id,e.$db,t)}inspect(e,t,n){n??=s;const r=[n(this.namespace,t),n(this.oid,t),...this.db?[n(this.db,t)]:[],...Object.keys(this.fields).length>0?[n(this.fields,t)]:[]];return r[1]=n===s?`new ObjectId(${r[1]})`:r[1],`new DBRef(${r.join(", ")})`}}function G(e){if(""===e)return e;let t=0;const n="-"===e[t],r="+"===e[t];(r||n)&&(t+=1);let o=!1;for(;t<e.length&&"0"===e[t];++t)o=!0;return o?`${n?"-":""}${e.length===t?"0":e.slice(t)}`:r?e.slice(1):e}let H;try{H=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}const K=4294967296,Y=0x10000000000000000,Q=Y/2,J={},X={},Z=/^(\+?0|(\+|-)?[1-9][0-9]*)$/;class ee extends x{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(e=0,t,n){super();const r="boolean"==typeof t?t:Boolean(n),o="number"==typeof t?t:0,i="string"==typeof e?ee.fromString(e,r):"bigint"==typeof e?ee.fromBigInt(e,r):{low:0|e,high:0|o,unsigned:r};this.low=i.low,this.high=i.high,this.unsigned=i.unsigned}static fromBits(e,t,n){return new ee(e,t,n)}static fromInt(e,t){let n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=X[e],r)?r:(n=ee.fromBits(e,(0|e)<0?-1:0,!0),o&&(X[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=J[e],r)?r:(n=ee.fromBits(e,e<0?-1:0,!1),o&&(J[e]=n),n)}static fromNumber(e,t){if(isNaN(e))return t?ee.UZERO:ee.ZERO;if(t){if(e<0)return ee.UZERO;if(e>=Y)return ee.MAX_UNSIGNED_VALUE}else{if(e<=-0x8000000000000000)return ee.MIN_VALUE;if(e+1>=Q)return ee.MAX_VALUE}return e<0?ee.fromNumber(-e,t).neg():ee.fromBits(e%K|0,e/K|0,t)}static fromBigInt(e,t){const n=BigInt(4294967295),r=BigInt(32);return new ee(Number(e&n),Number(e>>r&n),t)}static _fromString(e,t,n){if(0===e.length)throw new m("empty string");if(n<2||36<n)throw new m("radix");let r;if((r=e.indexOf("-"))>0)throw new m("interior hyphen");if(0===r)return ee._fromString(e.substring(1),t,n).neg();const o=ee.fromNumber(Math.pow(n,8));let i=ee.ZERO;for(let t=0;t<e.length;t+=8){const r=Math.min(8,e.length-t),s=parseInt(e.substring(t,t+r),n);if(r<8){const e=ee.fromNumber(Math.pow(n,r));i=i.mul(e).add(ee.fromNumber(s))}else i=i.mul(o),i=i.add(ee.fromNumber(s))}return i.unsigned=t,i}static fromStringStrict(e,t,n){let r=!1;if("number"==typeof t?(n=t,t=!1):r=!!t,n??=10,e.trim()!==e)throw new m(`Input: '${e}' contains leading and/or trailing whitespace`);if(!function(e,t){const n="0123456789abcdefghijklmnopqrstuvwxyz".slice(0,t=t??10);return!new RegExp(`[^-+${n}]`,"i").test(e)&&e}(e,n))throw new m(`Input: '${e}' contains invalid characters for radix: ${n}`);const o=G(e),i=ee._fromString(o,r,n);if(i.toString(n).toLowerCase()!==o.toLowerCase())throw new m(`Input: ${e} is not representable as ${i.unsigned?"an unsigned":"a signed"} 64-bit Long ${null!=n?`with radix: ${n}`:""}`);return i}static fromString(e,t,n){let r=!1;return"number"==typeof t?(n=t,t=!1):r=!!t,n??=10,"NaN"===e&&n<24||("Infinity"===e||"+Infinity"===e||"-Infinity"===e)&&n<35?ee.ZERO:ee._fromString(e,r,n)}static fromBytes(e,t,n){return n?ee.fromBytesLE(e,t):ee.fromBytesBE(e,t)}static fromBytesLE(e,t){return new ee(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}static fromBytesBE(e,t){return new ee(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}static isLong(e){return null!=e&&"object"==typeof e&&"__isLong__"in e&&!0===e.__isLong__}static fromValue(e,t){return"number"==typeof e?ee.fromNumber(e,t):"string"==typeof e?ee.fromString(e,t):ee.fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}add(e){ee.isLong(e)||(e=ee.fromValue(e));const t=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,u=e.low>>>16;let a=0,c=0,l=0,h=0;return h+=o+(65535&e.low),l+=h>>>16,h&=65535,l+=r+u,c+=l>>>16,l&=65535,c+=n+s,a+=c>>>16,c&=65535,a+=t+i,a&=65535,ee.fromBits(l<<16|h,a<<16|c,this.unsigned)}and(e){return ee.isLong(e)||(e=ee.fromValue(e)),ee.fromBits(this.low&e.low,this.high&e.high,this.unsigned)}compare(e){if(ee.isLong(e)||(e=ee.fromValue(e)),this.eq(e))return 0;const t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1}comp(e){return this.compare(e)}divide(e){if(ee.isLong(e)||(e=ee.fromValue(e)),e.isZero())throw new m("division by zero");if(H){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;const t=(this.unsigned?H.div_u:H.div_s)(this.low,this.high,e.low,e.high);return ee.fromBits(t,H.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ee.UZERO:ee.ZERO;let t,n,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ee.UZERO;if(e.gt(this.shru(1)))return ee.UONE;r=ee.UZERO}else{if(this.eq(ee.MIN_VALUE)){if(e.eq(ee.ONE)||e.eq(ee.NEG_ONE))return ee.MIN_VALUE;if(e.eq(ee.MIN_VALUE))return ee.ONE;return t=this.shr(1).div(e).shl(1),t.eq(ee.ZERO)?e.isNegative()?ee.ONE:ee.NEG_ONE:(n=this.sub(e.mul(t)),r=t.add(n.div(e)),r)}if(e.eq(ee.MIN_VALUE))return this.unsigned?ee.UZERO:ee.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=ee.ZERO}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));const o=Math.ceil(Math.log(t)/Math.LN2),i=o<=48?1:Math.pow(2,o-48);let s=ee.fromNumber(t),u=s.mul(e);for(;u.isNegative()||u.gt(n);)t-=i,s=ee.fromNumber(t,this.unsigned),u=s.mul(e);s.isZero()&&(s=ee.ONE),r=r.add(s),n=n.sub(u)}return r}div(e){return this.divide(e)}equals(e){return ee.isLong(e)||(e=ee.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)}eq(e){return this.equals(e)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(ee.MIN_VALUE)?64:this.neg().getNumBitsAbs();const e=0!==this.high?this.high:this.low;let t;for(t=31;t>0&&!(e&1<<t);t--);return 0!==this.high?t+33:t+1}greaterThan(e){return this.comp(e)>0}gt(e){return this.greaterThan(e)}greaterThanOrEqual(e){return this.comp(e)>=0}gte(e){return this.greaterThanOrEqual(e)}ge(e){return this.greaterThanOrEqual(e)}isEven(){return!(1&this.low)}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return!(1&~this.low)}isPositive(){return this.unsigned||this.high>=0}isZero(){return 0===this.high&&0===this.low}lessThan(e){return this.comp(e)<0}lt(e){return this.lessThan(e)}lessThanOrEqual(e){return this.comp(e)<=0}lte(e){return this.lessThanOrEqual(e)}modulo(e){if(ee.isLong(e)||(e=ee.fromValue(e)),H){const t=(this.unsigned?H.rem_u:H.rem_s)(this.low,this.high,e.low,e.high);return ee.fromBits(t,H.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))}mod(e){return this.modulo(e)}rem(e){return this.modulo(e)}multiply(e){if(this.isZero())return ee.ZERO;if(ee.isLong(e)||(e=ee.fromValue(e)),H){const t=H.mul(this.low,this.high,e.low,e.high);return ee.fromBits(t,H.get_high(),this.unsigned)}if(e.isZero())return ee.ZERO;if(this.eq(ee.MIN_VALUE))return e.isOdd()?ee.MIN_VALUE:ee.ZERO;if(e.eq(ee.MIN_VALUE))return this.isOdd()?ee.MIN_VALUE:ee.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(ee.TWO_PWR_24)&&e.lt(ee.TWO_PWR_24))return ee.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);const t=this.high>>>16,n=65535&this.high,r=this.low>>>16,o=65535&this.low,i=e.high>>>16,s=65535&e.high,u=e.low>>>16,a=65535&e.low;let c=0,l=0,h=0,p=0;return p+=o*a,h+=p>>>16,p&=65535,h+=r*a,l+=h>>>16,h&=65535,h+=o*u,l+=h>>>16,h&=65535,l+=n*a,c+=l>>>16,l&=65535,l+=r*u,c+=l>>>16,l&=65535,l+=o*s,c+=l>>>16,l&=65535,c+=t*a+n*u+r*s+o*i,c&=65535,ee.fromBits(h<<16|p,c<<16|l,this.unsigned)}mul(e){return this.multiply(e)}negate(){return!this.unsigned&&this.eq(ee.MIN_VALUE)?ee.MIN_VALUE:this.not().add(ee.ONE)}neg(){return this.negate()}not(){return ee.fromBits(~this.low,~this.high,this.unsigned)}notEquals(e){return!this.equals(e)}neq(e){return this.notEquals(e)}ne(e){return this.notEquals(e)}or(e){return ee.isLong(e)||(e=ee.fromValue(e)),ee.fromBits(this.low|e.low,this.high|e.high,this.unsigned)}shiftLeft(e){return ee.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?ee.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):ee.fromBits(0,this.low<<e-32,this.unsigned)}shl(e){return this.shiftLeft(e)}shiftRight(e){return ee.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?ee.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):ee.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)}shr(e){return this.shiftRight(e)}shiftRightUnsigned(e){if(ee.isLong(e)&&(e=e.toInt()),0===(e&=63))return this;{const t=this.high;if(e<32){const n=this.low;return ee.fromBits(n>>>e|t<<32-e,t>>>e,this.unsigned)}return 32===e?ee.fromBits(t,0,this.unsigned):ee.fromBits(t>>>e-32,0,this.unsigned)}}shr_u(e){return this.shiftRightUnsigned(e)}shru(e){return this.shiftRightUnsigned(e)}subtract(e){return ee.isLong(e)||(e=ee.fromValue(e)),this.add(e.neg())}sub(e){return this.subtract(e)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*K+(this.low>>>0):this.high*K+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}toSigned(){return this.unsigned?ee.fromBits(this.low,this.high,!1):this}toString(e){if((e=e||10)<2||36<e)throw new m("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ee.MIN_VALUE)){const t=ee.fromNumber(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}const t=ee.fromNumber(Math.pow(e,6),this.unsigned);let n=this,r="";for(;;){const o=n.div(t);let i=(n.sub(o.mul(t)).toInt()>>>0).toString(e);if(n=o,n.isZero())return i+r;for(;i.length<6;)i="0"+i;r=""+i+r}}toUnsigned(){return this.unsigned?this:ee.fromBits(this.low,this.high,!0)}xor(e){return ee.isLong(e)||(e=ee.fromValue(e)),ee.fromBits(this.low^e.low,this.high^e.high,this.unsigned)}eqz(){return this.isZero()}le(e){return this.lessThanOrEqual(e)}toExtendedJSON(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(e,t){const{useBigInt64:n=!1,relaxed:r=!0}={...t};if(e.$numberLong.length>20)throw new m("$numberLong string is too long");if(!Z.test(e.$numberLong))throw new m(`$numberLong string "${e.$numberLong}" is in an invalid format`);if(n){const t=BigInt(e.$numberLong);return BigInt.asIntN(64,t)}const o=ee.fromString(e.$numberLong);return r?o.toNumber():o}inspect(e,t,n){n??=s;return`new Long(${n(this.toString(),t)}${this.unsigned?`, ${n(this.unsigned,t)}`:""})`}}ee.TWO_PWR_24=ee.fromInt(1<<24),ee.MAX_UNSIGNED_VALUE=ee.fromBits(-1,-1,!0),ee.ZERO=ee.fromInt(0),ee.UZERO=ee.fromInt(0,!0),ee.ONE=ee.fromInt(1),ee.UONE=ee.fromInt(1,!0),ee.NEG_ONE=ee.fromInt(-1),ee.MAX_VALUE=ee.fromBits(-1,2147483647,!1),ee.MIN_VALUE=ee.fromBits(0,-2147483648,!1);const te=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,ne=/^(\+|-)?(Infinity|inf)$/i,re=/^(\+|-)?NaN$/i,oe=6111,ie=-6176,se=$.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),ue=$.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),ae=$.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),ce=/^([-+])?(\d+)?$/;function le(e){return!isNaN(parseInt(e,10))}function he(e){const t=ee.fromNumber(1e9);let n=ee.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:n};for(let r=0;r<=3;r++)n=n.shiftLeft(32),n=n.add(new ee(e.parts[r],0)),e.parts[r]=n.div(t).low,n=n.modulo(t);return{quotient:e,rem:n}}function pe(e,t){throw new m(`"${e}" is not a valid Decimal128 string - ${t}`)}class de extends x{get _bsontype(){return"Decimal128"}constructor(e){if(super(),"string"==typeof e)this.bytes=de.fromString(e).bytes;else{if(!(e instanceof Uint8Array||t(e)))throw new m("Decimal128 must take a Buffer or string");if(16!==e.byteLength)throw new m("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}}static fromString(e){return de._fromString(e,{allowRounding:!1})}static fromStringWithRounding(e){return de._fromString(e,{allowRounding:!0})}static _fromString(e,t){let n=!1,r=!1,o=!1,i=!1,s=0,u=0,a=0,c=0,l=0;const h=[0];let p=0,d=0,f=0,y=0,g=new ee(0,0),E=new ee(0,0),A=0,b=0;if(e.length>=7e3)throw new m(e+" not a valid Decimal128 string");const _=e.match(te),O=e.match(ne),C=e.match(re);if(!_&&!O&&!C||0===e.length)throw new m(e+" not a valid Decimal128 string");if(_){const t=_[2],n=_[4],r=_[5],o=_[6];n&&void 0===o&&pe(e,"missing exponent power"),n&&void 0===t&&pe(e,"missing exponent base"),void 0===n&&(r||o)&&pe(e,"missing e before exponent")}if("+"!==e[b]&&"-"!==e[b]||(r=!0,n="-"===e[b++]),!le(e[b])&&"."!==e[b]){if("i"===e[b]||"I"===e[b])return new de(n?ue:ae);if("N"===e[b])return new de(se)}for(;le(e[b])||"."===e[b];)"."!==e[b]?(p<34&&("0"!==e[b]||i)&&(i||(l=u),i=!0,h[d++]=parseInt(e[b],10),p+=1),i&&(a+=1),o&&(c+=1),u+=1,b+=1):(o&&pe(e,"contains multiple periods"),o=!0,b+=1);if(o&&!u)throw new m(e+" not a valid Decimal128 string");if("e"===e[b]||"E"===e[b]){const t=e.substr(++b).match(ce);if(!t||!t[2])return new de(se);y=parseInt(t[0],10),b+=t[0].length}if(e[b])return new de(se);if(p){if(f=p-1,s=a,1!==s)for(;"0"===e[l+s-1+Number(r)+Number(o)];)s-=1}else h[0]=0,a=1,p=1,s=0;for(y<=c&&c>y+16384?y=ie:y-=c;y>oe;){if(f+=1,f>=34){if(0===s){y=oe;break}pe(e,"overflow")}y-=1}if(t.allowRounding){for(;y<ie||p<a;){if(0===f&&s<p){y=ie,s=0;break}if(p<a?a-=1:f-=1,y<oe)y+=1;else{if(h.join("").match(/^0+$/)){y=oe;break}pe(e,"overflow")}}if(f+1<s){let t=u;o&&(l+=1,t+=1),r&&(l+=1,t+=1);const i=parseInt(e[l+f+1],10);let s=0;if(i>=5&&(s=1,5===i)){s=h[f]%2==1?1:0;for(let n=l+f+2;n<t;n++)if(parseInt(e[n],10)){s=1;break}}if(s){let e=f;for(;e>=0&&++h[e]>9;e--)if(h[e]=0,0===e){if(!(y<oe))return new de(n?ue:ae);y+=1,h[e]=1}}}}else{for(;y<ie||p<a;){if(0===f){if(0===s){y=ie;break}pe(e,"exponent underflow")}p<a?("0"!==e[a-1+Number(r)+Number(o)]&&0!==s&&pe(e,"inexact rounding"),a-=1):(0!==h[f]&&pe(e,"inexact rounding"),f-=1),y<oe?y+=1:pe(e,"overflow")}if(f+1<s){o&&(l+=1),r&&(l+=1);0!==parseInt(e[l+f+1],10)&&pe(e,"inexact rounding")}}if(g=ee.fromNumber(0),E=ee.fromNumber(0),0===s)g=ee.fromNumber(0),E=ee.fromNumber(0);else if(f<17){let e=0;for(E=ee.fromNumber(h[e++]),g=new ee(0,0);e<=f;e++)E=E.multiply(ee.fromNumber(10)),E=E.add(ee.fromNumber(h[e]))}else{let e=0;for(g=ee.fromNumber(h[e++]);e<=f-17;e++)g=g.multiply(ee.fromNumber(10)),g=g.add(ee.fromNumber(h[e]));for(E=ee.fromNumber(h[e++]);e<=f;e++)E=E.multiply(ee.fromNumber(10)),E=E.add(ee.fromNumber(h[e]))}const w=function(e,t){if(!e&&!t)return{high:ee.fromNumber(0),low:ee.fromNumber(0)};const n=e.shiftRightUnsigned(32),r=new ee(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new ee(t.getLowBits(),0);let s=n.multiply(o),u=n.multiply(i);const a=r.multiply(o);let c=r.multiply(i);return s=s.add(u.shiftRightUnsigned(32)),u=new ee(u.getLowBits(),0).add(a).add(c.shiftRightUnsigned(32)),s=s.add(u.shiftRightUnsigned(32)),c=u.shiftLeft(32).add(new ee(c.getLowBits(),0)),{high:s,low:c}}(g,ee.fromString("100000000000000000"));w.low=w.low.add(E),function(e,t){const n=e.high>>>0,r=t.high>>>0;if(n<r)return!0;if(n===r&&e.low>>>0<t.low>>>0)return!0;return!1}(w.low,E)&&(w.high=w.high.add(ee.fromNumber(1))),A=y+6176;const S={low:ee.fromNumber(0),high:ee.fromNumber(0)};w.high.shiftRightUnsigned(49).and(ee.fromNumber(1)).equals(ee.fromNumber(1))?(S.high=S.high.or(ee.fromNumber(3).shiftLeft(61)),S.high=S.high.or(ee.fromNumber(A).and(ee.fromNumber(16383).shiftLeft(47))),S.high=S.high.or(w.high.and(ee.fromNumber(0x7fffffffffff)))):(S.high=S.high.or(ee.fromNumber(16383&A).shiftLeft(49)),S.high=S.high.or(w.high.and(ee.fromNumber(562949953421311)))),S.low=w.low,n&&(S.high=S.high.or(ee.fromString("9223372036854775808")));const v=$.allocateUnsafe(16);return b=0,v[b++]=255&S.low.low,v[b++]=S.low.low>>8&255,v[b++]=S.low.low>>16&255,v[b++]=S.low.low>>24&255,v[b++]=255&S.low.high,v[b++]=S.low.high>>8&255,v[b++]=S.low.high>>16&255,v[b++]=S.low.high>>24&255,v[b++]=255&S.high.low,v[b++]=S.high.low>>8&255,v[b++]=S.high.low>>16&255,v[b++]=S.high.low>>24&255,v[b++]=255&S.high.high,v[b++]=S.high.high>>8&255,v[b++]=S.high.high>>16&255,v[b++]=S.high.high>>24&255,new de(v)}toString(){let e,t=0;const n=new Array(36);for(let e=0;e<n.length;e++)n[e]=0;let r,o,i,s=0,u=!1,a={parts:[0,0,0,0]};const c=[];s=0;const l=this.bytes,h=l[s++]|l[s++]<<8|l[s++]<<16|l[s++]<<24,p=l[s++]|l[s++]<<8|l[s++]<<16|l[s++]<<24,d=l[s++]|l[s++]<<8|l[s++]<<16|l[s++]<<24,f=l[s++]|l[s++]<<8|l[s++]<<16|l[s++]<<24;s=0;({low:new ee(h,p),high:new ee(d,f)}).high.lessThan(ee.ZERO)&&c.push("-");const m=f>>26&31;if(m>>3==3){if(30===m)return c.join("")+"Infinity";if(31===m)return"NaN";e=f>>15&16383,r=8+(f>>14&1)}else r=f>>14&7,e=f>>17&16383;const y=e-6176;if(a.parts[0]=(16383&f)+((15&r)<<14),a.parts[1]=d,a.parts[2]=p,a.parts[3]=h,0===a.parts[0]&&0===a.parts[1]&&0===a.parts[2]&&0===a.parts[3])u=!0;else for(i=3;i>=0;i--){let e=0;const t=he(a);if(a=t.quotient,e=t.rem.low,e)for(o=8;o>=0;o--)n[9*i+o]=e%10,e=Math.floor(e/10)}if(u)t=1,n[s]=0;else for(t=36;!n[s];)t-=1,s+=1;const g=t-1+y;if(g>=34||g<=-7||y>0){if(t>34)return c.push("0"),y>0?c.push(`E+${y}`):y<0&&c.push(`E${y}`),c.join("");c.push(`${n[s++]}`),t-=1,t&&c.push(".");for(let e=0;e<t;e++)c.push(`${n[s++]}`);c.push("E"),g>0?c.push(`+${g}`):c.push(`${g}`)}else if(y>=0)for(let e=0;e<t;e++)c.push(`${n[s++]}`);else{let e=t+y;if(e>0)for(let t=0;t<e;t++)c.push(`${n[s++]}`);else c.push("0");for(c.push(".");e++<0;)c.push("0");for(let r=0;r<t-Math.max(e-1,0);r++)c.push(`${n[s++]}`)}return c.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(e){return de.fromString(e.$numberDecimal)}inspect(e,t,n){n??=s;return`new Decimal128(${n(this.toString(),t)})`}}class fe extends x{get _bsontype(){return"Double"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e}static fromString(e){const t=Number(e);if("NaN"===e)return new fe(NaN);if("Infinity"===e)return new fe(1/0);if("-Infinity"===e)return new fe(-1/0);if(!Number.isFinite(t))throw new m(`Input: ${e} is not representable as a Double`);if(e.trim()!==e)throw new m(`Input: '${e}' contains whitespace`);if(""===e)throw new m("Input is an empty string");if(/[^-0-9.+eE]/.test(e))throw new m(`Input: '${e}' is not in decimal or exponential notation`);return new fe(t)}valueOf(){return this.value}toJSON(){return this.value}toString(e){return this.value.toString(e)}toExtendedJSON(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(e,t){const n=parseFloat(e.$numberDouble);return t&&t.relaxed?n:new fe(n)}inspect(e,t,n){return n??=s,`new Double(${n(this.value,t)})`}}class me extends x{get _bsontype(){return"Int32"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=0|+e}static fromString(e){const t=G(e),n=Number(e);if(a<n)throw new m(`Input: '${e}' is larger than the maximum value for Int32`);if(c>n)throw new m(`Input: '${e}' is smaller than the minimum value for Int32`);if(!Number.isSafeInteger(n))throw new m(`Input: '${e}' is not a safe integer`);if(n.toString()!==t)throw new m(`Input: '${e}' is not a valid Int32 string`);return new me(n)}valueOf(){return this.value}toString(e){return this.value.toString(e)}toJSON(){return this.value}toExtendedJSON(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(e,t){return t&&t.relaxed?parseInt(e.$numberInt,10):new me(e.$numberInt)}inspect(e,t,n){return n??=s,`new Int32(${n(this.value,t)})`}}class ye extends x{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new ye}inspect(){return"new MaxKey()"}}class ge extends x{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new ge}inspect(){return"new MinKey()"}}let Ee=null;const Ae=new WeakMap;class be extends x{get _bsontype(){return"ObjectId"}constructor(e){let t;if(super(),"object"==typeof e&&e&&"id"in e){if("string"!=typeof e.id&&!ArrayBuffer.isView(e.id))throw new m("Argument passed in must have an id that is of type string or Buffer");t="toHexString"in e&&"function"==typeof e.toHexString?$.fromHex(e.toHexString()):e.id}else t=e;if(null==t||"number"==typeof t)this.buffer=be.generate("number"==typeof t?t:void 0);else if(ArrayBuffer.isView(t)&&12===t.byteLength)this.buffer=$.toLocalBufferType(t);else{if("string"!=typeof t)throw new m("Argument passed in does not match the accepted types");if(!be.validateHexString(t))throw new m("input must be a 24 character hex string, 12 byte Uint8Array, or an integer");this.buffer=$.fromHex(t),be.cacheHexString&&Ae.set(this,t)}}get id(){return this.buffer}set id(e){this.buffer=e,be.cacheHexString&&Ae.set(this,$.toHex(e))}static validateHexString(e){if(24!==e?.length)return!1;for(let t=0;t<24;t++){const n=e.charCodeAt(t);if(!(n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70))return!1}return!0}toHexString(){if(be.cacheHexString){const e=Ae.get(this);if(e)return e}const e=$.toHex(this.id);return be.cacheHexString&&Ae.set(this,e),e}static getInc(){return be.index=(be.index+1)%16777215}static generate(e){"number"!=typeof e&&(e=Math.floor(Date.now()/1e3));const t=be.getInc(),n=$.allocateUnsafe(12);return R.setInt32BE(n,0,e),null===Ee&&(Ee=$.randomBytes(5)),n[4]=Ee[0],n[5]=Ee[1],n[6]=Ee[2],n[7]=Ee[3],n[8]=Ee[4],n[11]=255&t,n[10]=t>>8&255,n[9]=t>>16&255,n}toString(e){return"base64"===e?$.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}static is(e){return null!=e&&"object"==typeof e&&"_bsontype"in e&&"ObjectId"===e._bsontype}equals(e){if(null==e)return!1;if(be.is(e))return this.buffer[11]===e.buffer[11]&&$.equals(this.buffer,e.buffer);if("string"==typeof e)return e.toLowerCase()===this.toHexString();if("object"==typeof e&&"function"==typeof e.toHexString){const t=e.toHexString(),n=this.toHexString();return"string"==typeof t&&t.toLowerCase()===n}return!1}getTimestamp(){const e=new Date,t=R.getUint32BE(this.buffer,0);return e.setTime(1e3*Math.floor(t)),e}static createPk(){return new be}serializeInto(e,t){return e[t]=this.buffer[0],e[t+1]=this.buffer[1],e[t+2]=this.buffer[2],e[t+3]=this.buffer[3],e[t+4]=this.buffer[4],e[t+5]=this.buffer[5],e[t+6]=this.buffer[6],e[t+7]=this.buffer[7],e[t+8]=this.buffer[8],e[t+9]=this.buffer[9],e[t+10]=this.buffer[10],e[t+11]=this.buffer[11],12}static createFromTime(e){const t=$.allocate(12);for(let e=11;e>=4;e--)t[e]=0;return R.setInt32BE(t,0,e),new be(t)}static createFromHexString(e){if(24!==e?.length)throw new m("hex string must be 24 characters");return new be($.fromHex(e))}static createFromBase64(e){if(16!==e?.length)throw new m("base64 string must be 16 characters");return new be($.fromBase64(e))}static isValid(e){if(null==e)return!1;if("string"==typeof e)return be.validateHexString(e);try{return new be(e),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(e){return new be(e.$oid)}isCached(){return be.cacheHexString&&Ae.has(this)}inspect(e,t,n){return n??=s,`new ObjectId(${n(this.toHexString(),t)})`}}function _e(e,t,n){let r=5;if(Array.isArray(e))for(let o=0;o<e.length;o++)r+=Oe(o.toString(),e[o],t,!0,n);else{"function"==typeof e?.toBSON&&(e=e.toBSON());for(const o of Object.keys(e))r+=Oe(o,e[o],t,!1,n)}return r}function Oe(e,t,o=!1,s=!1,l=!1){switch("function"==typeof t?.toBSON&&(t=t.toBSON()),typeof t){case"string":return 1+$.utf8ByteLength(e)+1+4+$.utf8ByteLength(t)+1;case"number":return Math.floor(t)===t&&t>=d&&t<=p&&t>=c&&t<=a?(null!=e?$.utf8ByteLength(e)+1:0)+5:(null!=e?$.utf8ByteLength(e)+1:0)+9;case"undefined":return s||!l?(null!=e?$.utf8ByteLength(e)+1:0)+1:0;case"boolean":return(null!=e?$.utf8ByteLength(e)+1:0)+2;case"object":if(null!=t&&"string"==typeof t._bsontype&&6!==t[u])throw new y;if(null==t||"MinKey"===t._bsontype||"MaxKey"===t._bsontype)return(null!=e?$.utf8ByteLength(e)+1:0)+1;if("ObjectId"===t._bsontype)return(null!=e?$.utf8ByteLength(e)+1:0)+13;if(t instanceof Date||i(t))return(null!=e?$.utf8ByteLength(e)+1:0)+9;if(ArrayBuffer.isView(t)||t instanceof ArrayBuffer||n(t))return(null!=e?$.utf8ByteLength(e)+1:0)+6+t.byteLength;if("Long"===t._bsontype||"Double"===t._bsontype||"Timestamp"===t._bsontype)return(null!=e?$.utf8ByteLength(e)+1:0)+9;if("Decimal128"===t._bsontype)return(null!=e?$.utf8ByteLength(e)+1:0)+17;if("Code"===t._bsontype)return null!=t.scope&&Object.keys(t.scope).length>0?(null!=e?$.utf8ByteLength(e)+1:0)+1+4+4+$.utf8ByteLength(t.code.toString())+1+_e(t.scope,o,l):(null!=e?$.utf8ByteLength(e)+1:0)+1+4+$.utf8ByteLength(t.code.toString())+1;if("Binary"===t._bsontype){const n=t;return n.sub_type===k.SUBTYPE_BYTE_ARRAY?(null!=e?$.utf8ByteLength(e)+1:0)+(n.position+1+4+1+4):(null!=e?$.utf8ByteLength(e)+1:0)+(n.position+1+4+1)}if("Symbol"===t._bsontype)return(null!=e?$.utf8ByteLength(e)+1:0)+$.utf8ByteLength(t.value)+4+1+1;if("DBRef"===t._bsontype){const n=Object.assign({$ref:t.collection,$id:t.oid},t.fields);return null!=t.db&&(n.$db=t.db),(null!=e?$.utf8ByteLength(e)+1:0)+1+_e(n,o,l)}return t instanceof RegExp||r(t)?(null!=e?$.utf8ByteLength(e)+1:0)+1+$.utf8ByteLength(t.source)+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1:"BSONRegExp"===t._bsontype?(null!=e?$.utf8ByteLength(e)+1:0)+1+$.utf8ByteLength(t.pattern)+1+$.utf8ByteLength(t.options)+1:(null!=e?$.utf8ByteLength(e)+1:0)+_e(t,o,l)+1;case"function":return o?(null!=e?$.utf8ByteLength(e)+1:0)+1+4+$.utf8ByteLength(t.toString())+1:0;case"bigint":return(null!=e?$.utf8ByteLength(e)+1:0)+9;case"symbol":return 0;default:throw new m("Unrecognized JS type: "+typeof t)}}be.index=Math.floor(16777215*Math.random());class Ce extends x{get _bsontype(){return"BSONRegExp"}constructor(e,t){if(super(),this.pattern=e,this.options=(t??"").split("").sort().join(""),-1!==this.pattern.indexOf("\0"))throw new m(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(-1!==this.options.indexOf("\0"))throw new m(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let e=0;e<this.options.length;e++)if("i"!==this.options[e]&&"m"!==this.options[e]&&"x"!==this.options[e]&&"l"!==this.options[e]&&"s"!==this.options[e]&&"u"!==this.options[e])throw new m(`The regular expression option [${this.options[e]}] is not supported`)}static parseOptions(e){return e?e.split("").sort().join(""):""}toExtendedJSON(e){return(e=e||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(e){if("$regex"in e){if("string"==typeof e.$regex)return new Ce(e.$regex,Ce.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new Ce(e.$regularExpression.pattern,Ce.parseOptions(e.$regularExpression.options));throw new m(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(e)}`)}inspect(e,t,n){const r=function(e){if(null!=e&&"object"==typeof e&&"stylize"in e&&"function"==typeof e.stylize)return e.stylize}(t)??(e=>e);n??=s;return`new BSONRegExp(${r(n(this.pattern),"regexp")}, ${r(n(this.options),"regexp")})`}}class we extends x{get _bsontype(){return"BSONSymbol"}constructor(e){super(),this.value=e}valueOf(){return this.value}toString(){return this.value}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(e){return new we(e.$symbol)}inspect(e,t,n){return n??=s,`new BSONSymbol(${n(this.value,t)})`}}const Se=ee;class ve extends Se{get _bsontype(){return"Timestamp"}get i(){return this.low>>>0}get t(){return this.high>>>0}constructor(e){if(null==e)super(0,0,!0);else if("bigint"==typeof e)super(e,!0);else if(ee.isLong(e))super(e.low,e.high,!0);else{if("object"!=typeof e||!("t"in e)||!("i"in e))throw new m("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }");{if("number"!=typeof e.t&&("object"!=typeof e.t||"Int32"!==e.t._bsontype))throw new m("Timestamp constructed from { t, i } must provide t as a number");if("number"!=typeof e.i&&("object"!=typeof e.i||"Int32"!==e.i._bsontype))throw new m("Timestamp constructed from { t, i } must provide i as a number");const t=Number(e.t),n=Number(e.i);if(t<0||Number.isNaN(t))throw new m("Timestamp constructed from { t, i } must provide a positive t");if(n<0||Number.isNaN(n))throw new m("Timestamp constructed from { t, i } must provide a positive i");if(t>4294967295)throw new m("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(n>4294967295)throw new m("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(n,t,!0)}}}toJSON(){return{$timestamp:this.toString()}}static fromInt(e){return new ve(ee.fromInt(e,!0))}static fromNumber(e){return new ve(ee.fromNumber(e,!0))}static fromBits(e,t){return new ve({i:e,t:t})}static fromString(e,t){return new ve(ee.fromString(e,!0,t))}toExtendedJSON(){return{$timestamp:{t:this.t,i:this.i}}}static fromExtendedJSON(e){const t=ee.isLong(e.$timestamp.i)?e.$timestamp.i.getLowBitsUnsigned():e.$timestamp.i,n=ee.isLong(e.$timestamp.t)?e.$timestamp.t.getLowBitsUnsigned():e.$timestamp.t;return new ve({t:n,i:t})}inspect(e,t,n){n??=s;return`new Timestamp({ t: ${n(this.t,t)}, i: ${n(this.i,t)} })`}}ve.MAX_VALUE=ee.MAX_UNSIGNED_VALUE;const De=ee.fromNumber(p),Me=ee.fromNumber(d);function Te(e,t,n){const r=(t=null==t?{}:t)&&t.index?t.index:0,o=R.getInt32LE(e,r);if(o<5)throw new m(`bson size must be >= 5, is ${o}`);if(t.allowObjectSmallerThanBufferSize&&e.length<o)throw new m(`buffer length ${e.length} must be >= bson size ${o}`);if(!t.allowObjectSmallerThanBufferSize&&e.length!==o)throw new m(`buffer length ${e.length} must === bson size ${o}`);if(o+r>e.byteLength)throw new m(`(bson size ${o} + options.index ${r} must be <= buffer length ${e.byteLength})`);if(0!==e[r+o-1])throw new m("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return Fe(e,r,t,n)}const Be=/^\$ref$|^\$id$|^\$db$/;function Fe(e,t,n,r=!1){const o=null==n.fieldsAsRaw?null:n.fieldsAsRaw,i=null!=n.raw&&n.raw,s="boolean"==typeof n.bsonRegExp&&n.bsonRegExp,u=n.promoteBuffers??!1,a=n.promoteLongs??!0,c=n.promoteValues??!0,l=n.useBigInt64??!1;if(l&&!c)throw new m("Must either request bigint or Long for int64 deserialization");if(l&&!a)throw new m("Must either request bigint or Long for int64 deserialization");let h,p,d=!0;const f=(null==n.validation?{utf8:!0}:n.validation).utf8;if("boolean"==typeof f)h=f;else{d=!1;const e=Object.keys(f).map((function(e){return f[e]}));if(0===e.length)throw new m("UTF-8 validation setting cannot be empty");if("boolean"!=typeof e[0])throw new m("Invalid UTF-8 validation option, must specify boolean values");if(h=e[0],!e.every((e=>e===h)))throw new m("Invalid UTF-8 validation option - keys must be all true or all false")}if(!d){p=new Set;for(const e of Object.keys(f))p.add(e)}const y=t;if(e.length<5)throw new m("corrupt bson message < 5 bytes long");const g=R.getInt32LE(e,t);if(t+=4,g<5||g>e.length)throw new m("corrupt bson message");const E=r?[]:{};let A=0,b=!r&&null;for(;;){const f=e[t++];if(0===f)break;let y=t;for(;0!==e[y]&&y<e.length;)y++;if(y>=e.byteLength)throw new m("Bad BSON Document: illegal CString");const g=r?A++:$.toUTF8(e,t,y,!1);let _,O=!0;if(O=d||p?.has(g)?h:!h,!1!==b&&"$"===g[0]&&(b=Be.test(g)),t=y+1,2===f){const n=R.getInt32LE(e,t);if(t+=4,n<=0||n>e.length-t||0!==e[t+n-1])throw new m("bad string length in bson");_=$.toUTF8(e,t,t+n-1,O),t+=n}else if(7===f){const n=$.allocateUnsafe(12);for(let r=0;r<12;r++)n[r]=e[t+r];_=new be(n),t+=12}else if(16===f&&!1===c)_=new me(R.getInt32LE(e,t)),t+=4;else if(16===f)_=R.getInt32LE(e,t),t+=4;else if(1===f)_=R.getFloat64LE(e,t),t+=8,!1===c&&(_=new fe(_));else if(9===f){const n=R.getInt32LE(e,t),r=R.getInt32LE(e,t+4);t+=8,_=new Date(new ee(n,r).toNumber())}else if(8===f){if(0!==e[t]&&1!==e[t])throw new m("illegal boolean type value");_=1===e[t++]}else if(3===f){const r=t,o=R.getInt32LE(e,t);if(o<=0||o>e.length-t)throw new m("bad embedded document length in bson");if(i)_=e.subarray(t,t+o);else{let t=n;d||(t={...n,validation:{utf8:O}}),_=Fe(e,r,t,!1)}t+=o}else if(4===f){const r=t,i=R.getInt32LE(e,t);let s=n;const u=t+i;if(o&&o[g]&&(s={...n,raw:!0}),d||(s={...s,validation:{utf8:O}}),_=Fe(e,r,s,!0),0!==e[(t+=i)-1])throw new m("invalid array terminator byte");if(t!==u)throw new m("corrupted array bson")}else if(6===f)_=void 0;else if(10===f)_=null;else if(18===f)if(l)_=R.getBigInt64LE(e,t),t+=8;else{const n=R.getInt32LE(e,t),r=R.getInt32LE(e,t+4);t+=8;const o=new ee(n,r);_=a&&!0===c&&o.lessThanOrEqual(De)&&o.greaterThanOrEqual(Me)?o.toNumber():o}else if(19===f){const n=$.allocateUnsafe(16);for(let r=0;r<16;r++)n[r]=e[t+r];t+=16,_=new de(n)}else if(5===f){let n=R.getInt32LE(e,t);t+=4;const r=n,o=e[t++];if(n<0)throw new m("Negative binary type element size found");if(n>e.byteLength)throw new m("Binary type size larger than document size");if(o===k.SUBTYPE_BYTE_ARRAY){if(n=R.getInt32LE(e,t),t+=4,n<0)throw new m("Negative binary type element size found for subtype 0x02");if(n>r-4)throw new m("Binary type with subtype 0x02 contains too long binary size");if(n<r-4)throw new m("Binary type with subtype 0x02 contains too short binary size")}u&&c?_=$.toLocalBufferType(e.subarray(t,t+n)):(_=new k(e.subarray(t,t+n),o),4===o&&V.isValid(_)&&(_=_.toUUID())),t+=n}else if(11===f&&!1===s){for(y=t;0!==e[y]&&y<e.length;)y++;if(y>=e.length)throw new m("Bad BSON Document: illegal CString");const n=$.toUTF8(e,t,y,!1);for(y=t=y+1;0!==e[y]&&y<e.length;)y++;if(y>=e.length)throw new m("Bad BSON Document: illegal CString");const r=$.toUTF8(e,t,y,!1);t=y+1;const o=new Array(r.length);for(y=0;y<r.length;y++)switch(r[y]){case"m":o[y]="m";break;case"s":o[y]="g";break;case"i":o[y]="i"}_=new RegExp(n,o.join(""))}else if(11===f&&!0===s){for(y=t;0!==e[y]&&y<e.length;)y++;if(y>=e.length)throw new m("Bad BSON Document: illegal CString");const n=$.toUTF8(e,t,y,!1);for(y=t=y+1;0!==e[y]&&y<e.length;)y++;if(y>=e.length)throw new m("Bad BSON Document: illegal CString");const r=$.toUTF8(e,t,y,!1);t=y+1,_=new Ce(n,r)}else if(14===f){const n=R.getInt32LE(e,t);if(t+=4,n<=0||n>e.length-t||0!==e[t+n-1])throw new m("bad string length in bson");const r=$.toUTF8(e,t,t+n-1,O);_=c?r:new we(r),t+=n}else if(17===f)_=new ve({i:R.getUint32LE(e,t),t:R.getUint32LE(e,t+4)}),t+=8;else if(255===f)_=new ge;else if(127===f)_=new ye;else if(13===f){const n=R.getInt32LE(e,t);if(t+=4,n<=0||n>e.length-t||0!==e[t+n-1])throw new m("bad string length in bson");const r=$.toUTF8(e,t,t+n-1,O);_=new z(r),t+=n}else if(15===f){const r=R.getInt32LE(e,t);if(t+=4,r<13)throw new m("code_w_scope total size shorter minimum expected length");const o=R.getInt32LE(e,t);if(t+=4,o<=0||o>e.length-t||0!==e[t+o-1])throw new m("bad string length in bson");const i=$.toUTF8(e,t,t+o-1,O),s=t+=o,u=R.getInt32LE(e,t),a=Fe(e,s,n,!1);if(t+=u,r<8+u+o)throw new m("code_w_scope total size is too short, truncating scope");if(r>8+u+o)throw new m("code_w_scope total size is too long, clips outer document");_=new z(i,a)}else{if(12!==f)throw new m(`Detected unknown BSON type ${f.toString(16)} for fieldname "${g}"`);{const n=R.getInt32LE(e,t);if(t+=4,n<=0||n>e.length-t||0!==e[t+n-1])throw new m("bad string length in bson");const r=$.toUTF8(e,t,t+n-1,O);t+=n;const o=$.allocateUnsafe(12);for(let n=0;n<12;n++)o[n]=e[t+n];const i=new be(o);t+=12,_=new q(r,i)}}"__proto__"===g?Object.defineProperty(E,g,{value:_,writable:!0,enumerable:!0,configurable:!0}):E[g]=_}if(g!==t-y){if(r)throw new m("corrupt array bson");throw new m("corrupt object bson")}if(!b)return E;if(W(E)){const e=Object.assign({},E);return delete e.$ref,delete e.$id,delete e.$db,new q(E.$ref,E.$id,E.$db,e)}return E}const $e=/\x00/,xe=new Set(["$db","$ref","$id","$clusterTime"]);function Pe(e,t,n,r){e[r++]=2;e[(r=r+$.encodeUTF8Into(e,t,r)+1)-1]=0;const o=$.encodeUTF8Into(e,n,r+4);return R.setInt32LE(e,r,o+1),r=r+4+o,e[r++]=0,r}function Ne(e,t,n,r){const o=!Object.is(n,-0)&&Number.isSafeInteger(n)&&n<=a&&n>=c?16:1;e[r++]=o;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r+=16===o?R.setInt32LE(e,r,n):R.setFloat64LE(e,r,n)}function Ie(e,t,n,r){e[r++]=18;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r+=R.setBigInt64LE(e,r,n)}function Re(e,t,n,r){e[r++]=10;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r}function ke(e,t,n,r){e[r++]=8;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,e[r++]=n?1:0,r}function je(e,t,n,r){e[r++]=9;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=ee.fromNumber(n.getTime()),i=o.getLowBits(),s=o.getHighBits();return r+=R.setInt32LE(e,r,i),r+=R.setInt32LE(e,r,s)}function Le(e,t,n,r){e[r++]=11;if(r+=$.encodeUTF8Into(e,t,r),e[r++]=0,n.source&&null!=n.source.match($e))throw new m("value "+n.source+" must not contain null bytes");return r+=$.encodeUTF8Into(e,n.source,r),e[r++]=0,n.ignoreCase&&(e[r++]=105),n.global&&(e[r++]=115),n.multiline&&(e[r++]=109),e[r++]=0,r}function Ue(e,t,n,r){e[r++]=11;if(r+=$.encodeUTF8Into(e,t,r),e[r++]=0,null!=n.pattern.match($e))throw new m("pattern "+n.pattern+" must not contain null bytes");r+=$.encodeUTF8Into(e,n.pattern,r),e[r++]=0;const o=n.options.split("").sort().join("");return r+=$.encodeUTF8Into(e,o,r),e[r++]=0,r}function Ve(e,t,n,r){null===n?e[r++]=10:"MinKey"===n._bsontype?e[r++]=255:e[r++]=127;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r}function ze(e,t,n,r){e[r++]=7;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r+=n.serializeInto(e,r)}function We(e,t,n,r){e[r++]=5;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=n.length;if(r+=R.setInt32LE(e,r,o),e[r++]=0,o<=16)for(let t=0;t<o;t++)e[r+t]=n[t];else e.set(n,r);return r+=o}function qe(e,t,n,r,o,i,s,u,a){if(a.has(n))throw new m("Cannot convert circular structure to BSON");a.add(n),e[r++]=Array.isArray(n)?4:3;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const c=tt(e,n,o,r,i+1,s,u,a);return a.delete(n),c}function Ge(e,t,n,r){e[r++]=19;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;for(let t=0;t<16;t++)e[r+t]=n.bytes[t];return r+16}function He(e,t,n,r){e[r++]="Long"===n._bsontype?18:17;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=n.getLowBits(),i=n.getHighBits();return r+=R.setInt32LE(e,r,o),r+=R.setInt32LE(e,r,i)}function Ke(e,t,n,r){n=n.valueOf(),e[r++]=16;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r+=R.setInt32LE(e,r,n)}function Ye(e,t,n,r){e[r++]=1;return r+=$.encodeUTF8Into(e,t,r),e[r++]=0,r+=R.setFloat64LE(e,r,n.value)}function Qe(e,t,n,r){e[r++]=13;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=n.toString(),i=$.encodeUTF8Into(e,o,r+4)+1;return R.setInt32LE(e,r,i),r=r+4+i-1,e[r++]=0,r}function Je(e,t,n,r,o=!1,i=0,s=!1,u=!0,a){if(n.scope&&"object"==typeof n.scope){e[r++]=15;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;let c=r;const l=n.code;r+=4;const h=$.encodeUTF8Into(e,l,r+4)+1;R.setInt32LE(e,r,h),e[r+4+h-1]=0,r=r+h+4;const p=tt(e,n.scope,o,r,i+1,s,u,a);r=p-1;const d=p-c;c+=R.setInt32LE(e,c,d),e[r++]=0}else{e[r++]=13;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=n.code.toString(),i=$.encodeUTF8Into(e,o,r+4)+1;R.setInt32LE(e,r,i),r=r+4+i-1,e[r++]=0}return r}function Xe(e,t,n,r){e[r++]=5;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=n.buffer;let i=n.position;if(n.sub_type===k.SUBTYPE_BYTE_ARRAY&&(i+=4),r+=R.setInt32LE(e,r,i),e[r++]=n.sub_type,n.sub_type===k.SUBTYPE_BYTE_ARRAY&&(i-=4,r+=R.setInt32LE(e,r,i)),n.sub_type===k.SUBTYPE_VECTOR&&j(n),i<=16)for(let t=0;t<i;t++)e[r+t]=o[t];else e.set(o,r);return r+=n.position}function Ze(e,t,n,r){e[r++]=14;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;const o=$.encodeUTF8Into(e,n.value,r+4)+1;return R.setInt32LE(e,r,o),r=r+4+o-1,e[r++]=0,r}function et(e,t,n,r,o,i,s){e[r++]=3;r+=$.encodeUTF8Into(e,t,r),e[r++]=0;let u=r,a={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(a.$db=n.db),a=Object.assign(a,n.fields);const c=tt(e,a,!1,r,o+1,i,!0,s),l=c-u;return u+=R.setInt32LE(e,r,l),c}function tt(e,s,a,c,l,h,p,d){if(null==d){if(null==s)return e[0]=5,e[1]=0,e[2]=0,e[3]=0,e[4]=0,5;if(Array.isArray(s))throw new m("serialize does not support an array as the root input");if("object"!=typeof s)throw new m("serialize does not support non-object as the root input");if("_bsontype"in s&&"string"==typeof s._bsontype)throw new m("BSON types cannot be serialized as a document");if(i(s)||r(s)||t(s)||n(s))throw new m("date, regexp, typedarray, and arraybuffer cannot be BSON documents");d=new Set}d.add(s);let f=c+4;if(Array.isArray(s))for(let n=0;n<s.length;n++){const o=`${n}`;let c=s[n];"function"==typeof c?.toBSON&&(c=c.toBSON());const g=typeof c;if(void 0===c)f=Re(e,o,0,f);else if(null===c)f=Re(e,o,0,f);else if("string"===g)f=Pe(e,o,c,f);else if("number"===g)f=Ne(e,o,c,f);else if("bigint"===g)f=Ie(e,o,c,f);else if("boolean"===g)f=ke(e,o,c,f);else if("object"===g&&null==c._bsontype)f=c instanceof Date||i(c)?je(e,o,c,f):c instanceof Uint8Array||t(c)?We(e,o,c,f):c instanceof RegExp||r(c)?Le(e,o,c,f):qe(e,o,c,f,a,l,h,p,d);else if("object"===g){if(6!==c[u])throw new y;if("ObjectId"===c._bsontype)f=ze(e,o,c,f);else if("Decimal128"===c._bsontype)f=Ge(e,o,c,f);else if("Long"===c._bsontype||"Timestamp"===c._bsontype)f=He(e,o,c,f);else if("Double"===c._bsontype)f=Ye(e,o,c,f);else if("Code"===c._bsontype)f=Je(e,o,c,f,a,l,h,p,d);else if("Binary"===c._bsontype)f=Xe(e,o,c,f);else if("BSONSymbol"===c._bsontype)f=Ze(e,o,c,f);else if("DBRef"===c._bsontype)f=et(e,o,c,f,l,h,d);else if("BSONRegExp"===c._bsontype)f=Ue(e,o,c,f);else if("Int32"===c._bsontype)f=Ke(e,o,c,f);else if("MinKey"===c._bsontype||"MaxKey"===c._bsontype)f=Ve(e,o,c,f);else if(void 0!==c._bsontype)throw new m(`Unrecognized or invalid _bsontype: ${String(c._bsontype)}`)}else"function"===g&&h&&(f=Qe(e,o,c,f))}else if(s instanceof Map||o(s)){const n=s.entries();let o=!1;for(;!o;){const s=n.next();if(o=!!s.done,o)continue;const c=s.value?s.value[0]:void 0;let g=s.value?s.value[1]:void 0;"function"==typeof g?.toBSON&&(g=g.toBSON());const E=typeof g;if("string"==typeof c&&!xe.has(c)){if(null!=c.match($e))throw new m("key "+c+" must not contain null bytes");if(a){if("$"===c[0])throw new m("key "+c+" must not start with '$'");if(c.includes("."))throw new m("key "+c+" must not contain '.'")}}if(void 0===g)!1===p&&(f=Re(e,c,0,f));else if(null===g)f=Re(e,c,0,f);else if("string"===E)f=Pe(e,c,g,f);else if("number"===E)f=Ne(e,c,g,f);else if("bigint"===E)f=Ie(e,c,g,f);else if("boolean"===E)f=ke(e,c,g,f);else if("object"===E&&null==g._bsontype)f=g instanceof Date||i(g)?je(e,c,g,f):g instanceof Uint8Array||t(g)?We(e,c,g,f):g instanceof RegExp||r(g)?Le(e,c,g,f):qe(e,c,g,f,a,l,h,p,d);else if("object"===E){if(6!==g[u])throw new y;if("ObjectId"===g._bsontype)f=ze(e,c,g,f);else if("Decimal128"===g._bsontype)f=Ge(e,c,g,f);else if("Long"===g._bsontype||"Timestamp"===g._bsontype)f=He(e,c,g,f);else if("Double"===g._bsontype)f=Ye(e,c,g,f);else if("Code"===g._bsontype)f=Je(e,c,g,f,a,l,h,p,d);else if("Binary"===g._bsontype)f=Xe(e,c,g,f);else if("BSONSymbol"===g._bsontype)f=Ze(e,c,g,f);else if("DBRef"===g._bsontype)f=et(e,c,g,f,l,h,d);else if("BSONRegExp"===g._bsontype)f=Ue(e,c,g,f);else if("Int32"===g._bsontype)f=Ke(e,c,g,f);else if("MinKey"===g._bsontype||"MaxKey"===g._bsontype)f=Ve(e,c,g,f);else if(void 0!==g._bsontype)throw new m(`Unrecognized or invalid _bsontype: ${String(g._bsontype)}`)}else"function"===E&&h&&(f=Qe(e,c,g,f))}}else{if("function"==typeof s?.toBSON&&null!=(s=s.toBSON())&&"object"!=typeof s)throw new m("toBSON function did not return an object");for(const n of Object.keys(s)){let o=s[n];"function"==typeof o?.toBSON&&(o=o.toBSON());const c=typeof o;if("string"==typeof n&&!xe.has(n)){if(null!=n.match($e))throw new m("key "+n+" must not contain null bytes");if(a){if("$"===n[0])throw new m("key "+n+" must not start with '$'");if(n.includes("."))throw new m("key "+n+" must not contain '.'")}}if(void 0===o)!1===p&&(f=Re(e,n,0,f));else if(null===o)f=Re(e,n,0,f);else if("string"===c)f=Pe(e,n,o,f);else if("number"===c)f=Ne(e,n,o,f);else if("bigint"===c)f=Ie(e,n,o,f);else if("boolean"===c)f=ke(e,n,o,f);else if("object"===c&&null==o._bsontype)f=o instanceof Date||i(o)?je(e,n,o,f):o instanceof Uint8Array||t(o)?We(e,n,o,f):o instanceof RegExp||r(o)?Le(e,n,o,f):qe(e,n,o,f,a,l,h,p,d);else if("object"===c){if(6!==o[u])throw new y;if("ObjectId"===o._bsontype)f=ze(e,n,o,f);else if("Decimal128"===o._bsontype)f=Ge(e,n,o,f);else if("Long"===o._bsontype||"Timestamp"===o._bsontype)f=He(e,n,o,f);else if("Double"===o._bsontype)f=Ye(e,n,o,f);else if("Code"===o._bsontype)f=Je(e,n,o,f,a,l,h,p,d);else if("Binary"===o._bsontype)f=Xe(e,n,o,f);else if("BSONSymbol"===o._bsontype)f=Ze(e,n,o,f);else if("DBRef"===o._bsontype)f=et(e,n,o,f,l,h,d);else if("BSONRegExp"===o._bsontype)f=Ue(e,n,o,f);else if("Int32"===o._bsontype)f=Ke(e,n,o,f);else if("MinKey"===o._bsontype||"MaxKey"===o._bsontype)f=Ve(e,n,o,f);else if(void 0!==o._bsontype)throw new m(`Unrecognized or invalid _bsontype: ${String(o._bsontype)}`)}else"function"===c&&h&&(f=Qe(e,n,o,f))}}d.delete(s),e[f++]=0;const g=f-c;return c+=R.setInt32LE(e,c,g),f}const nt={$oid:be,$binary:k,$uuid:k,$symbol:we,$numberInt:me,$numberDecimal:de,$numberDouble:fe,$numberLong:ee,$minKey:ge,$maxKey:ye,$regex:Ce,$regularExpression:Ce,$timestamp:ve};function rt(e,t={}){if("number"==typeof e){const n=e<=a&&e>=c,r=e<=l&&e>=h;if(t.relaxed||t.legacy)return e;if(Number.isInteger(e)&&!Object.is(e,-0)){if(n)return new me(e);if(r)return t.useBigInt64?BigInt(e):ee.fromNumber(e)}return new fe(e)}if(null==e||"object"!=typeof e)return e;if(e.$undefined)return null;const n=Object.keys(e).filter((t=>t.startsWith("$")&&null!=e[t]));for(let r=0;r<n.length;r++){const o=nt[n[r]];if(o)return o.fromExtendedJSON(e,t)}if(null!=e.$date){const n=e.$date,r=new Date;if(t.legacy)if("number"==typeof n)r.setTime(n);else if("string"==typeof n)r.setTime(Date.parse(n));else{if("bigint"!=typeof n)throw new g("Unrecognized type for EJSON date: "+typeof n);r.setTime(Number(n))}else if("string"==typeof n)r.setTime(Date.parse(n));else if(ee.isLong(n))r.setTime(n.toNumber());else if("number"==typeof n&&t.relaxed)r.setTime(n);else{if("bigint"!=typeof n)throw new g("Unrecognized type for EJSON date: "+typeof n);r.setTime(Number(n))}return r}if(null!=e.$code){const t=Object.assign({},e);return e.$scope&&(t.$scope=rt(e.$scope)),z.fromExtendedJSON(e)}if(W(e)||e.$dbPointer){const t=e.$ref?e:e.$dbPointer;if(t instanceof q)return t;const n=Object.keys(t).filter((e=>e.startsWith("$")));let r=!0;if(n.forEach((e=>{-1===["$ref","$id","$db"].indexOf(e)&&(r=!1)})),r)return q.fromExtendedJSON(t)}return e}function ot(e){const t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function it(e,t){if(e instanceof Map||o(e)){const n=Object.create(null);for(const[t,r]of e){if("string"!=typeof t)throw new m("Can only serialize maps with string keys");n[t]=r}return it(n,t)}if(("object"==typeof e||"function"==typeof e)&&null!==e){const n=t.seenObjects.findIndex((t=>t.obj===e));if(-1!==n){const e=t.seenObjects.map((e=>e.propertyName)),r=e.slice(0,n).map((e=>`${e} -> `)).join(""),o=e[n],i=" -> "+e.slice(n+1,e.length-1).map((e=>`${e} -> `)).join(""),s=e[e.length-1],u=" ".repeat(r.length+o.length/2),a="-".repeat(i.length+(o.length+s.length)/2-1);throw new m(`Converting circular structure to EJSON:\n    ${r}${o}${i}${s}\n    ${u}\\${a}/`)}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return function(e,t){return e.map(((e,n)=>{t.seenObjects.push({propertyName:`index ${n}`,obj:null});try{return it(e,t)}finally{t.seenObjects.pop()}}))}(e,t);if(void 0===e)return null;if(e instanceof Date||i(e)){const n=e.getTime(),r=n>-1&&n<2534023188e5;return t.legacy?t.relaxed&&r?{$date:e.getTime()}:{$date:ot(e)}:t.relaxed&&r?{$date:ot(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(!("number"!=typeof e||t.relaxed&&isFinite(e))){if(Number.isInteger(e)&&!Object.is(e,-0)){if(e>=c&&e<=a)return{$numberInt:e.toString()};if(e>=h&&e<=l)return{$numberLong:e.toString()}}return{$numberDouble:Object.is(e,-0)?"-0.0":e.toString()}}if("bigint"==typeof e)return t.relaxed?Number(BigInt.asIntN(64,e)):{$numberLong:BigInt.asIntN(64,e).toString()};if(e instanceof RegExp||r(e)){let n=e.flags;if(void 0===n){const t=e.toString().match(/[gimuy]*$/);t&&(n=t[0])}return new Ce(e.source,n).toExtendedJSON(t)}return null!=e&&"object"==typeof e?function(e,t){if(null==e||"object"!=typeof e)throw new m("not an object instance");const n=e._bsontype;if(void 0===n){const n={};for(const r of Object.keys(e)){t.seenObjects.push({propertyName:r,obj:null});try{const o=it(e[r],t);"__proto__"===r?Object.defineProperty(n,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):n[r]=o}finally{t.seenObjects.pop()}}return n}if(null!=e&&"object"==typeof e&&"string"==typeof e._bsontype&&6!==e[u])throw new y;if(function(e){return null!=e&&"object"==typeof e&&"_bsontype"in e&&"string"==typeof e._bsontype}(e)){let r=e;if("function"!=typeof r.toExtendedJSON){const t=st[e._bsontype];if(!t)throw new m("Unrecognized or invalid _bsontype: "+e._bsontype);r=t(r)}return"Code"===n&&r.scope?r=new z(r.code,it(r.scope,t)):"DBRef"===n&&r.oid&&(r=new q(it(r.collection,t),it(r.oid,t),it(r.db,t),it(r.fields,t))),r.toExtendedJSON(t)}throw new m("_bsontype must be a string, but was: "+typeof n)}(e,t):e}const st={Binary:e=>new k(e.value(),e.sub_type),Code:e=>new z(e.code,e.scope),DBRef:e=>new q(e.collection||e.namespace,e.oid,e.db,e.fields),Decimal128:e=>new de(e.bytes),Double:e=>new fe(e.value),Int32:e=>new me(e.value),Long:e=>ee.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_),MaxKey:()=>new ye,MinKey:()=>new ge,ObjectId:e=>new be(e),BSONRegExp:e=>new Ce(e.pattern,e.options),BSONSymbol:e=>new we(e.value),Timestamp:e=>ve.fromBits(e.low,e.high)};function ut(e,t){const n={useBigInt64:t?.useBigInt64??!1,relaxed:t?.relaxed??!0,legacy:t?.legacy??!1};return JSON.parse(e,((e,t)=>{if(-1!==e.indexOf("\0"))throw new m(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(e)}`);return rt(t,n)}))}function at(e,t,n,r){null!=n&&"object"==typeof n&&(r=n,n=0),null==t||"object"!=typeof t||Array.isArray(t)||(r=t,t=void 0,n=0);const o=it(e,Object.assign({relaxed:!0,legacy:!1},r,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(o,t,n)}const ct=Object.create(null);function lt(e,t){try{return R.getNonnegativeInt32LE(e,t)}catch(e){throw new E("BSON size cannot be negative",t,{cause:e})}}function ht(e,t){let n=t;for(;0!==e[n];n++);if(n===e.length-1)throw new E("Null terminator not found",t);return n}ct.parse=ut,ct.stringify=at,ct.serialize=function(e,t){return t=t||{},JSON.parse(at(e,t))},ct.deserialize=function(e,t){return t=t||{},ut(JSON.stringify(e),t)},Object.freeze(ct);const pt=Object.create(null);pt.parseToElements=function(e,t=0){if(t??=0,e.length<5)throw new E(`Input must be at least 5 bytes, got ${e.length} bytes`,t);const n=lt(e,t);if(n>e.length-t)throw new E(`Parsed documentSize (${n} bytes) does not match input length (${e.length} bytes)`,t);if(0!==e[t+n-1])throw new E("BSON documents must end in 0x00",t+n);const r=[];let o=t+4;for(;o<=n+t;){const i=e[o];if(o+=1,0===i){if(o-t!==n)throw new E("Invalid 0x00 type byte",o);break}const s=o,u=ht(e,o)-s;let a;if(o+=u+1,1===i||18===i||9===i||17===i)a=8;else if(16===i)a=4;else if(7===i)a=12;else if(19===i)a=16;else if(8===i)a=1;else if(10===i||6===i||127===i||255===i)a=0;else if(11===i)a=ht(e,ht(e,o)+1)+1-o;else if(3===i||4===i||15===i)a=lt(e,o);else{if(2!==i&&5!==i&&12!==i&&13!==i&&14!==i)throw new E(`Invalid 0x${i.toString(16).padStart(2,"0")} type byte`,o);a=lt(e,o)+4,5===i&&(a+=1),12===i&&(a+=12)}if(a>n)throw new E("value reports length larger than document",o);r.push([i,s,u,o,a]),o+=a}return r},pt.ByteUtils=$,pt.NumberUtils=R,Object.freeze(pt);const dt=17825792;let ft=$.allocate(dt);function mt(e){ft.length<e&&(ft=$.allocate(e))}function yt(e,t={}){const n="boolean"==typeof t.checkKeys&&t.checkKeys,r="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,o="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined,i="number"==typeof t.minInternalBufferSize?t.minInternalBufferSize:dt;ft.length<i&&(ft=$.allocate(i));const s=tt(ft,e,n,0,0,r,o,null),u=$.allocateUnsafe(s);return u.set(ft.subarray(0,s),0),u}function gt(e,t,n={}){const r="boolean"==typeof n.checkKeys&&n.checkKeys,o="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,i="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,s="number"==typeof n.index?n.index:0,u=tt(ft,e,r,0,0,o,i,null);return t.set(ft.subarray(0,u),s),s+u-1}function Et(e,t={}){return Te($.toLocalBufferType(e),t)}function At(e,t={}){return _e(e,"boolean"==typeof(t=t||{}).serializeFunctions&&t.serializeFunctions,"boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined)}function bt(e,t,n,r,o,i){const s=Object.assign({allowObjectSmallerThanBufferSize:!0,index:0},i),u=$.toLocalBufferType(e);let a=t;for(let e=0;e<n;e++){const t=R.getInt32LE(u,a);s.index=a,r[o+e]=Te(u,s),a+=t}return a}var _t=Object.freeze({__proto__:null,BSONError:m,BSONOffsetError:E,BSONRegExp:Ce,BSONRuntimeError:g,BSONSymbol:we,BSONType:f,BSONValue:x,BSONVersionError:y,Binary:k,Code:z,DBRef:q,Decimal128:de,Double:fe,EJSON:ct,Int32:me,Long:ee,MaxKey:ye,MinKey:ge,ObjectId:be,Timestamp:ve,UUID:V,calculateObjectSize:At,deserialize:Et,deserializeStream:bt,onDemand:pt,serialize:yt,serializeWithBufferAndIndex:gt,setInternalBufferSize:mt});return T.BSON=_t,T.BSONError=m,T.BSONOffsetError=E,T.BSONRegExp=Ce,T.BSONRuntimeError=g,T.BSONSymbol=we,T.BSONType=f,T.BSONValue=x,T.BSONVersionError=y,T.Binary=k,T.Code=z,T.DBRef=q,T.Decimal128=de,T.Double=fe,T.EJSON=ct,T.Int32=me,T.Long=ee,T.MaxKey=ye,T.MinKey=ge,T.ObjectId=be,T.Timestamp=ve,T.UUID=V,T.calculateObjectSize=At,T.deserialize=Et,T.deserializeStream=bt,T.onDemand=pt,T.serialize=yt,T.serializeWithBufferAndIndex=gt,T.setInternalBufferSize=mt,T}function F(){return w||(w=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toUTF8=e.getBigInt64LE=e.getFloat64LE=e.getInt32LE=e.UUID=e.Timestamp=e.serialize=e.ObjectId=e.MinKey=e.MaxKey=e.Long=e.Int32=e.EJSON=e.Double=e.deserialize=e.Decimal128=e.DBRef=e.Code=e.calculateObjectSize=e.BSONType=e.BSONSymbol=e.BSONRegExp=e.BSONError=e.BSON=e.Binary=void 0,e.parseToElementsToArray=function(e,n){const r=t.BSON.onDemand.parseToElements(e,n);return Array.isArray(r)?r:[...r]},e.pluckBSONSerializeOptions=function(e){const{fieldsAsRaw:t,useBigInt64:n,promoteValues:r,promoteBuffers:o,promoteLongs:i,serializeFunctions:s,ignoreUndefined:u,bsonRegExp:a,raw:c,enableUtf8Validation:l}=e;return{fieldsAsRaw:t,useBigInt64:n,promoteValues:r,promoteBuffers:o,promoteLongs:i,serializeFunctions:s,ignoreUndefined:u,bsonRegExp:a,raw:c,enableUtf8Validation:l}},e.resolveBSONOptions=function(e,t){const n=t?.bsonOptions;return{raw:e?.raw??n?.raw??!1,useBigInt64:e?.useBigInt64??n?.useBigInt64??!1,promoteLongs:e?.promoteLongs??n?.promoteLongs??!0,promoteValues:e?.promoteValues??n?.promoteValues??!0,promoteBuffers:e?.promoteBuffers??n?.promoteBuffers??!1,ignoreUndefined:e?.ignoreUndefined??n?.ignoreUndefined??!1,bsonRegExp:e?.bsonRegExp??n?.bsonRegExp??!1,serializeFunctions:e?.serializeFunctions??n?.serializeFunctions??!1,fieldsAsRaw:e?.fieldsAsRaw??n?.fieldsAsRaw??{},enableUtf8Validation:e?.enableUtf8Validation??n?.enableUtf8Validation??!0}},e.parseUtf8ValidationOption=function(e){const t=e?.enableUtf8Validation;if(!1===t)return{utf8:!1};return{utf8:{writeErrors:!1}}};const t=B();var n=B();Object.defineProperty(e,"Binary",{enumerable:!0,get:function(){return n.Binary}}),Object.defineProperty(e,"BSON",{enumerable:!0,get:function(){return n.BSON}}),Object.defineProperty(e,"BSONError",{enumerable:!0,get:function(){return n.BSONError}}),Object.defineProperty(e,"BSONRegExp",{enumerable:!0,get:function(){return n.BSONRegExp}}),Object.defineProperty(e,"BSONSymbol",{enumerable:!0,get:function(){return n.BSONSymbol}}),Object.defineProperty(e,"BSONType",{enumerable:!0,get:function(){return n.BSONType}}),Object.defineProperty(e,"calculateObjectSize",{enumerable:!0,get:function(){return n.calculateObjectSize}}),Object.defineProperty(e,"Code",{enumerable:!0,get:function(){return n.Code}}),Object.defineProperty(e,"DBRef",{enumerable:!0,get:function(){return n.DBRef}}),Object.defineProperty(e,"Decimal128",{enumerable:!0,get:function(){return n.Decimal128}}),Object.defineProperty(e,"deserialize",{enumerable:!0,get:function(){return n.deserialize}}),Object.defineProperty(e,"Double",{enumerable:!0,get:function(){return n.Double}}),Object.defineProperty(e,"EJSON",{enumerable:!0,get:function(){return n.EJSON}}),Object.defineProperty(e,"Int32",{enumerable:!0,get:function(){return n.Int32}}),Object.defineProperty(e,"Long",{enumerable:!0,get:function(){return n.Long}}),Object.defineProperty(e,"MaxKey",{enumerable:!0,get:function(){return n.MaxKey}}),Object.defineProperty(e,"MinKey",{enumerable:!0,get:function(){return n.MinKey}}),Object.defineProperty(e,"ObjectId",{enumerable:!0,get:function(){return n.ObjectId}}),Object.defineProperty(e,"serialize",{enumerable:!0,get:function(){return n.serialize}}),Object.defineProperty(e,"Timestamp",{enumerable:!0,get:function(){return n.Timestamp}}),Object.defineProperty(e,"UUID",{enumerable:!0,get:function(){return n.UUID}}),e.getInt32LE=t.BSON.onDemand.NumberUtils.getInt32LE,e.getFloat64LE=t.BSON.onDemand.NumberUtils.getFloat64LE,e.getBigInt64LE=t.BSON.onDemand.NumberUtils.getBigInt64LE,e.toUTF8=t.BSON.onDemand.ByteUtils.toUTF8}(M)),M}var $,x={};function P(){return $||($=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MongoWriteConcernError=e.MongoServerSelectionError=e.MongoSystemError=e.MongoMissingDependencyError=e.MongoMissingCredentialsError=e.MongoCompatibilityError=e.MongoInvalidArgumentError=e.MongoParseError=e.MongoNetworkTimeoutError=e.MongoNetworkError=e.MongoTopologyClosedError=e.MongoCursorExhaustedError=e.MongoServerClosedError=e.MongoCursorInUseError=e.MongoOperationTimeoutError=e.MongoUnexpectedServerResponseError=e.MongoGridFSChunkError=e.MongoGridFSStreamError=e.MongoTailableCursorError=e.MongoChangeStreamError=e.MongoClientBulkWriteExecutionError=e.MongoClientBulkWriteCursorError=e.MongoClientBulkWriteError=e.MongoGCPError=e.MongoAzureError=e.MongoOIDCError=e.MongoAWSError=e.MongoKerberosError=e.MongoExpiredSessionError=e.MongoTransactionError=e.MongoNotConnectedError=e.MongoDecompressionError=e.MongoBatchReExecutionError=e.MongoStalePrimaryError=e.MongoRuntimeError=e.MongoAPIError=e.MongoDriverError=e.MongoServerError=e.MongoError=e.MongoErrorLabel=e.GET_MORE_RESUMABLE_CODES=e.MONGODB_ERROR_CODES=e.NODE_IS_RECOVERING_ERROR_MESSAGE=e.LEGACY_NOT_PRIMARY_OR_SECONDARY_ERROR_MESSAGE=e.LEGACY_NOT_WRITABLE_PRIMARY_ERROR_MESSAGE=void 0,e.needsRetryableWriteLabel=function(n,r,o){if(n instanceof u)return!0;if(n instanceof t&&(r>=9||d(n))&&!n.hasErrorLabel(e.MongoErrorLabel.HandshakeError))return!1;if(n instanceof l){if("Mongos"===o&&r<9)return p.has(n.result.code??0);const e=n.result.writeConcernError.code??Number(n.code);return p.has(Number.isNaN(e)?0:e)}if(n instanceof t)return p.has(Number(n.code));const i=e.LEGACY_NOT_WRITABLE_PRIMARY_ERROR_MESSAGE.test(n.message);if(i)return!0;const s=e.NODE_IS_RECOVERING_ERROR_MESSAGE.test(n.message);if(s)return!0;return!1},e.isRetryableWriteError=d,e.isRetryableReadError=function(t){const n="number"==typeof t.code&&h.has(t.code);if(n)return!0;if(t instanceof u)return!0;const r=e.LEGACY_NOT_WRITABLE_PRIMARY_ERROR_MESSAGE.test(t.message);if(r)return!0;const o=e.NODE_IS_RECOVERING_ERROR_MESSAGE.test(t.message);if(o)return!0;return!1},e.isNodeShuttingDownError=function(e){return!("number"!=typeof e.code||!y.has(e.code))},e.isSDAMUnrecoverableError=function(t){if(t instanceof a||null==t)return!0;return g(t)||function(t){if("number"==typeof t.code)return m.has(t.code);if(g(t))return!1;return e.LEGACY_NOT_WRITABLE_PRIMARY_ERROR_MESSAGE.test(t.message)}(t)},e.isNetworkTimeoutError=function(e){return!!(e instanceof u&&e.message.match(/timed out/))},e.isResumableError=function(n,r){if(null==n||!(n instanceof t))return!1;if(n instanceof u)return!0;if(null!=r&&r>=9)return n.code===e.MONGODB_ERROR_CODES.CursorNotFound||n.hasErrorLabel(e.MongoErrorLabel.ResumableChangeStreamError);if("number"==typeof n.code)return e.GET_MORE_RESUMABLE_CODES.has(n.code);return!1},e.LEGACY_NOT_WRITABLE_PRIMARY_ERROR_MESSAGE=new RegExp("not master","i"),e.LEGACY_NOT_PRIMARY_OR_SECONDARY_ERROR_MESSAGE=new RegExp("not master or secondary","i"),e.NODE_IS_RECOVERING_ERROR_MESSAGE=new RegExp("node is recovering","i"),e.MONGODB_ERROR_CODES=Object.freeze({HostUnreachable:6,HostNotFound:7,AuthenticationFailed:18,NetworkTimeout:89,ShutdownInProgress:91,PrimarySteppedDown:189,ExceededTimeLimit:262,SocketException:9001,NotWritablePrimary:10107,InterruptedAtShutdown:11600,InterruptedDueToReplStateChange:11602,NotPrimaryNoSecondaryOk:13435,NotPrimaryOrSecondary:13436,StaleShardVersion:63,StaleEpoch:150,StaleConfig:13388,RetryChangeStream:234,FailedToSatisfyReadPreference:133,CursorNotFound:43,LegacyNotPrimary:10058,WriteConcernFailed:64,NamespaceNotFound:26,IllegalOperation:20,MaxTimeMSExpired:50,UnknownReplWriteConcern:79,UnsatisfiableWriteConcern:100,Reauthenticate:391,ReadConcernMajorityNotAvailableYet:134}),e.GET_MORE_RESUMABLE_CODES=new Set([e.MONGODB_ERROR_CODES.HostUnreachable,e.MONGODB_ERROR_CODES.HostNotFound,e.MONGODB_ERROR_CODES.NetworkTimeout,e.MONGODB_ERROR_CODES.ShutdownInProgress,e.MONGODB_ERROR_CODES.PrimarySteppedDown,e.MONGODB_ERROR_CODES.ExceededTimeLimit,e.MONGODB_ERROR_CODES.SocketException,e.MONGODB_ERROR_CODES.NotWritablePrimary,e.MONGODB_ERROR_CODES.InterruptedAtShutdown,e.MONGODB_ERROR_CODES.InterruptedDueToReplStateChange,e.MONGODB_ERROR_CODES.NotPrimaryNoSecondaryOk,e.MONGODB_ERROR_CODES.NotPrimaryOrSecondary,e.MONGODB_ERROR_CODES.StaleShardVersion,e.MONGODB_ERROR_CODES.StaleEpoch,e.MONGODB_ERROR_CODES.StaleConfig,e.MONGODB_ERROR_CODES.RetryChangeStream,e.MONGODB_ERROR_CODES.FailedToSatisfyReadPreference,e.MONGODB_ERROR_CODES.CursorNotFound]),e.MongoErrorLabel=Object.freeze({RetryableWriteError:"RetryableWriteError",TransientTransactionError:"TransientTransactionError",UnknownTransactionCommitResult:"UnknownTransactionCommitResult",ResumableChangeStreamError:"ResumableChangeStreamError",HandshakeError:"HandshakeError",ResetPool:"ResetPool",PoolRequstedRetry:"PoolRequstedRetry",InterruptInUseConnections:"InterruptInUseConnections",NoWritesPerformed:"NoWritesPerformed"});class t extends Error{get errorLabels(){return Array.from(this.errorLabelSet)}constructor(e,t){super(e,t),this.errorLabelSet=new Set}static buildErrorMessage(e){return"string"==typeof e?e:function(e){return null!=e&&"object"==typeof e&&"errors"in e&&Array.isArray(e.errors)}(e)&&0===e.message.length?0===e.errors.length?"AggregateError has an empty errors array. Please check the `cause` property for more information.":e.errors.map((({message:e})=>e)).join(", "):null!=e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:"empty error message"}get name(){return"MongoError"}get errmsg(){return this.message}hasErrorLabel(e){return this.errorLabelSet.has(e)}addErrorLabel(e){this.errorLabelSet.add(e)}}e.MongoError=t;class n extends t{constructor(e){if(super(e.message||e.errmsg||e.$err||"n/a"),e.errorLabels)for(const t of e.errorLabels)this.addErrorLabel(t);this.errorResponse=e;for(const t in e)"errorLabels"!==t&&"errmsg"!==t&&"message"!==t&&"errorResponse"!==t&&(this[t]=e[t])}get name(){return"MongoServerError"}}e.MongoServerError=n;class r extends t{constructor(e,t){super(e,t)}get name(){return"MongoDriverError"}}e.MongoDriverError=r;class o extends r{constructor(e,t){super(e,t)}get name(){return"MongoAPIError"}}e.MongoAPIError=o;class i extends r{constructor(e,t){super(e,t)}get name(){return"MongoRuntimeError"}}e.MongoRuntimeError=i;e.MongoStalePrimaryError=class extends i{constructor(e,t){super(e,t)}get name(){return"MongoStalePrimaryError"}};e.MongoBatchReExecutionError=class extends o{constructor(e="This batch has already been executed, create new batch to execute"){super(e)}get name(){return"MongoBatchReExecutionError"}};e.MongoDecompressionError=class extends i{constructor(e){super(e)}get name(){return"MongoDecompressionError"}};e.MongoNotConnectedError=class extends o{constructor(e){super(e)}get name(){return"MongoNotConnectedError"}};e.MongoTransactionError=class extends o{constructor(e){super(e)}get name(){return"MongoTransactionError"}};e.MongoExpiredSessionError=class extends o{constructor(e="Cannot use a session that has ended"){super(e)}get name(){return"MongoExpiredSessionError"}};e.MongoKerberosError=class extends i{constructor(e){super(e)}get name(){return"MongoKerberosError"}};e.MongoAWSError=class extends i{constructor(e,t){super(e,t)}get name(){return"MongoAWSError"}};class s extends i{constructor(e){super(e)}get name(){return"MongoOIDCError"}}e.MongoOIDCError=s;e.MongoAzureError=class extends s{constructor(e){super(e)}get name(){return"MongoAzureError"}};e.MongoGCPError=class extends s{constructor(e){super(e)}get name(){return"MongoGCPError"}};e.MongoClientBulkWriteError=class extends n{constructor(e){super(e),this.writeConcernErrors=[],this.writeErrors=new Map}get name(){return"MongoClientBulkWriteError"}};e.MongoClientBulkWriteCursorError=class extends i{constructor(e){super(e)}get name(){return"MongoClientBulkWriteCursorError"}};e.MongoClientBulkWriteExecutionError=class extends i{constructor(e){super(e)}get name(){return"MongoClientBulkWriteExecutionError"}};e.MongoChangeStreamError=class extends i{constructor(e){super(e)}get name(){return"MongoChangeStreamError"}};e.MongoTailableCursorError=class extends o{constructor(e="Tailable cursor does not support this operation"){super(e)}get name(){return"MongoTailableCursorError"}};e.MongoGridFSStreamError=class extends i{constructor(e){super(e)}get name(){return"MongoGridFSStreamError"}};e.MongoGridFSChunkError=class extends i{constructor(e){super(e)}get name(){return"MongoGridFSChunkError"}};e.MongoUnexpectedServerResponseError=class extends i{constructor(e,t){super(e,t)}get name(){return"MongoUnexpectedServerResponseError"}};e.MongoOperationTimeoutError=class extends r{get name(){return"MongoOperationTimeoutError"}};e.MongoCursorInUseError=class extends o{constructor(e="Cursor is already initialized"){super(e)}get name(){return"MongoCursorInUseError"}};e.MongoServerClosedError=class extends o{constructor(e="Server is closed"){super(e)}get name(){return"MongoServerClosedError"}};e.MongoCursorExhaustedError=class extends o{constructor(e){super(e||"Cursor is exhausted")}get name(){return"MongoCursorExhaustedError"}};e.MongoTopologyClosedError=class extends o{constructor(e="Topology is closed"){super(e)}get name(){return"MongoTopologyClosedError"}};class u extends t{constructor(e,t){super(e,{cause:t?.cause}),this.beforeHandshake=!!t?.beforeHandshake}get name(){return"MongoNetworkError"}}e.MongoNetworkError=u;e.MongoNetworkTimeoutError=class extends u{constructor(e,t){super(e,t)}get name(){return"MongoNetworkTimeoutError"}};class a extends r{constructor(e){super(e)}get name(){return"MongoParseError"}}e.MongoParseError=a;e.MongoInvalidArgumentError=class extends o{constructor(e,t){super(e,t)}get name(){return"MongoInvalidArgumentError"}};e.MongoCompatibilityError=class extends o{constructor(e){super(e)}get name(){return"MongoCompatibilityError"}};e.MongoMissingCredentialsError=class extends o{constructor(e){super(e)}get name(){return"MongoMissingCredentialsError"}};e.MongoMissingDependencyError=class extends o{constructor(e,t){super(e,t),this.dependencyName=t.dependencyName}get name(){return"MongoMissingDependencyError"}};class c extends t{constructor(e,n){n&&n.error?super(t.buildErrorMessage(n.error.message||n.error),{cause:n.error}):super(e),n&&(this.reason=n),this.code=n.error?.code}get name(){return"MongoSystemError"}}e.MongoSystemError=c;e.MongoServerSelectionError=class extends c{constructor(e,t){super(e,t)}get name(){return"MongoServerSelectionError"}};class l extends n{constructor(e){super({...e.writeConcernError,...e}),this.errInfo=e.writeConcernError.errInfo,this.result=e}get name(){return"MongoWriteConcernError"}}e.MongoWriteConcernError=l;const h=new Set([e.MONGODB_ERROR_CODES.HostUnreachable,e.MONGODB_ERROR_CODES.HostNotFound,e.MONGODB_ERROR_CODES.NetworkTimeout,e.MONGODB_ERROR_CODES.ShutdownInProgress,e.MONGODB_ERROR_CODES.PrimarySteppedDown,e.MONGODB_ERROR_CODES.SocketException,e.MONGODB_ERROR_CODES.NotWritablePrimary,e.MONGODB_ERROR_CODES.InterruptedAtShutdown,e.MONGODB_ERROR_CODES.InterruptedDueToReplStateChange,e.MONGODB_ERROR_CODES.NotPrimaryNoSecondaryOk,e.MONGODB_ERROR_CODES.NotPrimaryOrSecondary,e.MONGODB_ERROR_CODES.ExceededTimeLimit,e.MONGODB_ERROR_CODES.ReadConcernMajorityNotAvailableYet]),p=h;function d(t){return t.hasErrorLabel(e.MongoErrorLabel.RetryableWriteError)||t.hasErrorLabel(e.MongoErrorLabel.PoolRequstedRetry)}const f=new Set([e.MONGODB_ERROR_CODES.ShutdownInProgress,e.MONGODB_ERROR_CODES.PrimarySteppedDown,e.MONGODB_ERROR_CODES.InterruptedAtShutdown,e.MONGODB_ERROR_CODES.InterruptedDueToReplStateChange,e.MONGODB_ERROR_CODES.NotPrimaryOrSecondary]),m=new Set([e.MONGODB_ERROR_CODES.NotWritablePrimary,e.MONGODB_ERROR_CODES.NotPrimaryNoSecondaryOk,e.MONGODB_ERROR_CODES.LegacyNotPrimary]),y=new Set([e.MONGODB_ERROR_CODES.InterruptedAtShutdown,e.MONGODB_ERROR_CODES.ShutdownInProgress]);function g(t){return"number"==typeof t.code?f.has(t.code):e.LEGACY_NOT_PRIMARY_OR_SECONDARY_ERROR_MESSAGE.test(t.message)||e.NODE_IS_RECOVERING_ERROR_MESSAGE.test(t.message)}}(x)),x}var N,I={},R={},k={},j={},L={},U={},V={};function z(){return N||(N=1,e=V,Object.defineProperty(e,"__esModule",{value:!0}),e.END=e.CHANGE=e.INIT=e.MORE=e.RESPONSE=e.SERVER_HEARTBEAT_FAILED=e.SERVER_HEARTBEAT_SUCCEEDED=e.SERVER_HEARTBEAT_STARTED=e.COMMAND_FAILED=e.COMMAND_SUCCEEDED=e.COMMAND_STARTED=e.CLUSTER_TIME_RECEIVED=e.CONNECTION_CHECKED_IN=e.CONNECTION_CHECKED_OUT=e.CONNECTION_CHECK_OUT_FAILED=e.CONNECTION_CHECK_OUT_STARTED=e.CONNECTION_CLOSED=e.CONNECTION_READY=e.CONNECTION_CREATED=e.CONNECTION_POOL_READY=e.CONNECTION_POOL_CLEARED=e.CONNECTION_POOL_CLOSED=e.CONNECTION_POOL_CREATED=e.WAITING_FOR_SUITABLE_SERVER=e.SERVER_SELECTION_SUCCEEDED=e.SERVER_SELECTION_FAILED=e.SERVER_SELECTION_STARTED=e.TOPOLOGY_DESCRIPTION_CHANGED=e.TOPOLOGY_CLOSED=e.TOPOLOGY_OPENING=e.SERVER_DESCRIPTION_CHANGED=e.SERVER_CLOSED=e.SERVER_OPENING=e.DESCRIPTION_RECEIVED=e.UNPINNED=e.PINNED=e.MESSAGE=e.ENDED=e.CLOSED=e.CONNECT=e.OPEN=e.CLOSE=e.TIMEOUT=e.ERROR=e.SYSTEM_JS_COLLECTION=e.SYSTEM_COMMAND_COLLECTION=e.SYSTEM_USER_COLLECTION=e.SYSTEM_PROFILE_COLLECTION=e.SYSTEM_INDEX_COLLECTION=e.SYSTEM_NAMESPACE_COLLECTION=void 0,e.kDecoratedKeys=e.kDecorateResult=e.LEGACY_HELLO_COMMAND_CAMEL_CASE=e.LEGACY_HELLO_COMMAND=e.MONGO_CLIENT_EVENTS=e.LOCAL_SERVER_EVENTS=e.SERVER_RELAY_EVENTS=e.APM_EVENTS=e.TOPOLOGY_EVENTS=e.CMAP_EVENTS=e.HEARTBEAT_EVENTS=e.RESUME_TOKEN_CHANGED=void 0,e.SYSTEM_NAMESPACE_COLLECTION="system.namespaces",e.SYSTEM_INDEX_COLLECTION="system.indexes",e.SYSTEM_PROFILE_COLLECTION="system.profile",e.SYSTEM_USER_COLLECTION="system.users",e.SYSTEM_COMMAND_COLLECTION="$cmd",e.SYSTEM_JS_COLLECTION="system.js",e.ERROR="error",e.TIMEOUT="timeout",e.CLOSE="close",e.OPEN="open",e.CONNECT="connect",e.CLOSED="closed",e.ENDED="ended",e.MESSAGE="message",e.PINNED="pinned",e.UNPINNED="unpinned",e.DESCRIPTION_RECEIVED="descriptionReceived",e.SERVER_OPENING="serverOpening",e.SERVER_CLOSED="serverClosed",e.SERVER_DESCRIPTION_CHANGED="serverDescriptionChanged",e.TOPOLOGY_OPENING="topologyOpening",e.TOPOLOGY_CLOSED="topologyClosed",e.TOPOLOGY_DESCRIPTION_CHANGED="topologyDescriptionChanged",e.SERVER_SELECTION_STARTED="serverSelectionStarted",e.SERVER_SELECTION_FAILED="serverSelectionFailed",e.SERVER_SELECTION_SUCCEEDED="serverSelectionSucceeded",e.WAITING_FOR_SUITABLE_SERVER="waitingForSuitableServer",e.CONNECTION_POOL_CREATED="connectionPoolCreated",e.CONNECTION_POOL_CLOSED="connectionPoolClosed",e.CONNECTION_POOL_CLEARED="connectionPoolCleared",e.CONNECTION_POOL_READY="connectionPoolReady",e.CONNECTION_CREATED="connectionCreated",e.CONNECTION_READY="connectionReady",e.CONNECTION_CLOSED="connectionClosed",e.CONNECTION_CHECK_OUT_STARTED="connectionCheckOutStarted",e.CONNECTION_CHECK_OUT_FAILED="connectionCheckOutFailed",e.CONNECTION_CHECKED_OUT="connectionCheckedOut",e.CONNECTION_CHECKED_IN="connectionCheckedIn",e.CLUSTER_TIME_RECEIVED="clusterTimeReceived",e.COMMAND_STARTED="commandStarted",e.COMMAND_SUCCEEDED="commandSucceeded",e.COMMAND_FAILED="commandFailed",e.SERVER_HEARTBEAT_STARTED="serverHeartbeatStarted",e.SERVER_HEARTBEAT_SUCCEEDED="serverHeartbeatSucceeded",e.SERVER_HEARTBEAT_FAILED="serverHeartbeatFailed",e.RESPONSE="response",e.MORE="more",e.INIT="init",e.CHANGE="change",e.END="end",e.RESUME_TOKEN_CHANGED="resumeTokenChanged",e.HEARTBEAT_EVENTS=Object.freeze([e.SERVER_HEARTBEAT_STARTED,e.SERVER_HEARTBEAT_SUCCEEDED,e.SERVER_HEARTBEAT_FAILED]),e.CMAP_EVENTS=Object.freeze([e.CONNECTION_POOL_CREATED,e.CONNECTION_POOL_READY,e.CONNECTION_POOL_CLEARED,e.CONNECTION_POOL_CLOSED,e.CONNECTION_CREATED,e.CONNECTION_READY,e.CONNECTION_CLOSED,e.CONNECTION_CHECK_OUT_STARTED,e.CONNECTION_CHECK_OUT_FAILED,e.CONNECTION_CHECKED_OUT,e.CONNECTION_CHECKED_IN]),e.TOPOLOGY_EVENTS=Object.freeze([e.SERVER_OPENING,e.SERVER_CLOSED,e.SERVER_DESCRIPTION_CHANGED,e.TOPOLOGY_OPENING,e.TOPOLOGY_CLOSED,e.TOPOLOGY_DESCRIPTION_CHANGED,e.ERROR,e.TIMEOUT,e.CLOSE]),e.APM_EVENTS=Object.freeze([e.COMMAND_STARTED,e.COMMAND_SUCCEEDED,e.COMMAND_FAILED]),e.SERVER_RELAY_EVENTS=Object.freeze([e.SERVER_HEARTBEAT_STARTED,e.SERVER_HEARTBEAT_SUCCEEDED,e.SERVER_HEARTBEAT_FAILED,e.COMMAND_STARTED,e.COMMAND_SUCCEEDED,e.COMMAND_FAILED,...e.CMAP_EVENTS]),e.LOCAL_SERVER_EVENTS=Object.freeze([e.CONNECT,e.DESCRIPTION_RECEIVED,e.CLOSED,e.ENDED]),e.MONGO_CLIENT_EVENTS=Object.freeze([...e.CMAP_EVENTS,...e.APM_EVENTS,...e.TOPOLOGY_EVENTS,...e.HEARTBEAT_EVENTS]),e.LEGACY_HELLO_COMMAND="ismaster",e.LEGACY_HELLO_COMMAND_CAMEL_CASE="isMaster",e.kDecorateResult=Symbol.for("@@mdb.decorateDecryptionResult"),e.kDecoratedKeys=Symbol.for("@@mdb.decryptedKeys")),V;var e}var W,q={},G={};function H(){return W||(W=1,Object.defineProperty(G,"__esModule",{value:!0}),G.OP_MSG=G.OP_COMPRESSED=G.OP_DELETE=G.OP_QUERY=G.OP_INSERT=G.OP_UPDATE=G.OP_REPLY=G.MIN_SUPPORTED_QE_SERVER_VERSION=G.MIN_SUPPORTED_QE_WIRE_VERSION=G.MAX_SUPPORTED_WIRE_VERSION=G.MIN_SUPPORTED_WIRE_VERSION=G.MAX_SUPPORTED_SERVER_VERSION=G.MIN_SUPPORTED_SERVER_VERSION=void 0,G.MIN_SUPPORTED_SERVER_VERSION="4.0",G.MAX_SUPPORTED_SERVER_VERSION="8.0",G.MIN_SUPPORTED_WIRE_VERSION=7,G.MAX_SUPPORTED_WIRE_VERSION=25,G.MIN_SUPPORTED_QE_WIRE_VERSION=21,G.MIN_SUPPORTED_QE_SERVER_VERSION="7.0",G.OP_REPLY=1,G.OP_UPDATE=2001,G.OP_INSERT=2002,G.OP_QUERY=2004,G.OP_DELETE=2006,G.OP_COMPRESSED=2012,G.OP_MSG=2013),G}var K,Y={};function Q(){return K||(K=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReadConcern=e.ReadConcernLevel=void 0,e.ReadConcernLevel=Object.freeze({local:"local",majority:"majority",linearizable:"linearizable",available:"available",snapshot:"snapshot"});class t{constructor(t){this.level=e.ReadConcernLevel[t]??t}static fromOptions(e){if(null!=e){if(e.readConcern){const{readConcern:n}=e;if(n instanceof t)return n;if("string"==typeof n)return new t(n);if("level"in n&&n.level)return new t(n.level)}return e.level?new t(e.level):void 0}}static get MAJORITY(){return e.ReadConcernLevel.majority}static get AVAILABLE(){return e.ReadConcernLevel.available}static get LINEARIZABLE(){return e.ReadConcernLevel.linearizable}static get SNAPSHOT(){return e.ReadConcernLevel.snapshot}toJSON(){return{level:this.level}}}e.ReadConcern=t}(Y)),Y}var J,X={};function Z(){return J||(J=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ReadPreference=e.ReadPreferenceMode=void 0;const t=P();e.ReadPreferenceMode=Object.freeze({primary:"primary",primaryPreferred:"primaryPreferred",secondary:"secondary",secondaryPreferred:"secondaryPreferred",nearest:"nearest"});class n{constructor(e,r,o){if(!n.isValid(e))throw new t.MongoInvalidArgumentError(`Invalid read preference mode ${JSON.stringify(e)}`);if(null!=o||"object"!=typeof r||Array.isArray(r)){if(r&&!Array.isArray(r))throw new t.MongoInvalidArgumentError("ReadPreference tags must be an array")}else o=r,r=void 0;if(this.mode=e,this.tags=r,this.hedge=o?.hedge,this.maxStalenessSeconds=void 0,this.minWireVersion=void 0,null!=(o=o??{}).maxStalenessSeconds){if(o.maxStalenessSeconds<=0)throw new t.MongoInvalidArgumentError("maxStalenessSeconds must be a positive integer");this.maxStalenessSeconds=o.maxStalenessSeconds,this.minWireVersion=5}if(this.mode===n.PRIMARY){if(this.tags&&Array.isArray(this.tags)&&this.tags.length>0)throw new t.MongoInvalidArgumentError("Primary read preference cannot be combined with tags");if(this.maxStalenessSeconds)throw new t.MongoInvalidArgumentError("Primary read preference cannot be combined with maxStalenessSeconds");if(this.hedge)throw new t.MongoInvalidArgumentError("Primary read preference cannot be combined with hedge")}}get preference(){return this.mode}static fromString(e){return new n(e)}static fromOptions(e){if(!e)return;const t=e.readPreference??e.session?.transaction.options.readPreference,r=e.readPreferenceTags;if(null!=t){if("string"==typeof t)return new n(t,r,{maxStalenessSeconds:e.maxStalenessSeconds,hedge:e.hedge});if(!(t instanceof n)&&"object"==typeof t){const o=t.mode||t.preference;if(o&&"string"==typeof o)return new n(o,t.tags??r,{maxStalenessSeconds:t.maxStalenessSeconds,hedge:e.hedge})}return r&&(t.tags=r),t}}static translate(e){if(null==e.readPreference)return e;const r=e.readPreference;if("string"==typeof r)e.readPreference=new n(r);else if(!r||r instanceof n||"object"!=typeof r){if(!(r instanceof n))throw new t.MongoInvalidArgumentError(`Invalid read preference: ${r}`)}else{const t=r.mode||r.preference;t&&"string"==typeof t&&(e.readPreference=new n(t,r.tags,{maxStalenessSeconds:r.maxStalenessSeconds}))}return e}static isValid(e){return new Set([n.PRIMARY,n.PRIMARY_PREFERRED,n.SECONDARY,n.SECONDARY_PREFERRED,n.NEAREST,null]).has(e)}isValid(e){return n.isValid("string"==typeof e?e:this.mode)}secondaryOk(){return new Set([n.PRIMARY_PREFERRED,n.SECONDARY,n.SECONDARY_PREFERRED,n.NEAREST]).has(this.mode)}equals(e){return e.mode===this.mode}toJSON(){const e={mode:this.mode};return Array.isArray(this.tags)&&(e.tags=this.tags),this.maxStalenessSeconds&&(e.maxStalenessSeconds=this.maxStalenessSeconds),this.hedge&&(e.hedge=this.hedge),e}}e.ReadPreference=n,n.PRIMARY=e.ReadPreferenceMode.primary,n.PRIMARY_PREFERRED=e.ReadPreferenceMode.primaryPreferred,n.SECONDARY=e.ReadPreferenceMode.secondary,n.SECONDARY_PREFERRED=e.ReadPreferenceMode.secondaryPreferred,n.NEAREST=e.ReadPreferenceMode.nearest,n.primary=new n(e.ReadPreferenceMode.primary),n.primaryPreferred=new n(e.ReadPreferenceMode.primaryPreferred),n.secondary=new n(e.ReadPreferenceMode.secondary),n.secondaryPreferred=new n(e.ReadPreferenceMode.secondaryPreferred),n.nearest=new n(e.ReadPreferenceMode.nearest)}(X)),X}var ee,te={};function ne(){if(ee)return te;return ee=1,Object.defineProperty(te,"__esModule",{value:!0}),te.ServerType=te.TopologyType=te.STATE_CONNECTED=te.STATE_CONNECTING=te.STATE_CLOSED=te.STATE_CLOSING=void 0,te._advanceClusterTime=function(e,t){(null==e.clusterTime||t.clusterTime.greaterThan(e.clusterTime.clusterTime))&&(e.clusterTime=t)},te.STATE_CLOSING="closing",te.STATE_CLOSED="closed",te.STATE_CONNECTING="connecting",te.STATE_CONNECTED="connected",te.TopologyType=Object.freeze({Single:"Single",ReplicaSetNoPrimary:"ReplicaSetNoPrimary",ReplicaSetWithPrimary:"ReplicaSetWithPrimary",Sharded:"Sharded",Unknown:"Unknown",LoadBalanced:"LoadBalanced"}),te.ServerType=Object.freeze({Standalone:"Standalone",Mongos:"Mongos",PossiblePrimary:"PossiblePrimary",RSPrimary:"RSPrimary",RSSecondary:"RSSecondary",RSArbiter:"RSArbiter",RSOther:"RSOther",RSGhost:"RSGhost",Unknown:"Unknown",LoadBalancer:"LoadBalancer"}),te}var re,oe,ie,se,ue,ae,ce={},le={},he={};function pe(){if(oe)return le;oe=1,Object.defineProperty(le,"__esModule",{value:!0}),le.ClientBulkWriteCursorResponse=le.ExplainedCursorResponse=le.CursorResponse=le.MongoDBResponse=void 0,le.isErrorResponse=o;const e=F(),t=P(),n=fe(),r=function(){if(re)return he;re=1,Object.defineProperty(he,"__esModule",{value:!0}),he.OnDemandDocument=void 0;const e=F();class t{constructor(t,n=0,r=!1,o){this.bson=t,this.offset=n,this.isArray=r,this.cache=Object.create(null),this.indexFound=Object.create(null),this.elements=o??(0,e.parseToElementsToArray)(this.bson,n)}isElementName(e,t){const n=t[2],r=t[1];if(e.length!==n)return!1;const o=r+n;for(let t=r,n=0;n<e.length&&t<o;n++,t++)if(this.bson[t]!==e.charCodeAt(n))return!1;return!0}getElement(e){const t=this.cache[e];if(!1===t)return null;if(null!=t)return t;if("number"==typeof e){if(this.isArray){if(e<this.elements.length){const t={element:this.elements[e],value:void 0};return this.cache[e]=t,this.indexFound[e]=!0,t}return null}return null}for(let t=0;t<this.elements.length;t++){const n=this.elements[t];if(!(t in this.indexFound)&&this.isElementName(e,n)){const r={element:n,value:void 0};return this.cache[e]=r,this.indexFound[t]=!0,r}}return this.cache[e]=!1,null}toJSValue(n,r){const o=n[0],i=n[3],s=n[4];if(r!==o)return null;switch(r){case e.BSONType.null:case e.BSONType.undefined:return null;case e.BSONType.double:return(0,e.getFloat64LE)(this.bson,i);case e.BSONType.int:return(0,e.getInt32LE)(this.bson,i);case e.BSONType.long:return(0,e.getBigInt64LE)(this.bson,i);case e.BSONType.bool:return Boolean(this.bson[i]);case e.BSONType.objectId:return new e.ObjectId(this.bson.subarray(i,i+12));case e.BSONType.timestamp:return new e.Timestamp((0,e.getBigInt64LE)(this.bson,i));case e.BSONType.string:return(0,e.toUTF8)(this.bson,i+4,i+s-1,!1);case e.BSONType.binData:{const t=(0,e.getInt32LE)(this.bson,i),n=this.bson[i+4];if(2===n){const n=(0,e.getInt32LE)(this.bson,i+1+4);if(n<0)throw new e.BSONError("Negative binary type element size found for subtype 0x02");if(n>t-4)throw new e.BSONError("Binary type with subtype 0x02 contains too long binary size");if(n<t-4)throw new e.BSONError("Binary type with subtype 0x02 contains too short binary size");return new e.Binary(this.bson.subarray(i+1+4+4,i+1+4+4+n),2)}return new e.Binary(this.bson.subarray(i+1+4,i+1+4+t),n)}case e.BSONType.date:return new Date(Number((0,e.getBigInt64LE)(this.bson,i)));case e.BSONType.object:return new t(this.bson,i);case e.BSONType.array:return new t(this.bson,i,!0);default:throw new e.BSONError(`Unsupported BSON type: ${r}`)}}size(){return this.elements.length}has(e){const t=this.cache[e];return!1!==t&&(null!=t||null!=this.getElement(e))}get(t,n,r){const o=this.getElement(t);if(null==o){if(!0===r)throw new e.BSONError(`BSON element "${t}" is missing`);return null}if(null==o.value){const i=this.toJSValue(o.element,n);if(null==i){if(!0===r)throw new e.BSONError(`BSON element "${t}" is missing`);return null}o.value=i}return o.value}getNumber(t,n){const r=this.get(t,e.BSONType.bool),o=null==r?null:r?1:0,i=this.get(t,e.BSONType.long),s=null==i?null:Number(i),u=o??s??this.get(t,e.BSONType.int)??this.get(t,e.BSONType.double);if(!0===n&&null==u)throw new e.BSONError(`BSON element "${t}" is missing`);return u}toObject(t){return(0,e.deserialize)(this.bson,{...t,index:this.offset,allowObjectSmallerThanBufferSize:!0})}toBytes(){const t=(0,e.getInt32LE)(this.bson,this.offset);return this.bson.subarray(this.offset,this.offset+t)}}return he.OnDemandDocument=t,he}();function o(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(2===r[2]){const t=r[1];if(111===e[t]&&107===e[t+1]){const t=r[3],n=r[4];for(let r=t;r<t+n;r++)if(0!==e[r])return!1;return!0}}}return!0}class i extends r.OnDemandDocument{get(e,n,r){try{return super.get(e,n,r)}catch(e){throw new t.MongoUnexpectedServerResponseError(e.message,{cause:e})}}static is(e){return e instanceof i}static make(t){const n=(0,e.parseToElementsToArray)(t,0);return o(t,n)?new i(t,0,!1,n):new this(t,0,!1,n)}get isMaxTimeExpiredError(){if(0===this.ok&&this.code===t.MONGODB_ERROR_CODES.MaxTimeMSExpired)return!0;if(0===this.ok)return!1;if(this.get("writeConcernError",e.BSONType.object)?.getNumber("code")===t.MONGODB_ERROR_CODES.MaxTimeMSExpired)return!0;const n=this.get("writeErrors",e.BSONType.array);if(n?.size())for(let r=0;r<n.size();r++){if(n.get(r,e.BSONType.object)?.getNumber("code")===t.MONGODB_ERROR_CODES.MaxTimeMSExpired)return!0}return!1}get recoveryToken(){return this.get("recoveryToken",e.BSONType.object)?.toObject({promoteValues:!1,promoteLongs:!1,promoteBuffers:!1,validation:{utf8:!0}})??null}get atClusterTime(){return this.get("cursor",e.BSONType.object)?.get("atClusterTime",e.BSONType.timestamp)??this.get("atClusterTime",e.BSONType.timestamp)}get operationTime(){return this.get("operationTime",e.BSONType.timestamp)}get ok(){return this.getNumber("ok")?1:0}get $err(){return this.get("$err",e.BSONType.string)}get errmsg(){return this.get("errmsg",e.BSONType.string)}get code(){return this.getNumber("code")}get $clusterTime(){if(!("clusterTime"in this)){const t=this.get("$clusterTime",e.BSONType.object);if(null==t)return this.clusterTime=null,null;const n=t.get("clusterTime",e.BSONType.timestamp,!0),r=t.get("signature",e.BSONType.object)?.toObject();this.clusterTime={clusterTime:n,signature:r}}return this.clusterTime??null}toObject(t){const n={...(0,e.pluckBSONSerializeOptions)(t??{}),validation:(0,e.parseUtf8ValidationOption)(t)};return super.toObject(n)}}le.MongoDBResponse=i,i.empty=new i(new Uint8Array([13,0,0,0,16,111,107,0,1,0,0,0,0]));class s extends i{constructor(){super(...arguments),this._batch=null,this.iterated=0,this._encryptedBatch=null}static is(e){return e instanceof s||e===s.emptyGetMore}get cursor(){return this.get("cursor",e.BSONType.object,!0)}get id(){try{return e.Long.fromBigInt(this.cursor.get("id",e.BSONType.long,!0))}catch(e){throw new t.MongoUnexpectedServerResponseError(e.message,{cause:e})}}get ns(){const t=this.cursor.get("ns",e.BSONType.string);return null!=t?(0,n.ns)(t):null}get length(){return Math.max(this.batchSize-this.iterated,0)}get encryptedBatch(){if(null==this.encryptedResponse)return null;if(null!=this._encryptedBatch)return this._encryptedBatch;const n=this.encryptedResponse?.get("cursor",e.BSONType.object);if(n?.has("firstBatch"))this._encryptedBatch=n.get("firstBatch",e.BSONType.array,!0);else{if(!n?.has("nextBatch"))throw new t.MongoUnexpectedServerResponseError("Cursor document did not contain a batch");this._encryptedBatch=n.get("nextBatch",e.BSONType.array,!0)}return this._encryptedBatch}get batch(){if(null!=this._batch)return this._batch;const n=this.cursor;if(n.has("firstBatch"))this._batch=n.get("firstBatch",e.BSONType.array,!0);else{if(!n.has("nextBatch"))throw new t.MongoUnexpectedServerResponseError("Cursor document did not contain a batch");this._batch=n.get("nextBatch",e.BSONType.array,!0)}return this._batch}get batchSize(){return this.batch?.size()}get postBatchResumeToken(){return this.cursor.get("postBatchResumeToken",e.BSONType.object)?.toObject({promoteValues:!1,promoteLongs:!1,promoteBuffers:!1,validation:{utf8:!0}})??null}shift(t){if(this.iterated>=this.batchSize)return null;const r=this.batch.get(this.iterated,e.BSONType.object,!0)??null,o=this.encryptedBatch?.get(this.iterated,e.BSONType.object,!0)??null;if(this.iterated+=1,t?.raw)return r.toBytes();{const e=r.toObject(t);return o&&(0,n.decorateDecryptionResult)(e,o.toObject(t),!0),e}}clear(){this.iterated=this.batchSize}}le.CursorResponse=s,s.emptyGetMore={id:new e.Long(0),length:0,shift:()=>null};le.ExplainedCursorResponse=class extends s{constructor(){super(...arguments),this.isExplain=!0,this._length=1}get id(){return e.Long.fromBigInt(0n)}get batchSize(){return 0}get ns(){return null}get length(){return this._length}shift(e){return 0===this._length?null:(this._length-=1,this.toObject(e))}};return le.ClientBulkWriteCursorResponse=class extends s{get insertedCount(){return this.get("nInserted",e.BSONType.int,!0)}get upsertedCount(){return this.get("nUpserted",e.BSONType.int,!0)}get matchedCount(){return this.get("nMatched",e.BSONType.int,!0)}get modifiedCount(){return this.get("nModified",e.BSONType.int,!0)}get deletedCount(){return this.get("nDeleted",e.BSONType.int,!0)}get writeConcernError(){return this.get("writeConcernError",e.BSONType.object,!1)}},le}function de(){if(ie)return ce;ie=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.WriteConcern=ce.WRITE_CONCERN_KEYS=void 0,ce.throwIfWriteConcernError=function(n){if("object"==typeof n&&null!=n){const r=e.MongoDBResponse.is(n)&&n.has("writeConcernError")?n.toObject():!e.MongoDBResponse.is(n)&&"writeConcernError"in n?n:null;if(null!=r)throw new t.MongoWriteConcernError(r)}};const e=pe(),t=P();ce.WRITE_CONCERN_KEYS=["w","wtimeout","j","journal","fsync"];class n{constructor(e,t,n,r){null!=e&&(Number.isNaN(Number(e))?this.w=e:this.w=Number(e)),null!=t&&(this.wtimeoutMS=this.wtimeout=t),null!=n&&(this.journal=this.j=n),null!=r&&(this.journal=this.j=!!r)}static apply(e,t){const n={};return null!=t.w&&(n.w=t.w),null!=t.wtimeoutMS&&(n.wtimeout=t.wtimeoutMS),null!=t.journal&&(n.j=t.j),e.writeConcern=n,e}static fromOptions(e,t){if(null==e)return;let r;t=t??{},r="string"==typeof e||"number"==typeof e?{w:e}:e instanceof n?e:e.writeConcern;const o=t instanceof n?t:t.writeConcern,{w:i,wtimeout:s,j:u,fsync:a,journal:c,wtimeoutMS:l}={...o,...r};return null!=i||null!=s||null!=l||null!=u||null!=c||null!=a?new n(i,s??l,u??c,a):void 0}}return ce.WriteConcern=n,ce}function fe(){return se||(se=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.kDispose=e.randomBytes=e.COSMOS_DB_MSG=e.DOCUMENT_DB_MSG=e.COSMOS_DB_CHECK=e.DOCUMENT_DB_CHECK=e.MONGODB_WARNING_CODE=e.DEFAULT_PK_FACTORY=e.HostAddress=e.BufferPool=e.List=e.MongoDBCollectionNamespace=e.MongoDBNamespace=e.ByteUtils=void 0,e.isUint8Array=function(e){return null!=e&&"object"==typeof e&&Symbol.toStringTag in e&&"Uint8Array"===e[Symbol.toStringTag]},e.hostMatchesWildcards=function(e,t){for(const n of t)if(e===n||n.startsWith("*.")&&e?.endsWith(n.substring(2,n.length))||n.startsWith("*/")&&e?.endsWith(n.substring(2,n.length)))return!0;return!1},e.normalizeHintField=function(e){let t;if("string"==typeof e)t=e;else if(Array.isArray(e))t={},e.forEach((e=>{t[e]=1}));else if(null!=e&&"object"==typeof e){t={};for(const n in e)t[n]=e[n]}return t},e.isObject=C,e.mergeOptions=function(e,t){return{...e,...t}},e.filterOptions=function(e,t){const n={};for(const r in e)t.includes(r)&&(n[r]=e[r]);return n},e.applyRetryableWrites=function(e,t){t&&t.s.options?.retryWrites&&(e.retryWrites=!0);return e},e.isPromiseLike=function(e){return null!=e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then},e.decorateWithCollation=function(e,t,n){const r=w(t).capabilities;if(n.collation&&"object"==typeof n.collation){if(!r||!r.commandsTakeCollation)throw new g.MongoCompatibilityError("Current topology does not support collation");e.collation=n.collation}},e.decorateWithReadConcern=function(e,t,n){if(n&&n.session&&n.session.inTransaction())return;const r=Object.assign({},e.readConcern||{});t.s.readConcern&&Object.assign(r,t.s.readConcern);Object.keys(r).length>0&&Object.assign(e,{readConcern:r})},e.getTopology=w,e.ns=function(e){return S.fromString(e)},e.makeCounter=function*(e=0){let t=e;for(;;){const e=t;t+=1,yield e}},e.uuidV4=function(){const e=t.randomBytes(16);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,e},e.maxWireVersion=function(e){if(e){if(e.loadBalanced||e.serverApi?.version)return m.MAX_SUPPORTED_WIRE_VERSION;if(e.hello)return e.hello.maxWireVersion;if("lastHello"in e&&"function"==typeof e.lastHello){const t=e.lastHello();if(t)return t.maxWireVersion}if(e.description&&"maxWireVersion"in e.description&&null!=e.description.maxWireVersion)return e.description.maxWireVersion}return 0},e.arrayStrictEqual=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;return e.length===t.length&&e.every(((e,n)=>e===t[n]))},e.errorStrictEqual=function(e,t){if(e===t)return!0;if(!e||!t)return e===t;if(null==e&&null!=t||null!=e&&null==t)return!1;if(e.constructor.name!==t.constructor.name)return!1;if(e.message!==t.message)return!1;return!0},e.makeStateMachine=function(e){return function(t,n){const r=e[t.s.state];if(r&&r.indexOf(n)<0)throw new g.MongoRuntimeError(`illegal state transition from [${t.s.state}] => [${n}], allowed: [${r}]`);t.emit("stateChanged",t.s.state,n),t.s.state=n}},e.now=D,e.calculateDurationInMs=function(e){if("number"!=typeof e)return-1;const t=D()-e;return t<0?0:t},e.hasAtomicOperators=function e(t){if(Array.isArray(t)){for(const n of t)if(e(n))return!0;return!1}const n=Object.keys(t);return n.length>0&&"$"===n[0][0]},e.resolveTimeoutOptions=function(e,t){const{socketTimeoutMS:n,serverSelectionTimeoutMS:r,waitQueueTimeoutMS:o,timeoutMS:i}=e.s.options;return{socketTimeoutMS:n,serverSelectionTimeoutMS:r,waitQueueTimeoutMS:o,timeoutMS:i,...t}},e.resolveOptions=function(e,t){const n=Object.assign({},t,(0,f.resolveBSONOptions)(t,e)),r=t?.timeoutMS??e?.timeoutMS,o=t?.session;if(!o?.inTransaction()){const o=E.ReadConcern.fromOptions(t)??e?.readConcern;o&&(n.readConcern=o);let i=_.WriteConcern.fromOptions(t)??e?.writeConcern;i&&(null!=r&&(i=_.WriteConcern.fromOptions({writeConcern:{...i,wtimeout:void 0,wtimeoutMS:void 0}})),n.writeConcern=i)}n.timeoutMS=r;const i=A.ReadPreference.fromOptions(t)??e?.readPreference;i&&(n.readPreference=i);if(o?.explicit&&null!=o?.timeoutContext&&null!=t?.timeoutMS)throw new g.MongoInvalidArgumentError("An operation cannot be given a timeoutMS setting when inside a withTransaction call that has a timeoutMS setting");return n},e.isSuperset=M,e.isHello=function(e){return!(!e[y.LEGACY_HELLO_COMMAND]&&!e.hello)},e.setDifference=function(e,t){const n=new Set(e);for(const e of t)n.delete(e);return n},e.isRecord=function(e,t=void 0){if(!C(e))return!1;const n=e.constructor;if(n&&n.prototype){if(!C(n.prototype))return!1;if(!T(n.prototype,"isPrototypeOf"))return!1}if(t){return M(Object.keys(e),t)}return!0},e.emitWarning=x,e.emitWarningOnce=function(e){if(!N.has(e))return N.add(e),x(e)},e.enumToString=function(e){return Object.values(e).join(", ")},e.supportsRetryableWrites=function(e){if(!e)return!1;if(e.loadBalanced)return!0;if(null!=e.description.logicalSessionTimeoutMinutes&&e.description.type!==b.ServerType.Standalone)return!0;return!1},e.shuffle=function(e,t=0){const n=Array.from(e);if(t>n.length)throw new g.MongoRuntimeError("Limit must be less than the number of items");let r=n.length;const o=t%n.length==0?1:n.length-t;for(;r>o;){const e=Math.floor(Math.random()*r);r-=1;const t=n[r];n[r]=n[e],n[e]=t}return t%n.length==0?n:n.slice(o)},e.commandSupportsReadConcern=function(e){if(e.aggregate||e.count||e.distinct||e.find||e.geoNear)return!0;return!1},e.compareObjectId=function(t,n){if(null==t&&null==n)return 0;if(null==t)return-1;if(null==n)return 1;return e.ByteUtils.compare(t.id,n.id)},e.parseInteger=I,e.parseUnsignedInteger=function(e){const t=I(e);return null!=t&&t>=0?t:null},e.checkParentDomainMatch=function(e,t){const n=e.endsWith(".")?e.slice(0,e.length-1):e,r=t.endsWith(".")?t.slice(0,t.length-1):t,o=/^.*?\./,i=r.split(".").length<3,s=`.${n.replace(o,"")}`;let u=i?r:`.${r.replace(o,"")}`;u.startsWith(".")||(u="."+u);if(i&&n.split(".").length<=r.split(".").length)throw new g.MongoAPIError("Server record does not have at least one more domain level than parent URI");if(!s.endsWith(u))throw new g.MongoAPIError("Server record does not share hostname with parent URI")},e.get=function(e,t={}){return new Promise(((n,r)=>{let o;const i=c.get(e,t,(e=>{e.setEncoding("utf8");let t="";e.on("data",(e=>t+=e)),e.on("end",(()=>{(0,l.clearTimeout)(o),n({status:e.statusCode,body:t})}))})).on("error",(e=>{(0,l.clearTimeout)(o),r(e)})).end();o=(0,l.setTimeout)((()=>{i.destroy(new g.MongoNetworkTimeoutError("request timed out after 10 seconds"))}),1e4)}))},e.request=async function(e,t={}){return await new Promise(((n,r)=>{const o={method:"GET",timeout:1e4,json:!0,...h.parse(e),...t},i=c.request(o,(e=>{e.setEncoding("utf8");let o="";e.on("data",(e=>{o+=e})),e.once("end",(()=>{if(!1!==t.json)try{const e=JSON.parse(o);n(e)}catch{r(new g.MongoRuntimeError(`Invalid JSON response: "${o}"`))}else n(o)}))}));i.once("timeout",(()=>i.destroy(new g.MongoNetworkTimeoutError(`Network request to ${e} timed out after ${t.timeout} ms`)))),i.once("error",(e=>r(e))),i.end()}))},e.isHostMatch=function(e,t){return!(!t||!e.test(t.toLowerCase()))},e.promiseWithResolvers=R,e.squashError=function(e){return},e.once=async function(t,n,r){r?.signal?.throwIfAborted();const{promise:o,resolve:i,reject:s}=R(),u=e=>i(e),a=e=>s(e),c=k(r?.signal,(function(){s(this.reason)}));t.once(n,u).once("error",a);try{return await o}finally{t.off(n,u),t.off("error",a),c?.[e.kDispose]()}},e.maybeAddIdToDocuments=function(e,t,n){const r="boolean"==typeof n.forceServerObjectId?n.forceServerObjectId:e.s.db.options?.forceServerObjectId;if(!0===r)return t;const o=t=>(null==t._id&&(t._id=e.s.pkFactory.createPk()),t);return Array.isArray(t)?t.map(o):o(t)},e.fileIsAccessible=async function(e,t){try{return await a.promises.access(e,t),!0}catch{return!1}},e.csotMin=function(e,t){return 0===e?t:0===t?e:Math.min(e,t)},e.noop=function(){return},e.decorateDecryptionResult=function e(t,n,r=!0){if(r&&(Buffer.isBuffer(n)&&(n=(0,f.deserialize)(n)),Buffer.isBuffer(t)))throw new g.MongoRuntimeError("Expected result of decryption to be deserialized BSON object");if(!t||"object"!=typeof t)return;for(const r of Object.keys(t)){const o=n[r];o&&"Binary"===o._bsontype&&6===o.sub_type?(t[y.kDecoratedKeys]||Object.defineProperty(t,y.kDecoratedKeys,{value:[],configurable:!0,enumerable:!1,writable:!1}),t[y.kDecoratedKeys].push(r)):e(t[r],o,!1)}},e.addAbortListener=k,e.abortable=async function(t,{signal:n}){if(null==n)return await t;const{promise:r,reject:o}=R(),i=n.aborted?o(n.reason):k(n,(function(){o(this.reason)}));try{return await Promise.race([t,r])}finally{i?.[e.kDispose]()}};const t=r,a=o,c=i,l=s,h=u,p=u,d=n,f=F(),m=H(),y=z(),g=P(),E=Q(),A=Z(),b=ne(),_=de();e.ByteUtils={toLocalBufferType:e=>Buffer.isBuffer(e)?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength),equals:(t,n)=>e.ByteUtils.toLocalBufferType(t).equals(n),compare:(t,n)=>e.ByteUtils.toLocalBufferType(t).compare(n),toBase64:t=>e.ByteUtils.toLocalBufferType(t).toString("base64")};const O=e=>Object.prototype.toString.call(e);function C(e){return"[object Object]"===O(e)}function w(e){if("topology"in e&&e.topology)return e.topology;if("client"in e&&e.client.topology)return e.client.topology;throw new g.MongoNotConnectedError("MongoClient must be connected to perform this operation")}class S{constructor(e,t){this.db=e,this.collection=t,this.collection=""===t?void 0:t}toString(){return this.collection?`${this.db}.${this.collection}`:this.db}withCollection(e){return new v(this.db,e)}static fromString(e){if("string"!=typeof e||""===e)throw new g.MongoRuntimeError(`Cannot parse namespace from "${e}"`);const[t,...n]=e.split("."),r=n.join(".");return new S(t,""===r?void 0:r)}}e.MongoDBNamespace=S;class v extends S{constructor(e,t){super(e,t),this.collection=t}static fromString(e){return super.fromString(e)}}function D(){const e=process.hrtime();return Math.floor(1e3*e[0]+e[1]/1e6)}function M(e,t){e=Array.isArray(e)?new Set(e):e,t=Array.isArray(t)?new Set(t):t;for(const n of t)if(!e.has(n))return!1;return!0}e.MongoDBCollectionNamespace=v;const T=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class B{get length(){return this.count}get[Symbol.toStringTag](){return"List"}constructor(){this.count=0,this.head={next:null,prev:null,value:null},this.head.next=this.head,this.head.prev=this.head}toArray(){return Array.from(this)}toString(){return`head <=> ${this.toArray().join(" <=> ")} <=> head`}*[Symbol.iterator](){for(const e of this.nodes())yield e.value}*nodes(){let e=this.head.next;for(;e!==this.head;){const{next:t}=e;yield e,e=t}}push(e){this.count+=1;const t={next:this.head,prev:this.head.prev,value:e};this.head.prev.next=t,this.head.prev=t}pushMany(e){for(const t of e)this.push(t)}unshift(e){this.count+=1;const t={next:this.head.next,prev:this.head,value:e};this.head.next.prev=t,this.head.next=t}remove(e){if(e===this.head||0===this.length)return null;this.count-=1;const t=e.prev,n=e.next;return t.next=n,n.prev=t,e.value}shift(){return this.remove(this.head.next)}pop(){return this.remove(this.head.prev)}prune(e){for(const t of this.nodes())e(t.value)&&this.remove(t)}clear(){this.count=0,this.head.next=this.head,this.head.prev=this.head}first(){return this.head.next.value}last(){return this.head.prev.value}}e.List=B;e.BufferPool=class{constructor(){this.buffers=new B,this.totalByteLength=0}get length(){return this.totalByteLength}append(e){this.buffers.push(e),this.totalByteLength+=e.length}getInt32(){if(this.totalByteLength<4)return null;const e=this.buffers.first();if(null!=e&&e.byteLength>=4)return e.readInt32LE(0);const t=this.read(4),n=t.readInt32LE(0);return this.totalByteLength+=4,this.buffers.unshift(t),n}read(e){if("number"!=typeof e||e<0)throw new g.MongoInvalidArgumentError('Argument "size" must be a non-negative number');if(e>this.totalByteLength)return Buffer.alloc(0);const t=Buffer.allocUnsafe(e);for(let n=0;n<e;){const r=this.buffers.shift();if(null==r)break;const o=e-n,i=Math.min(o,r.byteLength),s=r.subarray(0,i);t.set(s,n),n+=i,this.totalByteLength-=i,i<r.byteLength&&this.buffers.unshift(r.subarray(i))}return t}};class ${constructor(e){this.host=void 0,this.port=void 0,this.socketPath=void 0,this.isIPv6=!1;const t=e.split(" ").join("%20");if(t.endsWith(".sock"))return void(this.socketPath=decodeURIComponent(t));const n=`iLoveJS://${t}`;let r;try{r=new p.URL(n)}catch(e){const n=new g.MongoRuntimeError(`Unable to parse ${t} with URL`);throw n.cause=e,n}const o=r.hostname,i=r.port;let s=decodeURIComponent(o).toLowerCase();if(s.startsWith("[")&&s.endsWith("]")&&(this.isIPv6=!0,s=s.substring(1,o.length-1)),this.host=s.toLowerCase(),this.port="number"==typeof i?i:"string"==typeof i&&""!==i?Number.parseInt(i,10):27017,0===this.port)throw new g.MongoParseError("Invalid port (zero) with hostname");Object.freeze(this)}[Symbol.for("nodejs.util.inspect.custom")](){return this.inspect()}inspect(){return`new HostAddress('${this.toString()}')`}toString(){return"string"==typeof this.host?this.isIPv6?`[${this.host}]:${this.port}`:`${this.host}:${this.port}`:`${this.socketPath}`}static fromString(e){return new $(e)}static fromHostPort(e,t){return e.includes(":")&&(e=`[${e}]`),$.fromString(`${e}:${t}`)}static fromSrvRecord({name:e,port:t}){return $.fromHostPort(e,t)}toHostPort(){if(this.socketPath)return{host:this.socketPath,port:0};return{host:this.host??"",port:this.port??0}}}function x(t){return process.emitWarning(t,{code:e.MONGODB_WARNING_CODE})}e.HostAddress=$,e.DEFAULT_PK_FACTORY={createPk:()=>new f.ObjectId},e.MONGODB_WARNING_CODE="MONGODB DRIVER";const N=new Set;function I(e){if("number"==typeof e)return Math.trunc(e);const t=Number.parseInt(String(e),10);return Number.isNaN(t)?null:t}function R(){let e,t;return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}}function k(t,n){if(null!=t)return t.addEventListener("abort",n,{once:!0}),{[e.kDispose]:()=>t.removeEventListener("abort",n)}}e.DOCUMENT_DB_CHECK=/(\.docdb\.amazonaws\.com$)|(\.docdb-elastic\.amazonaws\.com$)/,e.COSMOS_DB_CHECK=/\.cosmos\.azure\.com$/,e.DOCUMENT_DB_MSG="You appear to be connected to a DocumentDB cluster. For more information regarding feature compatibility and support please visit https://www.mongodb.com/supportability/documentdb",e.COSMOS_DB_MSG="You appear to be connected to a CosmosDB cluster. For more information regarding feature compatibility and support please visit https://www.mongodb.com/supportability/cosmosdb",e.randomBytes=(0,d.promisify)(t.randomBytes),e.kDispose=Symbol.dispose??Symbol("dispose")}(q)),q}function me(){return ue||(ue=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MongoLogger=e.MongoLoggableComponent=e.SEVERITY_LEVEL_MAP=e.DEFAULT_MAX_DOCUMENT_LENGTH=e.SeverityLevel=void 0,e.parseSeverityFromString=u,e.createStdioLogger=a,e.stringifyWithMaxLen=h,e.defaultLogTransform=g;const t=n,r=F(),o=z(),i=fe();e.SeverityLevel=Object.freeze({EMERGENCY:"emergency",ALERT:"alert",CRITICAL:"critical",ERROR:"error",WARNING:"warn",NOTICE:"notice",INFORMATIONAL:"info",DEBUG:"debug",TRACE:"trace",OFF:"off"}),e.DEFAULT_MAX_DOCUMENT_LENGTH=1e3;class s extends Map{constructor(e){const t=[];for(const[n,r]of e)t.push([r,n]);t.push(...e),super(t)}getNumericSeverityLevel(e){return this.get(e)}getSeverityLevelName(e){return this.get(e)}}function u(t){const n=Object.values(e.SeverityLevel),r=t?.toLowerCase();return null!=r&&n.includes(r)?r:null}function a(e){return{write:(0,t.promisify)(((n,r)=>{const o=(0,t.inspect)(n,{compact:!0,breakLength:1/0});e.write(`${o}\n`,"utf-8",r)}))}}function c(e,t,n){return u(e)??u(t)??n}function l(t,n){const r=e.SEVERITY_LEVEL_MAP.getNumericSeverityLevel(t),o=e.SEVERITY_LEVEL_MAP.getNumericSeverityLevel(n);return r<o?-1:r>o?1:0}function h(e,t,n={}){let o="",s=0;const u=function(e,n){if(!(s>=t)){if(""===e)return s+=1,n;if(s+=e.length+4,null==n)return n;switch(typeof n){case"string":s+=n.length+2;break;case"number":case"bigint":s+=String(n).length;break;case"boolean":s+=n?4:5;break;case"object":if((0,i.isUint8Array)(n))s+=22+n.byteLength+.33*n.byteLength+18|0;else if("_bsontype"in n){const e=n;switch(e._bsontype){case"Int32":s+=String(e.value).length;break;case"Double":s+=(0|e.value)===e.value?String(e.value).length+2:String(e.value).length;break;case"Long":s+=e.toString().length;break;case"ObjectId":s+=35;break;case"MaxKey":case"MinKey":s+=13;break;case"Binary":s+=22+n.position+.33*n.position+18|0;break;case"Timestamp":s+=19+String(e.t).length+5+String(e.i).length+2;break;case"Code":null==e.scope?s+=e.code.length+10+2:s+=e.code.length+10+11;break;case"BSONRegExp":s+=34+e.pattern.length+13+e.options.length+3}}}return n}};if("string"==typeof e)o=e;else if("function"==typeof e)o=e.name;else try{o=0!==t?r.EJSON.stringify(e,u,0,n):r.EJSON.stringify(e,n)}catch(e){o=`Extended JSON serialization failed with: ${e.message}`}return 0!==t&&o.length>t&&o.charCodeAt(t-1)!==o.codePointAt(t-1)&&0===--t?"":0!==t&&o.length>t?`${o.slice(0,t)}...`:o}function p(t,n,r=e.DEFAULT_MAX_DOCUMENT_LENGTH){const{selector:o,operation:i,topologyDescription:s,message:u}=n;return t.selector=h(o,r),t.operation=i,t.topologyDescription=h(s,r),t.message=u,t}function d(e,t){e.commandName=t.commandName,e.requestId=t.requestId,e.driverConnectionId=t.connectionId;const{host:n,port:r}=i.HostAddress.fromString(t.address).toHostPort();return e.serverHost=n,e.serverPort=r,t?.serviceId&&(e.serviceId=t.serviceId.toHexString()),e.databaseName=t.databaseName,e.serverConnectionId=t.serverConnectionId,e}function f(e,t){const{host:n,port:r}=i.HostAddress.fromString(t.address).toHostPort();return e.serverHost=n,e.serverPort=r,e}function m(e,t){return e.topologyId=t.topologyId,e}function y(e,t){const{awaited:n,connectionId:r}=t;e.awaited=n,e.driverConnectionId=t.connectionId;const{host:o,port:s}=i.HostAddress.fromString(r).toHostPort();return e.serverHost=o,e.serverPort=s,e}function g(t,n=e.DEFAULT_MAX_DOCUMENT_LENGTH){let r=Object.create(null);switch(t.name){case o.SERVER_SELECTION_STARTED:return r=p(r,t,n),r;case o.SERVER_SELECTION_FAILED:return r=p(r,t,n),r.failure=t.failure?.message,r;case o.SERVER_SELECTION_SUCCEEDED:return r=p(r,t,n),r.serverHost=t.serverHost,r.serverPort=t.serverPort,r;case o.WAITING_FOR_SUITABLE_SERVER:return r=p(r,t,n),r.remainingTimeMS=t.remainingTimeMS,r;case o.COMMAND_STARTED:return r=d(r,t),r.message="Command started",r.command=h(t.command,n,{relaxed:!0}),r.databaseName=t.databaseName,r;case o.COMMAND_SUCCEEDED:return r=d(r,t),r.message="Command succeeded",r.durationMS=t.duration,r.reply=h(t.reply,n,{relaxed:!0}),r;case o.COMMAND_FAILED:return r=d(r,t),r.message="Command failed",r.durationMS=t.duration,r.failure=t.failure?.message??"(redacted)",r;case o.CONNECTION_POOL_CREATED:if(r=f(r,t),r.message="Connection pool created",t.options){const{maxIdleTimeMS:e,minPoolSize:n,maxPoolSize:o,maxConnecting:i,waitQueueTimeoutMS:s}=t.options;r={...r,maxIdleTimeMS:e,minPoolSize:n,maxPoolSize:o,maxConnecting:i,waitQueueTimeoutMS:s}}return r;case o.CONNECTION_POOL_READY:return r=f(r,t),r.message="Connection pool ready",r;case o.CONNECTION_POOL_CLEARED:return r=f(r,t),r.message="Connection pool cleared","ObjectId"===t.serviceId?._bsontype&&(r.serviceId=t.serviceId?.toHexString()),r;case o.CONNECTION_POOL_CLOSED:return r=f(r,t),r.message="Connection pool closed",r;case o.CONNECTION_CREATED:return r=f(r,t),r.message="Connection created",r.driverConnectionId=t.connectionId,r;case o.CONNECTION_READY:return r=f(r,t),r.message="Connection ready",r.driverConnectionId=t.connectionId,r.durationMS=t.durationMS,r;case o.CONNECTION_CLOSED:switch(r=f(r,t),r.message="Connection closed",r.driverConnectionId=t.connectionId,t.reason){case"stale":r.reason="Connection became stale because the pool was cleared";break;case"idle":r.reason="Connection has been available but unused for longer than the configured max idle time";break;case"error":r.reason="An error occurred while using the connection",t.error&&(r.error=t.error);break;case"poolClosed":r.reason="Connection pool was closed";break;default:r.reason=`Unknown close reason: ${t.reason}`}return r;case o.CONNECTION_CHECK_OUT_STARTED:return r=f(r,t),r.message="Connection checkout started",r;case o.CONNECTION_CHECK_OUT_FAILED:switch(r=f(r,t),r.message="Connection checkout failed",t.reason){case"poolClosed":r.reason="Connection pool was closed";break;case"timeout":r.reason="Wait queue timeout elapsed without a connection becoming available";break;case"connectionError":r.reason="An error occurred while trying to establish a new connection",t.error&&(r.error=t.error);break;default:r.reason=`Unknown close reason: ${t.reason}`}return r.durationMS=t.durationMS,r;case o.CONNECTION_CHECKED_OUT:return r=f(r,t),r.message="Connection checked out",r.driverConnectionId=t.connectionId,r.durationMS=t.durationMS,r;case o.CONNECTION_CHECKED_IN:return r=f(r,t),r.message="Connection checked in",r.driverConnectionId=t.connectionId,r;case o.SERVER_OPENING:return r=m(r,t),r=f(r,t),r.message="Starting server monitoring",r;case o.SERVER_CLOSED:return r=m(r,t),r=f(r,t),r.message="Stopped server monitoring",r;case o.SERVER_HEARTBEAT_STARTED:return r=m(r,t),r=y(r,t),r.message="Server heartbeat started",r;case o.SERVER_HEARTBEAT_SUCCEEDED:return r=m(r,t),r=y(r,t),r.message="Server heartbeat succeeded",r.durationMS=t.duration,r.serverConnectionId=t.serverConnectionId,r.reply=h(t.reply,n,{relaxed:!0}),r;case o.SERVER_HEARTBEAT_FAILED:return r=m(r,t),r=y(r,t),r.message="Server heartbeat failed",r.durationMS=t.duration,r.failure=t.failure?.message,r;case o.TOPOLOGY_OPENING:return r=m(r,t),r.message="Starting topology monitoring",r;case o.TOPOLOGY_CLOSED:return r=m(r,t),r.message="Stopped topology monitoring",r;case o.TOPOLOGY_DESCRIPTION_CHANGED:return r=m(r,t),r.message="Topology description changed",r.previousDescription=r.reply=h(t.previousDescription,n),r.newDescription=r.reply=h(t.newDescription,n),r;default:for(const[e,n]of Object.entries(t))null!=n&&(r[e]=n)}return r}e.SEVERITY_LEVEL_MAP=new s([[e.SeverityLevel.OFF,-1/0],[e.SeverityLevel.EMERGENCY,0],[e.SeverityLevel.ALERT,1],[e.SeverityLevel.CRITICAL,2],[e.SeverityLevel.ERROR,3],[e.SeverityLevel.WARNING,4],[e.SeverityLevel.NOTICE,5],[e.SeverityLevel.INFORMATIONAL,6],[e.SeverityLevel.DEBUG,7],[e.SeverityLevel.TRACE,8]]),e.MongoLoggableComponent=Object.freeze({COMMAND:"command",TOPOLOGY:"topology",SERVER_SELECTION:"serverSelection",CONNECTION:"connection",CLIENT:"client"});e.MongoLogger=class{constructor(e){this.pendingLog=null,this.error=this.log.bind(this,"error"),this.warn=this.log.bind(this,"warn"),this.info=this.log.bind(this,"info"),this.debug=this.log.bind(this,"debug"),this.trace=this.log.bind(this,"trace"),this.componentSeverities=e.componentSeverities,this.maxDocumentLength=e.maxDocumentLength,this.logDestination=e.logDestination,this.logDestinationIsStdErr=e.logDestinationIsStdErr,this.severities=this.createLoggingSeverities()}createLoggingSeverities(){const t=Object();for(const n of Object.values(e.MongoLoggableComponent)){t[n]={};for(const r of Object.values(e.SeverityLevel))t[n][r]=l(r,this.componentSeverities[n])<=0}return t}turnOffSeverities(){for(const t of Object.values(e.MongoLoggableComponent)){this.componentSeverities[t]=e.SeverityLevel.OFF;for(const n of Object.values(e.SeverityLevel))this.severities[t][n]=!1}}logWriteFailureHandler(t){if(this.logDestinationIsStdErr)return this.turnOffSeverities(),void this.clearPendingLog();this.logDestination=a(process.stderr),this.logDestinationIsStdErr=!0,this.clearPendingLog(),this.error(e.MongoLoggableComponent.CLIENT,{toLog:function(){return{message:"User input for mongodbLogPath is now invalid. Logging is halted.",error:t.message}}}),this.turnOffSeverities(),this.clearPendingLog()}clearPendingLog(){this.pendingLog=null}willLog(t,n){return n!==e.SeverityLevel.OFF&&this.severities[t][n]}log(e,t,n){if(!this.willLog(t,e))return;let r={t:new Date,c:t,s:e};if("string"==typeof n?r.message=n:"object"==typeof n&&(r=function(e){const t=e;return void 0!==t.toLog&&"function"==typeof t.toLog}(n)?{...r,...n.toLog()}:{...r,...g(n,this.maxDocumentLength)}),(0,i.isPromiseLike)(this.pendingLog))this.pendingLog=this.pendingLog.then((()=>this.logDestination.write(r))).then(this.clearPendingLog.bind(this),this.logWriteFailureHandler.bind(this));else try{const e=this.logDestination.write(r);(0,i.isPromiseLike)(e)&&(this.pendingLog=e.then(this.clearPendingLog.bind(this),this.logWriteFailureHandler.bind(this)))}catch(e){this.logWriteFailureHandler(e)}}static resolveOptions(t,n){const r=function({MONGODB_LOG_PATH:e},{mongodbLogPath:t}){return"string"==typeof t&&/^stderr$/i.test(t)?{mongodbLogPath:a(process.stderr),mongodbLogPathIsStdErr:!0}:"string"==typeof t&&/^stdout$/i.test(t)?{mongodbLogPath:a(process.stdout),mongodbLogPathIsStdErr:!1}:"object"==typeof t&&"function"==typeof t?.write?{mongodbLogPath:t,mongodbLogPathIsStdErr:!1}:e&&/^stderr$/i.test(e)?{mongodbLogPath:a(process.stderr),mongodbLogPathIsStdErr:!0}:e&&/^stdout$/i.test(e)?{mongodbLogPath:a(process.stdout),mongodbLogPathIsStdErr:!1}:{mongodbLogPath:a(process.stderr),mongodbLogPathIsStdErr:!0}}(t,n),o={...t,...n,mongodbLogPath:r.mongodbLogPath,mongodbLogPathIsStdErr:r.mongodbLogPathIsStdErr},s=c(o.mongodbLogComponentSeverities?.default,o.MONGODB_LOG_ALL,e.SeverityLevel.OFF);return{componentSeverities:{command:c(o.mongodbLogComponentSeverities?.command,o.MONGODB_LOG_COMMAND,s),topology:c(o.mongodbLogComponentSeverities?.topology,o.MONGODB_LOG_TOPOLOGY,s),serverSelection:c(o.mongodbLogComponentSeverities?.serverSelection,o.MONGODB_LOG_SERVER_SELECTION,s),connection:c(o.mongodbLogComponentSeverities?.connection,o.MONGODB_LOG_CONNECTION,s),client:c(o.mongodbLogComponentSeverities?.client,o.MONGODB_LOG_CLIENT,s),default:s},maxDocumentLength:o.mongodbLogMaxDocumentLength??(0,i.parseUnsignedInteger)(o.MONGODB_LOG_MAX_DOCUMENT_LENGTH)??1e3,logDestination:o.mongodbLogPath,logDestinationIsStdErr:o.mongodbLogPathIsStdErr}}}}(U)),U}function ye(){if(ae)return L;ae=1,Object.defineProperty(L,"__esModule",{value:!0}),L.CancellationToken=L.TypedEventEmitter=void 0;const e=t,n=me(),r=fe();class o extends e.EventEmitter{emitAndLog(e,...t){this.emit(e,...t),this.component&&this.mongoLogger?.debug(this.component,t[0])}emitAndLogHeartbeat(e,t,n,...r){if(this.emit(e,...r),this.component){const e={topologyId:t,serverConnectionId:n??null,...r[0]};this.mongoLogger?.debug(this.component,e)}}emitAndLogCommand(e,t,r,o,...i){if(e&&this.emit(t,...i),o){const e={databaseName:r,...i[0]};this.mongoLogger?.debug(n.MongoLoggableComponent.COMMAND,e)}}}L.TypedEventEmitter=o;return L.CancellationToken=class extends o{constructor(...e){super(...e),this.on("error",r.noop)}},L}var ge,Ee={},Ae={};function be(){return ge||(ge=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MIN_SECONDARY_WRITE_WIRE_VERSION=void 0,e.writableServerSelector=function(){return function(e,t){return u(e,t.filter((e=>e.isWritable)))}},e.sameServerSelector=function(e){return function(t,n){return e?n.filter((t=>t.address===e.address&&t.type!==r.ServerType.Unknown)):[]}},e.secondaryWritableServerSelector=function(t,r){if(!r||!t||t&&t<e.MIN_SECONDARY_WRITE_WIRE_VERSION)return d(n.ReadPreference.primary);return d(r)},e.readPreferenceServerSelector=d;const t=P(),n=Z(),r=ne(),o=1e4,i=90;function s(e,t){const n=Object.keys(e),r=Object.keys(t);for(let o=0;o<n.length;++o){const i=n[o];if(-1===r.indexOf(i)||t[i]!==e[i])return!1}return!0}function u(e,t){const n=t.reduce(((e,t)=>Math.min(t.roundTripTime,e)),1/0),r=n+e.localThresholdMS;return t.reduce(((e,t)=>(t.roundTripTime<=r&&t.roundTripTime>=n&&e.push(t),e)),[])}function a(e){return e.type===r.ServerType.RSPrimary}function c(e){return e.type===r.ServerType.RSSecondary}function l(e){return e.type===r.ServerType.RSSecondary||e.type===r.ServerType.RSPrimary}function h(e){return e.type!==r.ServerType.Unknown}function p(e){return e.type===r.ServerType.LoadBalancer}function d(e){if(!e.isValid())throw new t.MongoInvalidArgumentError("Invalid read preference specified");return function(d,f,m=[]){const y=d.commonWireVersion;if(y&&e.minWireVersion&&e.minWireVersion>y)throw new t.MongoCompatibilityError(`Minimum wire version '${e.minWireVersion}' required, but found '${y}'`);if(d.type===r.TopologyType.LoadBalanced)return f.filter(p);if(d.type===r.TopologyType.Unknown)return[];if(d.type===r.TopologyType.Single)return u(d,f.filter(h));if(d.type===r.TopologyType.Sharded){const e=f.filter((e=>!m.includes(e)));return u(d,(e.length>0?e:m).filter(h))}const g=e.mode;if(g===n.ReadPreference.PRIMARY)return f.filter(a);if(g===n.ReadPreference.PRIMARY_PREFERRED){const e=f.filter(a);if(e.length)return e}const E=g===n.ReadPreference.NEAREST?l:c,A=u(d,function(e,t){if(null==e.tags||Array.isArray(e.tags)&&0===e.tags.length)return t;for(let n=0;n<e.tags.length;++n){const r=e.tags[n],o=t.reduce(((e,t)=>(s(r,t.tags)&&e.push(t),e)),[]);if(o.length)return o}return[]}(e,function(e,n,s){if(null==e.maxStalenessSeconds||e.maxStalenessSeconds<0)return s;const u=e.maxStalenessSeconds,c=(n.heartbeatFrequencyMS+o)/1e3;if(u<c)throw new t.MongoInvalidArgumentError(`Option "maxStalenessSeconds" must be at least ${c} seconds`);if(u<i)throw new t.MongoInvalidArgumentError(`Option "maxStalenessSeconds" must be at least ${i} seconds`);if(n.type===r.TopologyType.ReplicaSetWithPrimary){const t=Array.from(n.servers.values()).filter(a)[0];return s.reduce(((r,o)=>((o.lastUpdateTime-o.lastWriteDate-(t.lastUpdateTime-t.lastWriteDate)+n.heartbeatFrequencyMS)/1e3<=(e.maxStalenessSeconds??0)&&r.push(o),r)),[])}if(n.type===r.TopologyType.ReplicaSetNoPrimary){if(0===s.length)return s;const t=s.reduce(((e,t)=>t.lastWriteDate>e.lastWriteDate?t:e));return s.reduce(((r,o)=>((t.lastWriteDate-o.lastWriteDate+n.heartbeatFrequencyMS)/1e3<=(e.maxStalenessSeconds??0)&&r.push(o),r)),[])}return s}(e,d,f.filter(E))));return g===n.ReadPreference.SECONDARY_PREFERRED&&0===A.length?f.filter(a):A}}e.MIN_SECONDARY_WRITE_WIRE_VERSION=13}(Ae)),Ae}var _e,Oe={};function Ce(){if(_e)return Oe;_e=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.LegacyTimeoutContext=Oe.CSOTTimeoutContext=Oe.TimeoutContext=Oe.Timeout=Oe.TimeoutError=void 0;const e=s,t=P(),n=fe();class r extends Error{get name(){return"TimeoutError"}constructor(e,t){super(e,t),this.duration=t.duration}static is(e){return null!=e&&"object"==typeof e&&"name"in e&&"TimeoutError"===e.name}}Oe.TimeoutError=r;class o extends Promise{get remainingTime(){return this.timedOut?0:0===this.duration?1/0:this.start+this.duration-Math.trunc(performance.now())}get timeElapsed(){return Math.trunc(performance.now())-this.start}constructor(o=()=>null,i){const s=i?.duration??0,u=!!i?.unref,a=i?.rejection;if(s<0)throw new t.MongoInvalidArgumentError("Cannot create a Timeout with a negative duration");let c;super(((e,t)=>{c=t,o(n.noop,t)})),this.ended=null,this.timedOut=!1,this.cleared=!1,this.duration=s,this.start=Math.trunc(performance.now()),null==a&&this.duration>0?(this.id=(0,e.setTimeout)((()=>{this.ended=Math.trunc(performance.now()),this.timedOut=!0,c(new r(`Expired after ${s}ms`,{duration:s}))}),this.duration),"function"==typeof this.id.unref&&u&&this.id.unref()):null!=a&&(this.ended=Math.trunc(performance.now()),this.timedOut=!0,c(a))}clear(){(0,e.clearTimeout)(this.id),this.id=void 0,this.timedOut=!1,this.cleared=!0}throwIfExpired(){if(this.timedOut)throw this.then(void 0,n.squashError),new r("Timed out",{duration:this.duration})}static expires(e,t){return new o(void 0,{duration:e,unref:t})}static reject(e){return new o(void 0,{duration:0,unref:!0,rejection:e})}}Oe.Timeout=o;class i{static create(e){if(null!=e.session?.timeoutContext)return e.session?.timeoutContext;if(null!=(n=e)&&"object"==typeof n&&"serverSelectionTimeoutMS"in n&&"number"==typeof n.serverSelectionTimeoutMS&&"timeoutMS"in n&&"number"==typeof n.timeoutMS)return new u(e);if(function(e){return null!=e&&"object"==typeof e&&"serverSelectionTimeoutMS"in e&&"number"==typeof e.serverSelectionTimeoutMS&&"waitQueueTimeoutMS"in e&&"number"==typeof e.waitQueueTimeoutMS}(e))return new a(e);throw new t.MongoRuntimeError("Unrecognized options");var n}}Oe.TimeoutContext=i;class u extends i{constructor(e){super(),this.minRoundTripTime=0,this.start=Math.trunc(performance.now()),this.timeoutMS=e.timeoutMS,this.serverSelectionTimeoutMS=e.serverSelectionTimeoutMS,this.socketTimeoutMS=e.socketTimeoutMS,this.clearServerSelectionTimeout=!1}get maxTimeMS(){return this.remainingTimeMS-this.minRoundTripTime}get remainingTimeMS(){const e=Math.trunc(performance.now())-this.start;return this.timeoutMS<=0?1/0:this.timeoutMS-e}csotEnabled(){return!0}get serverSelectionTimeout(){if("object"!=typeof this._serverSelectionTimeout||this._serverSelectionTimeout?.cleared){const{remainingTimeMS:e,serverSelectionTimeoutMS:r}=this;if(e<=0)return o.reject(new t.MongoOperationTimeoutError(`Timed out in server selection after ${this.timeoutMS}ms`));0!==r&&(0,n.csotMin)(e,r)===r?this._serverSelectionTimeout=o.expires(r):e>0&&Number.isFinite(e)?this._serverSelectionTimeout=o.expires(e):this._serverSelectionTimeout=null}return this._serverSelectionTimeout}get connectionCheckoutTimeout(){if("object"!=typeof this._connectionCheckoutTimeout||this._connectionCheckoutTimeout?.cleared){if("object"!=typeof this._serverSelectionTimeout)throw new t.MongoRuntimeError("Unreachable. If you are seeing this error, please file a ticket on the NODE driver project on Jira");this._connectionCheckoutTimeout=this._serverSelectionTimeout}return this._connectionCheckoutTimeout}get timeoutForSocketWrite(){const{remainingTimeMS:e}=this;return Number.isFinite(e)?e>0?o.expires(e):o.reject(new t.MongoOperationTimeoutError("Timed out before socket write")):null}get timeoutForSocketRead(){const{remainingTimeMS:e}=this;return Number.isFinite(e)?e>0?o.expires(e):o.reject(new t.MongoOperationTimeoutError("Timed out before socket read")):null}refresh(){this.start=Math.trunc(performance.now()),this.minRoundTripTime=0,this._serverSelectionTimeout?.clear(),this._connectionCheckoutTimeout?.clear()}clear(){this._serverSelectionTimeout?.clear(),this._connectionCheckoutTimeout?.clear()}getRemainingTimeMSOrThrow(e){const{remainingTimeMS:n}=this;if(n<=0)throw new t.MongoOperationTimeoutError(e??`Expired after ${this.timeoutMS}ms`);return n}clone(){const e=new u({timeoutMS:this.timeoutMS,serverSelectionTimeoutMS:this.serverSelectionTimeoutMS});return e.start=this.start,e}refreshed(){return new u(this)}addMaxTimeMSToCommand(e,t){if(t.omitMaxTimeMS)return;const n=this.remainingTimeMS-this.minRoundTripTime;n>0&&Number.isFinite(n)&&(e.maxTimeMS=n)}getSocketTimeoutMS(){return 0}}Oe.CSOTTimeoutContext=u;class a extends i{constructor(e){super(),this.options=e,this.clearServerSelectionTimeout=!0}csotEnabled(){return!1}get serverSelectionTimeout(){return null!=this.options.serverSelectionTimeoutMS&&this.options.serverSelectionTimeoutMS>0?o.expires(this.options.serverSelectionTimeoutMS):null}get connectionCheckoutTimeout(){return null!=this.options.waitQueueTimeoutMS&&this.options.waitQueueTimeoutMS>0?o.expires(this.options.waitQueueTimeoutMS):null}get timeoutForSocketWrite(){return null}get timeoutForSocketRead(){return null}refresh(){}clear(){}get maxTimeMS(){return null}refreshed(){return new a(this.options)}addMaxTimeMSToCommand(e,t){}getSocketTimeoutMS(){return this.options.socketTimeoutMS}}return Oe.LegacyTimeoutContext=a,Oe}var we,Se,ve={};function De(){return we||(we=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractOperation=e.Aspect=void 0,e.defineAspects=function(e,t){Array.isArray(t)||t instanceof Set||(t=[t]);return t=new Set(t),Object.defineProperty(e,"aspects",{value:t,writable:!1}),t};const t=F(),n=Z();e.Aspect={READ_OPERATION:Symbol("READ_OPERATION"),WRITE_OPERATION:Symbol("WRITE_OPERATION"),RETRYABLE:Symbol("RETRYABLE"),EXPLAINABLE:Symbol("EXPLAINABLE"),SKIP_COLLATION:Symbol("SKIP_COLLATION"),CURSOR_CREATING:Symbol("CURSOR_CREATING"),MUST_SELECT_SAME_SERVER:Symbol("MUST_SELECT_SAME_SERVER"),COMMAND_BATCHING:Symbol("COMMAND_BATCHING")};e.AbstractOperation=class{constructor(r={}){this.readPreference=this.hasAspect(e.Aspect.WRITE_OPERATION)?n.ReadPreference.primary:n.ReadPreference.fromOptions(r)??n.ReadPreference.primary,this.bsonOptions=(0,t.resolveBSONOptions)(r),this._session=null!=r.session?r.session:void 0,this.options=r,this.bypassPinningCheck=!!r.bypassPinningCheck,this.trySecondaryWrite=!1}hasAspect(e){const t=this.constructor;return null!=t.aspects&&t.aspects.has(e)}get session(){return this._session}clearSession(){this._session=void 0}resetBatch(){return!0}get canRetryRead(){return this.hasAspect(e.Aspect.RETRYABLE)&&this.hasAspect(e.Aspect.READ_OPERATION)}get canRetryWrite(){return this.hasAspect(e.Aspect.RETRYABLE)&&this.hasAspect(e.Aspect.WRITE_OPERATION)}}}(ve)),ve}function Me(){if(Se)return Ee;Se=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.executeOperation=async function(a,c,l){if(!(c instanceof i.AbstractOperation))throw new e.MongoRuntimeError("This method requires a valid operation instance");const h=null==a.topology?await(0,o.abortable)(async function(t){if(null==t.topology){if(t.s.hasBeenClosed)throw new e.MongoNotConnectedError("Client must be connected before running operations");t.s.options.__skipPingOnConnect=!0;try{if(await t.connect(),null==t.topology)throw new e.MongoRuntimeError("client.connect did not create a topology but also did not throw");return t.topology}finally{delete t.s.options.__skipPingOnConnect}}return t.topology}(a),c.options):a.topology;let p,d=c.session;if(null==d)p=Symbol(),d=a.startSession({owner:p,explicit:!1});else{if(d.hasEnded)throw new e.MongoExpiredSessionError("Use of expired sessions is not permitted");if(d.snapshotEnabled&&!h.capabilities.supportsSnapshotReads)throw new e.MongoCompatibilityError("Snapshot reads require MongoDB 5.0 or later");if(d.client!==a)throw new e.MongoInvalidArgumentError("ClientSession must be from the same MongoClient")}const f=c.readPreference??t.ReadPreference.primary,m=!!d?.inTransaction(),y=c.hasAspect(i.Aspect.READ_OPERATION);if(m&&!f.equals(t.ReadPreference.primary)&&(y||"runCommand"===c.commandName))throw new e.MongoTransactionError(`Read preference in a transaction must be primary, not: ${f.mode}`);d?.isPinned&&d.transaction.isCommitted&&!c.bypassPinningCheck&&d.unpin();l??=r.TimeoutContext.create({session:d,serverSelectionTimeoutMS:a.s.options.serverSelectionTimeoutMS,waitQueueTimeoutMS:a.s.options.waitQueueTimeoutMS,timeoutMS:c.options.timeoutMS});try{return await async function(t,{topology:r,timeoutContext:a,session:c,readPreference:l}){let h;h=t.hasAspect(i.Aspect.MUST_SELECT_SAME_SERVER)?(0,n.sameServerSelector)(t.server?.description):t.trySecondaryWrite?(0,n.secondaryWritableServerSelector)(r.commonWireVersion,l):l;let p=await r.selectServer(h,{session:c,operationName:t.commandName,timeoutContext:a,signal:t.options.signal});const d=t.hasAspect(i.Aspect.READ_OPERATION),f=t.hasAspect(i.Aspect.WRITE_OPERATION),m=c?.inTransaction()??!1,y=r.s.options.retryReads&&!m&&t.canRetryRead,g=r.s.options.retryWrites&&!m&&(0,o.supportsRetryableWrites)(p)&&t.canRetryWrite,E=t.hasAspect(i.Aspect.RETRYABLE)&&null!=c&&(d&&y||f&&g);f&&g&&null!=c&&(t.options.willRetryWrite=!0,c.incrementTransactionNumber());const A=E?a.csotEnabled()?1/0:2:1;let b,_;for(let n=0;n<A;n++){if(b){if(f&&b.code===s)throw new e.MongoServerError({message:u,errmsg:u,originalError:b});if(t.hasAspect(i.Aspect.COMMAND_BATCHING)&&!t.canRetryWrite)throw b;if(f&&!(0,e.isRetryableWriteError)(b))throw b;if(d&&!(0,e.isRetryableReadError)(b))throw b;if(b instanceof e.MongoNetworkError&&t.hasAspect(i.Aspect.CURSOR_CREATING)&&null!=c&&c.isPinned&&!c.inTransaction()&&c.unpin({force:!0,forceClear:!0}),p=await r.selectServer(h,{session:c,operationName:t.commandName,previousServer:_,signal:t.options.signal}),f&&!(0,o.supportsRetryableWrites)(p))throw new e.MongoUnexpectedServerResponseError("Selected server does not support retryable writes")}try{return n>0&&t.hasAspect(i.Aspect.COMMAND_BATCHING)&&t.resetBatch(),await t.execute(p,c,a)}catch(t){if(!(t instanceof e.MongoError))throw t;if(null!=b&&t.hasErrorLabel(e.MongoErrorLabel.NoWritesPerformed))throw b;_=p.description,b=t,a.clear()}}throw b??new e.MongoRuntimeError("Tried to propagate retryability error, but no error was found.")}(c,{topology:h,timeoutContext:l,session:d,readPreference:f})}finally{null!=d?.owner&&d.owner===p&&await d.endSession()}};const e=P(),t=Z(),n=be(),r=Ce(),o=fe(),i=De(),s=e.MONGODB_ERROR_CODES.IllegalOperation,u="This MongoDB deployment does not support retryable writes. Please add retryWrites=false to your connection string.";return Ee}var Te,Be={};function Fe(){if(Te)return Be;Te=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.GetMoreOperation=void 0;const e=pe(),t=P(),n=fe(),r=De();class o extends r.AbstractOperation{constructor(e,t,n,r){super(r),this.options=r,this.ns=e,this.cursorId=t,this.server=n}get commandName(){return"getMore"}async execute(r,o,i){if(r!==this.server)throw new t.MongoRuntimeError("Getmore must run on the same server operation began on");if(null==this.cursorId||this.cursorId.isZero())throw new t.MongoRuntimeError("Unable to iterate cursor with no id");const s=this.ns.collection;if(null==s)throw new t.MongoRuntimeError("A collection name must be determined before getMore");const u={getMore:this.cursorId,collection:s};"number"==typeof this.options.batchSize&&(u.batchSize=Math.abs(this.options.batchSize)),"number"==typeof this.options.maxAwaitTimeMS&&(u.maxTimeMS=this.options.maxAwaitTimeMS),void 0!==this.options.comment&&(0,n.maxWireVersion)(r)>=9&&(u.comment=this.options.comment);const a={returnFieldSelector:null,documentsReturnedIn:"nextBatch",timeoutContext:i,...this.options};return await r.command(this.ns,u,a,e.CursorResponse)}}return Be.GetMoreOperation=o,(0,r.defineAspects)(o,[r.Aspect.READ_OPERATION,r.Aspect.MUST_SELECT_SAME_SERVER]),Be}var $e,xe={};var Pe,Ne={},Ie={},Re={},ke={},je={};function Le(){if(Pe)return je;Pe=1,Object.defineProperty(je,"__esModule",{value:!0}),je.OrderedBulkOperation=void 0;const e=F(),t=P(),n=ta();class r extends n.BulkOperationBase{constructor(e,t){super(e,t,!0)}addToOperationsList(r,o){const i=e.calculateObjectSize(o,{checkKeys:!1,ignoreUndefined:!1});if(i>=this.s.maxBsonObjectSize)throw new t.MongoInvalidArgumentError(`Document is larger than the maximum size ${this.s.maxBsonObjectSize}`);null==this.s.currentBatch&&(this.s.currentBatch=new n.Batch(r,this.s.currentIndex));const s=this.s.maxKeySize;if((this.s.currentBatchSize+1>=this.s.maxWriteBatchSize||this.s.currentBatchSize>0&&this.s.currentBatchSizeBytes+s+i>=this.s.maxBatchSizeBytes||this.s.currentBatch.batchType!==r)&&(this.s.batches.push(this.s.currentBatch),this.s.currentBatch=new n.Batch(r,this.s.currentIndex),this.s.currentBatchSize=0,this.s.currentBatchSizeBytes=0),r===n.BatchType.INSERT&&this.s.bulkResult.insertedIds.push({index:this.s.currentIndex,_id:o._id}),Array.isArray(o))throw new t.MongoInvalidArgumentError("Operation passed in cannot be an Array");return this.s.currentBatch.originalIndexes.push(this.s.currentIndex),this.s.currentBatch.operations.push(o),this.s.currentBatchSize+=1,this.s.currentBatchSizeBytes+=s+i,this.s.currentIndex+=1,this}}return je.OrderedBulkOperation=r,je}var Ue,Ve={};function ze(){if(Ue)return Ve;Ue=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.UnorderedBulkOperation=void 0;const e=F(),t=P(),n=ta();class r extends n.BulkOperationBase{constructor(e,t){super(e,t,!1)}handleWriteError(e){if(!this.s.batches.length)return super.handleWriteError(e)}addToOperationsList(r,o){const i=e.calculateObjectSize(o,{checkKeys:!1,ignoreUndefined:!1});if(i>=this.s.maxBsonObjectSize)throw new t.MongoInvalidArgumentError(`Document is larger than the maximum size ${this.s.maxBsonObjectSize}`);this.s.currentBatch=void 0,r===n.BatchType.INSERT?this.s.currentBatch=this.s.currentInsertBatch:r===n.BatchType.UPDATE?this.s.currentBatch=this.s.currentUpdateBatch:r===n.BatchType.DELETE&&(this.s.currentBatch=this.s.currentRemoveBatch);const s=this.s.maxKeySize;if(null==this.s.currentBatch&&(this.s.currentBatch=new n.Batch(r,this.s.currentIndex)),(this.s.currentBatch.size+1>=this.s.maxWriteBatchSize||this.s.currentBatch.size>0&&this.s.currentBatch.sizeBytes+s+i>=this.s.maxBatchSizeBytes||this.s.currentBatch.batchType!==r)&&(this.s.batches.push(this.s.currentBatch),this.s.currentBatch=new n.Batch(r,this.s.currentIndex)),Array.isArray(o))throw new t.MongoInvalidArgumentError("Operation passed in cannot be an Array");return this.s.currentBatch.operations.push(o),this.s.currentBatch.originalIndexes.push(this.s.currentIndex),this.s.currentIndex=this.s.currentIndex+1,r===n.BatchType.INSERT?(this.s.currentInsertBatch=this.s.currentBatch,this.s.bulkResult.insertedIds.push({index:this.s.bulkResult.insertedIds.length,_id:o._id})):r===n.BatchType.UPDATE?this.s.currentUpdateBatch=this.s.currentBatch:r===n.BatchType.DELETE&&(this.s.currentRemoveBatch=this.s.currentBatch),this.s.currentBatch.size+=1,this.s.currentBatch.sizeBytes+=s+i,this}}return Ve.UnorderedBulkOperation=r,Ve}var We,qe,Ge={},He={};function Ke(){return We||(We=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AggregateOperation=e.DB_AGGREGATE_COLLECTION=void 0;const t=pe(),n=P(),r=fe(),o=de(),i=Zu(),s=De();e.DB_AGGREGATE_COLLECTION=1;class u extends i.CommandOperation{constructor(t,r,o){if(super(void 0,{...o,dbName:t.db}),this.options={...o},this.target=t.collection||e.DB_AGGREGATE_COLLECTION,this.pipeline=r,this.hasWriteStage=!1,"string"==typeof o?.out)this.pipeline=this.pipeline.concat({$out:o.out}),this.hasWriteStage=!0;else if(r.length>0){const e=r[r.length-1];(e.$out||e.$merge)&&(this.hasWriteStage=!0)}if(this.hasWriteStage?this.trySecondaryWrite=!0:delete this.options.writeConcern,this.explain&&this.writeConcern)throw new n.MongoInvalidArgumentError('Option "explain" cannot be used on an aggregate call with writeConcern');if(null!=o?.cursor&&"object"!=typeof o.cursor)throw new n.MongoInvalidArgumentError("Cursor options must be an object")}get commandName(){return"aggregate"}get canRetryRead(){return!this.hasWriteStage}addToPipeline(e){this.pipeline.push(e)}async execute(e,n,i){const s=this.options,u=(0,r.maxWireVersion)(e),a={aggregate:this.target,pipeline:this.pipeline};return this.hasWriteStage&&u<8&&(this.readConcern=void 0),this.hasWriteStage&&this.writeConcern&&o.WriteConcern.apply(a,this.writeConcern),!0===s.bypassDocumentValidation&&(a.bypassDocumentValidation=s.bypassDocumentValidation),"boolean"==typeof s.allowDiskUse&&(a.allowDiskUse=s.allowDiskUse),s.hint&&(a.hint=s.hint),s.let&&(a.let=s.let),void 0!==s.comment&&(a.comment=s.comment),a.cursor=s.cursor||{},s.batchSize&&!this.hasWriteStage&&(a.cursor.batchSize=s.batchSize),await super.executeCommand(e,n,a,i,this.explain?t.ExplainedCursorResponse:t.CursorResponse)}}e.AggregateOperation=u,(0,s.defineAspects)(u,[s.Aspect.READ_OPERATION,s.Aspect.RETRYABLE,s.Aspect.EXPLAINABLE,s.Aspect.CURSOR_CREATING])}(He)),He}function Ye(){if(qe)return Ge;qe=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.AggregationCursor=void 0;const e=P(),t=Xu(),n=Ke(),r=Me(),o=fe(),i=Ju();class s extends t.ExplainableCursor{constructor(t,n,r=[],o={}){super(t,n,o),this.pipeline=r,this.aggregateOptions=o;const s=this.pipeline[this.pipeline.length-1];if(null!=this.cursorOptions.timeoutMS&&this.cursorOptions.timeoutMode===i.CursorTimeoutMode.ITERATION&&(null!=s?.$merge||null!=s?.$out))throw new e.MongoAPIError("Cannot use $out or $merge stage with ITERATION timeoutMode")}clone(){const e=(0,o.mergeOptions)({},this.aggregateOptions);return delete e.session,new s(this.client,this.namespace,this.pipeline,{...e})}map(e){return super.map(e)}async _initialize(o){const i={...this.aggregateOptions,...this.cursorOptions,session:o,signal:this.signal};if(i.explain)try{(0,t.validateExplainTimeoutOptions)(i,t.Explain.fromOptions(i))}catch{throw new e.MongoAPIError("timeoutMS cannot be used with explain when explain is specified in aggregateOptions")}const s=new n.AggregateOperation(this.namespace,this.pipeline,i),u=await(0,r.executeOperation)(this.client,s,this.timeoutContext);return{server:s.server,session:o,response:u}}async explain(e,t){const{explain:o,timeout:i}=this.resolveExplainTimeoutOptions(e,t);return(await(0,r.executeOperation)(this.client,new n.AggregateOperation(this.namespace,this.pipeline,{...this.aggregateOptions,...this.cursorOptions,...i,explain:o??!0}))).shift(this.deserializationOptions)}addStage(t){if(this.throwIfInitialized(),null!=this.cursorOptions.timeoutMS&&this.cursorOptions.timeoutMode===i.CursorTimeoutMode.ITERATION&&(null!=t.$out||null!=t.$merge))throw new e.MongoAPIError("Cannot use $out or $merge stage with ITERATION timeoutMode");return this.pipeline.push(t),this}group(e){return this.addStage({$group:e})}limit(e){return this.addStage({$limit:e})}match(e){return this.addStage({$match:e})}out(e){return this.addStage({$out:e})}project(e){return this.addStage({$project:e})}lookup(e){return this.addStage({$lookup:e})}redact(e){return this.addStage({$redact:e})}skip(e){return this.addStage({$skip:e})}sort(e){return this.addStage({$sort:e})}unwind(e){return this.addStage({$unwind:e})}geoNear(e){return this.addStage({$geoNear:e})}}return Ge.AggregationCursor=s,Ge}var Qe,Je={},Xe={};function Ze(){if(Qe)return Xe;Qe=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.CountOperation=void 0;const e=Zu(),t=De();class n extends e.CommandOperation{constructor(e,t,n){super({s:{namespace:e}},n),this.options=n,this.collectionName=e.collection,this.query=t}get commandName(){return"count"}async execute(e,t,n){const r=this.options,o={count:this.collectionName,query:this.query};"number"==typeof r.limit&&(o.limit=r.limit),"number"==typeof r.skip&&(o.skip=r.skip),null!=r.hint&&(o.hint=r.hint),"number"==typeof r.maxTimeMS&&(o.maxTimeMS=r.maxTimeMS);const i=await super.executeCommand(e,t,o,n);return i?i.n:0}}return Xe.CountOperation=n,(0,t.defineAspects)(n,[t.Aspect.READ_OPERATION,t.Aspect.RETRYABLE]),Xe}var et,tt,nt,rt={},ot={};function it(){if(et)return ot;et=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.formatSort=function(n,r){if(null==n)return;if("string"==typeof n)return new Map([[n,t(r)]]);if("object"!=typeof n)throw new e.MongoInvalidArgumentError(`Invalid sort format: ${JSON.stringify(n)} Sort must be a valid object`);if(!Array.isArray(n))return(o=n)instanceof Map&&o.size>0?function(e){const n=Array.from(e).map((([e,n])=>[`${e}`,t(n)]));return new Map(n)}(n):Object.keys(n).length?function(e){const n=Object.entries(e).map((([e,n])=>[`${e}`,t(n)]));return new Map(n)}(n):void 0;var o;return n.length?function(e){return Array.isArray(e)&&Array.isArray(e[0])}(n)?function(e){const n=e.map((([e,n])=>[`${e}`,t(n)]));return new Map(n)}(n):function(e){if(Array.isArray(e)&&2===e.length)try{return t(e[1]),!0}catch{return!1}return!1}(n)?function(e){return new Map([[`${e[0]}`,t([e[1]])]])}(n):function(e){const t=e.map((e=>[`${e}`,1]));return new Map(t)}(n):void 0};const e=P();function t(t=1){const n=`${t}`.toLowerCase();if("object"==typeof(r=t)&&null!=r&&"$meta"in r&&"string"==typeof r.$meta)return t;var r;switch(n){case"ascending":case"asc":case"1":return 1;case"descending":case"desc":case"-1":return-1;default:throw new e.MongoInvalidArgumentError(`Invalid sort direction: ${JSON.stringify(t)}`)}}return ot}function st(){if(tt)return rt;tt=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.FindOperation=void 0;const e=pe(),t=P(),n=Xu(),r=Q(),o=it(),i=fe(),s=Zu(),u=De();class a extends s.CommandOperation{constructor(e,n={},r={}){if(super(void 0,r),this.options={...r},delete this.options.writeConcern,this.ns=e,"object"!=typeof n||Array.isArray(n))throw new t.MongoInvalidArgumentError("Query filter must be a plain object or ObjectId");this.filter=null!=n&&"ObjectId"===n._bsontype?{_id:n}:n}get commandName(){return"find"}async execute(t,s,u){this.server=t;const a=this.options;let c=function(e,t,n){const s={find:e.collection,filter:t};n.sort&&(s.sort=(0,o.formatSort)(n.sort));if(n.projection){let e=n.projection;e&&Array.isArray(e)&&(e=e.length?e.reduce(((e,t)=>(e[t]=1,e)),{}):{_id:1}),s.projection=e}n.hint&&(s.hint=(0,i.normalizeHintField)(n.hint));"number"==typeof n.skip&&(s.skip=n.skip);"number"==typeof n.limit&&(n.limit<0?(s.limit=-n.limit,s.singleBatch=!0):s.limit=n.limit);"number"==typeof n.batchSize&&(n.batchSize<0?(n.limit&&0!==n.limit&&Math.abs(n.batchSize)<Math.abs(n.limit)&&(s.limit=-n.batchSize),s.singleBatch=!0):s.batchSize=n.batchSize);"boolean"==typeof n.singleBatch&&(s.singleBatch=n.singleBatch);void 0!==n.comment&&(s.comment=n.comment);"number"==typeof n.maxTimeMS&&(s.maxTimeMS=n.maxTimeMS);const u=r.ReadConcern.fromOptions(n);u&&(s.readConcern=u.toJSON());n.max&&(s.max=n.max);n.min&&(s.min=n.min);"boolean"==typeof n.returnKey&&(s.returnKey=n.returnKey);"boolean"==typeof n.showRecordId&&(s.showRecordId=n.showRecordId);"boolean"==typeof n.tailable&&(s.tailable=n.tailable);"boolean"==typeof n.oplogReplay&&(s.oplogReplay=n.oplogReplay);"boolean"==typeof n.timeout?s.noCursorTimeout=!n.timeout:"boolean"==typeof n.noCursorTimeout&&(s.noCursorTimeout=n.noCursorTimeout);"boolean"==typeof n.awaitData&&(s.awaitData=n.awaitData);"boolean"==typeof n.allowPartialResults&&(s.allowPartialResults=n.allowPartialResults);n.collation&&(s.collation=n.collation);"boolean"==typeof n.allowDiskUse&&(s.allowDiskUse=n.allowDiskUse);n.let&&(s.let=n.let);return s}(this.ns,this.filter,a);return this.explain&&((0,n.validateExplainTimeoutOptions)(this.options,this.explain),c=(0,n.decorateWithExplain)(c,this.explain)),await t.command(this.ns,c,{...this.options,...this.bsonOptions,documentsReturnedIn:"firstBatch",session:s,timeoutContext:u},this.explain?e.ExplainedCursorResponse:e.CursorResponse)}}return rt.FindOperation=a,(0,u.defineAspects)(a,[u.Aspect.READ_OPERATION,u.Aspect.RETRYABLE,u.Aspect.EXPLAINABLE,u.Aspect.CURSOR_CREATING]),rt}function ut(){if(nt)return Je;nt=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.FindCursor=Je.FLAGS=void 0;const e=pe(),t=P(),n=Xu(),r=Ze(),o=Me(),i=st(),s=it(),u=fe();Je.FLAGS=["tailable","oplogReplay","noCursorTimeout","awaitData","exhaust","partial"];class a extends n.ExplainableCursor{constructor(e,t,n={},r={}){super(e,t,r),this.numReturned=0,this.cursorFilter=n,this.findOptions=r,null!=r.sort&&(this.findOptions.sort=(0,s.formatSort)(r.sort))}clone(){const e=(0,u.mergeOptions)({},this.findOptions);return delete e.session,new a(this.client,this.namespace,this.cursorFilter,{...e})}map(e){return super.map(e)}async _initialize(e){const r={...this.findOptions,...this.cursorOptions,session:e,signal:this.signal};if(r.explain)try{(0,n.validateExplainTimeoutOptions)(r,n.Explain.fromOptions(r))}catch{throw new t.MongoAPIError("timeoutMS cannot be used with explain when explain is specified in findOptions")}const s=new i.FindOperation(this.namespace,this.cursorFilter,r),u=await(0,o.executeOperation)(this.client,s,this.timeoutContext);return this.numReturned=u.batchSize,{server:s.server,session:e,response:u}}async getMore(t){const n=this.numReturned;if(n){const r=this.findOptions.limit;if((t=r&&r>0&&n+t>r?r-n:t)<=0){try{await this.close()}catch(e){(0,u.squashError)(e)}return e.CursorResponse.emptyGetMore}}const r=await super.getMore(t);return this.numReturned=this.numReturned+r.batchSize,r}async count(e){if((0,u.emitWarningOnce)("cursor.count is deprecated and will be removed in the next major version, please use `collection.estimatedDocumentCount` or `collection.countDocuments` instead "),"boolean"==typeof e)throw new t.MongoInvalidArgumentError("Invalid first parameter to count");return await(0,o.executeOperation)(this.client,new r.CountOperation(this.namespace,this.cursorFilter,{...this.findOptions,...this.cursorOptions,...e}))}async explain(e,t){const{explain:n,timeout:r}=this.resolveExplainTimeoutOptions(e,t);return(await(0,o.executeOperation)(this.client,new i.FindOperation(this.namespace,this.cursorFilter,{...this.findOptions,...this.cursorOptions,...r,explain:n??!0}))).shift(this.deserializationOptions)}filter(e){return this.throwIfInitialized(),this.cursorFilter=e,this}hint(e){return this.throwIfInitialized(),this.findOptions.hint=e,this}min(e){return this.throwIfInitialized(),this.findOptions.min=e,this}max(e){return this.throwIfInitialized(),this.findOptions.max=e,this}returnKey(e){return this.throwIfInitialized(),this.findOptions.returnKey=e,this}showRecordId(e){return this.throwIfInitialized(),this.findOptions.showRecordId=e,this}addQueryModifier(e,n){if(this.throwIfInitialized(),"$"!==e[0])throw new t.MongoInvalidArgumentError(`${e} is not a valid query modifier`);switch(e.substr(1)){case"comment":this.findOptions.comment=n;break;case"explain":this.findOptions.explain=n;break;case"hint":this.findOptions.hint=n;break;case"max":this.findOptions.max=n;break;case"maxTimeMS":this.findOptions.maxTimeMS=n;break;case"min":this.findOptions.min=n;break;case"orderby":this.findOptions.sort=(0,s.formatSort)(n);break;case"query":this.cursorFilter=n;break;case"returnKey":this.findOptions.returnKey=n;break;case"showDiskLoc":this.findOptions.showRecordId=n;break;default:throw new t.MongoInvalidArgumentError(`Invalid query modifier: ${e}`)}return this}comment(e){return this.throwIfInitialized(),this.findOptions.comment=e,this}maxAwaitTimeMS(e){if(this.throwIfInitialized(),"number"!=typeof e)throw new t.MongoInvalidArgumentError("Argument for maxAwaitTimeMS must be a number");return this.findOptions.maxAwaitTimeMS=e,this}maxTimeMS(e){if(this.throwIfInitialized(),"number"!=typeof e)throw new t.MongoInvalidArgumentError("Argument for maxTimeMS must be a number");return this.findOptions.maxTimeMS=e,this}project(e){return this.throwIfInitialized(),this.findOptions.projection=e,this}sort(e,n){if(this.throwIfInitialized(),this.findOptions.tailable)throw new t.MongoTailableCursorError("Tailable cursor does not support sorting");return this.findOptions.sort=(0,s.formatSort)(e,n),this}allowDiskUse(e=!0){if(this.throwIfInitialized(),!this.findOptions.sort)throw new t.MongoInvalidArgumentError('Option "allowDiskUse" requires a sort specification');return e?(this.findOptions.allowDiskUse=!0,this):(this.findOptions.allowDiskUse=!1,this)}collation(e){return this.throwIfInitialized(),this.findOptions.collation=e,this}limit(e){if(this.throwIfInitialized(),this.findOptions.tailable)throw new t.MongoTailableCursorError("Tailable cursor does not support limit");if("number"!=typeof e)throw new t.MongoInvalidArgumentError('Operation "limit" requires an integer');return this.findOptions.limit=e,this}skip(e){if(this.throwIfInitialized(),this.findOptions.tailable)throw new t.MongoTailableCursorError("Tailable cursor does not support skip");if("number"!=typeof e)throw new t.MongoInvalidArgumentError('Operation "skip" requires an integer');return this.findOptions.skip=e,this}}return Je.FindCursor=a,Je}var at,ct,lt={},ht={};function pt(){if(at)return ht;at=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.ListIndexesOperation=ht.DropIndexOperation=ht.CreateIndexesOperation=void 0;const e=pe(),t=P(),n=fe(),r=Zu(),o=De(),i=new Set(["background","unique","name","partialFilterExpression","sparse","hidden","expireAfterSeconds","storageEngine","collation","version","weights","default_language","language_override","textIndexVersion","2dsphereIndexVersion","bits","min","max","bucketSize","wildcardProjection"]);function s(e){const t=new Map,r=Array.isArray(e)&&(o=e,!Array.isArray(o)||2!==o.length||"number"!=typeof(i=o[1])&&"2d"!==i&&"2dsphere"!==i&&"text"!==i&&"geoHaystack"!==i)?e:[e];var o,i;for(const e of r)if("string"==typeof e)t.set(e,1);else if(Array.isArray(e))t.set(e[0],e[1]??1);else if(e instanceof Map)for(const[n,r]of e)t.set(n,r);else if((0,n.isObject)(e))for(const[n,r]of Object.entries(e))t.set(n,r);return t}class u extends r.CommandOperation{constructor(e,t,n,r){super(e,r),this.options=r??{},this.collectionName=t,this.indexes=n.map((e=>{const t=e.key instanceof Map?e.key:new Map(Object.entries(e.key)),n=e.name??Array.from(t).flat().join("_"),r=function(e){const t=Object.entries(e).filter((([e])=>i.has(e)));return Object.fromEntries(t.map((([e,t])=>"version"===e?["v",t]:[e,t])))}(e);return{...r,name:n,key:t}}))}static fromIndexDescriptionArray(e,t,n,r){return new u(e,t,n,r)}static fromIndexSpecification(e,t,n,r={}){const o=s(n),i={...r,key:o};return new u(e,t,[i],r)}get commandName(){return"createIndexes"}async execute(e,r,o){const i=this.options,s=this.indexes,u=(0,n.maxWireVersion)(e),a={createIndexes:this.collectionName,indexes:s};if(null!=i.commitQuorum){if(u<9)throw new t.MongoCompatibilityError("Option `commitQuorum` for `createIndexes` not supported on servers < 4.4");a.commitQuorum=i.commitQuorum}this.options.collation=void 0,await super.executeCommand(e,r,a,o);return s.map((e=>e.name||""))}}ht.CreateIndexesOperation=u;class a extends r.CommandOperation{constructor(e,t,n){super(e,n),this.options=n??{},this.collection=e,this.indexName=t}get commandName(){return"dropIndexes"}async execute(e,t,n){const r={dropIndexes:this.collection.collectionName,index:this.indexName};return await super.executeCommand(e,t,r,n)}}ht.DropIndexOperation=a;class c extends r.CommandOperation{constructor(e,t){super(e,t),this.options={...t},delete this.options.writeConcern,this.collectionNamespace=e.s.namespace}get commandName(){return"listIndexes"}async execute(t,r,o){const i=(0,n.maxWireVersion)(t),s=this.options.batchSize?{batchSize:this.options.batchSize}:{},u={listIndexes:this.collectionNamespace.collection,cursor:s};return i>=9&&void 0!==this.options.comment&&(u.comment=this.options.comment),await super.executeCommand(t,r,u,o,e.CursorResponse)}}return ht.ListIndexesOperation=c,(0,o.defineAspects)(c,[o.Aspect.READ_OPERATION,o.Aspect.RETRYABLE,o.Aspect.CURSOR_CREATING]),(0,o.defineAspects)(u,[o.Aspect.WRITE_OPERATION]),(0,o.defineAspects)(a,[o.Aspect.WRITE_OPERATION]),ht}function dt(){if(ct)return lt;ct=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.ListIndexesCursor=void 0;const e=Me(),t=pt(),n=Ju();class r extends n.AbstractCursor{constructor(e,t){super(e.client,e.s.namespace,t),this.parent=e,this.options=t}clone(){return new r(this.parent,{...this.options,...this.cursorOptions})}async _initialize(n){const r=new t.ListIndexesOperation(this.parent,{...this.cursorOptions,...this.options,session:n}),o=await(0,e.executeOperation)(this.parent.client,r,this.timeoutContext);return{server:r.server,session:n,response:o}}}return lt.ListIndexesCursor=r,lt}var ft,mt={};var yt,gt={};function Et(){if(yt)return gt;yt=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.BulkWriteOperation=void 0;const e=De();class t extends e.AbstractOperation{constructor(e,t,n){super(n),this.options=n,this.collection=e,this.operations=t}get commandName(){return"bulkWrite"}async execute(e,t,n){const r=this.collection,o=this.operations,i={...this.options,...this.bsonOptions,readPreference:this.readPreference,timeoutContext:n},s=!1===i.ordered?r.initializeUnorderedBulkOp(i):r.initializeOrderedBulkOp(i);for(let e=0;e<o.length;e++)s.raw(o[e]);return await s.execute({...i,session:t})}}return gt.BulkWriteOperation=t,(0,e.defineAspects)(t,[e.Aspect.WRITE_OPERATION]),gt}var At,bt={};var _t,Ot={};function Ct(){if(_t)return Ot;_t=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.DropDatabaseOperation=Ot.DropCollectionOperation=void 0;const e=P(),t=Zu(),n=De();class r extends t.CommandOperation{constructor(e,t,n={}){super(e,n),this.db=e,this.options=n,this.name=t}get commandName(){return"drop"}async execute(t,n,o){const i=this.db,s=this.options,u=this.name,a=i.client.s.options.autoEncryption?.encryptedFieldsMap;let c=s.encryptedFields??a?.[`${i.databaseName}.${u}`];if(!c&&a){const e=await i.listCollections({name:u},{nameOnly:!1}).toArray();c=e?.[0]?.options?.encryptedFields}if(c){const s=c.escCollection||`enxcol_.${u}.esc`,a=c.ecocCollection||`enxcol_.${u}.ecoc`;for(const u of[s,a]){const s=new r(i,u);try{await s.executeWithoutEncryptedFieldsCheck(t,n,o)}catch(t){if(!(t instanceof e.MongoServerError)||t.code!==e.MONGODB_ERROR_CODES.NamespaceNotFound)throw t}}}return await this.executeWithoutEncryptedFieldsCheck(t,n,o)}async executeWithoutEncryptedFieldsCheck(e,t,n){return await super.executeCommand(e,t,{drop:this.name},n),!0}}Ot.DropCollectionOperation=r;class o extends t.CommandOperation{constructor(e,t){super(e,t),this.options=t}get commandName(){return"dropDatabase"}async execute(e,t,n){return await super.executeCommand(e,t,{dropDatabase:1},n),!0}}return Ot.DropDatabaseOperation=o,(0,n.defineAspects)(r,[n.Aspect.WRITE_OPERATION]),(0,n.defineAspects)(o,[n.Aspect.WRITE_OPERATION]),Ot}var wt,St={};var vt,Dt={};function Mt(){return vt||(vt=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FindOneAndUpdateOperation=e.FindOneAndReplaceOperation=e.FindOneAndDeleteOperation=e.FindAndModifyOperation=e.ReturnDocument=void 0;const t=P(),n=Z(),r=it(),o=fe(),i=Zu(),s=De();function u(t,n){return t.new=n.returnDocument===e.ReturnDocument.AFTER,t.upsert=!0===n.upsert,!0===n.bypassDocumentValidation&&(t.bypassDocumentValidation=n.bypassDocumentValidation),t}e.ReturnDocument=Object.freeze({BEFORE:"before",AFTER:"after"});class a extends i.CommandOperation{constructor(e,t,o){super(e,o),this.options=o??{},this.cmdBase={remove:!1,new:!1,upsert:!1},o.includeResultMetadata??=!1;const i=(0,r.formatSort)(o.sort);i&&(this.cmdBase.sort=i),o.projection&&(this.cmdBase.fields=o.projection),o.maxTimeMS&&(this.cmdBase.maxTimeMS=o.maxTimeMS),o.writeConcern&&(this.cmdBase.writeConcern=o.writeConcern),o.let&&(this.cmdBase.let=o.let),void 0!==o.comment&&(this.cmdBase.comment=o.comment),this.readPreference=n.ReadPreference.primary,this.collection=e,this.query=t}get commandName(){return"findAndModify"}async execute(e,n,r){const i=this.collection,s=this.query,u={...this.options,...this.bsonOptions},a={findAndModify:i.collectionName,query:s,...this.cmdBase};if((0,o.decorateWithCollation)(a,i,u),u.hint){if(0===this.writeConcern?.w||(0,o.maxWireVersion)(e)<8)throw new t.MongoCompatibilityError("The current topology does not support a hint on findAndModify commands");a.hint=u.hint}const c=await super.executeCommand(e,n,a,r);return u.includeResultMetadata?c:c.value??null}}e.FindAndModifyOperation=a;e.FindOneAndDeleteOperation=class extends a{constructor(e,n,r){if(null==n||"object"!=typeof n)throw new t.MongoInvalidArgumentError('Argument "filter" must be an object');super(e,n,r),this.cmdBase.remove=!0}};e.FindOneAndReplaceOperation=class extends a{constructor(e,n,r,i){if(null==n||"object"!=typeof n)throw new t.MongoInvalidArgumentError('Argument "filter" must be an object');if(null==r||"object"!=typeof r)throw new t.MongoInvalidArgumentError('Argument "replacement" must be an object');if((0,o.hasAtomicOperators)(r))throw new t.MongoInvalidArgumentError("Replacement document must not contain atomic operators");super(e,n,i),this.cmdBase.update=r,u(this.cmdBase,i)}};e.FindOneAndUpdateOperation=class extends a{constructor(e,n,r,i){if(null==n||"object"!=typeof n)throw new t.MongoInvalidArgumentError('Argument "filter" must be an object');if(null==r||"object"!=typeof r)throw new t.MongoInvalidArgumentError('Argument "update" must be an object');if(!(0,o.hasAtomicOperators)(r))throw new t.MongoInvalidArgumentError("Update document requires atomic operators");super(e,n,i),this.cmdBase.update=r,u(this.cmdBase,i),i.arrayFilters&&(this.cmdBase.arrayFilters=i.arrayFilters)}},(0,s.defineAspects)(a,[s.Aspect.WRITE_OPERATION,s.Aspect.RETRYABLE,s.Aspect.EXPLAINABLE])}(Dt)),Dt}var Tt,Bt={};function Ft(){if(Tt)return Bt;Tt=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.InsertManyOperation=Bt.InsertOneOperation=Bt.InsertOperation=void 0;const e=P(),t=fe(),n=de(),r=Et(),o=Zu(),i=De();class s extends o.CommandOperation{constructor(e,t,n){super(void 0,n),this.options={...n,checkKeys:n.checkKeys??!1},this.ns=e,this.documents=t}get commandName(){return"insert"}async execute(e,t,n){const r=this.options??{},o="boolean"!=typeof r.ordered||r.ordered,i={insert:this.ns.collection,documents:this.documents,ordered:o};return"boolean"==typeof r.bypassDocumentValidation&&(i.bypassDocumentValidation=r.bypassDocumentValidation),void 0!==r.comment&&(i.comment=r.comment),await super.executeCommand(e,t,i,n)}}Bt.InsertOperation=s;class u extends s{constructor(e,n,r){super(e.s.namespace,(0,t.maybeAddIdToDocuments)(e,[n],r),r)}async execute(t,n,r){const o=await super.execute(t,n,r);if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,insertedId:this.documents[0]._id}}}Bt.InsertOneOperation=u;class a extends i.AbstractOperation{constructor(t,n,r){if(super(r),!Array.isArray(n))throw new e.MongoInvalidArgumentError('Argument "docs" must be an array of documents');this.options=r,this.collection=t,this.docs=n}get commandName(){return"insert"}async execute(t,o,i){const s=this.collection,u={...this.options,...this.bsonOptions,readPreference:this.readPreference},a=n.WriteConcern.fromOptions(u),c=new r.BulkWriteOperation(s,this.docs.map((e=>({insertOne:{document:e}}))),u);try{const e=await c.execute(t,o,i);return{acknowledged:0!==a?.w,insertedCount:e.insertedCount,insertedIds:e.insertedIds}}catch(t){if(t&&"Operation must be an object with an operation key"===t.message)throw new e.MongoInvalidArgumentError("Collection.insertMany() cannot be called with an array that has null/undefined values");throw t}}}return Bt.InsertManyOperation=a,(0,i.defineAspects)(s,[i.Aspect.RETRYABLE,i.Aspect.WRITE_OPERATION]),(0,i.defineAspects)(u,[i.Aspect.RETRYABLE,i.Aspect.WRITE_OPERATION]),(0,i.defineAspects)(a,[i.Aspect.WRITE_OPERATION]),Bt}var $t,xt={};var Pt,Nt={};var It,Rt={};function kt(){if(It)return Rt;It=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.RenameOperation=void 0;const e=Yt(),t=fe(),n=Zu(),r=De();class o extends n.CommandOperation{constructor(e,n,r){super(e,r),this.collection=e,this.newName=n,this.options=r,this.ns=new t.MongoDBNamespace("admin","$cmd")}get commandName(){return"renameCollection"}async execute(t,n,r){const o={renameCollection:this.collection.namespace,to:this.collection.s.namespace.withCollection(this.newName).toString(),dropTarget:"boolean"==typeof this.options.dropTarget&&this.options.dropTarget};return await super.executeCommand(t,n,o,r),new e.Collection(this.collection.s.db,this.newName,this.collection.s.options)}}return Rt.RenameOperation=o,(0,r.defineAspects)(o,[r.Aspect.WRITE_OPERATION]),Rt}var jt,Lt={};var Ut,Vt={};var zt,Wt={};var qt,Gt,Ht={};function Kt(){if(qt)return Ht;qt=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ReplaceOneOperation=Ht.UpdateManyOperation=Ht.UpdateOneOperation=Ht.UpdateOperation=void 0,Ht.makeUpdateStatement=a;const e=P(),t=fe(),n=Zu(),r=De();class o extends n.CommandOperation{constructor(e,t,n){super(void 0,n),this.options=n,this.ns=e,this.statements=t}get commandName(){return"update"}get canRetryWrite(){return!1!==super.canRetryWrite&&this.statements.every((e=>null==e.multi||!1===e.multi))}async execute(t,n,r){const o=this.options??{},i="boolean"!=typeof o.ordered||o.ordered,s={update:this.ns.collection,updates:this.statements,ordered:i};"boolean"==typeof o.bypassDocumentValidation&&(s.bypassDocumentValidation=o.bypassDocumentValidation),o.let&&(s.let=o.let),void 0!==o.comment&&(s.comment=o.comment);if(this.writeConcern&&0===this.writeConcern.w&&this.statements.find((e=>e.hint)))throw new e.MongoCompatibilityError("hint is not supported with unacknowledged writes");return await super.executeCommand(t,n,s,r)}}Ht.UpdateOperation=o;class i extends o{constructor(n,r,o,i){if(super(n.s.namespace,[a(r,o,{...i,multi:!1})],i),!(0,t.hasAtomicOperators)(o))throw new e.MongoInvalidArgumentError("Update document requires atomic operators")}async execute(t,n,r){const o=await super.execute(t,n,r);if(null!=this.explain)return o;if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,modifiedCount:o.nModified??o.n,upsertedId:Array.isArray(o.upserted)&&o.upserted.length>0?o.upserted[0]._id:null,upsertedCount:Array.isArray(o.upserted)&&o.upserted.length?o.upserted.length:0,matchedCount:Array.isArray(o.upserted)&&o.upserted.length>0?0:o.n}}}Ht.UpdateOneOperation=i;class s extends o{constructor(n,r,o,i){if(super(n.s.namespace,[a(r,o,{...i,multi:!0})],i),!(0,t.hasAtomicOperators)(o))throw new e.MongoInvalidArgumentError("Update document requires atomic operators")}async execute(t,n,r){const o=await super.execute(t,n,r);if(null!=this.explain)return o;if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,modifiedCount:o.nModified??o.n,upsertedId:Array.isArray(o.upserted)&&o.upserted.length>0?o.upserted[0]._id:null,upsertedCount:Array.isArray(o.upserted)&&o.upserted.length?o.upserted.length:0,matchedCount:Array.isArray(o.upserted)&&o.upserted.length>0?0:o.n}}}Ht.UpdateManyOperation=s;class u extends o{constructor(n,r,o,i){if(super(n.s.namespace,[a(r,o,{...i,multi:!1})],i),(0,t.hasAtomicOperators)(o))throw new e.MongoInvalidArgumentError("Replacement document must not contain atomic operators")}async execute(t,n,r){const o=await super.execute(t,n,r);if(null!=this.explain)return o;if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,modifiedCount:o.nModified??o.n,upsertedId:Array.isArray(o.upserted)&&o.upserted.length>0?o.upserted[0]._id:null,upsertedCount:Array.isArray(o.upserted)&&o.upserted.length?o.upserted.length:0,matchedCount:Array.isArray(o.upserted)&&o.upserted.length>0?0:o.n}}}function a(t,n,r){if(null==t||"object"!=typeof t)throw new e.MongoInvalidArgumentError("Selector must be a valid JavaScript object");if(null==n||"object"!=typeof n)throw new e.MongoInvalidArgumentError("Document must be a valid JavaScript object");const o={q:t,u:n};return"boolean"==typeof r.upsert&&(o.upsert=r.upsert),r.multi&&(o.multi=r.multi),r.hint&&(o.hint=r.hint),r.arrayFilters&&(o.arrayFilters=r.arrayFilters),r.collation&&(o.collation=r.collation),o}return Ht.ReplaceOneOperation=u,(0,r.defineAspects)(o,[r.Aspect.RETRYABLE,r.Aspect.WRITE_OPERATION,r.Aspect.SKIP_COLLATION]),(0,r.defineAspects)(i,[r.Aspect.RETRYABLE,r.Aspect.WRITE_OPERATION,r.Aspect.EXPLAINABLE,r.Aspect.SKIP_COLLATION]),(0,r.defineAspects)(s,[r.Aspect.WRITE_OPERATION,r.Aspect.EXPLAINABLE,r.Aspect.SKIP_COLLATION]),(0,r.defineAspects)(u,[r.Aspect.RETRYABLE,r.Aspect.WRITE_OPERATION,r.Aspect.SKIP_COLLATION]),Ht}function Yt(){if(Gt)return ke;Gt=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.Collection=void 0;const e=F(),t=Le(),n=ze(),r=Nn(),o=Ye(),i=ut(),s=dt(),u=function(){if(ft)return mt;ft=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.ListSearchIndexesCursor=void 0;const e=Ye();class t extends e.AggregationCursor{constructor({fullNamespace:e,client:t},n,r={}){super(t,e,null==n?[{$listSearchIndexes:{}}]:[{$listSearchIndexes:{name:n}}],r)}}return mt.ListSearchIndexesCursor=t,mt}(),a=P(),c=Et(),l=Ze(),h=ea(),p=function(){if(At)return bt;At=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.DistinctOperation=void 0;const e=fe(),t=Zu(),n=De();class r extends t.CommandOperation{constructor(e,t,n,r){super(e,r),this.options=r??{},this.collection=e,this.key=t,this.query=n}get commandName(){return"distinct"}async execute(t,n,r){const o=this.collection,i=this.key,s=this.query,u=this.options,a={distinct:o.collectionName,key:i,query:s};"number"==typeof u.maxTimeMS&&(a.maxTimeMS=u.maxTimeMS),void 0!==u.comment&&(a.comment=u.comment),(0,e.decorateWithReadConcern)(a,o,u),(0,e.decorateWithCollation)(a,o,u);const c=await super.executeCommand(t,n,a,r);return this.explain?c:c.values}}return bt.DistinctOperation=r,(0,n.defineAspects)(r,[n.Aspect.READ_OPERATION,n.Aspect.RETRYABLE,n.Aspect.EXPLAINABLE]),bt}(),d=Ct(),f=function(){if(wt)return St;wt=1,Object.defineProperty(St,"__esModule",{value:!0}),St.EstimatedDocumentCountOperation=void 0;const e=Zu(),t=De();class n extends e.CommandOperation{constructor(e,t={}){super(e,t),this.options=t,this.collectionName=e.collectionName}get commandName(){return"count"}async execute(e,t,n){const r={count:this.collectionName};"number"==typeof this.options.maxTimeMS&&(r.maxTimeMS=this.options.maxTimeMS),void 0!==this.options.comment&&(r.comment=this.options.comment);const o=await super.executeCommand(e,t,r,n);return o?.n||0}}return St.EstimatedDocumentCountOperation=n,(0,t.defineAspects)(n,[t.Aspect.READ_OPERATION,t.Aspect.RETRYABLE,t.Aspect.CURSOR_CREATING]),St}(),m=Me(),y=Mt(),g=pt(),E=Ft(),A=function(){if($t)return xt;$t=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.IsCappedOperation=void 0;const e=P(),t=De();class n extends t.AbstractOperation{constructor(e,t){super(t),this.options=t,this.collection=e}get commandName(){return"listCollections"}async execute(t,n){const r=this.collection,[o]=await r.s.db.listCollections({name:r.collectionName},{...this.options,nameOnly:!1,readPreference:this.readPreference,session:n}).toArray();if(null==o||null==o.options)throw new e.MongoAPIError(`collection ${r.namespace} not found`);return!!o.options?.capped}}return xt.IsCappedOperation=n,xt}(),b=function(){if(Pt)return Nt;Pt=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.OptionsOperation=void 0;const e=P(),t=De();class n extends t.AbstractOperation{constructor(e,t){super(t),this.options=t,this.collection=e}get commandName(){return"listCollections"}async execute(t,n){const r=this.collection,[o]=await r.s.db.listCollections({name:r.collectionName},{...this.options,nameOnly:!1,readPreference:this.readPreference,session:n}).toArray();if(null==o||null==o.options)throw new e.MongoAPIError(`collection ${r.namespace} not found`);return o.options}}return Nt.OptionsOperation=n,Nt}(),_=kt(),O=function(){if(jt)return Lt;jt=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.CreateSearchIndexesOperation=void 0;const e=De();class t extends e.AbstractOperation{constructor(e,t){super(),this.collection=e,this.descriptions=t}get commandName(){return"createSearchIndexes"}async execute(e,t,n){const r=this.collection.fullNamespace,o={createSearchIndexes:r.collection,indexes:this.descriptions},i=await e.command(r,o,{session:t,timeoutContext:n});return(i?.indexesCreated??[]).map((({name:e})=>e))}}return Lt.CreateSearchIndexesOperation=t,Lt}(),C=function(){if(Ut)return Vt;Ut=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.DropSearchIndexOperation=void 0;const e=P(),t=De();class n extends t.AbstractOperation{constructor(e,t){super(),this.collection=e,this.name=t}get commandName(){return"dropSearchIndex"}async execute(t,n,r){const o=this.collection.fullNamespace,i={dropSearchIndex:o.collection};"string"==typeof this.name&&(i.name=this.name);try{await t.command(o,i,{session:n,timeoutContext:r})}catch(t){if(!(t instanceof e.MongoServerError&&t.code===e.MONGODB_ERROR_CODES.NamespaceNotFound))throw t}}}return Vt.DropSearchIndexOperation=n,Vt}(),w=function(){if(zt)return Wt;zt=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.UpdateSearchIndexOperation=void 0;const e=De();class t extends e.AbstractOperation{constructor(e,t,n){super(),this.collection=e,this.name=t,this.definition=n}get commandName(){return"updateSearchIndex"}async execute(e,t,n){const r=this.collection.fullNamespace,o={updateSearchIndex:r.collection,name:this.name,definition:this.definition};await e.command(r,o,{session:t,timeoutContext:n})}}return Wt.UpdateSearchIndexOperation=t,Wt}(),S=Kt(),v=Q(),D=Z(),M=fe(),T=de();return ke.Collection=class{constructor(t,n,r){this.s={db:t,options:r,namespace:new M.MongoDBCollectionNamespace(t.databaseName,n),pkFactory:t.options?.pkFactory??M.DEFAULT_PK_FACTORY,readPreference:D.ReadPreference.fromOptions(r),bsonOptions:(0,e.resolveBSONOptions)(r,t),readConcern:v.ReadConcern.fromOptions(r),writeConcern:T.WriteConcern.fromOptions(r)},this.client=t.client}get dbName(){return this.s.namespace.db}get collectionName(){return this.s.namespace.collection}get namespace(){return this.fullNamespace.toString()}get fullNamespace(){return this.s.namespace}get readConcern(){return null==this.s.readConcern?this.s.db.readConcern:this.s.readConcern}get readPreference(){return null==this.s.readPreference?this.s.db.readPreference:this.s.readPreference}get bsonOptions(){return this.s.bsonOptions}get writeConcern(){return null==this.s.writeConcern?this.s.db.writeConcern:this.s.writeConcern}get hint(){return this.s.collectionHint}set hint(e){this.s.collectionHint=(0,M.normalizeHintField)(e)}get timeoutMS(){return this.s.options.timeoutMS}async insertOne(e,t){return await(0,m.executeOperation)(this.client,new E.InsertOneOperation(this,e,(0,M.resolveOptions)(this,t)))}async insertMany(e,t){return await(0,m.executeOperation)(this.client,new E.InsertManyOperation(this,e,(0,M.resolveOptions)(this,t??{ordered:!0})))}async bulkWrite(e,t){if(!Array.isArray(e))throw new a.MongoInvalidArgumentError('Argument "operations" must be an array of documents');return await(0,m.executeOperation)(this.client,new c.BulkWriteOperation(this,e,(0,M.resolveOptions)(this,t??{ordered:!0})))}async updateOne(e,t,n){return await(0,m.executeOperation)(this.client,new S.UpdateOneOperation(this,e,t,(0,M.resolveOptions)(this,n)))}async replaceOne(e,t,n){return await(0,m.executeOperation)(this.client,new S.ReplaceOneOperation(this,e,t,(0,M.resolveOptions)(this,n)))}async updateMany(e,t,n){return await(0,m.executeOperation)(this.client,new S.UpdateManyOperation(this,e,t,(0,M.resolveOptions)(this,n)))}async deleteOne(e={},t={}){return await(0,m.executeOperation)(this.client,new h.DeleteOneOperation(this,e,(0,M.resolveOptions)(this,t)))}async deleteMany(e={},t={}){return await(0,m.executeOperation)(this.client,new h.DeleteManyOperation(this,e,(0,M.resolveOptions)(this,t)))}async rename(e,t){return await(0,m.executeOperation)(this.client,new _.RenameOperation(this,e,(0,M.resolveOptions)(void 0,{...t,readPreference:D.ReadPreference.PRIMARY})))}async drop(e){return await(0,m.executeOperation)(this.client,new d.DropCollectionOperation(this.s.db,this.collectionName,e))}async findOne(e={},t={}){const n=this.find(e,t).limit(-1).batchSize(1),r=await n.next();return await n.close(),r}find(e={},t={}){return new i.FindCursor(this.client,this.s.namespace,e,(0,M.resolveOptions)(this,t))}async options(e){return await(0,m.executeOperation)(this.client,new b.OptionsOperation(this,(0,M.resolveOptions)(this,e)))}async isCapped(e){return await(0,m.executeOperation)(this.client,new A.IsCappedOperation(this,(0,M.resolveOptions)(this,e)))}async createIndex(e,t){return(await(0,m.executeOperation)(this.client,g.CreateIndexesOperation.fromIndexSpecification(this,this.collectionName,e,(0,M.resolveOptions)(this,t))))[0]}async createIndexes(e,t){return await(0,m.executeOperation)(this.client,g.CreateIndexesOperation.fromIndexDescriptionArray(this,this.collectionName,e,(0,M.resolveOptions)(this,{...t,maxTimeMS:void 0})))}async dropIndex(e,t){return await(0,m.executeOperation)(this.client,new g.DropIndexOperation(this,e,{...(0,M.resolveOptions)(this,t),readPreference:D.ReadPreference.primary}))}async dropIndexes(e){try{return await(0,m.executeOperation)(this.client,new g.DropIndexOperation(this,"*",(0,M.resolveOptions)(this,e))),!0}catch(e){if(e instanceof a.MongoOperationTimeoutError)throw e;return!1}}listIndexes(e){return new s.ListIndexesCursor(this,(0,M.resolveOptions)(this,e))}async indexExists(e,t){const n=Array.isArray(e)?e:[e],r=new Set(await this.listIndexes(t).map((({name:e})=>e)).toArray());return n.every((e=>r.has(e)))}async indexInformation(e){return await this.indexes({...e,full:e?.full??!1})}async estimatedDocumentCount(e){return await(0,m.executeOperation)(this.client,new f.EstimatedDocumentCountOperation(this,(0,M.resolveOptions)(this,e)))}async countDocuments(e={},t={}){const n=[];n.push({$match:e}),"number"==typeof t.skip&&n.push({$skip:t.skip}),"number"==typeof t.limit&&n.push({$limit:t.limit}),n.push({$group:{_id:1,n:{$sum:1}}});const r=this.aggregate(n,t),o=await r.next();return await r.close(),o?.n??0}async distinct(e,t={},n={}){return await(0,m.executeOperation)(this.client,new p.DistinctOperation(this,e,t,(0,M.resolveOptions)(this,n)))}async indexes(e){const t=await this.listIndexes(e).toArray();if(e?.full??!0)return t;const n=Object.fromEntries(t.map((({name:e,key:t})=>[e,Object.entries(t)])));return n}async findOneAndDelete(e,t){return await(0,m.executeOperation)(this.client,new y.FindOneAndDeleteOperation(this,e,(0,M.resolveOptions)(this,t)))}async findOneAndReplace(e,t,n){return await(0,m.executeOperation)(this.client,new y.FindOneAndReplaceOperation(this,e,t,(0,M.resolveOptions)(this,n)))}async findOneAndUpdate(e,t,n){return await(0,m.executeOperation)(this.client,new y.FindOneAndUpdateOperation(this,e,t,(0,M.resolveOptions)(this,n)))}aggregate(e=[],t){if(!Array.isArray(e))throw new a.MongoInvalidArgumentError('Argument "pipeline" must be an array of aggregation stages');return new o.AggregationCursor(this.client,this.s.namespace,e,(0,M.resolveOptions)(this,t))}watch(e=[],t={}){return Array.isArray(e)||(t=e,e=[]),new r.ChangeStream(this,e,(0,M.resolveOptions)(this,t))}initializeUnorderedBulkOp(e){return new n.UnorderedBulkOperation(this,(0,M.resolveOptions)(this,e))}initializeOrderedBulkOp(e){return new t.OrderedBulkOperation(this,(0,M.resolveOptions)(this,e))}async count(e={},t={}){return await(0,m.executeOperation)(this.client,new l.CountOperation(this.fullNamespace,e,(0,M.resolveOptions)(this,t)))}listSearchIndexes(e,t){t="object"==typeof e?e:null==t?{}:t;const n=null==e||"object"==typeof e?null:e;return new u.ListSearchIndexesCursor(this,n,t)}async createSearchIndex(e){const[t]=await this.createSearchIndexes([e]);return t}async createSearchIndexes(e){return await(0,m.executeOperation)(this.client,new O.CreateSearchIndexesOperation(this,e))}async dropSearchIndex(e){return await(0,m.executeOperation)(this.client,new C.DropSearchIndexOperation(this,e))}async updateSearchIndex(e,t){return await(0,m.executeOperation)(this.client,new w.UpdateSearchIndexOperation(this,e,t))}},ke}var Qt,Jt={};function Xt(){if(Qt)return Jt;Qt=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ChangeStreamCursor=void 0;const e=Nn(),t=z(),n=Ke(),r=Me(),o=fe(),i=Ju();class s extends i.AbstractCursor{constructor(e,t,n=[],r={}){super(e,t,{...r,tailable:!0,awaitData:!0}),this.pipeline=n,this.changeStreamCursorOptions=r,this._resumeToken=null,this.startAtOperationTime=r.startAtOperationTime??null,r.startAfter?this.resumeToken=r.startAfter:r.resumeAfter&&(this.resumeToken=r.resumeAfter)}set resumeToken(t){this._resumeToken=t,this.emit(e.ChangeStream.RESUME_TOKEN_CHANGED,t)}get resumeToken(){return this._resumeToken}get resumeOptions(){const e={...this.changeStreamCursorOptions};for(const t of["resumeAfter","startAfter","startAtOperationTime"])delete e[t];return null!=this.resumeToken?this.changeStreamCursorOptions.startAfter&&!this.hasReceived?e.startAfter=this.resumeToken:e.resumeAfter=this.resumeToken:null!=this.startAtOperationTime&&(0,o.maxWireVersion)(this.server)>=7&&(e.startAtOperationTime=this.startAtOperationTime),e}cacheResumeToken(e){0===this.bufferedCount()&&this.postBatchResumeToken?this.resumeToken=this.postBatchResumeToken:this.resumeToken=e,this.hasReceived=!0}_processBatch(e){const{postBatchResumeToken:t}=e;t&&(this.postBatchResumeToken=t,0===e.batchSize&&(this.resumeToken=t))}clone(){return new s(this.client,this.namespace,this.pipeline,{...this.cursorOptions})}async _initialize(e){const i=new n.AggregateOperation(this.namespace,this.pipeline,{...this.cursorOptions,...this.changeStreamCursorOptions,session:e}),s=await(0,r.executeOperation)(e.client,i,this.timeoutContext),u=i.server;return this.maxWireVersion=(0,o.maxWireVersion)(u),null==this.startAtOperationTime&&null==this.changeStreamCursorOptions.resumeAfter&&null==this.changeStreamCursorOptions.startAfter&&this.maxWireVersion>=7&&(this.startAtOperationTime=s.operationTime),this._processBatch(s),this.emit(t.INIT,s),this.emit(t.RESPONSE),{server:u,session:e,response:s}}async getMore(t){const n=await super.getMore(t);return this.maxWireVersion=(0,o.maxWireVersion)(this.server),this._processBatch(n),this.emit(e.ChangeStream.MORE,n),this.emit(e.ChangeStream.RESPONSE),n}}return Jt.ChangeStreamCursor=s,Jt}var Zt,en={},tn={},nn={};var rn,on={};function sn(){if(rn)return on;rn=1,Object.defineProperty(on,"__esModule",{value:!0}),on.RemoveUserOperation=void 0;const e=Zu(),t=De();class n extends e.CommandOperation{constructor(e,t,n){super(e,n),this.options=n,this.username=t}get commandName(){return"dropUser"}async execute(e,t,n){return await super.executeCommand(e,t,{dropUser:this.username},n),!0}}return on.RemoveUserOperation=n,(0,t.defineAspects)(n,[t.Aspect.WRITE_OPERATION]),on}var un,an={};function cn(){if(un)return an;un=1,Object.defineProperty(an,"__esModule",{value:!0}),an.RunAdminCommandOperation=an.RunCommandOperation=void 0;const e=fe(),t=De();class n extends t.AbstractOperation{constructor(e,t,n){super(n),this.command=t,this.options=n,this.ns=e.s.namespace.withCollection("$cmd")}get commandName(){return"runCommand"}async execute(e,t,n){this.server=e;return await e.command(this.ns,this.command,{...this.options,readPreference:this.readPreference,session:t,timeoutContext:n},this.options.responseType)}}an.RunCommandOperation=n;class r extends t.AbstractOperation{constructor(t,n){super(n),this.command=t,this.options=n,this.ns=new e.MongoDBNamespace("admin","$cmd")}get commandName(){return"runCommand"}async execute(e,t,n){this.server=e;return await e.command(this.ns,this.command,{...this.options,readPreference:this.readPreference,session:t,timeoutContext:n})}}return an.RunAdminCommandOperation=r,an}var ln,hn,pn={};function dn(){if(hn)return tn;hn=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.Admin=void 0;const e=F(),t=Me(),n=function(){if(Zt)return nn;Zt=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.ListDatabasesOperation=void 0;const e=fe(),t=Zu(),n=De();class r extends t.CommandOperation{constructor(t,n){super(t,n),this.options=n??{},this.ns=new e.MongoDBNamespace("admin","$cmd")}get commandName(){return"listDatabases"}async execute(t,n,r){const o={listDatabases:1};return"boolean"==typeof this.options.nameOnly&&(o.nameOnly=this.options.nameOnly),this.options.filter&&(o.filter=this.options.filter),"boolean"==typeof this.options.authorizedDatabases&&(o.authorizedDatabases=this.options.authorizedDatabases),(0,e.maxWireVersion)(t)>=9&&void 0!==this.options.comment&&(o.comment=this.options.comment),await super.executeCommand(t,n,o,r)}}return nn.ListDatabasesOperation=r,(0,n.defineAspects)(r,[n.Aspect.READ_OPERATION,n.Aspect.RETRYABLE]),nn}(),r=sn(),o=cn(),i=function(){if(ln)return pn;ln=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.ValidateCollectionOperation=void 0;const e=P(),t=Zu();class n extends t.CommandOperation{constructor(e,t,n){const r={validate:t},o=Object.keys(n);for(let e=0;e<o.length;e++)Object.prototype.hasOwnProperty.call(n,o[e])&&"session"!==o[e]&&(r[o[e]]=n[o[e]]);super(e.s.db,n),this.options=n,this.command=r,this.collectionName=t}get commandName(){return"validate"}async execute(t,n,r){const o=this.collectionName,i=await super.executeCommand(t,n,this.command,r);if(null!=i.result&&"string"!=typeof i.result)throw new e.MongoUnexpectedServerResponseError("Error with validation data");if(null!=i.result&&null!=i.result.match(/exception|corrupt/))throw new e.MongoUnexpectedServerResponseError(`Invalid collection ${o}`);if(null!=i.valid&&!i.valid)throw new e.MongoUnexpectedServerResponseError(`Invalid collection ${o}`);return i}}return pn.ValidateCollectionOperation=n,pn}();return tn.Admin=class{constructor(e){this.s={db:e}}async command(n,r){return await(0,t.executeOperation)(this.s.db.client,new o.RunAdminCommandOperation(n,{...(0,e.resolveBSONOptions)(r),session:r?.session,readPreference:r?.readPreference,timeoutMS:r?.timeoutMS??this.s.db.timeoutMS}))}async buildInfo(e){return await this.command({buildinfo:1},e)}async serverInfo(e){return await this.command({buildinfo:1},e)}async serverStatus(e){return await this.command({serverStatus:1},e)}async ping(e){return await this.command({ping:1},e)}async removeUser(e,n){return await(0,t.executeOperation)(this.s.db.client,new r.RemoveUserOperation(this.s.db,e,{dbName:"admin",...n}))}async validateCollection(e,n={}){return await(0,t.executeOperation)(this.s.db.client,new i.ValidateCollectionOperation(this,e,n))}async listDatabases(e){return await(0,t.executeOperation)(this.s.db.client,new n.ListDatabasesOperation(this.s.db,{timeoutMS:this.s.db.timeoutMS,...e}))}async replSetGetStatus(e){return await this.command({replSetGetStatus:1},e)}},tn}var fn,mn,yn={},gn={};function En(){if(mn)return yn;mn=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.ListCollectionsCursor=void 0;const e=Me(),t=function(){if(fn)return gn;fn=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.ListCollectionsOperation=void 0;const e=pe(),t=fe(),n=Zu(),r=De();class o extends n.CommandOperation{constructor(e,t,n){super(e,n),this.options={...n},delete this.options.writeConcern,this.db=e,this.filter=t,this.nameOnly=!!this.options.nameOnly,this.authorizedCollections=!!this.options.authorizedCollections,"number"==typeof this.options.batchSize&&(this.batchSize=this.options.batchSize)}get commandName(){return"listCollections"}async execute(n,r,o){return await super.executeCommand(n,r,this.generateCommand((0,t.maxWireVersion)(n)),o,e.CursorResponse)}generateCommand(e){const t={listCollections:1,filter:this.filter,cursor:this.batchSize?{batchSize:this.batchSize}:{},nameOnly:this.nameOnly,authorizedCollections:this.authorizedCollections};return e>=9&&void 0!==this.options.comment&&(t.comment=this.options.comment),t}}return gn.ListCollectionsOperation=o,(0,r.defineAspects)(o,[r.Aspect.READ_OPERATION,r.Aspect.RETRYABLE,r.Aspect.CURSOR_CREATING]),gn}(),n=Ju();class r extends n.AbstractCursor{constructor(e,t,n){super(e.client,e.s.namespace,n),this.parent=e,this.filter=t,this.options=n}clone(){return new r(this.parent,this.filter,{...this.options,...this.cursorOptions})}async _initialize(n){const r=new t.ListCollectionsOperation(this.parent,this.filter,{...this.cursorOptions,...this.options,session:n,signal:this.signal}),o=await(0,e.executeOperation)(this.parent.client,r,this.timeoutContext);return{server:r.server,session:n,response:o}}}return yn.ListCollectionsCursor=r,yn}var An,bn={};var _n,On={};var Cn,wn={};var Sn,vn={};var Dn,Mn={};function Tn(){return Dn||(Dn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SetProfilingLevelOperation=e.ProfilingLevel=void 0;const t=P(),n=fe(),r=Zu(),o=new Set(["off","slow_only","all"]);e.ProfilingLevel=Object.freeze({off:"off",slowOnly:"slow_only",all:"all"});class i extends r.CommandOperation{constructor(t,n,r){switch(super(t,r),this.options=r,n){case e.ProfilingLevel.off:this.profile=0;break;case e.ProfilingLevel.slowOnly:this.profile=1;break;case e.ProfilingLevel.all:this.profile=2;break;default:this.profile=0}this.level=n}get commandName(){return"profile"}async execute(r,i,s){const u=this.level;if(!o.has(u))throw new t.MongoInvalidArgumentError(`Profiling level must be one of "${(0,n.enumToString)(e.ProfilingLevel)}"`);return await super.executeCommand(r,i,{profile:this.profile},s),u}}e.SetProfilingLevelOperation=i}(Mn)),Mn}var Bn,Fn,$n,xn={};function Pn(){if(Fn)return en;Fn=1,Object.defineProperty(en,"__esModule",{value:!0}),en.Db=void 0;const e=dn(),t=F(),n=Nn(),r=Yt(),o=z(),i=Ye(),s=En(),u=function(){if(An)return bn;An=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.RunCommandCursor=void 0;const e=pe(),t=P(),n=Me(),r=Fe(),o=cn(),i=fe(),s=Ju();class u extends s.AbstractCursor{setComment(e){return this.getMoreOptions.comment=e,this}setMaxTimeMS(e){return this.getMoreOptions.maxAwaitTimeMS=e,this}setBatchSize(e){return this.getMoreOptions.batchSize=e,this}clone(){throw new t.MongoAPIError("Clone not supported, create a new cursor with db.runCursorCommand")}withReadConcern(e){throw new t.MongoAPIError("RunCommandCursor does not support readConcern it must be attached to the command being run")}addCursorFlag(e,n){throw new t.MongoAPIError("RunCommandCursor does not support cursor flags, they must be attached to the command being run")}maxTimeMS(e){throw new t.MongoAPIError("maxTimeMS must be configured on the command document directly, to configure getMore.maxTimeMS use cursor.setMaxTimeMS()")}batchSize(e){throw new t.MongoAPIError("batchSize must be configured on the command document directly, to configure getMore.batchSize use cursor.setBatchSize()")}constructor(e,t,n={}){super(e.client,(0,i.ns)(e.namespace),n),this.getMoreOptions={},this.db=e,this.command=Object.freeze({...t})}async _initialize(t){const r=new o.RunCommandOperation(this.db,this.command,{...this.cursorOptions,session:t,readPreference:this.cursorOptions.readPreference,responseType:e.CursorResponse}),i=await(0,n.executeOperation)(this.client,r,this.timeoutContext);return{server:r.server,session:t,response:i}}async getMore(e){const t=new r.GetMoreOperation(this.namespace,this.id,this.server,{...this.cursorOptions,session:this.session,...this.getMoreOptions});return await(0,n.executeOperation)(this.client,t,this.timeoutContext)}}return bn.RunCommandCursor=u,bn}(),a=P(),c=function(){if(_n)return On;_n=1,Object.defineProperty(On,"__esModule",{value:!0}),On.CollectionsOperation=void 0;const e=Yt(),t=De();class n extends t.AbstractOperation{constructor(e,t){super(t),this.options=t,this.db=e}get commandName(){return"listCollections"}async execute(t,n){const r=await this.db.listCollections({},{...this.options,nameOnly:!0,readPreference:this.readPreference,session:n}).toArray(),o=[];for(const{name:t}of r)t.includes("$")||o.push(new e.Collection(this.db,t,this.db.s.options));return o}}return On.CollectionsOperation=n,On}(),l=function(){if(Cn)return wn;Cn=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.CreateCollectionOperation=void 0;const e=H(),t=Yt(),n=P(),r=Zu(),o=pt(),i=De(),s=new Set(["w","wtimeout","timeoutMS","j","fsync","autoIndexId","pkFactory","raw","readPreference","session","readConcern","writeConcern","raw","fieldsAsRaw","useBigInt64","promoteLongs","promoteValues","promoteBuffers","bsonRegExp","serializeFunctions","ignoreUndefined","enableUtf8Validation"]);class u extends r.CommandOperation{constructor(e,t,n={}){super(e,n),this.options=n,this.db=e,this.name=t}get commandName(){return"create"}async execute(t,r,i){const s=this.db,a=this.name,c=this.options,l=c.encryptedFields??s.client.s.options.autoEncryption?.encryptedFieldsMap?.[`${s.databaseName}.${a}`];if(l){if(!t.loadBalanced&&t.description.maxWireVersion<e.MIN_SUPPORTED_QE_WIRE_VERSION)throw new n.MongoCompatibilityError(`Driver support of Queryable Encryption is incompatible with server. Upgrade server to use Queryable Encryption. The minimum server version required is ${e.MIN_SUPPORTED_QE_SERVER_VERSION}`);const o=l.escCollection??`enxcol_.${a}.esc`,h=l.ecocCollection??`enxcol_.${a}.ecoc`;for(const e of[o,h]){const n=new u(s,e,{clusteredIndex:{key:{_id:1},unique:!0}});await n.executeWithoutEncryptedFieldsCheck(t,r,i)}c.encryptedFields||(this.options={...this.options,encryptedFields:l})}const h=await this.executeWithoutEncryptedFieldsCheck(t,r,i);if(l){const e=o.CreateIndexesOperation.fromIndexSpecification(s,a,{__safeContent__:1},{});await e.execute(t,r,i)}return h}async executeWithoutEncryptedFieldsCheck(e,n,r){const o=this.db,i=this.name,u=this.options,a={create:i};for(const e in u)null==u[e]||"function"==typeof u[e]||s.has(e)||(a[e]=u[e]);return await super.executeCommand(e,n,a,r),new t.Collection(o,i,u)}}return wn.CreateCollectionOperation=u,(0,i.defineAspects)(u,[i.Aspect.WRITE_OPERATION]),wn}(),h=Ct(),p=Me(),d=pt(),f=function(){if(Sn)return vn;Sn=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.ProfilingLevelOperation=void 0;const e=P(),t=Zu();class n extends t.CommandOperation{constructor(e,t){super(e,t),this.options=t}get commandName(){return"profile"}async execute(t,n,r){const o=await super.executeCommand(t,n,{profile:-1},r);if(1===o.ok){const t=o.was;if(0===t)return"off";if(1===t)return"slow_only";if(2===t)return"all";throw new e.MongoUnexpectedServerResponseError(`Illegal profiling level value ${t}`)}throw new e.MongoUnexpectedServerResponseError("Error with profile command")}}return vn.ProfilingLevelOperation=n,vn}(),m=sn(),y=kt(),g=cn(),E=Tn(),A=function(){if(Bn)return xn;Bn=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.DbStatsOperation=void 0;const e=Zu(),t=De();class n extends e.CommandOperation{constructor(e,t){super(e,t),this.options=t}get commandName(){return"dbStats"}async execute(e,t,n){const r={dbStats:!0};return null!=this.options.scale&&(r.scale=this.options.scale),await super.executeCommand(e,t,r,n)}}return xn.DbStatsOperation=n,(0,t.defineAspects)(n,[t.Aspect.READ_OPERATION]),xn}(),b=Q(),_=Z(),O=fe(),C=de(),w=["writeConcern","readPreference","readPreferenceTags","native_parser","forceServerObjectId","pkFactory","serializeFunctions","raw","authSource","ignoreUndefined","readConcern","retryMiliSeconds","numberOfRetries","useBigInt64","promoteBuffers","promoteLongs","bsonRegExp","enableUtf8Validation","promoteValues","compression","retryWrites","timeoutMS"];class S{constructor(e,n,r){if(r=r??{},r=(0,O.filterOptions)(r,w),"string"==typeof n&&n.includes("."))throw new a.MongoInvalidArgumentError("Database names cannot contain the character '.'");this.s={options:r,readPreference:_.ReadPreference.fromOptions(r),bsonOptions:(0,t.resolveBSONOptions)(r,e),pkFactory:r?.pkFactory??O.DEFAULT_PK_FACTORY,readConcern:b.ReadConcern.fromOptions(r),writeConcern:C.WriteConcern.fromOptions(r),namespace:new O.MongoDBNamespace(n)},this.client=e}get databaseName(){return this.s.namespace.db}get options(){return this.s.options}get secondaryOk(){return"primary"!==this.s.readPreference?.preference||!1}get readConcern(){return this.s.readConcern}get readPreference(){return null==this.s.readPreference?this.client.readPreference:this.s.readPreference}get bsonOptions(){return this.s.bsonOptions}get writeConcern(){return this.s.writeConcern}get namespace(){return this.s.namespace.toString()}get timeoutMS(){return this.s.options?.timeoutMS}async createCollection(e,t){return await(0,p.executeOperation)(this.client,new l.CreateCollectionOperation(this,e,(0,O.resolveOptions)(this,t)))}async command(e,n){return await(0,p.executeOperation)(this.client,new g.RunCommandOperation(this,e,(0,O.resolveOptions)(void 0,{...(0,t.resolveBSONOptions)(n),timeoutMS:n?.timeoutMS??this.timeoutMS,session:n?.session,readPreference:n?.readPreference,signal:n?.signal})))}aggregate(e=[],t){return new i.AggregationCursor(this.client,this.s.namespace,e,(0,O.resolveOptions)(this,t))}admin(){return new e.Admin(this)}collection(e,t={}){if("function"==typeof t)throw new a.MongoInvalidArgumentError("The callback form of this helper has been removed.");return new r.Collection(this,e,(0,O.resolveOptions)(this,t))}async stats(e){return await(0,p.executeOperation)(this.client,new A.DbStatsOperation(this,(0,O.resolveOptions)(this,e)))}listCollections(e={},t={}){return new s.ListCollectionsCursor(this,e,(0,O.resolveOptions)(this,t))}async renameCollection(e,t,n){return await(0,p.executeOperation)(this.client,new y.RenameOperation(this.collection(e),t,(0,O.resolveOptions)(void 0,{...n,new_collection:!0,readPreference:_.ReadPreference.primary})))}async dropCollection(e,t){return await(0,p.executeOperation)(this.client,new h.DropCollectionOperation(this,e,(0,O.resolveOptions)(this,t)))}async dropDatabase(e){return await(0,p.executeOperation)(this.client,new h.DropDatabaseOperation(this,(0,O.resolveOptions)(this,e)))}async collections(e){return await(0,p.executeOperation)(this.client,new c.CollectionsOperation(this,(0,O.resolveOptions)(this,e)))}async createIndex(e,t,n){return(await(0,p.executeOperation)(this.client,d.CreateIndexesOperation.fromIndexSpecification(this,e,t,n)))[0]}async removeUser(e,t){return await(0,p.executeOperation)(this.client,new m.RemoveUserOperation(this,e,(0,O.resolveOptions)(this,t)))}async setProfilingLevel(e,t){return await(0,p.executeOperation)(this.client,new E.SetProfilingLevelOperation(this,e,(0,O.resolveOptions)(this,t)))}async profilingLevel(e){return await(0,p.executeOperation)(this.client,new f.ProfilingLevelOperation(this,(0,O.resolveOptions)(this,e)))}async indexInformation(e,t){return await this.collection(e).indexInformation((0,O.resolveOptions)(this,t))}watch(e=[],t={}){return Array.isArray(e)||(t=e,e=[]),new n.ChangeStream(this,e,(0,O.resolveOptions)(this,t))}runCursorCommand(e,t){return new u.RunCommandCursor(this,e,t)}}return en.Db=S,S.SYSTEM_NAMESPACE_COLLECTION=o.SYSTEM_NAMESPACE_COLLECTION,S.SYSTEM_INDEX_COLLECTION=o.SYSTEM_INDEX_COLLECTION,S.SYSTEM_PROFILE_COLLECTION=o.SYSTEM_PROFILE_COLLECTION,S.SYSTEM_USER_COLLECTION=o.SYSTEM_USER_COLLECTION,S.SYSTEM_COMMAND_COLLECTION=o.SYSTEM_COMMAND_COLLECTION,S.SYSTEM_JS_COLLECTION=o.SYSTEM_JS_COLLECTION,en}function Nn(){if($n)return Re;$n=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.ChangeStream=void 0;const e=Yt(),t=z(),n=Ju(),r=Xt(),o=Pn(),i=P(),s=Yu(),u=ye(),a=Qu(),c=Ce(),l=fe(),h=["resumeAfter","startAfter","startAtOperationTime","fullDocument","fullDocumentBeforeChange","showExpandedEvents"],p={COLLECTION:Symbol("Collection"),DATABASE:Symbol("Database"),CLUSTER:Symbol("Cluster")},d=[t.RESUME_TOKEN_CHANGED,t.END,t.CLOSE],f="ChangeStream is closed";class m extends u.TypedEventEmitter{async asyncDispose(){await this.close()}constructor(t,n=[],r={}){let u;if(super(),this.pipeline=n,this.options={...r},delete this.options.writeConcern,t instanceof e.Collection)this.type=p.COLLECTION,u=t.s.db.client.options.serverSelectionTimeoutMS;else if(t instanceof o.Db)this.type=p.DATABASE,u=t.client.options.serverSelectionTimeoutMS;else{if(!(t instanceof s.MongoClient))throw new i.MongoChangeStreamError("Parent provided to ChangeStream constructor must be an instance of Collection, Db, or MongoClient");this.type=p.CLUSTER,u=t.options.serverSelectionTimeoutMS}this.contextOwner=Symbol(),this.parent=t,this.namespace=t.s.namespace,!this.options.readPreference&&t.readPreference&&(this.options.readPreference=t.readPreference),this.cursor=this._createChangeStreamCursor(r),this.isClosed=!1,this.mode=!1,this.on("newListener",(e=>{"change"===e&&this.cursor&&0===this.listenerCount("change")&&this._streamEvents(this.cursor)})),this.on("removeListener",(e=>{"change"===e&&0===this.listenerCount("change")&&this.cursor&&this.cursorStream?.removeAllListeners("data")})),null!=this.options.timeoutMS&&(this.timeoutContext=new c.CSOTTimeoutContext({timeoutMS:this.options.timeoutMS,serverSelectionTimeoutMS:u}))}get resumeToken(){return this.cursor?.resumeToken}async hasNext(){this._setIsIterator(),this.timeoutContext?.refresh();try{for(;;)try{return await this.cursor.hasNext()}catch(e){try{await this._processErrorIteratorMode(e,null!=this.cursor.id)}catch(e){if(e instanceof i.MongoOperationTimeoutError&&null==this.cursor.id)throw e;try{await this.close()}catch(e){(0,l.squashError)(e)}throw e}}}finally{this.timeoutContext?.clear()}}async next(){this._setIsIterator(),this.timeoutContext?.refresh();try{for(;;)try{const e=await this.cursor.next();return this._processChange(e??null)}catch(e){try{await this._processErrorIteratorMode(e,null!=this.cursor.id)}catch(e){if(e instanceof i.MongoOperationTimeoutError&&null==this.cursor.id)throw e;try{await this.close()}catch(e){(0,l.squashError)(e)}throw e}}}finally{this.timeoutContext?.clear()}}async tryNext(){this._setIsIterator(),this.timeoutContext?.refresh();try{for(;;)try{return await this.cursor.tryNext()??null}catch(e){try{await this._processErrorIteratorMode(e,null!=this.cursor.id)}catch(e){if(e instanceof i.MongoOperationTimeoutError&&null==this.cursor.id)throw e;try{await this.close()}catch(e){(0,l.squashError)(e)}throw e}}}finally{this.timeoutContext?.clear()}}async*[Symbol.asyncIterator](){if(!this.closed)try{for(;;)yield await this.next()}finally{try{await this.close()}catch(e){(0,l.squashError)(e)}}}get closed(){return this.isClosed||this.cursor.closed}async close(){this.timeoutContext?.clear(),this.timeoutContext=void 0,this.isClosed=!0;const e=this.cursor;try{await e.close()}finally{this._endStream()}}stream(e){if(this.closed)throw new i.MongoChangeStreamError(f);return this.streamOptions=e,this.cursor.stream(e)}_setIsEmitter(){if("iterator"===this.mode)throw new i.MongoAPIError("ChangeStream cannot be used as an EventEmitter after being used as an iterator");this.mode="emitter"}_setIsIterator(){if("emitter"===this.mode)throw new i.MongoAPIError("ChangeStream cannot be used as an iterator after being used as an EventEmitter");this.mode="iterator"}_createChangeStreamCursor(e){const t=(0,l.filterOptions)(e,h);this.type===p.CLUSTER&&(t.allChangesForCluster=!0);const o=[{$changeStream:t},...this.pipeline],s=this.type===p.CLUSTER?this.parent:this.type===p.DATABASE||this.type===p.COLLECTION?this.parent.client:null;if(null==s)throw new i.MongoRuntimeError(`Changestream type should only be one of cluster, database, collection. Found ${this.type.toString()}`);const u=new r.ChangeStreamCursor(s,this.namespace,o,{...e,timeoutContext:this.timeoutContext?new n.CursorTimeoutContext(this.timeoutContext,this.contextOwner):void 0});for(const e of d)u.on(e,(t=>this.emit(e,t)));return this.listenerCount(m.CHANGE)>0&&this._streamEvents(u),u}_closeEmitterModeWithError(e){this.emit(m.ERROR,e),this.close().then(void 0,l.squashError)}_streamEvents(e){this._setIsEmitter();const t=this.cursorStream??e.stream();this.cursorStream=t,t.on("data",(e=>{try{const t=this._processChange(e);this.emit(m.CHANGE,t)}catch(e){this.emit(m.ERROR,e)}this.timeoutContext?.refresh()})),t.on("error",(e=>this._processErrorStreamMode(e,null!=this.cursor.id)))}_endStream(){this.cursorStream?.removeAllListeners("data"),this.cursorStream?.removeAllListeners("close"),this.cursorStream?.removeAllListeners("end"),this.cursorStream?.destroy(),this.cursorStream=void 0}_processChange(e){if(this.isClosed)throw new i.MongoAPIError(f);if(null==e)throw new i.MongoRuntimeError(f);if(e&&!e._id)throw new i.MongoChangeStreamError("A change stream document has been received that lacks a resume token (_id).");return this.cursor.cacheResumeToken(e._id),this.options.startAtOperationTime=void 0,e}_processErrorStreamMode(e,t){this.isClosed||(t&&((0,i.isResumableError)(e,this.cursor.maxWireVersion)||e instanceof i.MongoOperationTimeoutError)?(this._endStream(),this.cursor.close().then((()=>this._resume(e)),(t=>((0,l.squashError)(t),this._resume(e)))).then((()=>{e instanceof i.MongoOperationTimeoutError&&this.emit(m.ERROR,e)}),(()=>this._closeEmitterModeWithError(e)))):this._closeEmitterModeWithError(e))}async _processErrorIteratorMode(e,t){if(this.isClosed)throw new i.MongoAPIError(f);if(!t||!((0,i.isResumableError)(e,this.cursor.maxWireVersion)||e instanceof i.MongoOperationTimeoutError)){try{await this.close()}catch(e){(0,l.squashError)(e)}throw e}try{await this.cursor.close()}catch(e){(0,l.squashError)(e)}if(await this._resume(e),e instanceof i.MongoOperationTimeoutError)throw e}async _resume(e){this.timeoutContext?.refresh();const t=(0,l.getTopology)(this.parent);try{await t.selectServer(this.cursor.readPreference,{operationName:"reconnect topology in change stream",timeoutContext:this.timeoutContext}),this.cursor=this._createChangeStreamCursor(this.cursor.resumeOptions)}catch{throw await this.close(),e}}}return Re.ChangeStream=m,m.RESPONSE=t.RESPONSE,m.MORE=t.MORE,m.INIT=t.INIT,m.CLOSE=t.CLOSE,m.CHANGE=t.CHANGE,m.END=t.END,m.ERROR=t.ERROR,m.RESUME_TOKEN_CHANGED=t.RESUME_TOKEN_CHANGED,(0,a.configureResourceManagement)(m.prototype),Re}var In,Rn={},kn={},jn={};function Ln(){if(In)return jn;In=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.aws4=void 0,jn.getKerberos=function(){let n;try{n=require("kerberos")}catch(r){n=t(new e.MongoMissingDependencyError("Optional module `kerberos` not found. Please install it to enable kerberos authentication",{cause:r,dependencyName:"kerberos"}))}return n},jn.getZstdLibrary=function(){let n;try{n=require("@mongodb-js/zstd")}catch(r){n=t(new e.MongoMissingDependencyError("Optional module `@mongodb-js/zstd` not found. Please install it to enable zstd compression",{cause:r,dependencyName:"zstd"}))}return n},jn.getAwsCredentialProvider=function(){try{return require("@aws-sdk/credential-providers")}catch(n){return t(new e.MongoMissingDependencyError("Optional module `@aws-sdk/credential-providers` not found. Please install it to enable getting aws credentials via the official sdk.",{cause:n,dependencyName:"@aws-sdk/credential-providers"}))}},jn.getGcpMetadata=function(){try{return require("gcp-metadata")}catch(n){return t(new e.MongoMissingDependencyError("Optional module `gcp-metadata` not found. Please install it to enable getting gcp credentials via the official sdk.",{cause:n,dependencyName:"gcp-metadata"}))}},jn.getSnappy=function(){try{return require("snappy")}catch(t){return{kModuleError:new e.MongoMissingDependencyError("Optional module `snappy` not found. Please install it to enable snappy compression",{cause:t,dependencyName:"snappy"})}}},jn.getSocks=function(){try{return require("socks")}catch(t){return{kModuleError:new e.MongoMissingDependencyError("Optional module `socks` not found. Please install it to connections over a SOCKS5 proxy",{cause:t,dependencyName:"socks"})}}},jn.getMongoDBClientEncryption=function(){let t=null;try{t=require("mongodb-client-encryption")}catch(t){return{kModuleError:new e.MongoMissingDependencyError("Optional module `mongodb-client-encryption` not found. Please install it to use auto encryption or ClientEncryption.",{cause:t,dependencyName:"mongodb-client-encryption"})}}return t};const e=P();function t(e){return new Proxy(e?{kModuleError:e}:{},{get:(t,n)=>{if("kModuleError"===n)return e;throw e},set:()=>{throw e}})}return jn.aws4=function(){let n;try{n=require("aws4")}catch(r){n=t(new e.MongoMissingDependencyError("Optional module `aws4` not found. Please install it to enable AWS authentication",{cause:r,dependencyName:"aws4"}))}return n}(),jn}var Un,Vn,zn={};function Wn(){if(Un)return zn;Un=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.AuthProvider=zn.AuthContext=void 0;const e=P();zn.AuthContext=class{constructor(e,t,n){this.reauthenticating=!1,this.connection=e,this.credentials=t,this.options=n}};return zn.AuthProvider=class{async prepare(e,t){return e}async reauth(t){if(t.reauthenticating)throw new e.MongoRuntimeError("Reauthentication already in progress.");try{t.reauthenticating=!0,await this.auth(t)}finally{t.reauthenticating=!1}}},zn}function qn(){return Vn||(Vn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GSSAPI=e.GSSAPICanonicalizationValue=void 0,e.performGSSAPICanonicalizeHostName=h,e.resolveCname=p;const t=a,n=Ln(),r=P(),o=fe(),i=Wn();async function s(e,t){return await e.command((0,o.ns)("$external.$cmd"),t)}let u;e.GSSAPICanonicalizationValue=Object.freeze({on:!0,off:!1,none:"none",forward:"forward",forwardAndReverse:"forwardAndReverse"});class c extends i.AuthProvider{async auth(e){const{connection:t,credentials:o}=e;if(null==o)throw new r.MongoMissingCredentialsError("Credentials required for GSSAPI authentication");const{username:i}=o,a=await async function(e){const{hostAddress:t}=e.options,{credentials:o}=e;if(!t||"string"!=typeof t.host||!o)throw new r.MongoInvalidArgumentError("Connection must have host and port and credentials defined.");if(function(){u||(u=(0,n.getKerberos)())}(),"kModuleError"in u)throw u.kModuleError;const{initializeClient:i}=u,{username:s,password:a}=o,c=o.mechanismProperties,l=c.SERVICE_NAME??"mongodb",p=await h(t.host,c),d={};null!=a&&Object.assign(d,{user:s,password:a});const f=c.SERVICE_HOST??p;let m=`${l}${"win32"===process.platform?"/":"@"}${f}`;"SERVICE_REALM"in c&&(m=`${m}@${c.SERVICE_REALM}`);return await i(m,d)}(e),c=await a.step(""),p=await s(t,function(e){return{saslStart:1,mechanism:"GSSAPI",payload:e,autoAuthorize:1}}(c)),d=await l(a,10,p.payload),f=await s(t,function(e,t){return{saslContinue:1,conversationId:t,payload:e}}(d,p.conversationId)),m=await async function(e,t,n){const r=await e.unwrap(n);return await e.wrap(r||"",{user:t})}(a,i,f.payload);await s(t,{saslContinue:1,conversationId:f.conversationId,payload:m})}}async function l(e,t,n){try{return await e.step(n)||""}catch(r){if(0===t)throw r;return await l(e,t-1,n)}}async function h(n,r){const o=r.CANONICALIZE_HOST_NAME;if(!o||o===e.GSSAPICanonicalizationValue.none)return n;if(o!==e.GSSAPICanonicalizationValue.on&&o!==e.GSSAPICanonicalizationValue.forwardAndReverse)return await p(n);{const{address:e}=await t.promises.lookup(n);try{const r=await t.promises.resolvePtr(e);return r.length>0?r[0]:n}catch{return await p(n)}}}async function p(e){try{const n=await t.promises.resolveCname(e);return n.length>0?n[0]:e}catch{return e}}e.GSSAPI=c}(kn)),kn}var Gn,Hn,Kn={};function Yn(){return Gn||(Gn=1,e=Kn,Object.defineProperty(e,"__esModule",{value:!0}),e.AUTH_MECHS_AUTH_SRC_EXTERNAL=e.AuthMechanism=void 0,e.AuthMechanism=Object.freeze({MONGODB_AWS:"MONGODB-AWS",MONGODB_CR:"MONGODB-CR",MONGODB_DEFAULT:"DEFAULT",MONGODB_GSSAPI:"GSSAPI",MONGODB_PLAIN:"PLAIN",MONGODB_SCRAM_SHA1:"SCRAM-SHA-1",MONGODB_SCRAM_SHA256:"SCRAM-SHA-256",MONGODB_X509:"MONGODB-X509",MONGODB_OIDC:"MONGODB-OIDC"}),e.AUTH_MECHS_AUTH_SRC_EXTERNAL=new Set([e.AuthMechanism.MONGODB_GSSAPI,e.AuthMechanism.MONGODB_AWS,e.AuthMechanism.MONGODB_OIDC,e.AuthMechanism.MONGODB_X509])),Kn;var e}function Qn(){return Hn||(Hn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MongoCredentials=e.DEFAULT_ALLOWED_HOSTS=void 0;const t=P(),n=qn(),r=Yn();function o(e){return e&&Array.isArray(e.saslSupportedMechs)?e.saslSupportedMechs.includes(r.AuthMechanism.MONGODB_SCRAM_SHA256)?r.AuthMechanism.MONGODB_SCRAM_SHA256:r.AuthMechanism.MONGODB_SCRAM_SHA1:r.AuthMechanism.MONGODB_SCRAM_SHA256}const i=["test","azure","gcp","k8s"],s="Auth mechanism property ALLOWED_HOSTS must be an array of strings.";e.DEFAULT_ALLOWED_HOSTS=["*.mongodb.net","*.mongodb-qa.net","*.mongodb-dev.net","*.mongodbgov.net","localhost","127.0.0.1","::1"];class u{constructor(t){this.username=t.username??"",this.password=t.password,this.source=t.source,!this.source&&t.db&&(this.source=t.db),this.mechanism=t.mechanism||r.AuthMechanism.MONGODB_DEFAULT,this.mechanismProperties=t.mechanismProperties||{},this.mechanism.match(/MONGODB-AWS/i)&&(!this.username&&process.env.AWS_ACCESS_KEY_ID&&(this.username=process.env.AWS_ACCESS_KEY_ID),!this.password&&process.env.AWS_SECRET_ACCESS_KEY&&(this.password=process.env.AWS_SECRET_ACCESS_KEY),null==this.mechanismProperties.AWS_SESSION_TOKEN&&null!=process.env.AWS_SESSION_TOKEN&&(this.mechanismProperties={...this.mechanismProperties,AWS_SESSION_TOKEN:process.env.AWS_SESSION_TOKEN})),this.mechanism!==r.AuthMechanism.MONGODB_OIDC||this.mechanismProperties.ALLOWED_HOSTS||(this.mechanismProperties={...this.mechanismProperties,ALLOWED_HOSTS:e.DEFAULT_ALLOWED_HOSTS}),Object.freeze(this.mechanismProperties),Object.freeze(this)}equals(e){return this.mechanism===e.mechanism&&this.username===e.username&&this.password===e.password&&this.source===e.source}resolveAuthMechanism(e){return this.mechanism.match(/DEFAULT/i)?new u({username:this.username,password:this.password,source:this.source,mechanism:o(e),mechanismProperties:this.mechanismProperties}):this}validate(){if((this.mechanism===r.AuthMechanism.MONGODB_GSSAPI||this.mechanism===r.AuthMechanism.MONGODB_PLAIN||this.mechanism===r.AuthMechanism.MONGODB_SCRAM_SHA1||this.mechanism===r.AuthMechanism.MONGODB_SCRAM_SHA256)&&!this.username)throw new t.MongoMissingCredentialsError(`Username required for mechanism '${this.mechanism}'`);if(this.mechanism===r.AuthMechanism.MONGODB_OIDC){if(this.username&&this.mechanismProperties.ENVIRONMENT&&"azure"!==this.mechanismProperties.ENVIRONMENT)throw new t.MongoInvalidArgumentError(`username and ENVIRONMENT '${this.mechanismProperties.ENVIRONMENT}' may not be used together for mechanism '${this.mechanism}'.`);if(this.username&&this.password)throw new t.MongoInvalidArgumentError(`No password is allowed in ENVIRONMENT '${this.mechanismProperties.ENVIRONMENT}' for '${this.mechanism}'.`);if(("azure"===this.mechanismProperties.ENVIRONMENT||"gcp"===this.mechanismProperties.ENVIRONMENT)&&!this.mechanismProperties.TOKEN_RESOURCE)throw new t.MongoInvalidArgumentError("TOKEN_RESOURCE must be set in the auth mechanism properties when ENVIRONMENT is azure or gcp.");if(this.mechanismProperties.ENVIRONMENT&&!i.includes(this.mechanismProperties.ENVIRONMENT))throw new t.MongoInvalidArgumentError(`Currently only a ENVIRONMENT in ${i.join(",")} is supported for mechanism '${this.mechanism}'.`);if(!this.mechanismProperties.ENVIRONMENT&&!this.mechanismProperties.OIDC_CALLBACK&&!this.mechanismProperties.OIDC_HUMAN_CALLBACK)throw new t.MongoInvalidArgumentError(`Either a ENVIRONMENT, OIDC_CALLBACK, or OIDC_HUMAN_CALLBACK must be specified for mechanism '${this.mechanism}'.`);if(this.mechanismProperties.ALLOWED_HOSTS){const e=this.mechanismProperties.ALLOWED_HOSTS;if(!Array.isArray(e))throw new t.MongoInvalidArgumentError(s);for(const n of e)if("string"!=typeof n)throw new t.MongoInvalidArgumentError(s)}}if(r.AUTH_MECHS_AUTH_SRC_EXTERNAL.has(this.mechanism)&&null!=this.source&&"$external"!==this.source)throw new t.MongoAPIError(`Invalid source '${this.source}' for mechanism '${this.mechanism}' specified.`);if(this.mechanism===r.AuthMechanism.MONGODB_PLAIN&&null==this.source)throw new t.MongoAPIError("PLAIN Authentication Mechanism needs an auth source");if(this.mechanism===r.AuthMechanism.MONGODB_X509&&null!=this.password){if(""===this.password)return void Reflect.set(this,"password",void 0);throw new t.MongoAPIError("Password not allowed for mechanism MONGODB-X509")}const e=this.mechanismProperties.CANONICALIZE_HOST_NAME??!1;if(!Object.values(n.GSSAPICanonicalizationValue).includes(e))throw new t.MongoAPIError(`Invalid CANONICALIZE_HOST_NAME value: ${e}`)}static merge(e,t){return new u({username:t.username??e?.username??"",password:t.password??e?.password??"",mechanism:t.mechanism??e?.mechanism??r.AuthMechanism.MONGODB_DEFAULT,mechanismProperties:t.mechanismProperties??e?.mechanismProperties??{},source:t.source??t.db??e?.source??"admin"})}}e.MongoCredentials=u}(Rn)),Rn}var Jn,Xn={},Zn={},er={},tr={},nr={},rr={};function or(){return Jn||(Jn=1,function(e){function t(e,t,n){return n.globals&&(e=n.globals[e.name]),new e(`${n.context?n.context:"Value"} ${t}.`)}function n(e,n){if("bigint"==typeof e)throw t(TypeError,"is a BigInt which cannot be converted to a number",n);return n.globals?n.globals.Number(e):Number(e)}function r(e){return s(e>0&&e%1==.5&&!(1&e)||e<0&&e%1==-.5&&!(1&~e)?Math.floor(e):Math.round(e))}function o(e){return s(Math.trunc(e))}function i(e){return e<0?-1:1}function s(e){return 0===e?0:e}function u(e,{unsigned:u}){let a,c;u?(a=0,c=2**e-1):(a=-(2**(e-1)),c=2**(e-1)-1);const l=2**e,h=2**(e-1);return(e,p={})=>{let d=n(e,p);if(d=s(d),p.enforceRange){if(!Number.isFinite(d))throw t(TypeError,"is not a finite number",p);if(d=o(d),d<a||d>c)throw t(TypeError,`is outside the accepted range of ${a} to ${c}, inclusive`,p);return d}return!Number.isNaN(d)&&p.clamp?(d=Math.min(Math.max(d,a),c),d=r(d),d):Number.isFinite(d)&&0!==d?(d=o(d),d>=a&&d<=c?d:(d=function(e,t){const n=e%t;return i(t)!==i(n)?n+t:n}(d,l),!u&&d>=h?d-l:d)):0}}function a(e,{unsigned:i}){const u=Number.MAX_SAFE_INTEGER,a=i?0:Number.MIN_SAFE_INTEGER,c=i?BigInt.asUintN:BigInt.asIntN;return(i,l={})=>{let h=n(i,l);if(h=s(h),l.enforceRange){if(!Number.isFinite(h))throw t(TypeError,"is not a finite number",l);if(h=o(h),h<a||h>u)throw t(TypeError,`is outside the accepted range of ${a} to ${u}, inclusive`,l);return h}if(!Number.isNaN(h)&&l.clamp)return h=Math.min(Math.max(h,a),u),h=r(h),h;if(!Number.isFinite(h)||0===h)return 0;let p=BigInt(o(h));return p=c(e,p),Number(p)}}e.any=e=>e,e.undefined=()=>{},e.boolean=e=>Boolean(e),e.byte=u(8,{unsigned:!1}),e.octet=u(8,{unsigned:!0}),e.short=u(16,{unsigned:!1}),e["unsigned short"]=u(16,{unsigned:!0}),e.long=u(32,{unsigned:!1}),e["unsigned long"]=u(32,{unsigned:!0}),e["long long"]=a(64,{unsigned:!1}),e["unsigned long long"]=a(64,{unsigned:!0}),e.double=(e,r={})=>{const o=n(e,r);if(!Number.isFinite(o))throw t(TypeError,"is not a finite floating-point value",r);return o},e["unrestricted double"]=(e,t={})=>n(e,t),e.float=(e,r={})=>{const o=n(e,r);if(!Number.isFinite(o))throw t(TypeError,"is not a finite floating-point value",r);if(Object.is(o,-0))return o;const i=Math.fround(o);if(!Number.isFinite(i))throw t(TypeError,"is outside the range of a single-precision floating-point value",r);return i},e["unrestricted float"]=(e,t={})=>{const r=n(e,t);return isNaN(r)||Object.is(r,-0)?r:Math.fround(r)},e.DOMString=(e,n={})=>{if(n.treatNullAsEmptyString&&null===e)return"";if("symbol"==typeof e)throw t(TypeError,"is a symbol, which cannot be converted to a string",n);return(n.globals?n.globals.String:String)(e)},e.ByteString=(n,r={})=>{const o=e.DOMString(n,r);let i;for(let e=0;void 0!==(i=o.codePointAt(e));++e)if(i>255)throw t(TypeError,"is not a valid ByteString",r);return o},e.USVString=(t,n={})=>{const r=e.DOMString(t,n),o=r.length,i=[];for(let e=0;e<o;++e){const t=r.charCodeAt(e);if(t<55296||t>57343)i.push(String.fromCodePoint(t));else if(56320<=t&&t<=57343)i.push(String.fromCodePoint(65533));else if(e===o-1)i.push(String.fromCodePoint(65533));else{const n=r.charCodeAt(e+1);if(56320<=n&&n<=57343){const r=1023&t,o=1023&n;i.push(String.fromCodePoint(65536+1024*r+o)),++e}else i.push(String.fromCodePoint(65533))}}return i.join("")},e.object=(e,n={})=>{if(null===e||"object"!=typeof e&&"function"!=typeof e)throw t(TypeError,"is not an object",n);return e};const c=Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get,l="function"==typeof SharedArrayBuffer?Object.getOwnPropertyDescriptor(SharedArrayBuffer.prototype,"byteLength").get:null;function h(e){try{return c.call(e),!0}catch{return!1}}function p(e){try{return l.call(e),!0}catch{return!1}}function d(e){try{return new Uint8Array(e),!1}catch{return!0}}e.ArrayBuffer=(e,n={})=>{if(!h(e)){if(n.allowShared&&!p(e))throw t(TypeError,"is not an ArrayBuffer or SharedArrayBuffer",n);throw t(TypeError,"is not an ArrayBuffer",n)}if(d(e))throw t(TypeError,"is a detached ArrayBuffer",n);return e};const f=Object.getOwnPropertyDescriptor(DataView.prototype,"byteLength").get;e.DataView=(e,n={})=>{try{f.call(e)}catch(e){throw t(TypeError,"is not a DataView",n)}if(!n.allowShared&&p(e.buffer))throw t(TypeError,"is backed by a SharedArrayBuffer, which is not allowed",n);if(d(e.buffer))throw t(TypeError,"is backed by a detached ArrayBuffer",n);return e};const m=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Uint8Array).prototype,Symbol.toStringTag).get;[Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Uint8ClampedArray,Float32Array,Float64Array].forEach((n=>{const{name:r}=n,o=/^[AEIOU]/u.test(r)?"an":"a";e[r]=(e,n={})=>{if(!ArrayBuffer.isView(e)||m.call(e)!==r)throw t(TypeError,`is not ${o} ${r} object`,n);if(!n.allowShared&&p(e.buffer))throw t(TypeError,"is a view on a SharedArrayBuffer, which is not allowed",n);if(d(e.buffer))throw t(TypeError,"is a view on a detached ArrayBuffer",n);return e}})),e.ArrayBufferView=(e,n={})=>{if(!ArrayBuffer.isView(e))throw t(TypeError,"is not a view on an ArrayBuffer or SharedArrayBuffer",n);if(!n.allowShared&&p(e.buffer))throw t(TypeError,"is a view on a SharedArrayBuffer, which is not allowed",n);if(d(e.buffer))throw t(TypeError,"is a view on a detached ArrayBuffer",n);return e},e.BufferSource=(e,n={})=>{if(ArrayBuffer.isView(e)){if(!n.allowShared&&p(e.buffer))throw t(TypeError,"is a view on a SharedArrayBuffer, which is not allowed",n);if(d(e.buffer))throw t(TypeError,"is a view on a detached ArrayBuffer",n);return e}if(!n.allowShared&&!h(e))throw t(TypeError,"is not an ArrayBuffer or a view on one",n);if(n.allowShared&&!p(e)&&!h(e))throw t(TypeError,"is not an ArrayBuffer, SharedArrayBuffer, or a view on one",n);if(d(e))throw t(TypeError,"is a detached ArrayBuffer",n);return e},e.DOMTimeStamp=e["unsigned long long"]}(rr)),rr}var ir,sr={exports:{}};function ur(){return ir||(ir=1,function(e){const t=Function.prototype.call.bind(Object.prototype.hasOwnProperty);const n=Symbol("wrapper"),r=Symbol("impl"),o=Symbol("SameObject caches"),i=Symbol.for("[webidl2js] constructor registry"),s=Object.getPrototypeOf(Object.getPrototypeOf((async function*(){})).prototype);function u(e){if(t(e,i))return e[i];const n=Object.create(null);n["%Object.prototype%"]=e.Object.prototype,n["%IteratorPrototype%"]=Object.getPrototypeOf(Object.getPrototypeOf((new e.Array)[Symbol.iterator]()));try{n["%AsyncIteratorPrototype%"]=Object.getPrototypeOf(Object.getPrototypeOf(e.eval("(async function* () {})").prototype))}catch{n["%AsyncIteratorPrototype%"]=s}return e[i]=n,n}function a(e){return e?e[n]:null}function c(e){return e?e[r]:null}const l=Symbol("internal");const h=Object.getOwnPropertyDescriptor(ArrayBuffer.prototype,"byteLength").get;const p=Symbol("supports property index"),d=Symbol("supported property indices"),f=Symbol("supports property name"),m=Symbol("supported property names"),y=Symbol("indexed property get"),g=Symbol("indexed property set new"),E=Symbol("indexed property set existing"),A=Symbol("named property get"),b=Symbol("named property set new"),_=Symbol("named property set existing"),O=Symbol("named property delete"),C=Symbol("async iterator get the next iteration result"),w=Symbol("async iterator return steps"),S=Symbol("async iterator initialization steps"),v=Symbol("async iterator end of iteration");e.exports={isObject:function(e){return"object"==typeof e&&null!==e||"function"==typeof e},hasOwn:t,define:function(e,t){for(const n of Reflect.ownKeys(t)){const r=Reflect.getOwnPropertyDescriptor(t,n);if(r&&!Reflect.defineProperty(e,n,r))throw new TypeError(`Cannot redefine property: ${String(n)}`)}},newObjectInRealm:function(e,t){const n=u(e);return Object.defineProperties(Object.create(n["%Object.prototype%"]),Object.getOwnPropertyDescriptors(t))},wrapperSymbol:n,implSymbol:r,getSameObject:function(e,t,n){return e[o]||(e[o]=Object.create(null)),t in e[o]||(e[o][t]=n()),e[o][t]},ctorRegistrySymbol:i,initCtorRegistry:u,wrapperForImpl:a,implForWrapper:c,tryWrapperForImpl:function(e){const t=a(e);return t||e},tryImplForWrapper:function(e){const t=c(e);return t||e},iterInternalSymbol:l,isArrayBuffer:function(e){try{return h.call(e),!0}catch(e){return!1}},isArrayIndexPropName:function(e){if("string"!=typeof e)return!1;const t=e>>>0;return t!==2**32-1&&e===`${t}`},supportsPropertyIndex:p,supportedPropertyIndices:d,supportsPropertyName:f,supportedPropertyNames:m,indexedGet:y,indexedSetNew:g,indexedSetExisting:E,namedGet:A,namedSetNew:b,namedSetExisting:_,namedDelete:O,asyncIteratorNext:C,asyncIteratorReturn:w,asyncIteratorInit:S,asyncIteratorEOI:v,iteratorResult:function([e,t],n){let r;switch(n){case"key":r=e;break;case"value":r=t;break;case"key+value":r=[e,t]}return{value:r,done:!1}}}}(sr,sr.exports)),sr.exports}sr.exports;var ar={},cr={exports:{}};const lr=2147483647,hr=36,pr=/^xn--/,dr=/[^\0-\x7F]/,fr=/[\x2E\u3002\uFF0E\uFF61]/g,mr={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},yr=Math.floor,gr=String.fromCharCode;function Er(e){throw new RangeError(mr[e])}function Ar(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]);const o=function(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}((e=e.replace(fr,".")).split("."),t).join(".");return r+o}function br(e){const t=[];let n=0;const r=e.length;for(;n<r;){const o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<r){const r=e.charCodeAt(n++);56320==(64512&r)?t.push(((1023&o)<<10)+(1023&r)+65536):(t.push(o),n--)}else t.push(o)}return t}const _r=e=>String.fromCodePoint(...e),Or=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},Cr=function(e,t,n){let r=0;for(e=n?yr(e/700):e>>1,e+=yr(e/t);e>455;r+=hr)e=yr(e/35);return yr(r+36*e/(e+38))},wr=function(e){const t=[],n=e.length;let r=0,o=128,i=72,s=e.lastIndexOf("-");s<0&&(s=0);for(let n=0;n<s;++n)e.charCodeAt(n)>=128&&Er("not-basic"),t.push(e.charCodeAt(n));for(let a=s>0?s+1:0;a<n;){const s=r;for(let t=1,o=hr;;o+=hr){a>=n&&Er("invalid-input");const s=(u=e.charCodeAt(a++))>=48&&u<58?u-48+26:u>=65&&u<91?u-65:u>=97&&u<123?u-97:hr;s>=hr&&Er("invalid-input"),s>yr((lr-r)/t)&&Er("overflow"),r+=s*t;const c=o<=i?1:o>=i+26?26:o-i;if(s<c)break;const l=hr-c;t>yr(lr/l)&&Er("overflow"),t*=l}const c=t.length+1;i=Cr(r-s,c,0==s),yr(r/c)>lr-o&&Er("overflow"),o+=yr(r/c),r%=c,t.splice(r++,0,o)}var u;return String.fromCodePoint(...t)},Sr=function(e){const t=[],n=(e=br(e)).length;let r=128,o=0,i=72;for(const n of e)n<128&&t.push(gr(n));const s=t.length;let u=s;for(s&&t.push("-");u<n;){let n=lr;for(const t of e)t>=r&&t<n&&(n=t);const a=u+1;n-r>yr((lr-o)/a)&&Er("overflow"),o+=(n-r)*a,r=n;for(const n of e)if(n<r&&++o>lr&&Er("overflow"),n===r){let e=o;for(let n=hr;;n+=hr){const r=n<=i?1:n>=i+26?26:n-i;if(e<r)break;const o=e-r,s=hr-r;t.push(gr(Or(r+o%s,0))),e=yr(o/s)}t.push(gr(Or(e,0))),i=Cr(o,a,u===s),o=0,++u}++o,++r}return t.join("")},vr=function(e){return Ar(e,(function(e){return pr.test(e)?wr(e.slice(4).toLowerCase()):e}))},Dr=function(e){return Ar(e,(function(e){return dr.test(e)?"xn--"+Sr(e):e}))},Mr={version:"2.3.1",ucs2:{decode:br,encode:_r},decode:wr,encode:Sr,toASCII:Dr,toUnicode:vr};var Tr,Br,Fr=O(Object.freeze({__proto__:null,ucs2decode:br,ucs2encode:_r,decode:wr,encode:Sr,toASCII:Dr,toUnicode:vr,default:Mr}));function $r(){if(Br)return Tr;Br=1;return Tr={combiningMarks:/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6D}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{11002}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11082}\u{110B0}-\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{11134}\u{11145}\u{11146}\u{11173}\u{11180}-\u{11182}\u{111B3}-\u{111C0}\u{111C9}-\u{111CC}\u{111CE}\u{111CF}\u{1122C}-\u{11237}\u{1123E}\u{11241}\u{112DF}-\u{112EA}\u{11300}-\u{11303}\u{1133B}\u{1133C}\u{1133E}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11357}\u{11362}\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113B8}-\u{113C0}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}-\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11435}-\u{11446}\u{1145E}\u{114B0}-\u{114C3}\u{115AF}-\u{115B5}\u{115B8}-\u{115C0}\u{115DC}\u{115DD}\u{11630}-\u{11640}\u{116AB}-\u{116B7}\u{1171D}-\u{1172B}\u{1182C}-\u{1183A}\u{11930}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{1193E}\u{11940}\u{11942}\u{11943}\u{119D1}-\u{119D7}\u{119DA}-\u{119E0}\u{119E4}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A39}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A5B}\u{11A8A}-\u{11A99}\u{11C2F}-\u{11C36}\u{11C38}-\u{11C3F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D8A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D97}\u{11EF3}-\u{11EF6}\u{11F00}\u{11F01}\u{11F03}\u{11F34}-\u{11F3A}\u{11F3E}-\u{11F42}\u{11F5A}\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F51}-\u{16F87}\u{16F8F}-\u{16F92}\u{16FE4}\u{16FF0}\u{16FF1}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D165}-\u{1D169}\u{1D16D}-\u{1D172}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]/u,combiningClassVirama:/[\u094D\u09CD\u0A4D\u0ACD\u0B4D\u0BCD\u0C4D\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E3A\u0EBA\u0F84\u1039\u103A\u1714\u1715\u1734\u17D2\u1A60\u1B44\u1BAA\u1BAB\u1BF2\u1BF3\u2D7F\uA806\uA82C\uA8C4\uA953\uA9C0\uAAF6\uABED\u{10A3F}\u{11046}\u{11070}\u{1107F}\u{110B9}\u{11133}\u{11134}\u{111C0}\u{11235}\u{112EA}\u{1134D}\u{113CE}-\u{113D0}\u{11442}\u{114C2}\u{115BF}\u{1163F}\u{116B6}\u{1172B}\u{11839}\u{1193D}\u{1193E}\u{119E0}\u{11A34}\u{11A47}\u{11A99}\u{11C3F}\u{11D44}\u{11D45}\u{11D97}\u{11F41}\u{11F42}\u{1612F}]/u,validZWNJ:/[\u0620\u0626\u0628\u062A-\u062E\u0633-\u063F\u0641-\u0647\u0649\u064A\u066E\u066F\u0678-\u0687\u069A-\u06BF\u06C1\u06C2\u06CC\u06CE\u06D0\u06D1\u06FA-\u06FC\u06FF\u0712-\u0714\u071A-\u071D\u071F-\u0727\u0729\u072B\u072D\u072E\u074E-\u0758\u075C-\u076A\u076D-\u0770\u0772\u0775-\u0777\u077A-\u077F\u07CA-\u07EA\u0841-\u0845\u0848\u084A-\u0853\u0855\u0860\u0862-\u0865\u0868\u0886\u0889-\u088D\u08A0-\u08A9\u08AF\u08B0\u08B3-\u08B8\u08BA-\u08C8\u1807\u1820-\u1878\u1887-\u18A8\u18AA\uA840-\uA872\u{10AC0}-\u{10AC4}\u{10ACD}\u{10AD3}-\u{10ADC}\u{10ADE}-\u{10AE0}\u{10AEB}-\u{10AEE}\u{10B80}\u{10B82}\u{10B86}-\u{10B88}\u{10B8A}\u{10B8B}\u{10B8D}\u{10B90}\u{10BAD}\u{10BAE}\u{10D00}-\u{10D21}\u{10D23}\u{10EC3}\u{10EC4}\u{10F30}-\u{10F32}\u{10F34}-\u{10F44}\u{10F51}-\u{10F53}\u{10F70}-\u{10F73}\u{10F76}-\u{10F81}\u{10FB0}\u{10FB2}\u{10FB3}\u{10FB8}\u{10FBB}\u{10FBC}\u{10FBE}\u{10FBF}\u{10FC1}\u{10FC4}\u{10FCA}\u{10FCB}\u{1E900}-\u{1E943}][\xAD\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u061C\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u070F\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u200B\u200E\u200F\u202A-\u202E\u2060-\u2064\u206A-\u206F\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFEFF\uFFF9-\uFFFB\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6D}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11001}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11081}\u{110B3}-\u{110B6}\u{110B9}\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{1112B}\u{1112D}-\u{11134}\u{11173}\u{11180}\u{11181}\u{111B6}-\u{111BE}\u{111C9}-\u{111CC}\u{111CF}\u{1122F}-\u{11231}\u{11234}\u{11236}\u{11237}\u{1123E}\u{11241}\u{112DF}\u{112E3}-\u{112EA}\u{11300}\u{11301}\u{1133B}\u{1133C}\u{11340}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113BB}-\u{113C0}\u{113CE}\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11438}-\u{1143F}\u{11442}-\u{11444}\u{11446}\u{1145E}\u{114B3}-\u{114B8}\u{114BA}\u{114BF}\u{114C0}\u{114C2}\u{114C3}\u{115B2}-\u{115B5}\u{115BC}\u{115BD}\u{115BF}\u{115C0}\u{115DC}\u{115DD}\u{11633}-\u{1163A}\u{1163D}\u{1163F}\u{11640}\u{116AB}\u{116AD}\u{116B0}-\u{116B5}\u{116B7}\u{1171D}\u{1171F}\u{11722}-\u{11725}\u{11727}-\u{1172B}\u{1182F}-\u{11837}\u{11839}\u{1183A}\u{1193B}\u{1193C}\u{1193E}\u{11943}\u{119D4}-\u{119D7}\u{119DA}\u{119DB}\u{119E0}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A38}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A56}\u{11A59}-\u{11A5B}\u{11A8A}-\u{11A96}\u{11A98}\u{11A99}\u{11C30}-\u{11C36}\u{11C38}-\u{11C3D}\u{11C3F}\u{11C92}-\u{11CA7}\u{11CAA}-\u{11CB0}\u{11CB2}\u{11CB3}\u{11CB5}\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D90}\u{11D91}\u{11D95}\u{11D97}\u{11EF3}\u{11EF4}\u{11F00}\u{11F01}\u{11F36}-\u{11F3A}\u{11F40}\u{11F42}\u{11F5A}\u{13430}-\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{16129}\u{1612D}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F8F}-\u{16F92}\u{16FE4}\u{1BC9D}\u{1BC9E}\u{1BCA0}-\u{1BCA3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D167}-\u{1D169}\u{1D173}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94B}\u{E0001}\u{E0020}-\u{E007F}\u{E0100}-\u{E01EF}]*\u200C[\xAD\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u061C\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u070F\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u200B\u200E\u200F\u202A-\u202E\u2060-\u2064\u206A-\u206F\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFEFF\uFFF9-\uFFFB\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6D}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11001}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11081}\u{110B3}-\u{110B6}\u{110B9}\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{1112B}\u{1112D}-\u{11134}\u{11173}\u{11180}\u{11181}\u{111B6}-\u{111BE}\u{111C9}-\u{111CC}\u{111CF}\u{1122F}-\u{11231}\u{11234}\u{11236}\u{11237}\u{1123E}\u{11241}\u{112DF}\u{112E3}-\u{112EA}\u{11300}\u{11301}\u{1133B}\u{1133C}\u{11340}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113BB}-\u{113C0}\u{113CE}\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11438}-\u{1143F}\u{11442}-\u{11444}\u{11446}\u{1145E}\u{114B3}-\u{114B8}\u{114BA}\u{114BF}\u{114C0}\u{114C2}\u{114C3}\u{115B2}-\u{115B5}\u{115BC}\u{115BD}\u{115BF}\u{115C0}\u{115DC}\u{115DD}\u{11633}-\u{1163A}\u{1163D}\u{1163F}\u{11640}\u{116AB}\u{116AD}\u{116B0}-\u{116B5}\u{116B7}\u{1171D}\u{1171F}\u{11722}-\u{11725}\u{11727}-\u{1172B}\u{1182F}-\u{11837}\u{11839}\u{1183A}\u{1193B}\u{1193C}\u{1193E}\u{11943}\u{119D4}-\u{119D7}\u{119DA}\u{119DB}\u{119E0}\u{11A01}-\u{11A0A}\u{11A33}-\u{11A38}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A56}\u{11A59}-\u{11A5B}\u{11A8A}-\u{11A96}\u{11A98}\u{11A99}\u{11C30}-\u{11C36}\u{11C38}-\u{11C3D}\u{11C3F}\u{11C92}-\u{11CA7}\u{11CAA}-\u{11CB0}\u{11CB2}\u{11CB3}\u{11CB5}\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D90}\u{11D91}\u{11D95}\u{11D97}\u{11EF3}\u{11EF4}\u{11F00}\u{11F01}\u{11F36}-\u{11F3A}\u{11F40}\u{11F42}\u{11F5A}\u{13430}-\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{16129}\u{1612D}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F8F}-\u{16F92}\u{16FE4}\u{1BC9D}\u{1BC9E}\u{1BCA0}-\u{1BCA3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D167}-\u{1D169}\u{1D173}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94B}\u{E0001}\u{E0020}-\u{E007F}\u{E0100}-\u{E01EF}]*[\u0620\u0622-\u063F\u0641-\u064A\u066E\u066F\u0671-\u0673\u0675-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u077F\u07CA-\u07EA\u0840-\u0858\u0860\u0862-\u0865\u0867-\u086A\u0870-\u0882\u0886\u0889-\u088E\u08A0-\u08AC\u08AE-\u08C8\u1807\u1820-\u1878\u1887-\u18A8\u18AA\uA840-\uA871\u{10AC0}-\u{10AC5}\u{10AC7}\u{10AC9}\u{10ACA}\u{10ACE}-\u{10AD6}\u{10AD8}-\u{10AE1}\u{10AE4}\u{10AEB}-\u{10AEF}\u{10B80}-\u{10B91}\u{10BA9}-\u{10BAE}\u{10D01}-\u{10D23}\u{10EC2}-\u{10EC4}\u{10F30}-\u{10F44}\u{10F51}-\u{10F54}\u{10F70}-\u{10F81}\u{10FB0}\u{10FB2}-\u{10FB6}\u{10FB8}-\u{10FBF}\u{10FC1}-\u{10FC4}\u{10FC9}\u{10FCA}\u{1E900}-\u{1E943}]/u,bidiDomain:/[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05EA\u05EF-\u05F4\u0600-\u0605\u0608\u060B\u060D\u061B-\u064A\u0660-\u0669\u066B-\u066F\u0671-\u06D5\u06DD\u06E5\u06E6\u06EE\u06EF\u06FA-\u070D\u070F\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u083E\u0840-\u0858\u085E\u0860-\u086A\u0870-\u088E\u0890\u0891\u08A0-\u08C9\u08E2\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE70-\uFE74\uFE76-\uFEFC\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{10920}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A40}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE4}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D23}\u{10D30}-\u{10D39}\u{10D40}-\u{10D65}\u{10D6F}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E60}-\u{10E7E}\u{10E80}-\u{10EA9}\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10F00}-\u{10F27}\u{10F30}-\u{10F45}\u{10F51}-\u{10F59}\u{10F70}-\u{10F81}\u{10F86}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8CF}\u{1E900}-\u{1E943}\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}]/u,bidiS1LTR:/[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u02BB-\u02C1\u02D0\u02D1\u02E0-\u02E4\u02EE\u0370-\u0373\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0482\u048A-\u052F\u0531-\u0556\u0559-\u0589\u0903-\u0939\u093B\u093D-\u0940\u0949-\u094C\u094E-\u0950\u0958-\u0961\u0964-\u0980\u0982\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C0\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09FA\u09FC\u09FD\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A40\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A76\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC0\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0\u0AE1\u0AE6-\u0AF0\u0AF9\u0B02\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B3E\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0B57\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C01-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C41-\u0C44\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C77\u0C7F\u0C80\u0C82-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA\u0CCB\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D02-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D4F\u0D54-\u0D61\u0D66-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E4F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F17\u0F1A-\u0F34\u0F36\u0F38\u0F3E-\u0F47\u0F49-\u0F6C\u0F7F\u0F85\u0F88-\u0F8C\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u1000-\u102C\u1031\u1038\u103B\u103C\u103F-\u1057\u105A-\u105D\u1061-\u1070\u1075-\u1081\u1083\u1084\u1087-\u108C\u108E-\u109C\u109E-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1360-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u167F\u1681-\u169A\u16A0-\u16F8\u1700-\u1711\u1715\u171F-\u1731\u1734-\u1736\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17B6\u17BE-\u17C5\u17C7\u17C8\u17D4-\u17DA\u17DC\u17E0-\u17E9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A19\u1A1A\u1A1E-\u1A55\u1A57\u1A61\u1A63\u1A64\u1A6D-\u1A72\u1A80-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1B04-\u1B33\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B4C\u1B4E-\u1B6A\u1B74-\u1B7F\u1B82-\u1BA1\u1BA6\u1BA7\u1BAA\u1BAE-\u1BE5\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1BFC-\u1C2B\u1C34\u1C35\u1C3B-\u1C49\u1C4D-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD3\u1CE1\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5-\u1CF7\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200E\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u214F\u2160-\u2188\u2336-\u237A\u2395\u249C-\u24E9\u26AC\u2800-\u28FF\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u302E\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31BF\u31F0-\u321C\u3220-\u324F\u3260-\u327B\u327F-\u32B0\u32C0-\u32CB\u32D0-\u3376\u337B-\u33DD\u33E0-\u33FE\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA60C\uA610-\uA62B\uA640-\uA66E\uA680-\uA69D\uA6A0-\uA6EF\uA6F2-\uA6F7\uA722-\uA787\uA789-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA824\uA827\uA830-\uA837\uA840-\uA873\uA880-\uA8C3\uA8CE-\uA8D9\uA8F2-\uA8FE\uA900-\uA925\uA92E-\uA946\uA952\uA953\uA95F-\uA97C\uA983-\uA9B2\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA2F\uAA30\uAA33\uAA34\uAA40-\uAA42\uAA44-\uAA4B\uAA4D\uAA50-\uAA59\uAA5C-\uAA7B\uAA7D-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAAEB\uAAEE-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB69\uAB70-\uABE4\uABE6\uABE7\uABE9-\uABEC\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uD800-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10100}\u{10102}\u{10107}-\u{10133}\u{10137}-\u{1013F}\u{1018D}\u{1018E}\u{101D0}-\u{101FC}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{10300}-\u{10323}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{1039F}-\u{103C3}\u{103C8}-\u{103D5}\u{10400}-\u{1049D}\u{104A0}-\u{104A9}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{1056F}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{105C0}-\u{105F3}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{11000}\u{11002}-\u{11037}\u{11047}-\u{1104D}\u{11066}-\u{1106F}\u{11071}\u{11072}\u{11075}\u{11082}-\u{110B2}\u{110B7}\u{110B8}\u{110BB}-\u{110C1}\u{110CD}\u{110D0}-\u{110E8}\u{110F0}-\u{110F9}\u{11103}-\u{11126}\u{1112C}\u{11136}-\u{11147}\u{11150}-\u{11172}\u{11174}-\u{11176}\u{11182}-\u{111B5}\u{111BF}-\u{111C8}\u{111CD}\u{111CE}\u{111D0}-\u{111DF}\u{111E1}-\u{111F4}\u{11200}-\u{11211}\u{11213}-\u{1122E}\u{11232}\u{11233}\u{11235}\u{11238}-\u{1123D}\u{1123F}\u{11240}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A9}\u{112B0}-\u{112DE}\u{112E0}-\u{112E2}\u{112F0}-\u{112F9}\u{11302}\u{11303}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}-\u{1133F}\u{11341}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11350}\u{11357}\u{1135D}-\u{11363}\u{11380}-\u{11389}\u{1138B}\u{1138E}\u{11390}-\u{113B5}\u{113B7}-\u{113BA}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}\u{113CD}\u{113CF}\u{113D1}\u{113D3}-\u{113D5}\u{113D7}\u{113D8}\u{11400}-\u{11437}\u{11440}\u{11441}\u{11445}\u{11447}-\u{1145B}\u{1145D}\u{1145F}-\u{11461}\u{11480}-\u{114B2}\u{114B9}\u{114BB}-\u{114BE}\u{114C1}\u{114C4}-\u{114C7}\u{114D0}-\u{114D9}\u{11580}-\u{115B1}\u{115B8}-\u{115BB}\u{115BE}\u{115C1}-\u{115DB}\u{11600}-\u{11632}\u{1163B}\u{1163C}\u{1163E}\u{11641}-\u{11644}\u{11650}-\u{11659}\u{11680}-\u{116AA}\u{116AC}\u{116AE}\u{116AF}\u{116B6}\u{116B8}\u{116B9}\u{116C0}-\u{116C9}\u{116D0}-\u{116E3}\u{11700}-\u{1171A}\u{1171E}\u{11720}\u{11721}\u{11726}\u{11730}-\u{11746}\u{11800}-\u{1182E}\u{11838}\u{1183B}\u{118A0}-\u{118F2}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{11935}\u{11937}\u{11938}\u{1193D}\u{1193F}-\u{11942}\u{11944}-\u{11946}\u{11950}-\u{11959}\u{119A0}-\u{119A7}\u{119AA}-\u{119D3}\u{119DC}-\u{119DF}\u{119E1}-\u{119E4}\u{11A00}\u{11A07}\u{11A08}\u{11A0B}-\u{11A32}\u{11A39}\u{11A3A}\u{11A3F}-\u{11A46}\u{11A50}\u{11A57}\u{11A58}\u{11A5C}-\u{11A89}\u{11A97}\u{11A9A}-\u{11AA2}\u{11AB0}-\u{11AF8}\u{11B00}-\u{11B09}\u{11BC0}-\u{11BE1}\u{11BF0}-\u{11BF9}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2F}\u{11C3E}-\u{11C45}\u{11C50}-\u{11C6C}\u{11C70}-\u{11C8F}\u{11CA9}\u{11CB1}\u{11CB4}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D50}-\u{11D59}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D8E}\u{11D93}\u{11D94}\u{11D96}\u{11D98}\u{11DA0}-\u{11DA9}\u{11EE0}-\u{11EF2}\u{11EF5}-\u{11EF8}\u{11F02}-\u{11F10}\u{11F12}-\u{11F35}\u{11F3E}\u{11F3F}\u{11F41}\u{11F43}-\u{11F59}\u{11FB0}\u{11FC0}-\u{11FD4}\u{11FFF}-\u{12399}\u{12400}-\u{1246E}\u{12470}-\u{12474}\u{12480}-\u{12543}\u{12F90}-\u{12FF2}\u{13000}-\u{1343F}\u{13441}-\u{13446}\u{13460}-\u{143FA}\u{14400}-\u{14646}\u{16100}-\u{1611D}\u{1612A}-\u{1612C}\u{16130}-\u{16139}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A60}-\u{16A69}\u{16A6E}-\u{16ABE}\u{16AC0}-\u{16AC9}\u{16AD0}-\u{16AED}\u{16AF5}\u{16B00}-\u{16B2F}\u{16B37}-\u{16B45}\u{16B50}-\u{16B59}\u{16B5B}-\u{16B61}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16D40}-\u{16D79}\u{16E40}-\u{16E9A}\u{16F00}-\u{16F4A}\u{16F50}-\u{16F87}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{16FF0}\u{16FF1}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18CFF}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1BC9C}\u{1BC9F}\u{1CCD6}-\u{1CCEF}\u{1CF50}-\u{1CFC3}\u{1D000}-\u{1D0F5}\u{1D100}-\u{1D126}\u{1D129}-\u{1D166}\u{1D16A}-\u{1D172}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D1E8}\u{1D2C0}-\u{1D2D3}\u{1D2E0}-\u{1D2F3}\u{1D360}-\u{1D378}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1D800}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA8B}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E030}-\u{1E06D}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E140}-\u{1E149}\u{1E14E}\u{1E14F}\u{1E290}-\u{1E2AD}\u{1E2C0}-\u{1E2EB}\u{1E2F0}-\u{1E2F9}\u{1E4D0}-\u{1E4EB}\u{1E4F0}-\u{1E4F9}\u{1E5D0}-\u{1E5ED}\u{1E5F0}-\u{1E5FA}\u{1E5FF}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1F110}-\u{1F12E}\u{1F130}-\u{1F169}\u{1F170}-\u{1F1AC}\u{1F1E6}-\u{1F202}\u{1F210}-\u{1F23B}\u{1F240}-\u{1F248}\u{1F250}\u{1F251}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}\u{F0000}-\u{FFFFD}\u{100000}-\u{10FFFD}]/u,bidiS1RTL:/[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05EA\u05EF-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u070D\u070F\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u083E\u0840-\u0858\u085E\u0860-\u086A\u0870-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE70-\uFE74\uFE76-\uFEFC\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{10920}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A40}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE4}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D23}\u{10D4A}-\u{10D65}\u{10D6F}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E80}-\u{10EA9}\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10F00}-\u{10F27}\u{10F30}-\u{10F45}\u{10F51}-\u{10F59}\u{10F70}-\u{10F81}\u{10F86}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8CF}\u{1E900}-\u{1E943}\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}]/u,bidiS2:/^[\0-\x08\x0E-\x1B!-@\[-`\{-\x84\x86-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02B9\u02BA\u02C2-\u02CF\u02D2-\u02DF\u02E5-\u02ED\u02EF-\u036F\u0374\u0375\u037E\u0384\u0385\u0387\u03F6\u0483-\u0489\u058A\u058D-\u058F\u0591-\u05C7\u05D0-\u05EA\u05EF-\u05F4\u0600-\u070D\u070F-\u074A\u074D-\u07B1\u07C0-\u07FA\u07FD-\u082D\u0830-\u083E\u0840-\u085B\u085E\u0860-\u086A\u0870-\u088E\u0890\u0891\u0897-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09F2\u09F3\u09FB\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AF1\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0BF3-\u0BFA\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C78-\u0C7E\u0C81\u0CBC\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E3F\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39-\u0F3D\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1390-\u1399\u1400\u169B\u169C\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DB\u17DD\u17F0-\u17F9\u1800-\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1940\u1944\u1945\u19DE-\u19FF\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u200B-\u200D\u200F-\u2027\u202F-\u205E\u2060-\u2064\u206A-\u2070\u2074-\u207E\u2080-\u208E\u20A0-\u20C0\u20D0-\u20F0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u2150-\u215F\u2189-\u218B\u2190-\u2335\u237B-\u2394\u2396-\u2429\u2440-\u244A\u2460-\u249B\u24EA-\u26AB\u26AD-\u27FF\u2900-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF9-\u2CFF\u2D7F\u2DE0-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u3004\u3008-\u3020\u302A-\u302D\u3030\u3036\u3037\u303D-\u303F\u3099-\u309C\u30A0\u30FB\u31C0-\u31E5\u31EF\u321D\u321E\u3250-\u325F\u327C-\u327E\u32B1-\u32BF\u32CC-\u32CF\u3377-\u337A\u33DE\u33DF\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA60D-\uA60F\uA66F-\uA67F\uA69E\uA69F\uA6F0\uA6F1\uA700-\uA721\uA788\uA802\uA806\uA80B\uA825\uA826\uA828-\uA82C\uA838\uA839\uA874-\uA877\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uAB6A\uAB6B\uABE5\uABE8\uABED\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD8F\uFD92-\uFDC7\uFDCF\uFDF0-\uFE19\uFE20-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE74\uFE76-\uFEFC\uFEFF\uFF01-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD\u{10101}\u{10140}-\u{1018C}\u{10190}-\u{1019C}\u{101A0}\u{101FD}\u{102E0}-\u{102FB}\u{10376}-\u{1037A}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{1091F}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A38}-\u{10A3A}\u{10A3F}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE6}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B39}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D27}\u{10D30}-\u{10D39}\u{10D40}-\u{10D65}\u{10D69}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E60}-\u{10E7E}\u{10E80}-\u{10EA9}\u{10EAB}-\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10EFC}-\u{10F27}\u{10F30}-\u{10F59}\u{10F70}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{11001}\u{11038}-\u{11046}\u{11052}-\u{11065}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11081}\u{110B3}-\u{110B6}\u{110B9}\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{1112B}\u{1112D}-\u{11134}\u{11173}\u{11180}\u{11181}\u{111B6}-\u{111BE}\u{111C9}-\u{111CC}\u{111CF}\u{1122F}-\u{11231}\u{11234}\u{11236}\u{11237}\u{1123E}\u{11241}\u{112DF}\u{112E3}-\u{112EA}\u{11300}\u{11301}\u{1133B}\u{1133C}\u{11340}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113BB}-\u{113C0}\u{113CE}\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11438}-\u{1143F}\u{11442}-\u{11444}\u{11446}\u{1145E}\u{114B3}-\u{114B8}\u{114BA}\u{114BF}\u{114C0}\u{114C2}\u{114C3}\u{115B2}-\u{115B5}\u{115BC}\u{115BD}\u{115BF}\u{115C0}\u{115DC}\u{115DD}\u{11633}-\u{1163A}\u{1163D}\u{1163F}\u{11640}\u{11660}-\u{1166C}\u{116AB}\u{116AD}\u{116B0}-\u{116B5}\u{116B7}\u{1171D}\u{1171F}\u{11722}-\u{11725}\u{11727}-\u{1172B}\u{1182F}-\u{11837}\u{11839}\u{1183A}\u{1193B}\u{1193C}\u{1193E}\u{11943}\u{119D4}-\u{119D7}\u{119DA}\u{119DB}\u{119E0}\u{11A01}-\u{11A06}\u{11A09}\u{11A0A}\u{11A33}-\u{11A38}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A56}\u{11A59}-\u{11A5B}\u{11A8A}-\u{11A96}\u{11A98}\u{11A99}\u{11C30}-\u{11C36}\u{11C38}-\u{11C3D}\u{11C92}-\u{11CA7}\u{11CAA}-\u{11CB0}\u{11CB2}\u{11CB3}\u{11CB5}\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D90}\u{11D91}\u{11D95}\u{11D97}\u{11EF3}\u{11EF4}\u{11F00}\u{11F01}\u{11F36}-\u{11F3A}\u{11F40}\u{11F42}\u{11F5A}\u{11FD5}-\u{11FF1}\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{16129}\u{1612D}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F8F}-\u{16F92}\u{16FE2}\u{16FE4}\u{1BC9D}\u{1BC9E}\u{1BCA0}-\u{1BCA3}\u{1CC00}-\u{1CCD5}\u{1CCF0}-\u{1CCF9}\u{1CD00}-\u{1CEB3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D167}-\u{1D169}\u{1D173}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D1E9}\u{1D1EA}\u{1D200}-\u{1D245}\u{1D300}-\u{1D356}\u{1D6C1}\u{1D6DB}\u{1D6FB}\u{1D715}\u{1D735}\u{1D74F}\u{1D76F}\u{1D789}\u{1D7A9}\u{1D7C3}\u{1D7CE}-\u{1D7FF}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E2FF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8D6}\u{1E900}-\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{1EEF0}\u{1EEF1}\u{1F000}-\u{1F02B}\u{1F030}-\u{1F093}\u{1F0A0}-\u{1F0AE}\u{1F0B1}-\u{1F0BF}\u{1F0C1}-\u{1F0CF}\u{1F0D1}-\u{1F0F5}\u{1F100}-\u{1F10F}\u{1F12F}\u{1F16A}-\u{1F16F}\u{1F1AD}\u{1F260}-\u{1F265}\u{1F300}-\u{1F6D7}\u{1F6DC}-\u{1F6EC}\u{1F6F0}-\u{1F6FC}\u{1F700}-\u{1F776}\u{1F77B}-\u{1F7D9}\u{1F7E0}-\u{1F7EB}\u{1F7F0}\u{1F800}-\u{1F80B}\u{1F810}-\u{1F847}\u{1F850}-\u{1F859}\u{1F860}-\u{1F887}\u{1F890}-\u{1F8AD}\u{1F8B0}-\u{1F8BB}\u{1F8C0}\u{1F8C1}\u{1F900}-\u{1FA53}\u{1FA60}-\u{1FA6D}\u{1FA70}-\u{1FA7C}\u{1FA80}-\u{1FA89}\u{1FA8F}-\u{1FAC6}\u{1FACE}-\u{1FADC}\u{1FADF}-\u{1FAE9}\u{1FAF0}-\u{1FAF8}\u{1FB00}-\u{1FB92}\u{1FB94}-\u{1FBF9}\u{E0001}\u{E0020}-\u{E007F}\u{E0100}-\u{E01EF}]*$/u,bidiS3:/[0-9\xB2\xB3\xB9\u05BE\u05C0\u05C3\u05C6\u05D0-\u05EA\u05EF-\u05F4\u0600-\u0605\u0608\u060B\u060D\u061B-\u064A\u0660-\u0669\u066B-\u066F\u0671-\u06D5\u06DD\u06E5\u06E6\u06EE-\u070D\u070F\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u083E\u0840-\u0858\u085E\u0860-\u086A\u0870-\u088E\u0890\u0891\u08A0-\u08C9\u08E2\u200F\u2070\u2074-\u2079\u2080-\u2089\u2488-\u249B\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBC2\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\u{102E1}-\u{102FB}\u{10800}-\u{10805}\u{10808}\u{1080A}-\u{10835}\u{10837}\u{10838}\u{1083C}\u{1083F}-\u{10855}\u{10857}-\u{1089E}\u{108A7}-\u{108AF}\u{108E0}-\u{108F2}\u{108F4}\u{108F5}\u{108FB}-\u{1091B}\u{10920}-\u{10939}\u{1093F}\u{10980}-\u{109B7}\u{109BC}-\u{109CF}\u{109D2}-\u{10A00}\u{10A10}-\u{10A13}\u{10A15}-\u{10A17}\u{10A19}-\u{10A35}\u{10A40}-\u{10A48}\u{10A50}-\u{10A58}\u{10A60}-\u{10A9F}\u{10AC0}-\u{10AE4}\u{10AEB}-\u{10AF6}\u{10B00}-\u{10B35}\u{10B40}-\u{10B55}\u{10B58}-\u{10B72}\u{10B78}-\u{10B91}\u{10B99}-\u{10B9C}\u{10BA9}-\u{10BAF}\u{10C00}-\u{10C48}\u{10C80}-\u{10CB2}\u{10CC0}-\u{10CF2}\u{10CFA}-\u{10D23}\u{10D30}-\u{10D39}\u{10D40}-\u{10D65}\u{10D6F}-\u{10D85}\u{10D8E}\u{10D8F}\u{10E60}-\u{10E7E}\u{10E80}-\u{10EA9}\u{10EAD}\u{10EB0}\u{10EB1}\u{10EC2}-\u{10EC4}\u{10F00}-\u{10F27}\u{10F30}-\u{10F45}\u{10F51}-\u{10F59}\u{10F70}-\u{10F81}\u{10F86}-\u{10F89}\u{10FB0}-\u{10FCB}\u{10FE0}-\u{10FF6}\u{1CCF0}-\u{1CCF9}\u{1D7CE}-\u{1D7FF}\u{1E800}-\u{1E8C4}\u{1E8C7}-\u{1E8CF}\u{1E900}-\u{1E943}\u{1E94B}\u{1E950}-\u{1E959}\u{1E95E}\u{1E95F}\u{1EC71}-\u{1ECB4}\u{1ED01}-\u{1ED3D}\u{1EE00}-\u{1EE03}\u{1EE05}-\u{1EE1F}\u{1EE21}\u{1EE22}\u{1EE24}\u{1EE27}\u{1EE29}-\u{1EE32}\u{1EE34}-\u{1EE37}\u{1EE39}\u{1EE3B}\u{1EE42}\u{1EE47}\u{1EE49}\u{1EE4B}\u{1EE4D}-\u{1EE4F}\u{1EE51}\u{1EE52}\u{1EE54}\u{1EE57}\u{1EE59}\u{1EE5B}\u{1EE5D}\u{1EE5F}\u{1EE61}\u{1EE62}\u{1EE64}\u{1EE67}-\u{1EE6A}\u{1EE6C}-\u{1EE72}\u{1EE74}-\u{1EE77}\u{1EE79}-\u{1EE7C}\u{1EE7E}\u{1EE80}-\u{1EE89}\u{1EE8B}-\u{1EE9B}\u{1EEA1}-\u{1EEA3}\u{1EEA5}-\u{1EEA9}\u{1EEAB}-\u{1EEBB}\u{1F100}-\u{1F10A}\u{1FBF0}-\u{1FBF9}][\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6D}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11001}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11081}\u{110B3}-\u{110B6}\u{110B9}\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{1112B}\u{1112D}-\u{11134}\u{11173}\u{11180}\u{11181}\u{111B6}-\u{111BE}\u{111C9}-\u{111CC}\u{111CF}\u{1122F}-\u{11231}\u{11234}\u{11236}\u{11237}\u{1123E}\u{11241}\u{112DF}\u{112E3}-\u{112EA}\u{11300}\u{11301}\u{1133B}\u{1133C}\u{11340}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113BB}-\u{113C0}\u{113CE}\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11438}-\u{1143F}\u{11442}-\u{11444}\u{11446}\u{1145E}\u{114B3}-\u{114B8}\u{114BA}\u{114BF}\u{114C0}\u{114C2}\u{114C3}\u{115B2}-\u{115B5}\u{115BC}\u{115BD}\u{115BF}\u{115C0}\u{115DC}\u{115DD}\u{11633}-\u{1163A}\u{1163D}\u{1163F}\u{11640}\u{116AB}\u{116AD}\u{116B0}-\u{116B5}\u{116B7}\u{1171D}\u{1171F}\u{11722}-\u{11725}\u{11727}-\u{1172B}\u{1182F}-\u{11837}\u{11839}\u{1183A}\u{1193B}\u{1193C}\u{1193E}\u{11943}\u{119D4}-\u{119D7}\u{119DA}\u{119DB}\u{119E0}\u{11A01}-\u{11A06}\u{11A09}\u{11A0A}\u{11A33}-\u{11A38}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A56}\u{11A59}-\u{11A5B}\u{11A8A}-\u{11A96}\u{11A98}\u{11A99}\u{11C30}-\u{11C36}\u{11C38}-\u{11C3D}\u{11C92}-\u{11CA7}\u{11CAA}-\u{11CB0}\u{11CB2}\u{11CB3}\u{11CB5}\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D90}\u{11D91}\u{11D95}\u{11D97}\u{11EF3}\u{11EF4}\u{11F00}\u{11F01}\u{11F36}-\u{11F3A}\u{11F40}\u{11F42}\u{11F5A}\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{16129}\u{1612D}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F8F}-\u{16F92}\u{16FE4}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D167}-\u{1D169}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]*$/u,bidiS4EN:/[0-9\xB2\xB3\xB9\u06F0-\u06F9\u2070\u2074-\u2079\u2080-\u2089\u2488-\u249B\uFF10-\uFF19\u{102E1}-\u{102FB}\u{1CCF0}-\u{1CCF9}\u{1D7CE}-\u{1D7FF}\u{1F100}-\u{1F10A}\u{1FBF0}-\u{1FBF9}]/u,bidiS4AN:/[\u0600-\u0605\u0660-\u0669\u066B\u066C\u06DD\u0890\u0891\u08E2\u{10D30}-\u{10D39}\u{10D40}-\u{10D49}\u{10E60}-\u{10E7E}]/u,bidiS5:/^[\0-\x08\x0E-\x1B!-\x84\x86-\u0377\u037A-\u037F\u0384-\u038A\u038C\u038E-\u03A1\u03A3-\u052F\u0531-\u0556\u0559-\u058A\u058D-\u058F\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0606\u0607\u0609\u060A\u060C\u060E-\u061A\u064B-\u065F\u066A\u0670\u06D6-\u06DC\u06DE-\u06E4\u06E7-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07F6-\u07F9\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A76\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BFA\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C77-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4F\u0D54-\u0D63\u0D66-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E3A\u0E3F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F47\u0F49-\u0F6C\u0F71-\u0F97\u0F99-\u0FBC\u0FBE-\u0FCC\u0FCE-\u0FDA\u1000-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u137C\u1380-\u1399\u13A0-\u13F5\u13F8-\u13FD\u1400-\u167F\u1681-\u169C\u16A0-\u16F8\u1700-\u1715\u171F-\u1736\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17DD\u17E0-\u17E9\u17F0-\u17F9\u1800-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1940\u1944-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u19DE-\u1A1B\u1A1E-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1AB0-\u1ACE\u1B00-\u1B4C\u1B4E-\u1BF3\u1BFC-\u1C37\u1C3B-\u1C49\u1C4D-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD0-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u200B-\u200E\u2010-\u2027\u202F-\u205E\u2060-\u2064\u206A-\u2071\u2074-\u208E\u2090-\u209C\u20A0-\u20C0\u20D0-\u20F0\u2100-\u218B\u2190-\u2429\u2440-\u244A\u2460-\u2B73\u2B76-\u2B95\u2B97-\u2CF3\u2CF9-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2E5D\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3001-\u303F\u3041-\u3096\u3099-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31E5\u31EF-\u321E\u3220-\uA48C\uA490-\uA4C6\uA4D0-\uA62B\uA640-\uA6F7\uA700-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA82C\uA830-\uA839\uA840-\uA877\uA880-\uA8C5\uA8CE-\uA8D9\uA8E0-\uA953\uA95F-\uA97C\uA980-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA5C-\uAAC2\uAADB-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB6B\uAB70-\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uD800-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1E\uFB29\uFD3E-\uFD4F\uFDCF\uFDFD-\uFE19\uFE20-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFEFF\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFF9-\uFFFD\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10100}-\u{10102}\u{10107}-\u{10133}\u{10137}-\u{1018E}\u{10190}-\u{1019C}\u{101A0}\u{101D0}-\u{101FD}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{102E0}-\u{102FB}\u{10300}-\u{10323}\u{1032D}-\u{1034A}\u{10350}-\u{1037A}\u{10380}-\u{1039D}\u{1039F}-\u{103C3}\u{103C8}-\u{103D5}\u{10400}-\u{1049D}\u{104A0}-\u{104A9}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{1056F}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{105C0}-\u{105F3}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{1091F}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10B39}-\u{10B3F}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6E}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11000}-\u{1104D}\u{11052}-\u{11075}\u{1107F}-\u{110C2}\u{110CD}\u{110D0}-\u{110E8}\u{110F0}-\u{110F9}\u{11100}-\u{11134}\u{11136}-\u{11147}\u{11150}-\u{11176}\u{11180}-\u{111DF}\u{111E1}-\u{111F4}\u{11200}-\u{11211}\u{11213}-\u{11241}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A9}\u{112B0}-\u{112EA}\u{112F0}-\u{112F9}\u{11300}-\u{11303}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133B}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11350}\u{11357}\u{1135D}-\u{11363}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{11380}-\u{11389}\u{1138B}\u{1138E}\u{11390}-\u{113B5}\u{113B7}-\u{113C0}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}-\u{113D5}\u{113D7}\u{113D8}\u{113E1}\u{113E2}\u{11400}-\u{1145B}\u{1145D}-\u{11461}\u{11480}-\u{114C7}\u{114D0}-\u{114D9}\u{11580}-\u{115B5}\u{115B8}-\u{115DD}\u{11600}-\u{11644}\u{11650}-\u{11659}\u{11660}-\u{1166C}\u{11680}-\u{116B9}\u{116C0}-\u{116C9}\u{116D0}-\u{116E3}\u{11700}-\u{1171A}\u{1171D}-\u{1172B}\u{11730}-\u{11746}\u{11800}-\u{1183B}\u{118A0}-\u{118F2}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{11935}\u{11937}\u{11938}\u{1193B}-\u{11946}\u{11950}-\u{11959}\u{119A0}-\u{119A7}\u{119AA}-\u{119D7}\u{119DA}-\u{119E4}\u{11A00}-\u{11A47}\u{11A50}-\u{11AA2}\u{11AB0}-\u{11AF8}\u{11B00}-\u{11B09}\u{11BC0}-\u{11BE1}\u{11BF0}-\u{11BF9}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C36}\u{11C38}-\u{11C45}\u{11C50}-\u{11C6C}\u{11C70}-\u{11C8F}\u{11C92}-\u{11CA7}\u{11CA9}-\u{11CB6}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D47}\u{11D50}-\u{11D59}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D8E}\u{11D90}\u{11D91}\u{11D93}-\u{11D98}\u{11DA0}-\u{11DA9}\u{11EE0}-\u{11EF8}\u{11F00}-\u{11F10}\u{11F12}-\u{11F3A}\u{11F3E}-\u{11F5A}\u{11FB0}\u{11FC0}-\u{11FF1}\u{11FFF}-\u{12399}\u{12400}-\u{1246E}\u{12470}-\u{12474}\u{12480}-\u{12543}\u{12F90}-\u{12FF2}\u{13000}-\u{13455}\u{13460}-\u{143FA}\u{14400}-\u{14646}\u{16100}-\u{16139}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A60}-\u{16A69}\u{16A6E}-\u{16ABE}\u{16AC0}-\u{16AC9}\u{16AD0}-\u{16AED}\u{16AF0}-\u{16AF5}\u{16B00}-\u{16B45}\u{16B50}-\u{16B59}\u{16B5B}-\u{16B61}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16D40}-\u{16D79}\u{16E40}-\u{16E9A}\u{16F00}-\u{16F4A}\u{16F4F}-\u{16F87}\u{16F8F}-\u{16F9F}\u{16FE0}-\u{16FE4}\u{16FF0}\u{16FF1}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18CFF}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1BC9C}-\u{1BCA3}\u{1CC00}-\u{1CCF9}\u{1CD00}-\u{1CEB3}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1CF50}-\u{1CFC3}\u{1D000}-\u{1D0F5}\u{1D100}-\u{1D126}\u{1D129}-\u{1D1EA}\u{1D200}-\u{1D245}\u{1D2C0}-\u{1D2D3}\u{1D2E0}-\u{1D2F3}\u{1D300}-\u{1D356}\u{1D360}-\u{1D378}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D7CB}\u{1D7CE}-\u{1DA8B}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E030}-\u{1E06D}\u{1E08F}\u{1E100}-\u{1E12C}\u{1E130}-\u{1E13D}\u{1E140}-\u{1E149}\u{1E14E}\u{1E14F}\u{1E290}-\u{1E2AE}\u{1E2C0}-\u{1E2F9}\u{1E2FF}\u{1E4D0}-\u{1E4F9}\u{1E5D0}-\u{1E5FA}\u{1E5FF}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{1EEF0}\u{1EEF1}\u{1F000}-\u{1F02B}\u{1F030}-\u{1F093}\u{1F0A0}-\u{1F0AE}\u{1F0B1}-\u{1F0BF}\u{1F0C1}-\u{1F0CF}\u{1F0D1}-\u{1F0F5}\u{1F100}-\u{1F1AD}\u{1F1E6}-\u{1F202}\u{1F210}-\u{1F23B}\u{1F240}-\u{1F248}\u{1F250}\u{1F251}\u{1F260}-\u{1F265}\u{1F300}-\u{1F6D7}\u{1F6DC}-\u{1F6EC}\u{1F6F0}-\u{1F6FC}\u{1F700}-\u{1F776}\u{1F77B}-\u{1F7D9}\u{1F7E0}-\u{1F7EB}\u{1F7F0}\u{1F800}-\u{1F80B}\u{1F810}-\u{1F847}\u{1F850}-\u{1F859}\u{1F860}-\u{1F887}\u{1F890}-\u{1F8AD}\u{1F8B0}-\u{1F8BB}\u{1F8C0}\u{1F8C1}\u{1F900}-\u{1FA53}\u{1FA60}-\u{1FA6D}\u{1FA70}-\u{1FA7C}\u{1FA80}-\u{1FA89}\u{1FA8F}-\u{1FAC6}\u{1FACE}-\u{1FADC}\u{1FADF}-\u{1FAE9}\u{1FAF0}-\u{1FAF8}\u{1FB00}-\u{1FB92}\u{1FB94}-\u{1FBF9}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}\u{E0001}\u{E0020}-\u{E007F}\u{E0100}-\u{E01EF}\u{F0000}-\u{FFFFD}\u{100000}-\u{10FFFD}]*$/u,bidiS6:/[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u02BB-\u02C1\u02D0\u02D1\u02E0-\u02E4\u02EE\u0370-\u0373\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0482\u048A-\u052F\u0531-\u0556\u0559-\u0589\u06F0-\u06F9\u0903-\u0939\u093B\u093D-\u0940\u0949-\u094C\u094E-\u0950\u0958-\u0961\u0964-\u0980\u0982\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C0\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09FA\u09FC\u09FD\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A40\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A76\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC0\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0\u0AE1\u0AE6-\u0AF0\u0AF9\u0B02\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B3E\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0B57\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C01-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C41-\u0C44\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C77\u0C7F\u0C80\u0C82-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA\u0CCB\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D02-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D4F\u0D54-\u0D61\u0D66-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E4F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F17\u0F1A-\u0F34\u0F36\u0F38\u0F3E-\u0F47\u0F49-\u0F6C\u0F7F\u0F85\u0F88-\u0F8C\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u1000-\u102C\u1031\u1038\u103B\u103C\u103F-\u1057\u105A-\u105D\u1061-\u1070\u1075-\u1081\u1083\u1084\u1087-\u108C\u108E-\u109C\u109E-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1360-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u167F\u1681-\u169A\u16A0-\u16F8\u1700-\u1711\u1715\u171F-\u1731\u1734-\u1736\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17B6\u17BE-\u17C5\u17C7\u17C8\u17D4-\u17DA\u17DC\u17E0-\u17E9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A19\u1A1A\u1A1E-\u1A55\u1A57\u1A61\u1A63\u1A64\u1A6D-\u1A72\u1A80-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1B04-\u1B33\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B4C\u1B4E-\u1B6A\u1B74-\u1B7F\u1B82-\u1BA1\u1BA6\u1BA7\u1BAA\u1BAE-\u1BE5\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1BFC-\u1C2B\u1C34\u1C35\u1C3B-\u1C49\u1C4D-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD3\u1CE1\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5-\u1CF7\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200E\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u214F\u2160-\u2188\u2336-\u237A\u2395\u2488-\u24E9\u26AC\u2800-\u28FF\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u302E\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31BF\u31F0-\u321C\u3220-\u324F\u3260-\u327B\u327F-\u32B0\u32C0-\u32CB\u32D0-\u3376\u337B-\u33DD\u33E0-\u33FE\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA60C\uA610-\uA62B\uA640-\uA66E\uA680-\uA69D\uA6A0-\uA6EF\uA6F2-\uA6F7\uA722-\uA787\uA789-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA824\uA827\uA830-\uA837\uA840-\uA873\uA880-\uA8C3\uA8CE-\uA8D9\uA8F2-\uA8FE\uA900-\uA925\uA92E-\uA946\uA952\uA953\uA95F-\uA97C\uA983-\uA9B2\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA2F\uAA30\uAA33\uAA34\uAA40-\uAA42\uAA44-\uAA4B\uAA4D\uAA50-\uAA59\uAA5C-\uAA7B\uAA7D-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAAEB\uAAEE-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB69\uAB70-\uABE4\uABE6\uABE7\uABE9-\uABEC\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uD800-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\u{10000}-\u{1000B}\u{1000D}-\u{10026}\u{10028}-\u{1003A}\u{1003C}\u{1003D}\u{1003F}-\u{1004D}\u{10050}-\u{1005D}\u{10080}-\u{100FA}\u{10100}\u{10102}\u{10107}-\u{10133}\u{10137}-\u{1013F}\u{1018D}\u{1018E}\u{101D0}-\u{101FC}\u{10280}-\u{1029C}\u{102A0}-\u{102D0}\u{102E1}-\u{102FB}\u{10300}-\u{10323}\u{1032D}-\u{1034A}\u{10350}-\u{10375}\u{10380}-\u{1039D}\u{1039F}-\u{103C3}\u{103C8}-\u{103D5}\u{10400}-\u{1049D}\u{104A0}-\u{104A9}\u{104B0}-\u{104D3}\u{104D8}-\u{104FB}\u{10500}-\u{10527}\u{10530}-\u{10563}\u{1056F}-\u{1057A}\u{1057C}-\u{1058A}\u{1058C}-\u{10592}\u{10594}\u{10595}\u{10597}-\u{105A1}\u{105A3}-\u{105B1}\u{105B3}-\u{105B9}\u{105BB}\u{105BC}\u{105C0}-\u{105F3}\u{10600}-\u{10736}\u{10740}-\u{10755}\u{10760}-\u{10767}\u{10780}-\u{10785}\u{10787}-\u{107B0}\u{107B2}-\u{107BA}\u{11000}\u{11002}-\u{11037}\u{11047}-\u{1104D}\u{11066}-\u{1106F}\u{11071}\u{11072}\u{11075}\u{11082}-\u{110B2}\u{110B7}\u{110B8}\u{110BB}-\u{110C1}\u{110CD}\u{110D0}-\u{110E8}\u{110F0}-\u{110F9}\u{11103}-\u{11126}\u{1112C}\u{11136}-\u{11147}\u{11150}-\u{11172}\u{11174}-\u{11176}\u{11182}-\u{111B5}\u{111BF}-\u{111C8}\u{111CD}\u{111CE}\u{111D0}-\u{111DF}\u{111E1}-\u{111F4}\u{11200}-\u{11211}\u{11213}-\u{1122E}\u{11232}\u{11233}\u{11235}\u{11238}-\u{1123D}\u{1123F}\u{11240}\u{11280}-\u{11286}\u{11288}\u{1128A}-\u{1128D}\u{1128F}-\u{1129D}\u{1129F}-\u{112A9}\u{112B0}-\u{112DE}\u{112E0}-\u{112E2}\u{112F0}-\u{112F9}\u{11302}\u{11303}\u{11305}-\u{1130C}\u{1130F}\u{11310}\u{11313}-\u{11328}\u{1132A}-\u{11330}\u{11332}\u{11333}\u{11335}-\u{11339}\u{1133D}-\u{1133F}\u{11341}-\u{11344}\u{11347}\u{11348}\u{1134B}-\u{1134D}\u{11350}\u{11357}\u{1135D}-\u{11363}\u{11380}-\u{11389}\u{1138B}\u{1138E}\u{11390}-\u{113B5}\u{113B7}-\u{113BA}\u{113C2}\u{113C5}\u{113C7}-\u{113CA}\u{113CC}\u{113CD}\u{113CF}\u{113D1}\u{113D3}-\u{113D5}\u{113D7}\u{113D8}\u{11400}-\u{11437}\u{11440}\u{11441}\u{11445}\u{11447}-\u{1145B}\u{1145D}\u{1145F}-\u{11461}\u{11480}-\u{114B2}\u{114B9}\u{114BB}-\u{114BE}\u{114C1}\u{114C4}-\u{114C7}\u{114D0}-\u{114D9}\u{11580}-\u{115B1}\u{115B8}-\u{115BB}\u{115BE}\u{115C1}-\u{115DB}\u{11600}-\u{11632}\u{1163B}\u{1163C}\u{1163E}\u{11641}-\u{11644}\u{11650}-\u{11659}\u{11680}-\u{116AA}\u{116AC}\u{116AE}\u{116AF}\u{116B6}\u{116B8}\u{116B9}\u{116C0}-\u{116C9}\u{116D0}-\u{116E3}\u{11700}-\u{1171A}\u{1171E}\u{11720}\u{11721}\u{11726}\u{11730}-\u{11746}\u{11800}-\u{1182E}\u{11838}\u{1183B}\u{118A0}-\u{118F2}\u{118FF}-\u{11906}\u{11909}\u{1190C}-\u{11913}\u{11915}\u{11916}\u{11918}-\u{11935}\u{11937}\u{11938}\u{1193D}\u{1193F}-\u{11942}\u{11944}-\u{11946}\u{11950}-\u{11959}\u{119A0}-\u{119A7}\u{119AA}-\u{119D3}\u{119DC}-\u{119DF}\u{119E1}-\u{119E4}\u{11A00}\u{11A07}\u{11A08}\u{11A0B}-\u{11A32}\u{11A39}\u{11A3A}\u{11A3F}-\u{11A46}\u{11A50}\u{11A57}\u{11A58}\u{11A5C}-\u{11A89}\u{11A97}\u{11A9A}-\u{11AA2}\u{11AB0}-\u{11AF8}\u{11B00}-\u{11B09}\u{11BC0}-\u{11BE1}\u{11BF0}-\u{11BF9}\u{11C00}-\u{11C08}\u{11C0A}-\u{11C2F}\u{11C3E}-\u{11C45}\u{11C50}-\u{11C6C}\u{11C70}-\u{11C8F}\u{11CA9}\u{11CB1}\u{11CB4}\u{11D00}-\u{11D06}\u{11D08}\u{11D09}\u{11D0B}-\u{11D30}\u{11D46}\u{11D50}-\u{11D59}\u{11D60}-\u{11D65}\u{11D67}\u{11D68}\u{11D6A}-\u{11D8E}\u{11D93}\u{11D94}\u{11D96}\u{11D98}\u{11DA0}-\u{11DA9}\u{11EE0}-\u{11EF2}\u{11EF5}-\u{11EF8}\u{11F02}-\u{11F10}\u{11F12}-\u{11F35}\u{11F3E}\u{11F3F}\u{11F41}\u{11F43}-\u{11F59}\u{11FB0}\u{11FC0}-\u{11FD4}\u{11FFF}-\u{12399}\u{12400}-\u{1246E}\u{12470}-\u{12474}\u{12480}-\u{12543}\u{12F90}-\u{12FF2}\u{13000}-\u{1343F}\u{13441}-\u{13446}\u{13460}-\u{143FA}\u{14400}-\u{14646}\u{16100}-\u{1611D}\u{1612A}-\u{1612C}\u{16130}-\u{16139}\u{16800}-\u{16A38}\u{16A40}-\u{16A5E}\u{16A60}-\u{16A69}\u{16A6E}-\u{16ABE}\u{16AC0}-\u{16AC9}\u{16AD0}-\u{16AED}\u{16AF5}\u{16B00}-\u{16B2F}\u{16B37}-\u{16B45}\u{16B50}-\u{16B59}\u{16B5B}-\u{16B61}\u{16B63}-\u{16B77}\u{16B7D}-\u{16B8F}\u{16D40}-\u{16D79}\u{16E40}-\u{16E9A}\u{16F00}-\u{16F4A}\u{16F50}-\u{16F87}\u{16F93}-\u{16F9F}\u{16FE0}\u{16FE1}\u{16FE3}\u{16FF0}\u{16FF1}\u{17000}-\u{187F7}\u{18800}-\u{18CD5}\u{18CFF}-\u{18D08}\u{1AFF0}-\u{1AFF3}\u{1AFF5}-\u{1AFFB}\u{1AFFD}\u{1AFFE}\u{1B000}-\u{1B122}\u{1B132}\u{1B150}-\u{1B152}\u{1B155}\u{1B164}-\u{1B167}\u{1B170}-\u{1B2FB}\u{1BC00}-\u{1BC6A}\u{1BC70}-\u{1BC7C}\u{1BC80}-\u{1BC88}\u{1BC90}-\u{1BC99}\u{1BC9C}\u{1BC9F}\u{1CCD6}-\u{1CCF9}\u{1CF50}-\u{1CFC3}\u{1D000}-\u{1D0F5}\u{1D100}-\u{1D126}\u{1D129}-\u{1D166}\u{1D16A}-\u{1D172}\u{1D183}\u{1D184}\u{1D18C}-\u{1D1A9}\u{1D1AE}-\u{1D1E8}\u{1D2C0}-\u{1D2D3}\u{1D2E0}-\u{1D2F3}\u{1D360}-\u{1D378}\u{1D400}-\u{1D454}\u{1D456}-\u{1D49C}\u{1D49E}\u{1D49F}\u{1D4A2}\u{1D4A5}\u{1D4A6}\u{1D4A9}-\u{1D4AC}\u{1D4AE}-\u{1D4B9}\u{1D4BB}\u{1D4BD}-\u{1D4C3}\u{1D4C5}-\u{1D505}\u{1D507}-\u{1D50A}\u{1D50D}-\u{1D514}\u{1D516}-\u{1D51C}\u{1D51E}-\u{1D539}\u{1D53B}-\u{1D53E}\u{1D540}-\u{1D544}\u{1D546}\u{1D54A}-\u{1D550}\u{1D552}-\u{1D6A5}\u{1D6A8}-\u{1D6C0}\u{1D6C2}-\u{1D6DA}\u{1D6DC}-\u{1D6FA}\u{1D6FC}-\u{1D714}\u{1D716}-\u{1D734}\u{1D736}-\u{1D74E}\u{1D750}-\u{1D76E}\u{1D770}-\u{1D788}\u{1D78A}-\u{1D7A8}\u{1D7AA}-\u{1D7C2}\u{1D7C4}-\u{1D7CB}\u{1D7CE}-\u{1D9FF}\u{1DA37}-\u{1DA3A}\u{1DA6D}-\u{1DA74}\u{1DA76}-\u{1DA83}\u{1DA85}-\u{1DA8B}\u{1DF00}-\u{1DF1E}\u{1DF25}-\u{1DF2A}\u{1E030}-\u{1E06D}\u{1E100}-\u{1E12C}\u{1E137}-\u{1E13D}\u{1E140}-\u{1E149}\u{1E14E}\u{1E14F}\u{1E290}-\u{1E2AD}\u{1E2C0}-\u{1E2EB}\u{1E2F0}-\u{1E2F9}\u{1E4D0}-\u{1E4EB}\u{1E4F0}-\u{1E4F9}\u{1E5D0}-\u{1E5ED}\u{1E5F0}-\u{1E5FA}\u{1E5FF}\u{1E7E0}-\u{1E7E6}\u{1E7E8}-\u{1E7EB}\u{1E7ED}\u{1E7EE}\u{1E7F0}-\u{1E7FE}\u{1F100}-\u{1F10A}\u{1F110}-\u{1F12E}\u{1F130}-\u{1F169}\u{1F170}-\u{1F1AC}\u{1F1E6}-\u{1F202}\u{1F210}-\u{1F23B}\u{1F240}-\u{1F248}\u{1F250}\u{1F251}\u{1FBF0}-\u{1FBF9}\u{20000}-\u{2A6DF}\u{2A700}-\u{2B739}\u{2B740}-\u{2B81D}\u{2B820}-\u{2CEA1}\u{2CEB0}-\u{2EBE0}\u{2EBF0}-\u{2EE5D}\u{2F800}-\u{2FA1D}\u{30000}-\u{3134A}\u{31350}-\u{323AF}\u{F0000}-\u{FFFFD}\u{100000}-\u{10FFFD}][\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\u{101FD}\u{102E0}\u{10376}-\u{1037A}\u{10A01}-\u{10A03}\u{10A05}\u{10A06}\u{10A0C}-\u{10A0F}\u{10A38}-\u{10A3A}\u{10A3F}\u{10AE5}\u{10AE6}\u{10D24}-\u{10D27}\u{10D69}-\u{10D6D}\u{10EAB}\u{10EAC}\u{10EFC}-\u{10EFF}\u{10F46}-\u{10F50}\u{10F82}-\u{10F85}\u{11001}\u{11038}-\u{11046}\u{11070}\u{11073}\u{11074}\u{1107F}-\u{11081}\u{110B3}-\u{110B6}\u{110B9}\u{110BA}\u{110C2}\u{11100}-\u{11102}\u{11127}-\u{1112B}\u{1112D}-\u{11134}\u{11173}\u{11180}\u{11181}\u{111B6}-\u{111BE}\u{111C9}-\u{111CC}\u{111CF}\u{1122F}-\u{11231}\u{11234}\u{11236}\u{11237}\u{1123E}\u{11241}\u{112DF}\u{112E3}-\u{112EA}\u{11300}\u{11301}\u{1133B}\u{1133C}\u{11340}\u{11366}-\u{1136C}\u{11370}-\u{11374}\u{113BB}-\u{113C0}\u{113CE}\u{113D0}\u{113D2}\u{113E1}\u{113E2}\u{11438}-\u{1143F}\u{11442}-\u{11444}\u{11446}\u{1145E}\u{114B3}-\u{114B8}\u{114BA}\u{114BF}\u{114C0}\u{114C2}\u{114C3}\u{115B2}-\u{115B5}\u{115BC}\u{115BD}\u{115BF}\u{115C0}\u{115DC}\u{115DD}\u{11633}-\u{1163A}\u{1163D}\u{1163F}\u{11640}\u{116AB}\u{116AD}\u{116B0}-\u{116B5}\u{116B7}\u{1171D}\u{1171F}\u{11722}-\u{11725}\u{11727}-\u{1172B}\u{1182F}-\u{11837}\u{11839}\u{1183A}\u{1193B}\u{1193C}\u{1193E}\u{11943}\u{119D4}-\u{119D7}\u{119DA}\u{119DB}\u{119E0}\u{11A01}-\u{11A06}\u{11A09}\u{11A0A}\u{11A33}-\u{11A38}\u{11A3B}-\u{11A3E}\u{11A47}\u{11A51}-\u{11A56}\u{11A59}-\u{11A5B}\u{11A8A}-\u{11A96}\u{11A98}\u{11A99}\u{11C30}-\u{11C36}\u{11C38}-\u{11C3D}\u{11C92}-\u{11CA7}\u{11CAA}-\u{11CB0}\u{11CB2}\u{11CB3}\u{11CB5}\u{11CB6}\u{11D31}-\u{11D36}\u{11D3A}\u{11D3C}\u{11D3D}\u{11D3F}-\u{11D45}\u{11D47}\u{11D90}\u{11D91}\u{11D95}\u{11D97}\u{11EF3}\u{11EF4}\u{11F00}\u{11F01}\u{11F36}-\u{11F3A}\u{11F40}\u{11F42}\u{11F5A}\u{13440}\u{13447}-\u{13455}\u{1611E}-\u{16129}\u{1612D}-\u{1612F}\u{16AF0}-\u{16AF4}\u{16B30}-\u{16B36}\u{16F4F}\u{16F8F}-\u{16F92}\u{16FE4}\u{1BC9D}\u{1BC9E}\u{1CF00}-\u{1CF2D}\u{1CF30}-\u{1CF46}\u{1D167}-\u{1D169}\u{1D17B}-\u{1D182}\u{1D185}-\u{1D18B}\u{1D1AA}-\u{1D1AD}\u{1D242}-\u{1D244}\u{1DA00}-\u{1DA36}\u{1DA3B}-\u{1DA6C}\u{1DA75}\u{1DA84}\u{1DA9B}-\u{1DA9F}\u{1DAA1}-\u{1DAAF}\u{1E000}-\u{1E006}\u{1E008}-\u{1E018}\u{1E01B}-\u{1E021}\u{1E023}\u{1E024}\u{1E026}-\u{1E02A}\u{1E08F}\u{1E130}-\u{1E136}\u{1E2AE}\u{1E2EC}-\u{1E2EF}\u{1E4EC}-\u{1E4EF}\u{1E5EE}\u{1E5EF}\u{1E8D0}-\u{1E8D6}\u{1E944}-\u{1E94A}\u{E0100}-\u{E01EF}]*$/u}}var xr,Pr,Nr,Ir,Rr,kr,jr,Lr,Ur,Vr,zr,Wr,qr=[[[0,44],2],[[45,46],2],[47,2],[[48,57],2],[[58,64],2],[65,1,"a"],[66,1,"b"],[67,1,"c"],[68,1,"d"],[69,1,"e"],[70,1,"f"],[71,1,"g"],[72,1,"h"],[73,1,"i"],[74,1,"j"],[75,1,"k"],[76,1,"l"],[77,1,"m"],[78,1,"n"],[79,1,"o"],[80,1,"p"],[81,1,"q"],[82,1,"r"],[83,1,"s"],[84,1,"t"],[85,1,"u"],[86,1,"v"],[87,1,"w"],[88,1,"x"],[89,1,"y"],[90,1,"z"],[[91,96],2],[[97,122],2],[[123,127],2],[[128,159],3],[160,1," "],[[161,167],2],[168,1," "],[169,2],[170,1,"a"],[[171,172],2],[173,7],[174,2],[175,1," "],[[176,177],2],[178,1,"2"],[179,1,"3"],[180,1," "],[181,1,""],[182,2],[183,2],[184,1," "],[185,1,"1"],[186,1,"o"],[187,2],[188,1,"14"],[189,1,"12"],[190,1,"34"],[191,2],[192,1,""],[193,1,""],[194,1,""],[195,1,""],[196,1,""],[197,1,""],[198,1,""],[199,1,""],[200,1,""],[201,1,""],[202,1,""],[203,1,""],[204,1,""],[205,1,""],[206,1,""],[207,1,""],[208,1,""],[209,1,""],[210,1,""],[211,1,""],[212,1,""],[213,1,""],[214,1,""],[215,2],[216,1,""],[217,1,""],[218,1,""],[219,1,""],[220,1,""],[221,1,""],[222,1,""],[223,6,"ss"],[[224,246],2],[247,2],[[248,255],2],[256,1,""],[257,2],[258,1,""],[259,2],[260,1,""],[261,2],[262,1,""],[263,2],[264,1,""],[265,2],[266,1,""],[267,2],[268,1,""],[269,2],[270,1,""],[271,2],[272,1,""],[273,2],[274,1,""],[275,2],[276,1,""],[277,2],[278,1,""],[279,2],[280,1,""],[281,2],[282,1,""],[283,2],[284,1,""],[285,2],[286,1,""],[287,2],[288,1,""],[289,2],[290,1,""],[291,2],[292,1,""],[293,2],[294,1,""],[295,2],[296,1,""],[297,2],[298,1,""],[299,2],[300,1,""],[301,2],[302,1,""],[303,2],[304,1,"i"],[305,2],[[306,307],1,"ij"],[308,1,""],[309,2],[310,1,""],[[311,312],2],[313,1,""],[314,2],[315,1,""],[316,2],[317,1,""],[318,2],[[319,320],1,"l"],[321,1,""],[322,2],[323,1,""],[324,2],[325,1,""],[326,2],[327,1,""],[328,2],[329,1,"n"],[330,1,""],[331,2],[332,1,""],[333,2],[334,1,""],[335,2],[336,1,""],[337,2],[338,1,""],[339,2],[340,1,""],[341,2],[342,1,""],[343,2],[344,1,""],[345,2],[346,1,""],[347,2],[348,1,""],[349,2],[350,1,""],[351,2],[352,1,""],[353,2],[354,1,""],[355,2],[356,1,""],[357,2],[358,1,""],[359,2],[360,1,""],[361,2],[362,1,""],[363,2],[364,1,""],[365,2],[366,1,""],[367,2],[368,1,""],[369,2],[370,1,""],[371,2],[372,1,""],[373,2],[374,1,""],[375,2],[376,1,""],[377,1,""],[378,2],[379,1,""],[380,2],[381,1,""],[382,2],[383,1,"s"],[384,2],[385,1,""],[386,1,""],[387,2],[388,1,""],[389,2],[390,1,""],[391,1,""],[392,2],[393,1,""],[394,1,""],[395,1,""],[[396,397],2],[398,1,""],[399,1,""],[400,1,""],[401,1,""],[402,2],[403,1,""],[404,1,""],[405,2],[406,1,""],[407,1,""],[408,1,""],[[409,411],2],[412,1,""],[413,1,""],[414,2],[415,1,""],[416,1,""],[417,2],[418,1,""],[419,2],[420,1,""],[421,2],[422,1,""],[423,1,""],[424,2],[425,1,""],[[426,427],2],[428,1,""],[429,2],[430,1,""],[431,1,""],[432,2],[433,1,""],[434,1,""],[435,1,""],[436,2],[437,1,""],[438,2],[439,1,""],[440,1,""],[[441,443],2],[444,1,""],[[445,451],2],[[452,454],1,"d"],[[455,457],1,"lj"],[[458,460],1,"nj"],[461,1,""],[462,2],[463,1,""],[464,2],[465,1,""],[466,2],[467,1,""],[468,2],[469,1,""],[470,2],[471,1,""],[472,2],[473,1,""],[474,2],[475,1,""],[[476,477],2],[478,1,""],[479,2],[480,1,""],[481,2],[482,1,""],[483,2],[484,1,""],[485,2],[486,1,""],[487,2],[488,1,""],[489,2],[490,1,""],[491,2],[492,1,""],[493,2],[494,1,""],[[495,496],2],[[497,499],1,"dz"],[500,1,""],[501,2],[502,1,""],[503,1,""],[504,1,""],[505,2],[506,1,""],[507,2],[508,1,""],[509,2],[510,1,""],[511,2],[512,1,""],[513,2],[514,1,""],[515,2],[516,1,""],[517,2],[518,1,""],[519,2],[520,1,""],[521,2],[522,1,""],[523,2],[524,1,""],[525,2],[526,1,""],[527,2],[528,1,""],[529,2],[530,1,""],[531,2],[532,1,""],[533,2],[534,1,""],[535,2],[536,1,""],[537,2],[538,1,""],[539,2],[540,1,""],[541,2],[542,1,""],[543,2],[544,1,""],[545,2],[546,1,""],[547,2],[548,1,""],[549,2],[550,1,""],[551,2],[552,1,""],[553,2],[554,1,""],[555,2],[556,1,""],[557,2],[558,1,""],[559,2],[560,1,""],[561,2],[562,1,""],[563,2],[[564,566],2],[[567,569],2],[570,1,""],[571,1,""],[572,2],[573,1,""],[574,1,""],[[575,576],2],[577,1,""],[578,2],[579,1,""],[580,1,""],[581,1,""],[582,1,""],[583,2],[584,1,""],[585,2],[586,1,""],[587,2],[588,1,""],[589,2],[590,1,""],[591,2],[[592,680],2],[[681,685],2],[[686,687],2],[688,1,"h"],[689,1,""],[690,1,"j"],[691,1,"r"],[692,1,""],[693,1,""],[694,1,""],[695,1,"w"],[696,1,"y"],[[697,705],2],[[706,709],2],[[710,721],2],[[722,727],2],[728,1," "],[729,1," "],[730,1," "],[731,1," "],[732,1," "],[733,1," "],[734,2],[735,2],[736,1,""],[737,1,"l"],[738,1,"s"],[739,1,"x"],[740,1,""],[[741,745],2],[[746,747],2],[748,2],[749,2],[750,2],[[751,767],2],[[768,831],2],[832,1,""],[833,1,""],[834,2],[835,1,""],[836,1,""],[837,1,""],[[838,846],2],[847,7],[[848,855],2],[[856,860],2],[[861,863],2],[[864,865],2],[866,2],[[867,879],2],[880,1,""],[881,2],[882,1,""],[883,2],[884,1,""],[885,2],[886,1,""],[887,2],[[888,889],3],[890,1," "],[[891,893],2],[894,1,";"],[895,1,""],[[896,899],3],[900,1," "],[901,1," "],[902,1,""],[903,1,""],[904,1,""],[905,1,""],[906,1,""],[907,3],[908,1,""],[909,3],[910,1,""],[911,1,""],[912,2],[913,1,""],[914,1,""],[915,1,""],[916,1,""],[917,1,""],[918,1,""],[919,1,""],[920,1,""],[921,1,""],[922,1,""],[923,1,""],[924,1,""],[925,1,""],[926,1,""],[927,1,""],[928,1,""],[929,1,""],[930,3],[931,1,""],[932,1,""],[933,1,""],[934,1,""],[935,1,""],[936,1,""],[937,1,""],[938,1,""],[939,1,""],[[940,961],2],[962,6,""],[[963,974],2],[975,1,""],[976,1,""],[977,1,""],[978,1,""],[979,1,""],[980,1,""],[981,1,""],[982,1,""],[983,2],[984,1,""],[985,2],[986,1,""],[987,2],[988,1,""],[989,2],[990,1,""],[991,2],[992,1,""],[993,2],[994,1,""],[995,2],[996,1,""],[997,2],[998,1,""],[999,2],[1e3,1,""],[1001,2],[1002,1,""],[1003,2],[1004,1,""],[1005,2],[1006,1,""],[1007,2],[1008,1,""],[1009,1,""],[1010,1,""],[1011,2],[1012,1,""],[1013,1,""],[1014,2],[1015,1,""],[1016,2],[1017,1,""],[1018,1,""],[1019,2],[1020,2],[1021,1,""],[1022,1,""],[1023,1,""],[1024,1,""],[1025,1,""],[1026,1,""],[1027,1,""],[1028,1,""],[1029,1,""],[1030,1,""],[1031,1,""],[1032,1,""],[1033,1,""],[1034,1,""],[1035,1,""],[1036,1,""],[1037,1,""],[1038,1,""],[1039,1,""],[1040,1,""],[1041,1,""],[1042,1,""],[1043,1,""],[1044,1,""],[1045,1,""],[1046,1,""],[1047,1,""],[1048,1,""],[1049,1,""],[1050,1,""],[1051,1,""],[1052,1,""],[1053,1,""],[1054,1,""],[1055,1,""],[1056,1,""],[1057,1,""],[1058,1,""],[1059,1,""],[1060,1,""],[1061,1,""],[1062,1,""],[1063,1,""],[1064,1,""],[1065,1,""],[1066,1,""],[1067,1,""],[1068,1,""],[1069,1,""],[1070,1,""],[1071,1,""],[[1072,1103],2],[1104,2],[[1105,1116],2],[1117,2],[[1118,1119],2],[1120,1,""],[1121,2],[1122,1,""],[1123,2],[1124,1,""],[1125,2],[1126,1,""],[1127,2],[1128,1,""],[1129,2],[1130,1,""],[1131,2],[1132,1,""],[1133,2],[1134,1,""],[1135,2],[1136,1,""],[1137,2],[1138,1,""],[1139,2],[1140,1,""],[1141,2],[1142,1,""],[1143,2],[1144,1,""],[1145,2],[1146,1,""],[1147,2],[1148,1,""],[1149,2],[1150,1,""],[1151,2],[1152,1,""],[1153,2],[1154,2],[[1155,1158],2],[1159,2],[[1160,1161],2],[1162,1,""],[1163,2],[1164,1,""],[1165,2],[1166,1,""],[1167,2],[1168,1,""],[1169,2],[1170,1,""],[1171,2],[1172,1,""],[1173,2],[1174,1,""],[1175,2],[1176,1,""],[1177,2],[1178,1,""],[1179,2],[1180,1,""],[1181,2],[1182,1,""],[1183,2],[1184,1,""],[1185,2],[1186,1,""],[1187,2],[1188,1,""],[1189,2],[1190,1,""],[1191,2],[1192,1,""],[1193,2],[1194,1,""],[1195,2],[1196,1,""],[1197,2],[1198,1,""],[1199,2],[1200,1,""],[1201,2],[1202,1,""],[1203,2],[1204,1,""],[1205,2],[1206,1,""],[1207,2],[1208,1,""],[1209,2],[1210,1,""],[1211,2],[1212,1,""],[1213,2],[1214,1,""],[1215,2],[1216,1,""],[1217,1,""],[1218,2],[1219,1,""],[1220,2],[1221,1,""],[1222,2],[1223,1,""],[1224,2],[1225,1,""],[1226,2],[1227,1,""],[1228,2],[1229,1,""],[1230,2],[1231,2],[1232,1,""],[1233,2],[1234,1,""],[1235,2],[1236,1,""],[1237,2],[1238,1,""],[1239,2],[1240,1,""],[1241,2],[1242,1,""],[1243,2],[1244,1,""],[1245,2],[1246,1,""],[1247,2],[1248,1,""],[1249,2],[1250,1,""],[1251,2],[1252,1,""],[1253,2],[1254,1,""],[1255,2],[1256,1,""],[1257,2],[1258,1,""],[1259,2],[1260,1,""],[1261,2],[1262,1,""],[1263,2],[1264,1,""],[1265,2],[1266,1,""],[1267,2],[1268,1,""],[1269,2],[1270,1,""],[1271,2],[1272,1,""],[1273,2],[1274,1,""],[1275,2],[1276,1,""],[1277,2],[1278,1,""],[1279,2],[1280,1,""],[1281,2],[1282,1,""],[1283,2],[1284,1,""],[1285,2],[1286,1,""],[1287,2],[1288,1,""],[1289,2],[1290,1,""],[1291,2],[1292,1,""],[1293,2],[1294,1,""],[1295,2],[1296,1,""],[1297,2],[1298,1,""],[1299,2],[1300,1,""],[1301,2],[1302,1,""],[1303,2],[1304,1,""],[1305,2],[1306,1,""],[1307,2],[1308,1,""],[1309,2],[1310,1,""],[1311,2],[1312,1,""],[1313,2],[1314,1,""],[1315,2],[1316,1,""],[1317,2],[1318,1,""],[1319,2],[1320,1,""],[1321,2],[1322,1,""],[1323,2],[1324,1,""],[1325,2],[1326,1,""],[1327,2],[1328,3],[1329,1,""],[1330,1,""],[1331,1,""],[1332,1,""],[1333,1,""],[1334,1,""],[1335,1,""],[1336,1,""],[1337,1,""],[1338,1,""],[1339,1,""],[1340,1,""],[1341,1,""],[1342,1,""],[1343,1,""],[1344,1,""],[1345,1,""],[1346,1,""],[1347,1,""],[1348,1,""],[1349,1,""],[1350,1,""],[1351,1,""],[1352,1,""],[1353,1,""],[1354,1,""],[1355,1,""],[1356,1,""],[1357,1,""],[1358,1,""],[1359,1,""],[1360,1,""],[1361,1,""],[1362,1,""],[1363,1,""],[1364,1,""],[1365,1,""],[1366,1,""],[[1367,1368],3],[1369,2],[[1370,1375],2],[1376,2],[[1377,1414],2],[1415,1,""],[1416,2],[1417,2],[1418,2],[[1419,1420],3],[[1421,1422],2],[1423,2],[1424,3],[[1425,1441],2],[1442,2],[[1443,1455],2],[[1456,1465],2],[1466,2],[[1467,1469],2],[1470,2],[1471,2],[1472,2],[[1473,1474],2],[1475,2],[1476,2],[1477,2],[1478,2],[1479,2],[[1480,1487],3],[[1488,1514],2],[[1515,1518],3],[1519,2],[[1520,1524],2],[[1525,1535],3],[[1536,1539],3],[1540,3],[1541,3],[[1542,1546],2],[1547,2],[1548,2],[[1549,1551],2],[[1552,1557],2],[[1558,1562],2],[1563,2],[1564,3],[1565,2],[1566,2],[1567,2],[1568,2],[[1569,1594],2],[[1595,1599],2],[1600,2],[[1601,1618],2],[[1619,1621],2],[[1622,1624],2],[[1625,1630],2],[1631,2],[[1632,1641],2],[[1642,1645],2],[[1646,1647],2],[[1648,1652],2],[1653,1,""],[1654,1,""],[1655,1,""],[1656,1,""],[[1657,1719],2],[[1720,1721],2],[[1722,1726],2],[1727,2],[[1728,1742],2],[1743,2],[[1744,1747],2],[1748,2],[[1749,1756],2],[1757,3],[1758,2],[[1759,1768],2],[1769,2],[[1770,1773],2],[[1774,1775],2],[[1776,1785],2],[[1786,1790],2],[1791,2],[[1792,1805],2],[1806,3],[1807,3],[[1808,1836],2],[[1837,1839],2],[[1840,1866],2],[[1867,1868],3],[[1869,1871],2],[[1872,1901],2],[[1902,1919],2],[[1920,1968],2],[1969,2],[[1970,1983],3],[[1984,2037],2],[[2038,2042],2],[[2043,2044],3],[2045,2],[[2046,2047],2],[[2048,2093],2],[[2094,2095],3],[[2096,2110],2],[2111,3],[[2112,2139],2],[[2140,2141],3],[2142,2],[2143,3],[[2144,2154],2],[[2155,2159],3],[[2160,2183],2],[2184,2],[[2185,2190],2],[2191,3],[[2192,2193],3],[[2194,2198],3],[2199,2],[[2200,2207],2],[2208,2],[2209,2],[[2210,2220],2],[[2221,2226],2],[[2227,2228],2],[2229,2],[[2230,2237],2],[[2238,2247],2],[[2248,2258],2],[2259,2],[[2260,2273],2],[2274,3],[2275,2],[[2276,2302],2],[2303,2],[2304,2],[[2305,2307],2],[2308,2],[[2309,2361],2],[[2362,2363],2],[[2364,2381],2],[2382,2],[2383,2],[[2384,2388],2],[2389,2],[[2390,2391],2],[2392,1,""],[2393,1,""],[2394,1,""],[2395,1,""],[2396,1,""],[2397,1,""],[2398,1,""],[2399,1,""],[[2400,2403],2],[[2404,2405],2],[[2406,2415],2],[2416,2],[[2417,2418],2],[[2419,2423],2],[2424,2],[[2425,2426],2],[[2427,2428],2],[2429,2],[[2430,2431],2],[2432,2],[[2433,2435],2],[2436,3],[[2437,2444],2],[[2445,2446],3],[[2447,2448],2],[[2449,2450],3],[[2451,2472],2],[2473,3],[[2474,2480],2],[2481,3],[2482,2],[[2483,2485],3],[[2486,2489],2],[[2490,2491],3],[2492,2],[2493,2],[[2494,2500],2],[[2501,2502],3],[[2503,2504],2],[[2505,2506],3],[[2507,2509],2],[2510,2],[[2511,2518],3],[2519,2],[[2520,2523],3],[2524,1,""],[2525,1,""],[2526,3],[2527,1,""],[[2528,2531],2],[[2532,2533],3],[[2534,2545],2],[[2546,2554],2],[2555,2],[2556,2],[2557,2],[2558,2],[[2559,2560],3],[2561,2],[2562,2],[2563,2],[2564,3],[[2565,2570],2],[[2571,2574],3],[[2575,2576],2],[[2577,2578],3],[[2579,2600],2],[2601,3],[[2602,2608],2],[2609,3],[2610,2],[2611,1,""],[2612,3],[2613,2],[2614,1,""],[2615,3],[[2616,2617],2],[[2618,2619],3],[2620,2],[2621,3],[[2622,2626],2],[[2627,2630],3],[[2631,2632],2],[[2633,2634],3],[[2635,2637],2],[[2638,2640],3],[2641,2],[[2642,2648],3],[2649,1,""],[2650,1,""],[2651,1,""],[2652,2],[2653,3],[2654,1,""],[[2655,2661],3],[[2662,2676],2],[2677,2],[2678,2],[[2679,2688],3],[[2689,2691],2],[2692,3],[[2693,2699],2],[2700,2],[2701,2],[2702,3],[[2703,2705],2],[2706,3],[[2707,2728],2],[2729,3],[[2730,2736],2],[2737,3],[[2738,2739],2],[2740,3],[[2741,2745],2],[[2746,2747],3],[[2748,2757],2],[2758,3],[[2759,2761],2],[2762,3],[[2763,2765],2],[[2766,2767],3],[2768,2],[[2769,2783],3],[2784,2],[[2785,2787],2],[[2788,2789],3],[[2790,2799],2],[2800,2],[2801,2],[[2802,2808],3],[2809,2],[[2810,2815],2],[2816,3],[[2817,2819],2],[2820,3],[[2821,2828],2],[[2829,2830],3],[[2831,2832],2],[[2833,2834],3],[[2835,2856],2],[2857,3],[[2858,2864],2],[2865,3],[[2866,2867],2],[2868,3],[2869,2],[[2870,2873],2],[[2874,2875],3],[[2876,2883],2],[2884,2],[[2885,2886],3],[[2887,2888],2],[[2889,2890],3],[[2891,2893],2],[[2894,2900],3],[2901,2],[[2902,2903],2],[[2904,2907],3],[2908,1,""],[2909,1,""],[2910,3],[[2911,2913],2],[[2914,2915],2],[[2916,2917],3],[[2918,2927],2],[2928,2],[2929,2],[[2930,2935],2],[[2936,2945],3],[[2946,2947],2],[2948,3],[[2949,2954],2],[[2955,2957],3],[[2958,2960],2],[2961,3],[[2962,2965],2],[[2966,2968],3],[[2969,2970],2],[2971,3],[2972,2],[2973,3],[[2974,2975],2],[[2976,2978],3],[[2979,2980],2],[[2981,2983],3],[[2984,2986],2],[[2987,2989],3],[[2990,2997],2],[2998,2],[[2999,3001],2],[[3002,3005],3],[[3006,3010],2],[[3011,3013],3],[[3014,3016],2],[3017,3],[[3018,3021],2],[[3022,3023],3],[3024,2],[[3025,3030],3],[3031,2],[[3032,3045],3],[3046,2],[[3047,3055],2],[[3056,3058],2],[[3059,3066],2],[[3067,3071],3],[3072,2],[[3073,3075],2],[3076,2],[[3077,3084],2],[3085,3],[[3086,3088],2],[3089,3],[[3090,3112],2],[3113,3],[[3114,3123],2],[3124,2],[[3125,3129],2],[[3130,3131],3],[3132,2],[3133,2],[[3134,3140],2],[3141,3],[[3142,3144],2],[3145,3],[[3146,3149],2],[[3150,3156],3],[[3157,3158],2],[3159,3],[[3160,3161],2],[3162,2],[[3163,3164],3],[3165,2],[[3166,3167],3],[[3168,3169],2],[[3170,3171],2],[[3172,3173],3],[[3174,3183],2],[[3184,3190],3],[3191,2],[[3192,3199],2],[3200,2],[3201,2],[[3202,3203],2],[3204,2],[[3205,3212],2],[3213,3],[[3214,3216],2],[3217,3],[[3218,3240],2],[3241,3],[[3242,3251],2],[3252,3],[[3253,3257],2],[[3258,3259],3],[[3260,3261],2],[[3262,3268],2],[3269,3],[[3270,3272],2],[3273,3],[[3274,3277],2],[[3278,3284],3],[[3285,3286],2],[[3287,3292],3],[3293,2],[3294,2],[3295,3],[[3296,3297],2],[[3298,3299],2],[[3300,3301],3],[[3302,3311],2],[3312,3],[[3313,3314],2],[3315,2],[[3316,3327],3],[3328,2],[3329,2],[[3330,3331],2],[3332,2],[[3333,3340],2],[3341,3],[[3342,3344],2],[3345,3],[[3346,3368],2],[3369,2],[[3370,3385],2],[3386,2],[[3387,3388],2],[3389,2],[[3390,3395],2],[3396,2],[3397,3],[[3398,3400],2],[3401,3],[[3402,3405],2],[3406,2],[3407,2],[[3408,3411],3],[[3412,3414],2],[3415,2],[[3416,3422],2],[3423,2],[[3424,3425],2],[[3426,3427],2],[[3428,3429],3],[[3430,3439],2],[[3440,3445],2],[[3446,3448],2],[3449,2],[[3450,3455],2],[3456,3],[3457,2],[[3458,3459],2],[3460,3],[[3461,3478],2],[[3479,3481],3],[[3482,3505],2],[3506,3],[[3507,3515],2],[3516,3],[3517,2],[[3518,3519],3],[[3520,3526],2],[[3527,3529],3],[3530,2],[[3531,3534],3],[[3535,3540],2],[3541,3],[3542,2],[3543,3],[[3544,3551],2],[[3552,3557],3],[[3558,3567],2],[[3568,3569],3],[[3570,3571],2],[3572,2],[[3573,3584],3],[[3585,3634],2],[3635,1,""],[[3636,3642],2],[[3643,3646],3],[3647,2],[[3648,3662],2],[3663,2],[[3664,3673],2],[[3674,3675],2],[[3676,3712],3],[[3713,3714],2],[3715,3],[3716,2],[3717,3],[3718,2],[[3719,3720],2],[3721,2],[3722,2],[3723,3],[3724,2],[3725,2],[[3726,3731],2],[[3732,3735],2],[3736,2],[[3737,3743],2],[3744,2],[[3745,3747],2],[3748,3],[3749,2],[3750,3],[3751,2],[[3752,3753],2],[[3754,3755],2],[3756,2],[[3757,3762],2],[3763,1,""],[[3764,3769],2],[3770,2],[[3771,3773],2],[[3774,3775],3],[[3776,3780],2],[3781,3],[3782,2],[3783,3],[[3784,3789],2],[3790,2],[3791,3],[[3792,3801],2],[[3802,3803],3],[3804,1,""],[3805,1,""],[[3806,3807],2],[[3808,3839],3],[3840,2],[[3841,3850],2],[3851,2],[3852,1,""],[[3853,3863],2],[[3864,3865],2],[[3866,3871],2],[[3872,3881],2],[[3882,3892],2],[3893,2],[3894,2],[3895,2],[3896,2],[3897,2],[[3898,3901],2],[[3902,3906],2],[3907,1,""],[[3908,3911],2],[3912,3],[[3913,3916],2],[3917,1,""],[[3918,3921],2],[3922,1,""],[[3923,3926],2],[3927,1,""],[[3928,3931],2],[3932,1,""],[[3933,3944],2],[3945,1,""],[3946,2],[[3947,3948],2],[[3949,3952],3],[[3953,3954],2],[3955,1,""],[3956,2],[3957,1,""],[3958,1,""],[3959,1,""],[3960,1,""],[3961,1,""],[[3962,3968],2],[3969,1,""],[[3970,3972],2],[3973,2],[[3974,3979],2],[[3980,3983],2],[[3984,3986],2],[3987,1,""],[[3988,3989],2],[3990,2],[3991,2],[3992,3],[[3993,3996],2],[3997,1,""],[[3998,4001],2],[4002,1,""],[[4003,4006],2],[4007,1,""],[[4008,4011],2],[4012,1,""],[4013,2],[[4014,4016],2],[[4017,4023],2],[4024,2],[4025,1,""],[[4026,4028],2],[4029,3],[[4030,4037],2],[4038,2],[[4039,4044],2],[4045,3],[4046,2],[4047,2],[[4048,4049],2],[[4050,4052],2],[[4053,4056],2],[[4057,4058],2],[[4059,4095],3],[[4096,4129],2],[4130,2],[[4131,4135],2],[4136,2],[[4137,4138],2],[4139,2],[[4140,4146],2],[[4147,4149],2],[[4150,4153],2],[[4154,4159],2],[[4160,4169],2],[[4170,4175],2],[[4176,4185],2],[[4186,4249],2],[[4250,4253],2],[[4254,4255],2],[4256,1,""],[4257,1,""],[4258,1,""],[4259,1,""],[4260,1,""],[4261,1,""],[4262,1,""],[4263,1,""],[4264,1,""],[4265,1,""],[4266,1,""],[4267,1,""],[4268,1,""],[4269,1,""],[4270,1,""],[4271,1,""],[4272,1,""],[4273,1,""],[4274,1,""],[4275,1,""],[4276,1,""],[4277,1,""],[4278,1,""],[4279,1,""],[4280,1,""],[4281,1,""],[4282,1,""],[4283,1,""],[4284,1,""],[4285,1,""],[4286,1,""],[4287,1,""],[4288,1,""],[4289,1,""],[4290,1,""],[4291,1,""],[4292,1,""],[4293,1,""],[4294,3],[4295,1,""],[[4296,4300],3],[4301,1,""],[[4302,4303],3],[[4304,4342],2],[[4343,4344],2],[[4345,4346],2],[4347,2],[4348,1,""],[[4349,4351],2],[[4352,4441],2],[[4442,4446],2],[[4447,4448],7],[[4449,4514],2],[[4515,4519],2],[[4520,4601],2],[[4602,4607],2],[[4608,4614],2],[4615,2],[[4616,4678],2],[4679,2],[4680,2],[4681,3],[[4682,4685],2],[[4686,4687],3],[[4688,4694],2],[4695,3],[4696,2],[4697,3],[[4698,4701],2],[[4702,4703],3],[[4704,4742],2],[4743,2],[4744,2],[4745,3],[[4746,4749],2],[[4750,4751],3],[[4752,4782],2],[4783,2],[4784,2],[4785,3],[[4786,4789],2],[[4790,4791],3],[[4792,4798],2],[4799,3],[4800,2],[4801,3],[[4802,4805],2],[[4806,4807],3],[[4808,4814],2],[4815,2],[[4816,4822],2],[4823,3],[[4824,4846],2],[4847,2],[[4848,4878],2],[4879,2],[4880,2],[4881,3],[[4882,4885],2],[[4886,4887],3],[[4888,4894],2],[4895,2],[[4896,4934],2],[4935,2],[[4936,4954],2],[[4955,4956],3],[[4957,4958],2],[4959,2],[4960,2],[[4961,4988],2],[[4989,4991],3],[[4992,5007],2],[[5008,5017],2],[[5018,5023],3],[[5024,5108],2],[5109,2],[[5110,5111],3],[5112,1,""],[5113,1,""],[5114,1,""],[5115,1,""],[5116,1,""],[5117,1,""],[[5118,5119],3],[5120,2],[[5121,5740],2],[[5741,5742],2],[[5743,5750],2],[[5751,5759],2],[5760,3],[[5761,5786],2],[[5787,5788],2],[[5789,5791],3],[[5792,5866],2],[[5867,5872],2],[[5873,5880],2],[[5881,5887],3],[[5888,5900],2],[5901,2],[[5902,5908],2],[5909,2],[[5910,5918],3],[5919,2],[[5920,5940],2],[[5941,5942],2],[[5943,5951],3],[[5952,5971],2],[[5972,5983],3],[[5984,5996],2],[5997,3],[[5998,6e3],2],[6001,3],[[6002,6003],2],[[6004,6015],3],[[6016,6067],2],[[6068,6069],7],[[6070,6099],2],[[6100,6102],2],[6103,2],[[6104,6107],2],[6108,2],[6109,2],[[6110,6111],3],[[6112,6121],2],[[6122,6127],3],[[6128,6137],2],[[6138,6143],3],[[6144,6154],2],[[6155,6158],7],[6159,7],[[6160,6169],2],[[6170,6175],3],[[6176,6263],2],[6264,2],[[6265,6271],3],[[6272,6313],2],[6314,2],[[6315,6319],3],[[6320,6389],2],[[6390,6399],3],[[6400,6428],2],[[6429,6430],2],[6431,3],[[6432,6443],2],[[6444,6447],3],[[6448,6459],2],[[6460,6463],3],[6464,2],[[6465,6467],3],[[6468,6469],2],[[6470,6509],2],[[6510,6511],3],[[6512,6516],2],[[6517,6527],3],[[6528,6569],2],[[6570,6571],2],[[6572,6575],3],[[6576,6601],2],[[6602,6607],3],[[6608,6617],2],[6618,2],[[6619,6621],3],[[6622,6623],2],[[6624,6655],2],[[6656,6683],2],[[6684,6685],3],[[6686,6687],2],[[6688,6750],2],[6751,3],[[6752,6780],2],[[6781,6782],3],[[6783,6793],2],[[6794,6799],3],[[6800,6809],2],[[6810,6815],3],[[6816,6822],2],[6823,2],[[6824,6829],2],[[6830,6831],3],[[6832,6845],2],[6846,2],[[6847,6848],2],[[6849,6862],2],[[6863,6911],3],[[6912,6987],2],[6988,2],[6989,3],[[6990,6991],2],[[6992,7001],2],[[7002,7018],2],[[7019,7027],2],[[7028,7036],2],[[7037,7038],2],[7039,2],[[7040,7082],2],[[7083,7085],2],[[7086,7097],2],[[7098,7103],2],[[7104,7155],2],[[7156,7163],3],[[7164,7167],2],[[7168,7223],2],[[7224,7226],3],[[7227,7231],2],[[7232,7241],2],[[7242,7244],3],[[7245,7293],2],[[7294,7295],2],[7296,1,""],[7297,1,""],[7298,1,""],[7299,1,""],[[7300,7301],1,""],[7302,1,""],[7303,1,""],[7304,1,""],[7305,1,""],[7306,2],[[7307,7311],3],[7312,1,""],[7313,1,""],[7314,1,""],[7315,1,""],[7316,1,""],[7317,1,""],[7318,1,""],[7319,1,""],[7320,1,""],[7321,1,""],[7322,1,""],[7323,1,""],[7324,1,""],[7325,1,""],[7326,1,""],[7327,1,""],[7328,1,""],[7329,1,""],[7330,1,""],[7331,1,""],[7332,1,""],[7333,1,""],[7334,1,""],[7335,1,""],[7336,1,""],[7337,1,""],[7338,1,""],[7339,1,""],[7340,1,""],[7341,1,""],[7342,1,""],[7343,1,""],[7344,1,""],[7345,1,""],[7346,1,""],[7347,1,""],[7348,1,""],[7349,1,""],[7350,1,""],[7351,1,""],[7352,1,""],[7353,1,""],[7354,1,""],[[7355,7356],3],[7357,1,""],[7358,1,""],[7359,1,""],[[7360,7367],2],[[7368,7375],3],[[7376,7378],2],[7379,2],[[7380,7410],2],[[7411,7414],2],[7415,2],[[7416,7417],2],[7418,2],[[7419,7423],3],[[7424,7467],2],[7468,1,"a"],[7469,1,""],[7470,1,"b"],[7471,2],[7472,1,"d"],[7473,1,"e"],[7474,1,""],[7475,1,"g"],[7476,1,"h"],[7477,1,"i"],[7478,1,"j"],[7479,1,"k"],[7480,1,"l"],[7481,1,"m"],[7482,1,"n"],[7483,2],[7484,1,"o"],[7485,1,""],[7486,1,"p"],[7487,1,"r"],[7488,1,"t"],[7489,1,"u"],[7490,1,"w"],[7491,1,"a"],[7492,1,""],[7493,1,""],[7494,1,""],[7495,1,"b"],[7496,1,"d"],[7497,1,"e"],[7498,1,""],[7499,1,""],[7500,1,""],[7501,1,"g"],[7502,2],[7503,1,"k"],[7504,1,"m"],[7505,1,""],[7506,1,"o"],[7507,1,""],[7508,1,""],[7509,1,""],[7510,1,"p"],[7511,1,"t"],[7512,1,"u"],[7513,1,""],[7514,1,""],[7515,1,"v"],[7516,1,""],[7517,1,""],[7518,1,""],[7519,1,""],[7520,1,""],[7521,1,""],[7522,1,"i"],[7523,1,"r"],[7524,1,"u"],[7525,1,"v"],[7526,1,""],[7527,1,""],[7528,1,""],[7529,1,""],[7530,1,""],[7531,2],[[7532,7543],2],[7544,1,""],[[7545,7578],2],[7579,1,""],[7580,1,"c"],[7581,1,""],[7582,1,""],[7583,1,""],[7584,1,"f"],[7585,1,""],[7586,1,""],[7587,1,""],[7588,1,""],[7589,1,""],[7590,1,""],[7591,1,""],[7592,1,""],[7593,1,""],[7594,1,""],[7595,1,""],[7596,1,""],[7597,1,""],[7598,1,""],[7599,1,""],[7600,1,""],[7601,1,""],[7602,1,""],[7603,1,""],[7604,1,""],[7605,1,""],[7606,1,""],[7607,1,""],[7608,1,""],[7609,1,""],[7610,1,""],[7611,1,"z"],[7612,1,""],[7613,1,""],[7614,1,""],[7615,1,""],[[7616,7619],2],[[7620,7626],2],[[7627,7654],2],[[7655,7669],2],[[7670,7673],2],[7674,2],[7675,2],[7676,2],[7677,2],[[7678,7679],2],[7680,1,""],[7681,2],[7682,1,""],[7683,2],[7684,1,""],[7685,2],[7686,1,""],[7687,2],[7688,1,""],[7689,2],[7690,1,""],[7691,2],[7692,1,""],[7693,2],[7694,1,""],[7695,2],[7696,1,""],[7697,2],[7698,1,""],[7699,2],[7700,1,""],[7701,2],[7702,1,""],[7703,2],[7704,1,""],[7705,2],[7706,1,""],[7707,2],[7708,1,""],[7709,2],[7710,1,""],[7711,2],[7712,1,""],[7713,2],[7714,1,""],[7715,2],[7716,1,""],[7717,2],[7718,1,""],[7719,2],[7720,1,""],[7721,2],[7722,1,""],[7723,2],[7724,1,""],[7725,2],[7726,1,""],[7727,2],[7728,1,""],[7729,2],[7730,1,""],[7731,2],[7732,1,""],[7733,2],[7734,1,""],[7735,2],[7736,1,""],[7737,2],[7738,1,""],[7739,2],[7740,1,""],[7741,2],[7742,1,""],[7743,2],[7744,1,""],[7745,2],[7746,1,""],[7747,2],[7748,1,""],[7749,2],[7750,1,""],[7751,2],[7752,1,""],[7753,2],[7754,1,""],[7755,2],[7756,1,""],[7757,2],[7758,1,""],[7759,2],[7760,1,""],[7761,2],[7762,1,""],[7763,2],[7764,1,""],[7765,2],[7766,1,""],[7767,2],[7768,1,""],[7769,2],[7770,1,""],[7771,2],[7772,1,""],[7773,2],[7774,1,""],[7775,2],[7776,1,""],[7777,2],[7778,1,""],[7779,2],[7780,1,""],[7781,2],[7782,1,""],[7783,2],[7784,1,""],[7785,2],[7786,1,""],[7787,2],[7788,1,""],[7789,2],[7790,1,""],[7791,2],[7792,1,""],[7793,2],[7794,1,""],[7795,2],[7796,1,""],[7797,2],[7798,1,""],[7799,2],[7800,1,""],[7801,2],[7802,1,""],[7803,2],[7804,1,""],[7805,2],[7806,1,""],[7807,2],[7808,1,""],[7809,2],[7810,1,""],[7811,2],[7812,1,""],[7813,2],[7814,1,""],[7815,2],[7816,1,""],[7817,2],[7818,1,""],[7819,2],[7820,1,""],[7821,2],[7822,1,""],[7823,2],[7824,1,""],[7825,2],[7826,1,""],[7827,2],[7828,1,""],[[7829,7833],2],[7834,1,"a"],[7835,1,""],[[7836,7837],2],[7838,1,""],[7839,2],[7840,1,""],[7841,2],[7842,1,""],[7843,2],[7844,1,""],[7845,2],[7846,1,""],[7847,2],[7848,1,""],[7849,2],[7850,1,""],[7851,2],[7852,1,""],[7853,2],[7854,1,""],[7855,2],[7856,1,""],[7857,2],[7858,1,""],[7859,2],[7860,1,""],[7861,2],[7862,1,""],[7863,2],[7864,1,""],[7865,2],[7866,1,""],[7867,2],[7868,1,""],[7869,2],[7870,1,""],[7871,2],[7872,1,""],[7873,2],[7874,1,""],[7875,2],[7876,1,""],[7877,2],[7878,1,""],[7879,2],[7880,1,""],[7881,2],[7882,1,""],[7883,2],[7884,1,""],[7885,2],[7886,1,""],[7887,2],[7888,1,""],[7889,2],[7890,1,""],[7891,2],[7892,1,""],[7893,2],[7894,1,""],[7895,2],[7896,1,""],[7897,2],[7898,1,""],[7899,2],[7900,1,""],[7901,2],[7902,1,""],[7903,2],[7904,1,""],[7905,2],[7906,1,""],[7907,2],[7908,1,""],[7909,2],[7910,1,""],[7911,2],[7912,1,""],[7913,2],[7914,1,""],[7915,2],[7916,1,""],[7917,2],[7918,1,""],[7919,2],[7920,1,""],[7921,2],[7922,1,""],[7923,2],[7924,1,""],[7925,2],[7926,1,""],[7927,2],[7928,1,""],[7929,2],[7930,1,""],[7931,2],[7932,1,""],[7933,2],[7934,1,""],[7935,2],[[7936,7943],2],[7944,1,""],[7945,1,""],[7946,1,""],[7947,1,""],[7948,1,""],[7949,1,""],[7950,1,""],[7951,1,""],[[7952,7957],2],[[7958,7959],3],[7960,1,""],[7961,1,""],[7962,1,""],[7963,1,""],[7964,1,""],[7965,1,""],[[7966,7967],3],[[7968,7975],2],[7976,1,""],[7977,1,""],[7978,1,""],[7979,1,""],[7980,1,""],[7981,1,""],[7982,1,""],[7983,1,""],[[7984,7991],2],[7992,1,""],[7993,1,""],[7994,1,""],[7995,1,""],[7996,1,""],[7997,1,""],[7998,1,""],[7999,1,""],[[8e3,8005],2],[[8006,8007],3],[8008,1,""],[8009,1,""],[8010,1,""],[8011,1,""],[8012,1,""],[8013,1,""],[[8014,8015],3],[[8016,8023],2],[8024,3],[8025,1,""],[8026,3],[8027,1,""],[8028,3],[8029,1,""],[8030,3],[8031,1,""],[[8032,8039],2],[8040,1,""],[8041,1,""],[8042,1,""],[8043,1,""],[8044,1,""],[8045,1,""],[8046,1,""],[8047,1,""],[8048,2],[8049,1,""],[8050,2],[8051,1,""],[8052,2],[8053,1,""],[8054,2],[8055,1,""],[8056,2],[8057,1,""],[8058,2],[8059,1,""],[8060,2],[8061,1,""],[[8062,8063],3],[8064,1,""],[8065,1,""],[8066,1,""],[8067,1,""],[8068,1,""],[8069,1,""],[8070,1,""],[8071,1,""],[8072,1,""],[8073,1,""],[8074,1,""],[8075,1,""],[8076,1,""],[8077,1,""],[8078,1,""],[8079,1,""],[8080,1,""],[8081,1,""],[8082,1,""],[8083,1,""],[8084,1,""],[8085,1,""],[8086,1,""],[8087,1,""],[8088,1,""],[8089,1,""],[8090,1,""],[8091,1,""],[8092,1,""],[8093,1,""],[8094,1,""],[8095,1,""],[8096,1,""],[8097,1,""],[8098,1,""],[8099,1,""],[8100,1,""],[8101,1,""],[8102,1,""],[8103,1,""],[8104,1,""],[8105,1,""],[8106,1,""],[8107,1,""],[8108,1,""],[8109,1,""],[8110,1,""],[8111,1,""],[[8112,8113],2],[8114,1,""],[8115,1,""],[8116,1,""],[8117,3],[8118,2],[8119,1,""],[8120,1,""],[8121,1,""],[8122,1,""],[8123,1,""],[8124,1,""],[8125,1," "],[8126,1,""],[8127,1," "],[8128,1," "],[8129,1," "],[8130,1,""],[8131,1,""],[8132,1,""],[8133,3],[8134,2],[8135,1,""],[8136,1,""],[8137,1,""],[8138,1,""],[8139,1,""],[8140,1,""],[8141,1," "],[8142,1," "],[8143,1," "],[[8144,8146],2],[8147,1,""],[[8148,8149],3],[[8150,8151],2],[8152,1,""],[8153,1,""],[8154,1,""],[8155,1,""],[8156,3],[8157,1," "],[8158,1," "],[8159,1," "],[[8160,8162],2],[8163,1,""],[[8164,8167],2],[8168,1,""],[8169,1,""],[8170,1,""],[8171,1,""],[8172,1,""],[8173,1," "],[8174,1," "],[8175,1,"`"],[[8176,8177],3],[8178,1,""],[8179,1,""],[8180,1,""],[8181,3],[8182,2],[8183,1,""],[8184,1,""],[8185,1,""],[8186,1,""],[8187,1,""],[8188,1,""],[8189,1," "],[8190,1," "],[8191,3],[[8192,8202],1," "],[8203,7],[[8204,8205],6,""],[[8206,8207],3],[8208,2],[8209,1,""],[[8210,8214],2],[8215,1," "],[[8216,8227],2],[[8228,8230],3],[8231,2],[[8232,8238],3],[8239,1," "],[[8240,8242],2],[8243,1,""],[8244,1,""],[8245,2],[8246,1,""],[8247,1,""],[[8248,8251],2],[8252,1,"!!"],[8253,2],[8254,1," "],[[8255,8262],2],[8263,1,"??"],[8264,1,"?!"],[8265,1,"!?"],[[8266,8269],2],[[8270,8274],2],[[8275,8276],2],[[8277,8278],2],[8279,1,""],[[8280,8286],2],[8287,1," "],[[8288,8291],7],[8292,7],[8293,3],[[8294,8297],3],[[8298,8303],7],[8304,1,"0"],[8305,1,"i"],[[8306,8307],3],[8308,1,"4"],[8309,1,"5"],[8310,1,"6"],[8311,1,"7"],[8312,1,"8"],[8313,1,"9"],[8314,1,"+"],[8315,1,""],[8316,1,"="],[8317,1,"("],[8318,1,")"],[8319,1,"n"],[8320,1,"0"],[8321,1,"1"],[8322,1,"2"],[8323,1,"3"],[8324,1,"4"],[8325,1,"5"],[8326,1,"6"],[8327,1,"7"],[8328,1,"8"],[8329,1,"9"],[8330,1,"+"],[8331,1,""],[8332,1,"="],[8333,1,"("],[8334,1,")"],[8335,3],[8336,1,"a"],[8337,1,"e"],[8338,1,"o"],[8339,1,"x"],[8340,1,""],[8341,1,"h"],[8342,1,"k"],[8343,1,"l"],[8344,1,"m"],[8345,1,"n"],[8346,1,"p"],[8347,1,"s"],[8348,1,"t"],[[8349,8351],3],[[8352,8359],2],[8360,1,"rs"],[[8361,8362],2],[8363,2],[8364,2],[[8365,8367],2],[[8368,8369],2],[[8370,8373],2],[[8374,8376],2],[8377,2],[8378,2],[[8379,8381],2],[8382,2],[8383,2],[8384,2],[[8385,8399],3],[[8400,8417],2],[[8418,8419],2],[[8420,8426],2],[8427,2],[[8428,8431],2],[8432,2],[[8433,8447],3],[8448,1,"a/c"],[8449,1,"a/s"],[8450,1,"c"],[8451,1,"c"],[8452,2],[8453,1,"c/o"],[8454,1,"c/u"],[8455,1,""],[8456,2],[8457,1,"f"],[8458,1,"g"],[[8459,8462],1,"h"],[8463,1,""],[[8464,8465],1,"i"],[[8466,8467],1,"l"],[8468,2],[8469,1,"n"],[8470,1,"no"],[[8471,8472],2],[8473,1,"p"],[8474,1,"q"],[[8475,8477],1,"r"],[[8478,8479],2],[8480,1,"sm"],[8481,1,"tel"],[8482,1,"tm"],[8483,2],[8484,1,"z"],[8485,2],[8486,1,""],[8487,2],[8488,1,"z"],[8489,2],[8490,1,"k"],[8491,1,""],[8492,1,"b"],[8493,1,"c"],[8494,2],[[8495,8496],1,"e"],[8497,1,"f"],[8498,1,""],[8499,1,"m"],[8500,1,"o"],[8501,1,""],[8502,1,""],[8503,1,""],[8504,1,""],[8505,1,"i"],[8506,2],[8507,1,"fax"],[8508,1,""],[[8509,8510],1,""],[8511,1,""],[8512,1,""],[[8513,8516],2],[[8517,8518],1,"d"],[8519,1,"e"],[8520,1,"i"],[8521,1,"j"],[[8522,8523],2],[8524,2],[8525,2],[8526,2],[8527,2],[8528,1,"17"],[8529,1,"19"],[8530,1,"110"],[8531,1,"13"],[8532,1,"23"],[8533,1,"15"],[8534,1,"25"],[8535,1,"35"],[8536,1,"45"],[8537,1,"16"],[8538,1,"56"],[8539,1,"18"],[8540,1,"38"],[8541,1,"58"],[8542,1,"78"],[8543,1,"1"],[8544,1,"i"],[8545,1,"ii"],[8546,1,"iii"],[8547,1,"iv"],[8548,1,"v"],[8549,1,"vi"],[8550,1,"vii"],[8551,1,"viii"],[8552,1,"ix"],[8553,1,"x"],[8554,1,"xi"],[8555,1,"xii"],[8556,1,"l"],[8557,1,"c"],[8558,1,"d"],[8559,1,"m"],[8560,1,"i"],[8561,1,"ii"],[8562,1,"iii"],[8563,1,"iv"],[8564,1,"v"],[8565,1,"vi"],[8566,1,"vii"],[8567,1,"viii"],[8568,1,"ix"],[8569,1,"x"],[8570,1,"xi"],[8571,1,"xii"],[8572,1,"l"],[8573,1,"c"],[8574,1,"d"],[8575,1,"m"],[[8576,8578],2],[8579,1,""],[8580,2],[[8581,8584],2],[8585,1,"03"],[[8586,8587],2],[[8588,8591],3],[[8592,8682],2],[[8683,8691],2],[[8692,8703],2],[[8704,8747],2],[8748,1,""],[8749,1,""],[8750,2],[8751,1,""],[8752,1,""],[[8753,8945],2],[[8946,8959],2],[8960,2],[8961,2],[[8962,9e3],2],[9001,1,""],[9002,1,""],[[9003,9082],2],[9083,2],[9084,2],[[9085,9114],2],[[9115,9166],2],[[9167,9168],2],[[9169,9179],2],[[9180,9191],2],[9192,2],[[9193,9203],2],[[9204,9210],2],[[9211,9214],2],[9215,2],[[9216,9252],2],[[9253,9254],2],[[9255,9257],2],[[9258,9279],3],[[9280,9290],2],[[9291,9311],3],[9312,1,"1"],[9313,1,"2"],[9314,1,"3"],[9315,1,"4"],[9316,1,"5"],[9317,1,"6"],[9318,1,"7"],[9319,1,"8"],[9320,1,"9"],[9321,1,"10"],[9322,1,"11"],[9323,1,"12"],[9324,1,"13"],[9325,1,"14"],[9326,1,"15"],[9327,1,"16"],[9328,1,"17"],[9329,1,"18"],[9330,1,"19"],[9331,1,"20"],[9332,1,"(1)"],[9333,1,"(2)"],[9334,1,"(3)"],[9335,1,"(4)"],[9336,1,"(5)"],[9337,1,"(6)"],[9338,1,"(7)"],[9339,1,"(8)"],[9340,1,"(9)"],[9341,1,"(10)"],[9342,1,"(11)"],[9343,1,"(12)"],[9344,1,"(13)"],[9345,1,"(14)"],[9346,1,"(15)"],[9347,1,"(16)"],[9348,1,"(17)"],[9349,1,"(18)"],[9350,1,"(19)"],[9351,1,"(20)"],[[9352,9371],3],[9372,1,"(a)"],[9373,1,"(b)"],[9374,1,"(c)"],[9375,1,"(d)"],[9376,1,"(e)"],[9377,1,"(f)"],[9378,1,"(g)"],[9379,1,"(h)"],[9380,1,"(i)"],[9381,1,"(j)"],[9382,1,"(k)"],[9383,1,"(l)"],[9384,1,"(m)"],[9385,1,"(n)"],[9386,1,"(o)"],[9387,1,"(p)"],[9388,1,"(q)"],[9389,1,"(r)"],[9390,1,"(s)"],[9391,1,"(t)"],[9392,1,"(u)"],[9393,1,"(v)"],[9394,1,"(w)"],[9395,1,"(x)"],[9396,1,"(y)"],[9397,1,"(z)"],[9398,1,"a"],[9399,1,"b"],[9400,1,"c"],[9401,1,"d"],[9402,1,"e"],[9403,1,"f"],[9404,1,"g"],[9405,1,"h"],[9406,1,"i"],[9407,1,"j"],[9408,1,"k"],[9409,1,"l"],[9410,1,"m"],[9411,1,"n"],[9412,1,"o"],[9413,1,"p"],[9414,1,"q"],[9415,1,"r"],[9416,1,"s"],[9417,1,"t"],[9418,1,"u"],[9419,1,"v"],[9420,1,"w"],[9421,1,"x"],[9422,1,"y"],[9423,1,"z"],[9424,1,"a"],[9425,1,"b"],[9426,1,"c"],[9427,1,"d"],[9428,1,"e"],[9429,1,"f"],[9430,1,"g"],[9431,1,"h"],[9432,1,"i"],[9433,1,"j"],[9434,1,"k"],[9435,1,"l"],[9436,1,"m"],[9437,1,"n"],[9438,1,"o"],[9439,1,"p"],[9440,1,"q"],[9441,1,"r"],[9442,1,"s"],[9443,1,"t"],[9444,1,"u"],[9445,1,"v"],[9446,1,"w"],[9447,1,"x"],[9448,1,"y"],[9449,1,"z"],[9450,1,"0"],[[9451,9470],2],[9471,2],[[9472,9621],2],[[9622,9631],2],[[9632,9711],2],[[9712,9719],2],[[9720,9727],2],[[9728,9747],2],[[9748,9749],2],[[9750,9751],2],[9752,2],[9753,2],[[9754,9839],2],[[9840,9841],2],[[9842,9853],2],[[9854,9855],2],[[9856,9865],2],[[9866,9873],2],[[9874,9884],2],[9885,2],[[9886,9887],2],[[9888,9889],2],[[9890,9905],2],[9906,2],[[9907,9916],2],[[9917,9919],2],[[9920,9923],2],[[9924,9933],2],[9934,2],[[9935,9953],2],[9954,2],[9955,2],[[9956,9959],2],[[9960,9983],2],[9984,2],[[9985,9988],2],[9989,2],[[9990,9993],2],[[9994,9995],2],[[9996,10023],2],[10024,2],[[10025,10059],2],[10060,2],[10061,2],[10062,2],[[10063,10066],2],[[10067,10069],2],[10070,2],[10071,2],[[10072,10078],2],[[10079,10080],2],[[10081,10087],2],[[10088,10101],2],[[10102,10132],2],[[10133,10135],2],[[10136,10159],2],[10160,2],[[10161,10174],2],[10175,2],[[10176,10182],2],[[10183,10186],2],[10187,2],[10188,2],[10189,2],[[10190,10191],2],[[10192,10219],2],[[10220,10223],2],[[10224,10239],2],[[10240,10495],2],[[10496,10763],2],[10764,1,""],[[10765,10867],2],[10868,1,"::="],[10869,1,"=="],[10870,1,"==="],[[10871,10971],2],[10972,1,""],[[10973,11007],2],[[11008,11021],2],[[11022,11027],2],[[11028,11034],2],[[11035,11039],2],[[11040,11043],2],[[11044,11084],2],[[11085,11087],2],[[11088,11092],2],[[11093,11097],2],[[11098,11123],2],[[11124,11125],3],[[11126,11157],2],[11158,3],[11159,2],[[11160,11193],2],[[11194,11196],2],[[11197,11208],2],[11209,2],[[11210,11217],2],[11218,2],[[11219,11243],2],[[11244,11247],2],[[11248,11262],2],[11263,2],[11264,1,""],[11265,1,""],[11266,1,""],[11267,1,""],[11268,1,""],[11269,1,""],[11270,1,""],[11271,1,""],[11272,1,""],[11273,1,""],[11274,1,""],[11275,1,""],[11276,1,""],[11277,1,""],[11278,1,""],[11279,1,""],[11280,1,""],[11281,1,""],[11282,1,""],[11283,1,""],[11284,1,""],[11285,1,""],[11286,1,""],[11287,1,""],[11288,1,""],[11289,1,""],[11290,1,""],[11291,1,""],[11292,1,""],[11293,1,""],[11294,1,""],[11295,1,""],[11296,1,""],[11297,1,""],[11298,1,""],[11299,1,""],[11300,1,""],[11301,1,""],[11302,1,""],[11303,1,""],[11304,1,""],[11305,1,""],[11306,1,""],[11307,1,""],[11308,1,""],[11309,1,""],[11310,1,""],[11311,1,""],[[11312,11358],2],[11359,2],[11360,1,""],[11361,2],[11362,1,""],[11363,1,""],[11364,1,""],[[11365,11366],2],[11367,1,""],[11368,2],[11369,1,""],[11370,2],[11371,1,""],[11372,2],[11373,1,""],[11374,1,""],[11375,1,""],[11376,1,""],[11377,2],[11378,1,""],[11379,2],[11380,2],[11381,1,""],[[11382,11383],2],[[11384,11387],2],[11388,1,"j"],[11389,1,"v"],[11390,1,""],[11391,1,""],[11392,1,""],[11393,2],[11394,1,""],[11395,2],[11396,1,""],[11397,2],[11398,1,""],[11399,2],[11400,1,""],[11401,2],[11402,1,""],[11403,2],[11404,1,""],[11405,2],[11406,1,""],[11407,2],[11408,1,""],[11409,2],[11410,1,""],[11411,2],[11412,1,""],[11413,2],[11414,1,""],[11415,2],[11416,1,""],[11417,2],[11418,1,""],[11419,2],[11420,1,""],[11421,2],[11422,1,""],[11423,2],[11424,1,""],[11425,2],[11426,1,""],[11427,2],[11428,1,""],[11429,2],[11430,1,""],[11431,2],[11432,1,""],[11433,2],[11434,1,""],[11435,2],[11436,1,""],[11437,2],[11438,1,""],[11439,2],[11440,1,""],[11441,2],[11442,1,""],[11443,2],[11444,1,""],[11445,2],[11446,1,""],[11447,2],[11448,1,""],[11449,2],[11450,1,""],[11451,2],[11452,1,""],[11453,2],[11454,1,""],[11455,2],[11456,1,""],[11457,2],[11458,1,""],[11459,2],[11460,1,""],[11461,2],[11462,1,""],[11463,2],[11464,1,""],[11465,2],[11466,1,""],[11467,2],[11468,1,""],[11469,2],[11470,1,""],[11471,2],[11472,1,""],[11473,2],[11474,1,""],[11475,2],[11476,1,""],[11477,2],[11478,1,""],[11479,2],[11480,1,""],[11481,2],[11482,1,""],[11483,2],[11484,1,""],[11485,2],[11486,1,""],[11487,2],[11488,1,""],[11489,2],[11490,1,""],[[11491,11492],2],[[11493,11498],2],[11499,1,""],[11500,2],[11501,1,""],[[11502,11505],2],[11506,1,""],[11507,2],[[11508,11512],3],[[11513,11519],2],[[11520,11557],2],[11558,3],[11559,2],[[11560,11564],3],[11565,2],[[11566,11567],3],[[11568,11621],2],[[11622,11623],2],[[11624,11630],3],[11631,1,""],[11632,2],[[11633,11646],3],[11647,2],[[11648,11670],2],[[11671,11679],3],[[11680,11686],2],[11687,3],[[11688,11694],2],[11695,3],[[11696,11702],2],[11703,3],[[11704,11710],2],[11711,3],[[11712,11718],2],[11719,3],[[11720,11726],2],[11727,3],[[11728,11734],2],[11735,3],[[11736,11742],2],[11743,3],[[11744,11775],2],[[11776,11799],2],[[11800,11803],2],[[11804,11805],2],[[11806,11822],2],[11823,2],[11824,2],[11825,2],[[11826,11835],2],[[11836,11842],2],[[11843,11844],2],[[11845,11849],2],[[11850,11854],2],[11855,2],[[11856,11858],2],[[11859,11869],2],[[11870,11903],3],[[11904,11929],2],[11930,3],[[11931,11934],2],[11935,1,""],[[11936,12018],2],[12019,1,""],[[12020,12031],3],[12032,1,""],[12033,1,""],[12034,1,""],[12035,1,""],[12036,1,""],[12037,1,""],[12038,1,""],[12039,1,""],[12040,1,""],[12041,1,""],[12042,1,""],[12043,1,""],[12044,1,""],[12045,1,""],[12046,1,""],[12047,1,""],[12048,1,""],[12049,1,""],[12050,1,""],[12051,1,""],[12052,1,""],[12053,1,""],[12054,1,""],[12055,1,""],[12056,1,""],[12057,1,""],[12058,1,""],[12059,1,""],[12060,1,""],[12061,1,""],[12062,1,""],[12063,1,""],[12064,1,""],[12065,1,""],[12066,1,""],[12067,1,""],[12068,1,""],[12069,1,""],[12070,1,""],[12071,1,""],[12072,1,""],[12073,1,""],[12074,1,""],[12075,1,""],[12076,1,""],[12077,1,""],[12078,1,""],[12079,1,""],[12080,1,""],[12081,1,""],[12082,1,""],[12083,1,""],[12084,1,""],[12085,1,""],[12086,1,""],[12087,1,""],[12088,1,""],[12089,1,""],[12090,1,""],[12091,1,""],[12092,1,""],[12093,1,""],[12094,1,""],[12095,1,""],[12096,1,""],[12097,1,""],[12098,1,""],[12099,1,""],[12100,1,""],[12101,1,""],[12102,1,""],[12103,1,""],[12104,1,""],[12105,1,""],[12106,1,""],[12107,1,""],[12108,1,""],[12109,1,""],[12110,1,""],[12111,1,""],[12112,1,""],[12113,1,""],[12114,1,""],[12115,1,""],[12116,1,""],[12117,1,""],[12118,1,""],[12119,1,""],[12120,1,""],[12121,1,""],[12122,1,""],[12123,1,""],[12124,1,""],[12125,1,""],[12126,1,""],[12127,1,""],[12128,1,""],[12129,1,""],[12130,1,""],[12131,1,""],[12132,1,""],[12133,1,""],[12134,1,""],[12135,1,""],[12136,1,""],[12137,1,""],[12138,1,""],[12139,1,""],[12140,1,""],[12141,1,""],[12142,1,""],[12143,1,""],[12144,1,""],[12145,1,""],[12146,1,""],[12147,1,""],[12148,1,""],[12149,1,""],[12150,1,""],[12151,1,""],[12152,1,""],[12153,1,""],[12154,1,""],[12155,1,""],[12156,1,""],[12157,1,""],[12158,1,""],[12159,1,""],[12160,1,""],[12161,1,""],[12162,1,""],[12163,1,""],[12164,1,""],[12165,1,""],[12166,1,""],[12167,1,""],[12168,1,""],[12169,1,""],[12170,1,""],[12171,1,""],[12172,1,""],[12173,1,""],[12174,1,""],[12175,1,""],[12176,1,""],[12177,1,""],[12178,1,""],[12179,1,""],[12180,1,""],[12181,1,""],[12182,1,""],[12183,1,""],[12184,1,""],[12185,1,""],[12186,1,""],[12187,1,""],[12188,1,""],[12189,1,""],[12190,1,""],[12191,1,""],[12192,1,""],[12193,1,""],[12194,1,""],[12195,1,""],[12196,1,""],[12197,1,""],[12198,1,""],[12199,1,""],[12200,1,""],[12201,1,""],[12202,1,""],[12203,1,""],[12204,1,""],[12205,1,""],[12206,1,""],[12207,1,""],[12208,1,""],[12209,1,""],[12210,1,""],[12211,1,""],[12212,1,""],[12213,1,""],[12214,1,""],[12215,1,""],[12216,1,""],[12217,1,""],[12218,1,""],[12219,1,""],[12220,1,""],[12221,1,""],[12222,1,""],[12223,1,""],[12224,1,""],[12225,1,""],[12226,1,""],[12227,1,""],[12228,1,""],[12229,1,""],[12230,1,""],[12231,1,""],[12232,1,""],[12233,1,""],[12234,1,""],[12235,1,""],[12236,1,""],[12237,1,""],[12238,1,""],[12239,1,""],[12240,1,""],[12241,1,""],[12242,1,""],[12243,1,""],[12244,1,""],[12245,1,""],[[12246,12271],3],[[12272,12283],3],[[12284,12287],3],[12288,1," "],[12289,2],[12290,1,"."],[[12291,12292],2],[[12293,12295],2],[[12296,12329],2],[[12330,12333],2],[[12334,12341],2],[12342,1,""],[12343,2],[12344,1,""],[12345,1,""],[12346,1,""],[12347,2],[12348,2],[12349,2],[12350,2],[12351,2],[12352,3],[[12353,12436],2],[[12437,12438],2],[[12439,12440],3],[[12441,12442],2],[12443,1," "],[12444,1," "],[[12445,12446],2],[12447,1,""],[12448,2],[[12449,12542],2],[12543,1,""],[[12544,12548],3],[[12549,12588],2],[12589,2],[12590,2],[12591,2],[12592,3],[12593,1,""],[12594,1,""],[12595,1,""],[12596,1,""],[12597,1,""],[12598,1,""],[12599,1,""],[12600,1,""],[12601,1,""],[12602,1,""],[12603,1,""],[12604,1,""],[12605,1,""],[12606,1,""],[12607,1,""],[12608,1,""],[12609,1,""],[12610,1,""],[12611,1,""],[12612,1,""],[12613,1,""],[12614,1,""],[12615,1,""],[12616,1,""],[12617,1,""],[12618,1,""],[12619,1,""],[12620,1,""],[12621,1,""],[12622,1,""],[12623,1,""],[12624,1,""],[12625,1,""],[12626,1,""],[12627,1,""],[12628,1,""],[12629,1,""],[12630,1,""],[12631,1,""],[12632,1,""],[12633,1,""],[12634,1,""],[12635,1,""],[12636,1,""],[12637,1,""],[12638,1,""],[12639,1,""],[12640,1,""],[12641,1,""],[12642,1,""],[12643,1,""],[12644,7],[12645,1,""],[12646,1,""],[12647,1,""],[12648,1,""],[12649,1,""],[12650,1,""],[12651,1,""],[12652,1,""],[12653,1,""],[12654,1,""],[12655,1,""],[12656,1,""],[12657,1,""],[12658,1,""],[12659,1,""],[12660,1,""],[12661,1,""],[12662,1,""],[12663,1,""],[12664,1,""],[12665,1,""],[12666,1,""],[12667,1,""],[12668,1,""],[12669,1,""],[12670,1,""],[12671,1,""],[12672,1,""],[12673,1,""],[12674,1,""],[12675,1,""],[12676,1,""],[12677,1,""],[12678,1,""],[12679,1,""],[12680,1,""],[12681,1,""],[12682,1,""],[12683,1,""],[12684,1,""],[12685,1,""],[12686,1,""],[12687,3],[[12688,12689],2],[12690,1,""],[12691,1,""],[12692,1,""],[12693,1,""],[12694,1,""],[12695,1,""],[12696,1,""],[12697,1,""],[12698,1,""],[12699,1,""],[12700,1,""],[12701,1,""],[12702,1,""],[12703,1,""],[[12704,12727],2],[[12728,12730],2],[[12731,12735],2],[[12736,12751],2],[[12752,12771],2],[[12772,12773],2],[[12774,12782],3],[12783,3],[[12784,12799],2],[12800,1,"()"],[12801,1,"()"],[12802,1,"()"],[12803,1,"()"],[12804,1,"()"],[12805,1,"()"],[12806,1,"()"],[12807,1,"()"],[12808,1,"()"],[12809,1,"()"],[12810,1,"()"],[12811,1,"()"],[12812,1,"()"],[12813,1,"()"],[12814,1,"()"],[12815,1,"()"],[12816,1,"()"],[12817,1,"()"],[12818,1,"()"],[12819,1,"()"],[12820,1,"()"],[12821,1,"()"],[12822,1,"()"],[12823,1,"()"],[12824,1,"()"],[12825,1,"()"],[12826,1,"()"],[12827,1,"()"],[12828,1,"()"],[12829,1,"()"],[12830,1,"()"],[12831,3],[12832,1,"()"],[12833,1,"()"],[12834,1,"()"],[12835,1,"()"],[12836,1,"()"],[12837,1,"()"],[12838,1,"()"],[12839,1,"()"],[12840,1,"()"],[12841,1,"()"],[12842,1,"()"],[12843,1,"()"],[12844,1,"()"],[12845,1,"()"],[12846,1,"()"],[12847,1,"()"],[12848,1,"()"],[12849,1,"()"],[12850,1,"()"],[12851,1,"()"],[12852,1,"()"],[12853,1,"()"],[12854,1,"()"],[12855,1,"()"],[12856,1,"()"],[12857,1,"()"],[12858,1,"()"],[12859,1,"()"],[12860,1,"()"],[12861,1,"()"],[12862,1,"()"],[12863,1,"()"],[12864,1,"()"],[12865,1,"()"],[12866,1,"()"],[12867,1,"()"],[12868,1,""],[12869,1,""],[12870,1,""],[12871,1,""],[[12872,12879],2],[12880,1,"pte"],[12881,1,"21"],[12882,1,"22"],[12883,1,"23"],[12884,1,"24"],[12885,1,"25"],[12886,1,"26"],[12887,1,"27"],[12888,1,"28"],[12889,1,"29"],[12890,1,"30"],[12891,1,"31"],[12892,1,"32"],[12893,1,"33"],[12894,1,"34"],[12895,1,"35"],[12896,1,""],[12897,1,""],[12898,1,""],[12899,1,""],[12900,1,""],[12901,1,""],[12902,1,""],[12903,1,""],[12904,1,""],[12905,1,""],[12906,1,""],[12907,1,""],[12908,1,""],[12909,1,""],[12910,1,""],[12911,1,""],[12912,1,""],[12913,1,""],[12914,1,""],[12915,1,""],[12916,1,""],[12917,1,""],[12918,1,""],[12919,1,""],[12920,1,""],[12921,1,""],[12922,1,""],[12923,1,""],[12924,1,""],[12925,1,""],[12926,1,""],[12927,2],[12928,1,""],[12929,1,""],[12930,1,""],[12931,1,""],[12932,1,""],[12933,1,""],[12934,1,""],[12935,1,""],[12936,1,""],[12937,1,""],[12938,1,""],[12939,1,""],[12940,1,""],[12941,1,""],[12942,1,""],[12943,1,""],[12944,1,""],[12945,1,""],[12946,1,""],[12947,1,""],[12948,1,""],[12949,1,""],[12950,1,""],[12951,1,""],[12952,1,""],[12953,1,""],[12954,1,""],[12955,1,""],[12956,1,""],[12957,1,""],[12958,1,""],[12959,1,""],[12960,1,""],[12961,1,""],[12962,1,""],[12963,1,""],[12964,1,""],[12965,1,""],[12966,1,""],[12967,1,""],[12968,1,""],[12969,1,""],[12970,1,""],[12971,1,""],[12972,1,""],[12973,1,""],[12974,1,""],[12975,1,""],[12976,1,""],[12977,1,"36"],[12978,1,"37"],[12979,1,"38"],[12980,1,"39"],[12981,1,"40"],[12982,1,"41"],[12983,1,"42"],[12984,1,"43"],[12985,1,"44"],[12986,1,"45"],[12987,1,"46"],[12988,1,"47"],[12989,1,"48"],[12990,1,"49"],[12991,1,"50"],[12992,1,"1"],[12993,1,"2"],[12994,1,"3"],[12995,1,"4"],[12996,1,"5"],[12997,1,"6"],[12998,1,"7"],[12999,1,"8"],[13e3,1,"9"],[13001,1,"10"],[13002,1,"11"],[13003,1,"12"],[13004,1,"hg"],[13005,1,"erg"],[13006,1,"ev"],[13007,1,"ltd"],[13008,1,""],[13009,1,""],[13010,1,""],[13011,1,""],[13012,1,""],[13013,1,""],[13014,1,""],[13015,1,""],[13016,1,""],[13017,1,""],[13018,1,""],[13019,1,""],[13020,1,""],[13021,1,""],[13022,1,""],[13023,1,""],[13024,1,""],[13025,1,""],[13026,1,""],[13027,1,""],[13028,1,""],[13029,1,""],[13030,1,""],[13031,1,""],[13032,1,""],[13033,1,""],[13034,1,""],[13035,1,""],[13036,1,""],[13037,1,""],[13038,1,""],[13039,1,""],[13040,1,""],[13041,1,""],[13042,1,""],[13043,1,""],[13044,1,""],[13045,1,""],[13046,1,""],[13047,1,""],[13048,1,""],[13049,1,""],[13050,1,""],[13051,1,""],[13052,1,""],[13053,1,""],[13054,1,""],[13055,1,""],[13056,1,""],[13057,1,""],[13058,1,""],[13059,1,""],[13060,1,""],[13061,1,""],[13062,1,""],[13063,1,""],[13064,1,""],[13065,1,""],[13066,1,""],[13067,1,""],[13068,1,""],[13069,1,""],[13070,1,""],[13071,1,""],[13072,1,""],[13073,1,""],[13074,1,""],[13075,1,""],[13076,1,""],[13077,1,""],[13078,1,""],[13079,1,""],[13080,1,""],[13081,1,""],[13082,1,""],[13083,1,""],[13084,1,""],[13085,1,""],[13086,1,""],[13087,1,""],[13088,1,""],[13089,1,""],[13090,1,""],[13091,1,""],[13092,1,""],[13093,1,""],[13094,1,""],[13095,1,""],[13096,1,""],[13097,1,""],[13098,1,""],[13099,1,""],[13100,1,""],[13101,1,""],[13102,1,""],[13103,1,""],[13104,1,""],[13105,1,""],[13106,1,""],[13107,1,""],[13108,1,""],[13109,1,""],[13110,1,""],[13111,1,""],[13112,1,""],[13113,1,""],[13114,1,""],[13115,1,""],[13116,1,""],[13117,1,""],[13118,1,""],[13119,1,""],[13120,1,""],[13121,1,""],[13122,1,""],[13123,1,""],[13124,1,""],[13125,1,""],[13126,1,""],[13127,1,""],[13128,1,""],[13129,1,""],[13130,1,""],[13131,1,""],[13132,1,""],[13133,1,""],[13134,1,""],[13135,1,""],[13136,1,""],[13137,1,""],[13138,1,""],[13139,1,""],[13140,1,""],[13141,1,""],[13142,1,""],[13143,1,""],[13144,1,"0"],[13145,1,"1"],[13146,1,"2"],[13147,1,"3"],[13148,1,"4"],[13149,1,"5"],[13150,1,"6"],[13151,1,"7"],[13152,1,"8"],[13153,1,"9"],[13154,1,"10"],[13155,1,"11"],[13156,1,"12"],[13157,1,"13"],[13158,1,"14"],[13159,1,"15"],[13160,1,"16"],[13161,1,"17"],[13162,1,"18"],[13163,1,"19"],[13164,1,"20"],[13165,1,"21"],[13166,1,"22"],[13167,1,"23"],[13168,1,"24"],[13169,1,"hpa"],[13170,1,"da"],[13171,1,"au"],[13172,1,"bar"],[13173,1,"ov"],[13174,1,"pc"],[13175,1,"dm"],[13176,1,"dm2"],[13177,1,"dm3"],[13178,1,"iu"],[13179,1,""],[13180,1,""],[13181,1,""],[13182,1,""],[13183,1,""],[13184,1,"pa"],[13185,1,"na"],[13186,1,"a"],[13187,1,"ma"],[13188,1,"ka"],[13189,1,"kb"],[13190,1,"mb"],[13191,1,"gb"],[13192,1,"cal"],[13193,1,"kcal"],[13194,1,"pf"],[13195,1,"nf"],[13196,1,"f"],[13197,1,"g"],[13198,1,"mg"],[13199,1,"kg"],[13200,1,"hz"],[13201,1,"khz"],[13202,1,"mhz"],[13203,1,"ghz"],[13204,1,"thz"],[13205,1,"l"],[13206,1,"ml"],[13207,1,"dl"],[13208,1,"kl"],[13209,1,"fm"],[13210,1,"nm"],[13211,1,"m"],[13212,1,"mm"],[13213,1,"cm"],[13214,1,"km"],[13215,1,"mm2"],[13216,1,"cm2"],[13217,1,"m2"],[13218,1,"km2"],[13219,1,"mm3"],[13220,1,"cm3"],[13221,1,"m3"],[13222,1,"km3"],[13223,1,"ms"],[13224,1,"ms2"],[13225,1,"pa"],[13226,1,"kpa"],[13227,1,"mpa"],[13228,1,"gpa"],[13229,1,"rad"],[13230,1,"rads"],[13231,1,"rads2"],[13232,1,"ps"],[13233,1,"ns"],[13234,1,"s"],[13235,1,"ms"],[13236,1,"pv"],[13237,1,"nv"],[13238,1,"v"],[13239,1,"mv"],[13240,1,"kv"],[13241,1,"mv"],[13242,1,"pw"],[13243,1,"nw"],[13244,1,"w"],[13245,1,"mw"],[13246,1,"kw"],[13247,1,"mw"],[13248,1,"k"],[13249,1,"m"],[13250,3],[13251,1,"bq"],[13252,1,"cc"],[13253,1,"cd"],[13254,1,"ckg"],[13255,3],[13256,1,"db"],[13257,1,"gy"],[13258,1,"ha"],[13259,1,"hp"],[13260,1,"in"],[13261,1,"kk"],[13262,1,"km"],[13263,1,"kt"],[13264,1,"lm"],[13265,1,"ln"],[13266,1,"log"],[13267,1,"lx"],[13268,1,"mb"],[13269,1,"mil"],[13270,1,"mol"],[13271,1,"ph"],[13272,3],[13273,1,"ppm"],[13274,1,"pr"],[13275,1,"sr"],[13276,1,"sv"],[13277,1,"wb"],[13278,1,"vm"],[13279,1,"am"],[13280,1,"1"],[13281,1,"2"],[13282,1,"3"],[13283,1,"4"],[13284,1,"5"],[13285,1,"6"],[13286,1,"7"],[13287,1,"8"],[13288,1,"9"],[13289,1,"10"],[13290,1,"11"],[13291,1,"12"],[13292,1,"13"],[13293,1,"14"],[13294,1,"15"],[13295,1,"16"],[13296,1,"17"],[13297,1,"18"],[13298,1,"19"],[13299,1,"20"],[13300,1,"21"],[13301,1,"22"],[13302,1,"23"],[13303,1,"24"],[13304,1,"25"],[13305,1,"26"],[13306,1,"27"],[13307,1,"28"],[13308,1,"29"],[13309,1,"30"],[13310,1,"31"],[13311,1,"gal"],[[13312,19893],2],[[19894,19903],2],[[19904,19967],2],[[19968,40869],2],[[40870,40891],2],[[40892,40899],2],[[40900,40907],2],[40908,2],[[40909,40917],2],[[40918,40938],2],[[40939,40943],2],[[40944,40956],2],[[40957,40959],2],[[40960,42124],2],[[42125,42127],3],[[42128,42145],2],[[42146,42147],2],[[42148,42163],2],[42164,2],[[42165,42176],2],[42177,2],[[42178,42180],2],[42181,2],[42182,2],[[42183,42191],3],[[42192,42237],2],[[42238,42239],2],[[42240,42508],2],[[42509,42511],2],[[42512,42539],2],[[42540,42559],3],[42560,1,""],[42561,2],[42562,1,""],[42563,2],[42564,1,""],[42565,2],[42566,1,""],[42567,2],[42568,1,""],[42569,2],[42570,1,""],[42571,2],[42572,1,""],[42573,2],[42574,1,""],[42575,2],[42576,1,""],[42577,2],[42578,1,""],[42579,2],[42580,1,""],[42581,2],[42582,1,""],[42583,2],[42584,1,""],[42585,2],[42586,1,""],[42587,2],[42588,1,""],[42589,2],[42590,1,""],[42591,2],[42592,1,""],[42593,2],[42594,1,""],[42595,2],[42596,1,""],[42597,2],[42598,1,""],[42599,2],[42600,1,""],[42601,2],[42602,1,""],[42603,2],[42604,1,""],[[42605,42607],2],[[42608,42611],2],[[42612,42619],2],[[42620,42621],2],[42622,2],[42623,2],[42624,1,""],[42625,2],[42626,1,""],[42627,2],[42628,1,""],[42629,2],[42630,1,""],[42631,2],[42632,1,""],[42633,2],[42634,1,""],[42635,2],[42636,1,""],[42637,2],[42638,1,""],[42639,2],[42640,1,""],[42641,2],[42642,1,""],[42643,2],[42644,1,""],[42645,2],[42646,1,""],[42647,2],[42648,1,""],[42649,2],[42650,1,""],[42651,2],[42652,1,""],[42653,1,""],[42654,2],[42655,2],[[42656,42725],2],[[42726,42735],2],[[42736,42737],2],[[42738,42743],2],[[42744,42751],3],[[42752,42774],2],[[42775,42778],2],[[42779,42783],2],[[42784,42785],2],[42786,1,""],[42787,2],[42788,1,""],[42789,2],[42790,1,""],[42791,2],[42792,1,""],[42793,2],[42794,1,""],[42795,2],[42796,1,""],[42797,2],[42798,1,""],[[42799,42801],2],[42802,1,""],[42803,2],[42804,1,""],[42805,2],[42806,1,""],[42807,2],[42808,1,""],[42809,2],[42810,1,""],[42811,2],[42812,1,""],[42813,2],[42814,1,""],[42815,2],[42816,1,""],[42817,2],[42818,1,""],[42819,2],[42820,1,""],[42821,2],[42822,1,""],[42823,2],[42824,1,""],[42825,2],[42826,1,""],[42827,2],[42828,1,""],[42829,2],[42830,1,""],[42831,2],[42832,1,""],[42833,2],[42834,1,""],[42835,2],[42836,1,""],[42837,2],[42838,1,""],[42839,2],[42840,1,""],[42841,2],[42842,1,""],[42843,2],[42844,1,""],[42845,2],[42846,1,""],[42847,2],[42848,1,""],[42849,2],[42850,1,""],[42851,2],[42852,1,""],[42853,2],[42854,1,""],[42855,2],[42856,1,""],[42857,2],[42858,1,""],[42859,2],[42860,1,""],[42861,2],[42862,1,""],[42863,2],[42864,1,""],[[42865,42872],2],[42873,1,""],[42874,2],[42875,1,""],[42876,2],[42877,1,""],[42878,1,""],[42879,2],[42880,1,""],[42881,2],[42882,1,""],[42883,2],[42884,1,""],[42885,2],[42886,1,""],[[42887,42888],2],[[42889,42890],2],[42891,1,""],[42892,2],[42893,1,""],[42894,2],[42895,2],[42896,1,""],[42897,2],[42898,1,""],[42899,2],[[42900,42901],2],[42902,1,""],[42903,2],[42904,1,""],[42905,2],[42906,1,""],[42907,2],[42908,1,""],[42909,2],[42910,1,""],[42911,2],[42912,1,""],[42913,2],[42914,1,""],[42915,2],[42916,1,""],[42917,2],[42918,1,""],[42919,2],[42920,1,""],[42921,2],[42922,1,""],[42923,1,""],[42924,1,""],[42925,1,""],[42926,1,""],[42927,2],[42928,1,""],[42929,1,""],[42930,1,""],[42931,1,""],[42932,1,""],[42933,2],[42934,1,""],[42935,2],[42936,1,""],[42937,2],[42938,1,""],[42939,2],[42940,1,""],[42941,2],[42942,1,""],[42943,2],[42944,1,""],[42945,2],[42946,1,""],[42947,2],[42948,1,""],[42949,1,""],[42950,1,""],[42951,1,""],[42952,2],[42953,1,""],[42954,2],[42955,1,""],[42956,1,""],[42957,2],[[42958,42959],3],[42960,1,""],[42961,2],[42962,3],[42963,2],[42964,3],[42965,2],[42966,1,""],[42967,2],[42968,1,""],[42969,2],[42970,1,""],[42971,2],[42972,1,""],[[42973,42993],3],[42994,1,"c"],[42995,1,"f"],[42996,1,"q"],[42997,1,""],[42998,2],[42999,2],[43e3,1,""],[43001,1,""],[43002,2],[[43003,43007],2],[[43008,43047],2],[[43048,43051],2],[43052,2],[[43053,43055],3],[[43056,43065],2],[[43066,43071],3],[[43072,43123],2],[[43124,43127],2],[[43128,43135],3],[[43136,43204],2],[43205,2],[[43206,43213],3],[[43214,43215],2],[[43216,43225],2],[[43226,43231],3],[[43232,43255],2],[[43256,43258],2],[43259,2],[43260,2],[43261,2],[[43262,43263],2],[[43264,43309],2],[[43310,43311],2],[[43312,43347],2],[[43348,43358],3],[43359,2],[[43360,43388],2],[[43389,43391],3],[[43392,43456],2],[[43457,43469],2],[43470,3],[[43471,43481],2],[[43482,43485],3],[[43486,43487],2],[[43488,43518],2],[43519,3],[[43520,43574],2],[[43575,43583],3],[[43584,43597],2],[[43598,43599],3],[[43600,43609],2],[[43610,43611],3],[[43612,43615],2],[[43616,43638],2],[[43639,43641],2],[[43642,43643],2],[[43644,43647],2],[[43648,43714],2],[[43715,43738],3],[[43739,43741],2],[[43742,43743],2],[[43744,43759],2],[[43760,43761],2],[[43762,43766],2],[[43767,43776],3],[[43777,43782],2],[[43783,43784],3],[[43785,43790],2],[[43791,43792],3],[[43793,43798],2],[[43799,43807],3],[[43808,43814],2],[43815,3],[[43816,43822],2],[43823,3],[[43824,43866],2],[43867,2],[43868,1,""],[43869,1,""],[43870,1,""],[43871,1,""],[[43872,43875],2],[[43876,43877],2],[[43878,43879],2],[43880,2],[43881,1,""],[[43882,43883],2],[[43884,43887],3],[43888,1,""],[43889,1,""],[43890,1,""],[43891,1,""],[43892,1,""],[43893,1,""],[43894,1,""],[43895,1,""],[43896,1,""],[43897,1,""],[43898,1,""],[43899,1,""],[43900,1,""],[43901,1,""],[43902,1,""],[43903,1,""],[43904,1,""],[43905,1,""],[43906,1,""],[43907,1,""],[43908,1,""],[43909,1,""],[43910,1,""],[43911,1,""],[43912,1,""],[43913,1,""],[43914,1,""],[43915,1,""],[43916,1,""],[43917,1,""],[43918,1,""],[43919,1,""],[43920,1,""],[43921,1,""],[43922,1,""],[43923,1,""],[43924,1,""],[43925,1,""],[43926,1,""],[43927,1,""],[43928,1,""],[43929,1,""],[43930,1,""],[43931,1,""],[43932,1,""],[43933,1,""],[43934,1,""],[43935,1,""],[43936,1,""],[43937,1,""],[43938,1,""],[43939,1,""],[43940,1,""],[43941,1,""],[43942,1,""],[43943,1,""],[43944,1,""],[43945,1,""],[43946,1,""],[43947,1,""],[43948,1,""],[43949,1,""],[43950,1,""],[43951,1,""],[43952,1,""],[43953,1,""],[43954,1,""],[43955,1,""],[43956,1,""],[43957,1,""],[43958,1,""],[43959,1,""],[43960,1,""],[43961,1,""],[43962,1,""],[43963,1,""],[43964,1,""],[43965,1,""],[43966,1,""],[43967,1,""],[[43968,44010],2],[44011,2],[[44012,44013],2],[[44014,44015],3],[[44016,44025],2],[[44026,44031],3],[[44032,55203],2],[[55204,55215],3],[[55216,55238],2],[[55239,55242],3],[[55243,55291],2],[[55292,55295],3],[[55296,57343],3],[[57344,63743],3],[63744,1,""],[63745,1,""],[63746,1,""],[63747,1,""],[63748,1,""],[63749,1,""],[63750,1,""],[[63751,63752],1,""],[63753,1,""],[63754,1,""],[63755,1,""],[63756,1,""],[63757,1,""],[63758,1,""],[63759,1,""],[63760,1,""],[63761,1,""],[63762,1,""],[63763,1,""],[63764,1,""],[63765,1,""],[63766,1,""],[63767,1,""],[63768,1,""],[63769,1,""],[63770,1,""],[63771,1,""],[63772,1,""],[63773,1,""],[63774,1,""],[63775,1,""],[63776,1,""],[63777,1,""],[63778,1,""],[63779,1,""],[63780,1,""],[63781,1,""],[63782,1,""],[63783,1,""],[63784,1,""],[63785,1,""],[63786,1,""],[63787,1,""],[63788,1,""],[63789,1,""],[63790,1,""],[63791,1,""],[63792,1,""],[63793,1,""],[63794,1,""],[63795,1,""],[63796,1,""],[63797,1,""],[63798,1,""],[63799,1,""],[63800,1,""],[63801,1,""],[63802,1,""],[63803,1,""],[63804,1,""],[63805,1,""],[63806,1,""],[63807,1,""],[63808,1,""],[63809,1,""],[63810,1,""],[63811,1,""],[63812,1,""],[63813,1,""],[63814,1,""],[63815,1,""],[63816,1,""],[63817,1,""],[63818,1,""],[63819,1,""],[63820,1,""],[63821,1,""],[63822,1,""],[63823,1,""],[63824,1,""],[63825,1,""],[63826,1,""],[63827,1,""],[63828,1,""],[63829,1,""],[63830,1,""],[63831,1,""],[63832,1,""],[63833,1,""],[63834,1,""],[63835,1,""],[63836,1,""],[63837,1,""],[63838,1,""],[63839,1,""],[63840,1,""],[63841,1,""],[63842,1,""],[63843,1,""],[63844,1,""],[63845,1,""],[63846,1,""],[63847,1,""],[63848,1,""],[63849,1,""],[63850,1,""],[63851,1,""],[63852,1,""],[63853,1,""],[63854,1,""],[63855,1,""],[63856,1,""],[63857,1,""],[63858,1,""],[63859,1,""],[63860,1,""],[63861,1,""],[63862,1,""],[63863,1,""],[63864,1,""],[63865,1,""],[63866,1,""],[63867,1,""],[63868,1,""],[63869,1,""],[63870,1,""],[63871,1,""],[63872,1,""],[63873,1,""],[63874,1,""],[63875,1,""],[63876,1,""],[63877,1,""],[63878,1,""],[63879,1,""],[63880,1,""],[63881,1,""],[63882,1,""],[63883,1,""],[63884,1,""],[63885,1,""],[63886,1,""],[63887,1,""],[63888,1,""],[63889,1,""],[63890,1,""],[63891,1,""],[63892,1,""],[63893,1,""],[63894,1,""],[63895,1,""],[63896,1,""],[63897,1,""],[63898,1,""],[63899,1,""],[63900,1,""],[63901,1,""],[63902,1,""],[63903,1,""],[63904,1,""],[63905,1,""],[63906,1,""],[63907,1,""],[63908,1,""],[63909,1,""],[63910,1,""],[63911,1,""],[63912,1,""],[63913,1,""],[63914,1,""],[63915,1,""],[63916,1,""],[63917,1,""],[63918,1,""],[63919,1,""],[63920,1,""],[63921,1,""],[63922,1,""],[63923,1,""],[63924,1,""],[63925,1,""],[63926,1,""],[63927,1,""],[63928,1,""],[63929,1,""],[63930,1,""],[63931,1,""],[63932,1,""],[63933,1,""],[63934,1,""],[63935,1,""],[63936,1,""],[63937,1,""],[63938,1,""],[63939,1,""],[63940,1,""],[63941,1,""],[63942,1,""],[63943,1,""],[63944,1,""],[63945,1,""],[63946,1,""],[63947,1,""],[63948,1,""],[63949,1,""],[63950,1,""],[63951,1,""],[63952,1,""],[63953,1,""],[63954,1,""],[63955,1,""],[63956,1,""],[63957,1,""],[63958,1,""],[63959,1,""],[63960,1,""],[63961,1,""],[63962,1,""],[63963,1,""],[63964,1,""],[63965,1,""],[63966,1,""],[63967,1,""],[63968,1,""],[63969,1,""],[63970,1,""],[63971,1,""],[63972,1,""],[63973,1,""],[63974,1,""],[63975,1,""],[63976,1,""],[63977,1,""],[63978,1,""],[63979,1,""],[63980,1,""],[63981,1,""],[63982,1,""],[63983,1,""],[63984,1,""],[63985,1,""],[63986,1,""],[63987,1,""],[63988,1,""],[63989,1,""],[63990,1,""],[63991,1,""],[63992,1,""],[63993,1,""],[63994,1,""],[63995,1,""],[63996,1,""],[63997,1,""],[63998,1,""],[63999,1,""],[64e3,1,""],[64001,1,""],[64002,1,""],[64003,1,""],[64004,1,""],[64005,1,""],[64006,1,""],[64007,1,""],[64008,1,""],[64009,1,""],[64010,1,""],[64011,1,""],[64012,1,""],[64013,1,""],[[64014,64015],2],[64016,1,""],[64017,2],[64018,1,""],[[64019,64020],2],[64021,1,""],[64022,1,""],[64023,1,""],[64024,1,""],[64025,1,""],[64026,1,""],[64027,1,""],[64028,1,""],[64029,1,""],[64030,1,""],[64031,2],[64032,1,""],[64033,2],[64034,1,""],[[64035,64036],2],[64037,1,""],[64038,1,""],[[64039,64041],2],[64042,1,""],[64043,1,""],[64044,1,""],[64045,1,""],[64046,1,""],[64047,1,""],[64048,1,""],[64049,1,""],[64050,1,""],[64051,1,""],[64052,1,""],[64053,1,""],[64054,1,""],[64055,1,""],[64056,1,""],[64057,1,""],[64058,1,""],[64059,1,""],[64060,1,""],[64061,1,""],[64062,1,""],[64063,1,""],[64064,1,""],[64065,1,""],[64066,1,""],[64067,1,""],[64068,1,""],[64069,1,""],[64070,1,""],[64071,1,""],[64072,1,""],[64073,1,""],[64074,1,""],[64075,1,""],[64076,1,""],[64077,1,""],[64078,1,""],[64079,1,""],[64080,1,""],[64081,1,""],[64082,1,""],[64083,1,""],[64084,1,""],[64085,1,""],[64086,1,""],[64087,1,""],[64088,1,""],[64089,1,""],[64090,1,""],[64091,1,""],[64092,1,""],[[64093,64094],1,""],[64095,1,""],[64096,1,""],[64097,1,""],[64098,1,""],[64099,1,""],[64100,1,""],[64101,1,""],[64102,1,""],[64103,1,""],[64104,1,""],[64105,1,""],[64106,1,""],[64107,1,""],[64108,1,""],[64109,1,""],[[64110,64111],3],[64112,1,""],[64113,1,""],[64114,1,""],[64115,1,""],[64116,1,""],[64117,1,""],[64118,1,""],[64119,1,""],[64120,1,""],[64121,1,""],[64122,1,""],[64123,1,""],[64124,1,""],[64125,1,""],[64126,1,""],[64127,1,""],[64128,1,""],[64129,1,""],[64130,1,""],[64131,1,""],[64132,1,""],[64133,1,""],[64134,1,""],[64135,1,""],[64136,1,""],[64137,1,""],[64138,1,""],[64139,1,""],[64140,1,""],[64141,1,""],[64142,1,""],[64143,1,""],[64144,1,""],[64145,1,""],[64146,1,""],[64147,1,""],[64148,1,""],[64149,1,""],[64150,1,""],[64151,1,""],[64152,1,""],[64153,1,""],[64154,1,""],[64155,1,""],[64156,1,""],[64157,1,""],[64158,1,""],[64159,1,""],[64160,1,""],[64161,1,""],[64162,1,""],[64163,1,""],[64164,1,""],[64165,1,""],[64166,1,""],[64167,1,""],[64168,1,""],[64169,1,""],[64170,1,""],[64171,1,""],[64172,1,""],[64173,1,""],[64174,1,""],[64175,1,""],[64176,1,""],[64177,1,""],[64178,1,""],[64179,1,""],[64180,1,""],[64181,1,""],[64182,1,""],[64183,1,""],[64184,1,""],[64185,1,""],[64186,1,""],[64187,1,""],[64188,1,""],[64189,1,""],[64190,1,""],[64191,1,""],[64192,1,""],[64193,1,""],[64194,1,""],[64195,1,""],[64196,1,""],[64197,1,""],[64198,1,""],[64199,1,""],[64200,1,""],[64201,1,""],[64202,1,""],[64203,1,""],[64204,1,""],[64205,1,""],[64206,1,""],[64207,1,""],[64208,1,""],[64209,1,""],[64210,1,""],[64211,1,""],[64212,1,""],[64213,1,""],[64214,1,""],[64215,1,""],[64216,1,""],[64217,1,""],[[64218,64255],3],[64256,1,"ff"],[64257,1,"fi"],[64258,1,"fl"],[64259,1,"ffi"],[64260,1,"ffl"],[[64261,64262],1,"st"],[[64263,64274],3],[64275,1,""],[64276,1,""],[64277,1,""],[64278,1,""],[64279,1,""],[[64280,64284],3],[64285,1,""],[64286,2],[64287,1,""],[64288,1,""],[64289,1,""],[64290,1,""],[64291,1,""],[64292,1,""],[64293,1,""],[64294,1,""],[64295,1,""],[64296,1,""],[64297,1,"+"],[64298,1,""],[64299,1,""],[64300,1,""],[64301,1,""],[64302,1,""],[64303,1,""],[64304,1,""],[64305,1,""],[64306,1,""],[64307,1,""],[64308,1,""],[64309,1,""],[64310,1,""],[64311,3],[64312,1,""],[64313,1,""],[64314,1,""],[64315,1,""],[64316,1,""],[64317,3],[64318,1,""],[64319,3],[64320,1,""],[64321,1,""],[64322,3],[64323,1,""],[64324,1,""],[64325,3],[64326,1,""],[64327,1,""],[64328,1,""],[64329,1,""],[64330,1,""],[64331,1,""],[64332,1,""],[64333,1,""],[64334,1,""],[64335,1,""],[[64336,64337],1,""],[[64338,64341],1,""],[[64342,64345],1,""],[[64346,64349],1,""],[[64350,64353],1,""],[[64354,64357],1,""],[[64358,64361],1,""],[[64362,64365],1,""],[[64366,64369],1,""],[[64370,64373],1,""],[[64374,64377],1,""],[[64378,64381],1,""],[[64382,64385],1,""],[[64386,64387],1,""],[[64388,64389],1,""],[[64390,64391],1,""],[[64392,64393],1,""],[[64394,64395],1,""],[[64396,64397],1,""],[[64398,64401],1,""],[[64402,64405],1,""],[[64406,64409],1,""],[[64410,64413],1,""],[[64414,64415],1,""],[[64416,64419],1,""],[[64420,64421],1,""],[[64422,64425],1,""],[[64426,64429],1,""],[[64430,64431],1,""],[[64432,64433],1,""],[[64434,64449],2],[64450,2],[[64451,64466],3],[[64467,64470],1,""],[[64471,64472],1,""],[[64473,64474],1,""],[[64475,64476],1,""],[64477,1,""],[[64478,64479],1,""],[[64480,64481],1,""],[[64482,64483],1,""],[[64484,64487],1,""],[[64488,64489],1,""],[[64490,64491],1,""],[[64492,64493],1,""],[[64494,64495],1,""],[[64496,64497],1,""],[[64498,64499],1,""],[[64500,64501],1,""],[[64502,64504],1,""],[[64505,64507],1,""],[[64508,64511],1,""],[64512,1,""],[64513,1,""],[64514,1,""],[64515,1,""],[64516,1,""],[64517,1,""],[64518,1,""],[64519,1,""],[64520,1,""],[64521,1,""],[64522,1,""],[64523,1,""],[64524,1,""],[64525,1,""],[64526,1,""],[64527,1,""],[64528,1,""],[64529,1,""],[64530,1,""],[64531,1,""],[64532,1,""],[64533,1,""],[64534,1,""],[64535,1,""],[64536,1,""],[64537,1,""],[64538,1,""],[64539,1,""],[64540,1,""],[64541,1,""],[64542,1,""],[64543,1,""],[64544,1,""],[64545,1,""],[64546,1,""],[64547,1,""],[64548,1,""],[64549,1,""],[64550,1,""],[64551,1,""],[64552,1,""],[64553,1,""],[64554,1,""],[64555,1,""],[64556,1,""],[64557,1,""],[64558,1,""],[64559,1,""],[64560,1,""],[64561,1,""],[64562,1,""],[64563,1,""],[64564,1,""],[64565,1,""],[64566,1,""],[64567,1,""],[64568,1,""],[64569,1,""],[64570,1,""],[64571,1,""],[64572,1,""],[64573,1,""],[64574,1,""],[64575,1,""],[64576,1,""],[64577,1,""],[64578,1,""],[64579,1,""],[64580,1,""],[64581,1,""],[64582,1,""],[64583,1,""],[64584,1,""],[64585,1,""],[64586,1,""],[64587,1,""],[64588,1,""],[64589,1,""],[64590,1,""],[64591,1,""],[64592,1,""],[64593,1,""],[64594,1,""],[64595,1,""],[64596,1,""],[64597,1,""],[64598,1,""],[64599,1,""],[64600,1,""],[64601,1,""],[64602,1,""],[64603,1,""],[64604,1,""],[64605,1,""],[64606,1," "],[64607,1," "],[64608,1," "],[64609,1," "],[64610,1," "],[64611,1," "],[64612,1,""],[64613,1,""],[64614,1,""],[64615,1,""],[64616,1,""],[64617,1,""],[64618,1,""],[64619,1,""],[64620,1,""],[64621,1,""],[64622,1,""],[64623,1,""],[64624,1,""],[64625,1,""],[64626,1,""],[64627,1,""],[64628,1,""],[64629,1,""],[64630,1,""],[64631,1,""],[64632,1,""],[64633,1,""],[64634,1,""],[64635,1,""],[64636,1,""],[64637,1,""],[64638,1,""],[64639,1,""],[64640,1,""],[64641,1,""],[64642,1,""],[64643,1,""],[64644,1,""],[64645,1,""],[64646,1,""],[64647,1,""],[64648,1,""],[64649,1,""],[64650,1,""],[64651,1,""],[64652,1,""],[64653,1,""],[64654,1,""],[64655,1,""],[64656,1,""],[64657,1,""],[64658,1,""],[64659,1,""],[64660,1,""],[64661,1,""],[64662,1,""],[64663,1,""],[64664,1,""],[64665,1,""],[64666,1,""],[64667,1,""],[64668,1,""],[64669,1,""],[64670,1,""],[64671,1,""],[64672,1,""],[64673,1,""],[64674,1,""],[64675,1,""],[64676,1,""],[64677,1,""],[64678,1,""],[64679,1,""],[64680,1,""],[64681,1,""],[64682,1,""],[64683,1,""],[64684,1,""],[64685,1,""],[64686,1,""],[64687,1,""],[64688,1,""],[64689,1,""],[64690,1,""],[64691,1,""],[64692,1,""],[64693,1,""],[64694,1,""],[64695,1,""],[64696,1,""],[64697,1,""],[64698,1,""],[64699,1,""],[64700,1,""],[64701,1,""],[64702,1,""],[64703,1,""],[64704,1,""],[64705,1,""],[64706,1,""],[64707,1,""],[64708,1,""],[64709,1,""],[64710,1,""],[64711,1,""],[64712,1,""],[64713,1,""],[64714,1,""],[64715,1,""],[64716,1,""],[64717,1,""],[64718,1,""],[64719,1,""],[64720,1,""],[64721,1,""],[64722,1,""],[64723,1,""],[64724,1,""],[64725,1,""],[64726,1,""],[64727,1,""],[64728,1,""],[64729,1,""],[64730,1,""],[64731,1,""],[64732,1,""],[64733,1,""],[64734,1,""],[64735,1,""],[64736,1,""],[64737,1,""],[64738,1,""],[64739,1,""],[64740,1,""],[64741,1,""],[64742,1,""],[64743,1,""],[64744,1,""],[64745,1,""],[64746,1,""],[64747,1,""],[64748,1,""],[64749,1,""],[64750,1,""],[64751,1,""],[64752,1,""],[64753,1,""],[64754,1,""],[64755,1,""],[64756,1,""],[64757,1,""],[64758,1,""],[64759,1,""],[64760,1,""],[64761,1,""],[64762,1,""],[64763,1,""],[64764,1,""],[64765,1,""],[64766,1,""],[64767,1,""],[64768,1,""],[64769,1,""],[64770,1,""],[64771,1,""],[64772,1,""],[64773,1,""],[64774,1,""],[64775,1,""],[64776,1,""],[64777,1,""],[64778,1,""],[64779,1,""],[64780,1,""],[64781,1,""],[64782,1,""],[64783,1,""],[64784,1,""],[64785,1,""],[64786,1,""],[64787,1,""],[64788,1,""],[64789,1,""],[64790,1,""],[64791,1,""],[64792,1,""],[64793,1,""],[64794,1,""],[64795,1,""],[64796,1,""],[64797,1,""],[64798,1,""],[64799,1,""],[64800,1,""],[64801,1,""],[64802,1,""],[64803,1,""],[64804,1,""],[64805,1,""],[64806,1,""],[64807,1,""],[64808,1,""],[64809,1,""],[64810,1,""],[64811,1,""],[64812,1,""],[64813,1,""],[64814,1,""],[64815,1,""],[64816,1,""],[64817,1,""],[64818,1,""],[64819,1,""],[64820,1,""],[64821,1,""],[64822,1,""],[64823,1,""],[64824,1,""],[64825,1,""],[64826,1,""],[64827,1,""],[[64828,64829],1,""],[[64830,64831],2],[[64832,64847],2],[64848,1,""],[[64849,64850],1,""],[64851,1,""],[64852,1,""],[64853,1,""],[64854,1,""],[64855,1,""],[[64856,64857],1,""],[64858,1,""],[64859,1,""],[64860,1,""],[64861,1,""],[64862,1,""],[[64863,64864],1,""],[64865,1,""],[[64866,64867],1,""],[[64868,64869],1,""],[64870,1,""],[[64871,64872],1,""],[64873,1,""],[[64874,64875],1,""],[[64876,64877],1,""],[64878,1,""],[[64879,64880],1,""],[[64881,64882],1,""],[64883,1,""],[64884,1,""],[64885,1,""],[[64886,64887],1,""],[64888,1,""],[64889,1,""],[64890,1,""],[64891,1,""],[[64892,64893],1,""],[64894,1,""],[64895,1,""],[64896,1,""],[64897,1,""],[64898,1,""],[[64899,64900],1,""],[[64901,64902],1,""],[[64903,64904],1,""],[64905,1,""],[64906,1,""],[64907,1,""],[64908,1,""],[64909,1,""],[64910,1,""],[64911,1,""],[[64912,64913],3],[64914,1,""],[64915,1,""],[64916,1,""],[64917,1,""],[64918,1,""],[[64919,64920],1,""],[64921,1,""],[64922,1,""],[64923,1,""],[[64924,64925],1,""],[64926,1,""],[64927,1,""],[64928,1,""],[64929,1,""],[64930,1,""],[64931,1,""],[64932,1,""],[64933,1,""],[64934,1,""],[64935,1,""],[64936,1,""],[64937,1,""],[64938,1,""],[64939,1,""],[64940,1,""],[64941,1,""],[64942,1,""],[64943,1,""],[64944,1,""],[64945,1,""],[64946,1,""],[64947,1,""],[64948,1,""],[64949,1,""],[64950,1,""],[64951,1,""],[64952,1,""],[64953,1,""],[64954,1,""],[64955,1,""],[64956,1,""],[64957,1,""],[64958,1,""],[64959,1,""],[64960,1,""],[64961,1,""],[64962,1,""],[64963,1,""],[64964,1,""],[64965,1,""],[64966,1,""],[64967,1,""],[[64968,64974],3],[64975,2],[[64976,65007],3],[65008,1,""],[65009,1,""],[65010,1,""],[65011,1,""],[65012,1,""],[65013,1,""],[65014,1,""],[65015,1,""],[65016,1,""],[65017,1,""],[65018,1,"   "],[65019,1," "],[65020,1,""],[65021,2],[[65022,65023],2],[[65024,65039],7],[65040,1,","],[65041,1,""],[65042,3],[65043,1,":"],[65044,1,";"],[65045,1,"!"],[65046,1,"?"],[65047,1,""],[65048,1,""],[65049,3],[[65050,65055],3],[[65056,65059],2],[[65060,65062],2],[[65063,65069],2],[[65070,65071],2],[65072,3],[65073,1,""],[65074,1,""],[[65075,65076],1,"_"],[65077,1,"("],[65078,1,")"],[65079,1,"{"],[65080,1,"}"],[65081,1,""],[65082,1,""],[65083,1,""],[65084,1,""],[65085,1,""],[65086,1,""],[65087,1,""],[65088,1,""],[65089,1,""],[65090,1,""],[65091,1,""],[65092,1,""],[[65093,65094],2],[65095,1,"["],[65096,1,"]"],[[65097,65100],1," "],[[65101,65103],1,"_"],[65104,1,","],[65105,1,""],[65106,3],[65107,3],[65108,1,";"],[65109,1,":"],[65110,1,"?"],[65111,1,"!"],[65112,1,""],[65113,1,"("],[65114,1,")"],[65115,1,"{"],[65116,1,"}"],[65117,1,""],[65118,1,""],[65119,1,"#"],[65120,1,"&"],[65121,1,"*"],[65122,1,"+"],[65123,1,"-"],[65124,1,"<"],[65125,1,">"],[65126,1,"="],[65127,3],[65128,1,"\\"],[65129,1,"$"],[65130,1,"%"],[65131,1,"@"],[[65132,65135],3],[65136,1," "],[65137,1,""],[65138,1," "],[65139,2],[65140,1," "],[65141,3],[65142,1," "],[65143,1,""],[65144,1," "],[65145,1,""],[65146,1," "],[65147,1,""],[65148,1," "],[65149,1,""],[65150,1," "],[65151,1,""],[65152,1,""],[[65153,65154],1,""],[[65155,65156],1,""],[[65157,65158],1,""],[[65159,65160],1,""],[[65161,65164],1,""],[[65165,65166],1,""],[[65167,65170],1,""],[[65171,65172],1,""],[[65173,65176],1,""],[[65177,65180],1,""],[[65181,65184],1,""],[[65185,65188],1,""],[[65189,65192],1,""],[[65193,65194],1,""],[[65195,65196],1,""],[[65197,65198],1,""],[[65199,65200],1,""],[[65201,65204],1,""],[[65205,65208],1,""],[[65209,65212],1,""],[[65213,65216],1,""],[[65217,65220],1,""],[[65221,65224],1,""],[[65225,65228],1,""],[[65229,65232],1,""],[[65233,65236],1,""],[[65237,65240],1,""],[[65241,65244],1,""],[[65245,65248],1,""],[[65249,65252],1,""],[[65253,65256],1,""],[[65257,65260],1,""],[[65261,65262],1,""],[[65263,65264],1,""],[[65265,65268],1,""],[[65269,65270],1,""],[[65271,65272],1,""],[[65273,65274],1,""],[[65275,65276],1,""],[[65277,65278],3],[65279,7],[65280,3],[65281,1,"!"],[65282,1,'"'],[65283,1,"#"],[65284,1,"$"],[65285,1,"%"],[65286,1,"&"],[65287,1,"'"],[65288,1,"("],[65289,1,")"],[65290,1,"*"],[65291,1,"+"],[65292,1,","],[65293,1,"-"],[65294,1,"."],[65295,1,"/"],[65296,1,"0"],[65297,1,"1"],[65298,1,"2"],[65299,1,"3"],[65300,1,"4"],[65301,1,"5"],[65302,1,"6"],[65303,1,"7"],[65304,1,"8"],[65305,1,"9"],[65306,1,":"],[65307,1,";"],[65308,1,"<"],[65309,1,"="],[65310,1,">"],[65311,1,"?"],[65312,1,"@"],[65313,1,"a"],[65314,1,"b"],[65315,1,"c"],[65316,1,"d"],[65317,1,"e"],[65318,1,"f"],[65319,1,"g"],[65320,1,"h"],[65321,1,"i"],[65322,1,"j"],[65323,1,"k"],[65324,1,"l"],[65325,1,"m"],[65326,1,"n"],[65327,1,"o"],[65328,1,"p"],[65329,1,"q"],[65330,1,"r"],[65331,1,"s"],[65332,1,"t"],[65333,1,"u"],[65334,1,"v"],[65335,1,"w"],[65336,1,"x"],[65337,1,"y"],[65338,1,"z"],[65339,1,"["],[65340,1,"\\"],[65341,1,"]"],[65342,1,"^"],[65343,1,"_"],[65344,1,"`"],[65345,1,"a"],[65346,1,"b"],[65347,1,"c"],[65348,1,"d"],[65349,1,"e"],[65350,1,"f"],[65351,1,"g"],[65352,1,"h"],[65353,1,"i"],[65354,1,"j"],[65355,1,"k"],[65356,1,"l"],[65357,1,"m"],[65358,1,"n"],[65359,1,"o"],[65360,1,"p"],[65361,1,"q"],[65362,1,"r"],[65363,1,"s"],[65364,1,"t"],[65365,1,"u"],[65366,1,"v"],[65367,1,"w"],[65368,1,"x"],[65369,1,"y"],[65370,1,"z"],[65371,1,"{"],[65372,1,"|"],[65373,1,"}"],[65374,1,"~"],[65375,1,""],[65376,1,""],[65377,1,"."],[65378,1,""],[65379,1,""],[65380,1,""],[65381,1,""],[65382,1,""],[65383,1,""],[65384,1,""],[65385,1,""],[65386,1,""],[65387,1,""],[65388,1,""],[65389,1,""],[65390,1,""],[65391,1,""],[65392,1,""],[65393,1,""],[65394,1,""],[65395,1,""],[65396,1,""],[65397,1,""],[65398,1,""],[65399,1,""],[65400,1,""],[65401,1,""],[65402,1,""],[65403,1,""],[65404,1,""],[65405,1,""],[65406,1,""],[65407,1,""],[65408,1,""],[65409,1,""],[65410,1,""],[65411,1,""],[65412,1,""],[65413,1,""],[65414,1,""],[65415,1,""],[65416,1,""],[65417,1,""],[65418,1,""],[65419,1,""],[65420,1,""],[65421,1,""],[65422,1,""],[65423,1,""],[65424,1,""],[65425,1,""],[65426,1,""],[65427,1,""],[65428,1,""],[65429,1,""],[65430,1,""],[65431,1,""],[65432,1,""],[65433,1,""],[65434,1,""],[65435,1,""],[65436,1,""],[65437,1,""],[65438,1,""],[65439,1,""],[65440,7],[65441,1,""],[65442,1,""],[65443,1,""],[65444,1,""],[65445,1,""],[65446,1,""],[65447,1,""],[65448,1,""],[65449,1,""],[65450,1,""],[65451,1,""],[65452,1,""],[65453,1,""],[65454,1,""],[65455,1,""],[65456,1,""],[65457,1,""],[65458,1,""],[65459,1,""],[65460,1,""],[65461,1,""],[65462,1,""],[65463,1,""],[65464,1,""],[65465,1,""],[65466,1,""],[65467,1,""],[65468,1,""],[65469,1,""],[65470,1,""],[[65471,65473],3],[65474,1,""],[65475,1,""],[65476,1,""],[65477,1,""],[65478,1,""],[65479,1,""],[[65480,65481],3],[65482,1,""],[65483,1,""],[65484,1,""],[65485,1,""],[65486,1,""],[65487,1,""],[[65488,65489],3],[65490,1,""],[65491,1,""],[65492,1,""],[65493,1,""],[65494,1,""],[65495,1,""],[[65496,65497],3],[65498,1,""],[65499,1,""],[65500,1,""],[[65501,65503],3],[65504,1,""],[65505,1,""],[65506,1,""],[65507,1," "],[65508,1,""],[65509,1,""],[65510,1,""],[65511,3],[65512,1,""],[65513,1,""],[65514,1,""],[65515,1,""],[65516,1,""],[65517,1,""],[65518,1,""],[[65519,65528],3],[[65529,65531],3],[65532,3],[65533,3],[[65534,65535],3],[[65536,65547],2],[65548,3],[[65549,65574],2],[65575,3],[[65576,65594],2],[65595,3],[[65596,65597],2],[65598,3],[[65599,65613],2],[[65614,65615],3],[[65616,65629],2],[[65630,65663],3],[[65664,65786],2],[[65787,65791],3],[[65792,65794],2],[[65795,65798],3],[[65799,65843],2],[[65844,65846],3],[[65847,65855],2],[[65856,65930],2],[[65931,65932],2],[[65933,65934],2],[65935,3],[[65936,65947],2],[65948,2],[[65949,65951],3],[65952,2],[[65953,65999],3],[[66e3,66044],2],[66045,2],[[66046,66175],3],[[66176,66204],2],[[66205,66207],3],[[66208,66256],2],[[66257,66271],3],[66272,2],[[66273,66299],2],[[66300,66303],3],[[66304,66334],2],[66335,2],[[66336,66339],2],[[66340,66348],3],[[66349,66351],2],[[66352,66368],2],[66369,2],[[66370,66377],2],[66378,2],[[66379,66383],3],[[66384,66426],2],[[66427,66431],3],[[66432,66461],2],[66462,3],[66463,2],[[66464,66499],2],[[66500,66503],3],[[66504,66511],2],[[66512,66517],2],[[66518,66559],3],[66560,1,""],[66561,1,""],[66562,1,""],[66563,1,""],[66564,1,""],[66565,1,""],[66566,1,""],[66567,1,""],[66568,1,""],[66569,1,""],[66570,1,""],[66571,1,""],[66572,1,""],[66573,1,""],[66574,1,""],[66575,1,""],[66576,1,""],[66577,1,""],[66578,1,""],[66579,1,""],[66580,1,""],[66581,1,""],[66582,1,""],[66583,1,""],[66584,1,""],[66585,1,""],[66586,1,""],[66587,1,""],[66588,1,""],[66589,1,""],[66590,1,""],[66591,1,""],[66592,1,""],[66593,1,""],[66594,1,""],[66595,1,""],[66596,1,""],[66597,1,""],[66598,1,""],[66599,1,""],[[66600,66637],2],[[66638,66717],2],[[66718,66719],3],[[66720,66729],2],[[66730,66735],3],[66736,1,""],[66737,1,""],[66738,1,""],[66739,1,""],[66740,1,""],[66741,1,""],[66742,1,""],[66743,1,""],[66744,1,""],[66745,1,""],[66746,1,""],[66747,1,""],[66748,1,""],[66749,1,""],[66750,1,""],[66751,1,""],[66752,1,""],[66753,1,""],[66754,1,""],[66755,1,""],[66756,1,""],[66757,1,""],[66758,1,""],[66759,1,""],[66760,1,""],[66761,1,""],[66762,1,""],[66763,1,""],[66764,1,""],[66765,1,""],[66766,1,""],[66767,1,""],[66768,1,""],[66769,1,""],[66770,1,""],[66771,1,""],[[66772,66775],3],[[66776,66811],2],[[66812,66815],3],[[66816,66855],2],[[66856,66863],3],[[66864,66915],2],[[66916,66926],3],[66927,2],[66928,1,""],[66929,1,""],[66930,1,""],[66931,1,""],[66932,1,""],[66933,1,""],[66934,1,""],[66935,1,""],[66936,1,""],[66937,1,""],[66938,1,""],[66939,3],[66940,1,""],[66941,1,""],[66942,1,""],[66943,1,""],[66944,1,""],[66945,1,""],[66946,1,""],[66947,1,""],[66948,1,""],[66949,1,""],[66950,1,""],[66951,1,""],[66952,1,""],[66953,1,""],[66954,1,""],[66955,3],[66956,1,""],[66957,1,""],[66958,1,""],[66959,1,""],[66960,1,""],[66961,1,""],[66962,1,""],[66963,3],[66964,1,""],[66965,1,""],[66966,3],[[66967,66977],2],[66978,3],[[66979,66993],2],[66994,3],[[66995,67001],2],[67002,3],[[67003,67004],2],[[67005,67007],3],[[67008,67059],2],[[67060,67071],3],[[67072,67382],2],[[67383,67391],3],[[67392,67413],2],[[67414,67423],3],[[67424,67431],2],[[67432,67455],3],[67456,2],[67457,1,""],[67458,1,""],[67459,1,""],[67460,1,""],[67461,1,""],[67462,3],[67463,1,""],[67464,1,""],[67465,1,""],[67466,1,""],[67467,1,""],[67468,1,""],[67469,1,""],[67470,1,""],[67471,1,""],[67472,1,""],[67473,1,""],[67474,1,""],[67475,1,""],[67476,1,""],[67477,1,""],[67478,1,""],[67479,1,""],[67480,1,""],[67481,1,""],[67482,1,""],[67483,1,""],[67484,1,""],[67485,1,""],[67486,1,""],[67487,1,""],[67488,1,""],[67489,1,""],[67490,1,""],[67491,1,""],[67492,1,""],[67493,1,"q"],[67494,1,""],[67495,1,""],[67496,1,""],[67497,1,""],[67498,1,""],[67499,1,""],[67500,1,""],[67501,1,""],[67502,1,""],[67503,1,""],[67504,1,""],[67505,3],[67506,1,""],[67507,1,""],[67508,1,""],[67509,1,""],[67510,1,""],[67511,1,""],[67512,1,""],[67513,1,""],[67514,1,""],[[67515,67583],3],[[67584,67589],2],[[67590,67591],3],[67592,2],[67593,3],[[67594,67637],2],[67638,3],[[67639,67640],2],[[67641,67643],3],[67644,2],[[67645,67646],3],[67647,2],[[67648,67669],2],[67670,3],[[67671,67679],2],[[67680,67702],2],[[67703,67711],2],[[67712,67742],2],[[67743,67750],3],[[67751,67759],2],[[67760,67807],3],[[67808,67826],2],[67827,3],[[67828,67829],2],[[67830,67834],3],[[67835,67839],2],[[67840,67861],2],[[67862,67865],2],[[67866,67867],2],[[67868,67870],3],[67871,2],[[67872,67897],2],[[67898,67902],3],[67903,2],[[67904,67967],3],[[67968,68023],2],[[68024,68027],3],[[68028,68029],2],[[68030,68031],2],[[68032,68047],2],[[68048,68049],3],[[68050,68095],2],[[68096,68099],2],[68100,3],[[68101,68102],2],[[68103,68107],3],[[68108,68115],2],[68116,3],[[68117,68119],2],[68120,3],[[68121,68147],2],[[68148,68149],2],[[68150,68151],3],[[68152,68154],2],[[68155,68158],3],[68159,2],[[68160,68167],2],[68168,2],[[68169,68175],3],[[68176,68184],2],[[68185,68191],3],[[68192,68220],2],[[68221,68223],2],[[68224,68252],2],[[68253,68255],2],[[68256,68287],3],[[68288,68295],2],[68296,2],[[68297,68326],2],[[68327,68330],3],[[68331,68342],2],[[68343,68351],3],[[68352,68405],2],[[68406,68408],3],[[68409,68415],2],[[68416,68437],2],[[68438,68439],3],[[68440,68447],2],[[68448,68466],2],[[68467,68471],3],[[68472,68479],2],[[68480,68497],2],[[68498,68504],3],[[68505,68508],2],[[68509,68520],3],[[68521,68527],2],[[68528,68607],3],[[68608,68680],2],[[68681,68735],3],[68736,1,""],[68737,1,""],[68738,1,""],[68739,1,""],[68740,1,""],[68741,1,""],[68742,1,""],[68743,1,""],[68744,1,""],[68745,1,""],[68746,1,""],[68747,1,""],[68748,1,""],[68749,1,""],[68750,1,""],[68751,1,""],[68752,1,""],[68753,1,""],[68754,1,""],[68755,1,""],[68756,1,""],[68757,1,""],[68758,1,""],[68759,1,""],[68760,1,""],[68761,1,""],[68762,1,""],[68763,1,""],[68764,1,""],[68765,1,""],[68766,1,""],[68767,1,""],[68768,1,""],[68769,1,""],[68770,1,""],[68771,1,""],[68772,1,""],[68773,1,""],[68774,1,""],[68775,1,""],[68776,1,""],[68777,1,""],[68778,1,""],[68779,1,""],[68780,1,""],[68781,1,""],[68782,1,""],[68783,1,""],[68784,1,""],[68785,1,""],[68786,1,""],[[68787,68799],3],[[68800,68850],2],[[68851,68857],3],[[68858,68863],2],[[68864,68903],2],[[68904,68911],3],[[68912,68921],2],[[68922,68927],3],[[68928,68943],2],[68944,1,""],[68945,1,""],[68946,1,""],[68947,1,""],[68948,1,""],[68949,1,""],[68950,1,""],[68951,1,""],[68952,1,""],[68953,1,""],[68954,1,""],[68955,1,""],[68956,1,""],[68957,1,""],[68958,1,""],[68959,1,""],[68960,1,""],[68961,1,""],[68962,1,""],[68963,1,""],[68964,1,""],[68965,1,""],[[68966,68968],3],[[68969,68973],2],[68974,2],[[68975,68997],2],[[68998,69005],3],[[69006,69007],2],[[69008,69215],3],[[69216,69246],2],[69247,3],[[69248,69289],2],[69290,3],[[69291,69292],2],[69293,2],[[69294,69295],3],[[69296,69297],2],[[69298,69313],3],[[69314,69316],2],[[69317,69371],3],[69372,2],[[69373,69375],2],[[69376,69404],2],[[69405,69414],2],[69415,2],[[69416,69423],3],[[69424,69456],2],[[69457,69465],2],[[69466,69487],3],[[69488,69509],2],[[69510,69513],2],[[69514,69551],3],[[69552,69572],2],[[69573,69579],2],[[69580,69599],3],[[69600,69622],2],[[69623,69631],3],[[69632,69702],2],[[69703,69709],2],[[69710,69713],3],[[69714,69733],2],[[69734,69743],2],[[69744,69749],2],[[69750,69758],3],[69759,2],[[69760,69818],2],[[69819,69820],2],[69821,3],[[69822,69825],2],[69826,2],[[69827,69836],3],[69837,3],[[69838,69839],3],[[69840,69864],2],[[69865,69871],3],[[69872,69881],2],[[69882,69887],3],[[69888,69940],2],[69941,3],[[69942,69951],2],[[69952,69955],2],[[69956,69958],2],[69959,2],[[69960,69967],3],[[69968,70003],2],[[70004,70005],2],[70006,2],[[70007,70015],3],[[70016,70084],2],[[70085,70088],2],[[70089,70092],2],[70093,2],[[70094,70095],2],[[70096,70105],2],[70106,2],[70107,2],[70108,2],[[70109,70111],2],[70112,3],[[70113,70132],2],[[70133,70143],3],[[70144,70161],2],[70162,3],[[70163,70199],2],[[70200,70205],2],[70206,2],[[70207,70209],2],[[70210,70271],3],[[70272,70278],2],[70279,3],[70280,2],[70281,3],[[70282,70285],2],[70286,3],[[70287,70301],2],[70302,3],[[70303,70312],2],[70313,2],[[70314,70319],3],[[70320,70378],2],[[70379,70383],3],[[70384,70393],2],[[70394,70399],3],[70400,2],[[70401,70403],2],[70404,3],[[70405,70412],2],[[70413,70414],3],[[70415,70416],2],[[70417,70418],3],[[70419,70440],2],[70441,3],[[70442,70448],2],[70449,3],[[70450,70451],2],[70452,3],[[70453,70457],2],[70458,3],[70459,2],[[70460,70468],2],[[70469,70470],3],[[70471,70472],2],[[70473,70474],3],[[70475,70477],2],[[70478,70479],3],[70480,2],[[70481,70486],3],[70487,2],[[70488,70492],3],[[70493,70499],2],[[70500,70501],3],[[70502,70508],2],[[70509,70511],3],[[70512,70516],2],[[70517,70527],3],[[70528,70537],2],[70538,3],[70539,2],[[70540,70541],3],[70542,2],[70543,3],[[70544,70581],2],[70582,3],[[70583,70592],2],[70593,3],[70594,2],[[70595,70596],3],[70597,2],[70598,3],[[70599,70602],2],[70603,3],[[70604,70611],2],[[70612,70613],2],[70614,3],[[70615,70616],2],[[70617,70624],3],[[70625,70626],2],[[70627,70655],3],[[70656,70730],2],[[70731,70735],2],[[70736,70745],2],[70746,2],[70747,2],[70748,3],[70749,2],[70750,2],[70751,2],[[70752,70753],2],[[70754,70783],3],[[70784,70853],2],[70854,2],[70855,2],[[70856,70863],3],[[70864,70873],2],[[70874,71039],3],[[71040,71093],2],[[71094,71095],3],[[71096,71104],2],[[71105,71113],2],[[71114,71127],2],[[71128,71133],2],[[71134,71167],3],[[71168,71232],2],[[71233,71235],2],[71236,2],[[71237,71247],3],[[71248,71257],2],[[71258,71263],3],[[71264,71276],2],[[71277,71295],3],[[71296,71351],2],[71352,2],[71353,2],[[71354,71359],3],[[71360,71369],2],[[71370,71375],3],[[71376,71395],2],[[71396,71423],3],[[71424,71449],2],[71450,2],[[71451,71452],3],[[71453,71467],2],[[71468,71471],3],[[71472,71481],2],[[71482,71487],2],[[71488,71494],2],[[71495,71679],3],[[71680,71738],2],[71739,2],[[71740,71839],3],[71840,1,""],[71841,1,""],[71842,1,""],[71843,1,""],[71844,1,""],[71845,1,""],[71846,1,""],[71847,1,""],[71848,1,""],[71849,1,""],[71850,1,""],[71851,1,""],[71852,1,""],[71853,1,""],[71854,1,""],[71855,1,""],[71856,1,""],[71857,1,""],[71858,1,""],[71859,1,""],[71860,1,""],[71861,1,""],[71862,1,""],[71863,1,""],[71864,1,""],[71865,1,""],[71866,1,""],[71867,1,""],[71868,1,""],[71869,1,""],[71870,1,""],[71871,1,""],[[71872,71913],2],[[71914,71922],2],[[71923,71934],3],[71935,2],[[71936,71942],2],[[71943,71944],3],[71945,2],[[71946,71947],3],[[71948,71955],2],[71956,3],[[71957,71958],2],[71959,3],[[71960,71989],2],[71990,3],[[71991,71992],2],[[71993,71994],3],[[71995,72003],2],[[72004,72006],2],[[72007,72015],3],[[72016,72025],2],[[72026,72095],3],[[72096,72103],2],[[72104,72105],3],[[72106,72151],2],[[72152,72153],3],[[72154,72161],2],[72162,2],[[72163,72164],2],[[72165,72191],3],[[72192,72254],2],[[72255,72262],2],[72263,2],[[72264,72271],3],[[72272,72323],2],[[72324,72325],2],[[72326,72345],2],[[72346,72348],2],[72349,2],[[72350,72354],2],[[72355,72367],3],[[72368,72383],2],[[72384,72440],2],[[72441,72447],3],[[72448,72457],2],[[72458,72639],3],[[72640,72672],2],[72673,2],[[72674,72687],3],[[72688,72697],2],[[72698,72703],3],[[72704,72712],2],[72713,3],[[72714,72758],2],[72759,3],[[72760,72768],2],[[72769,72773],2],[[72774,72783],3],[[72784,72793],2],[[72794,72812],2],[[72813,72815],3],[[72816,72817],2],[[72818,72847],2],[[72848,72849],3],[[72850,72871],2],[72872,3],[[72873,72886],2],[[72887,72959],3],[[72960,72966],2],[72967,3],[[72968,72969],2],[72970,3],[[72971,73014],2],[[73015,73017],3],[73018,2],[73019,3],[[73020,73021],2],[73022,3],[[73023,73031],2],[[73032,73039],3],[[73040,73049],2],[[73050,73055],3],[[73056,73061],2],[73062,3],[[73063,73064],2],[73065,3],[[73066,73102],2],[73103,3],[[73104,73105],2],[73106,3],[[73107,73112],2],[[73113,73119],3],[[73120,73129],2],[[73130,73439],3],[[73440,73462],2],[[73463,73464],2],[[73465,73471],3],[[73472,73488],2],[73489,3],[[73490,73530],2],[[73531,73533],3],[[73534,73538],2],[[73539,73551],2],[[73552,73561],2],[73562,2],[[73563,73647],3],[73648,2],[[73649,73663],3],[[73664,73713],2],[[73714,73726],3],[73727,2],[[73728,74606],2],[[74607,74648],2],[74649,2],[[74650,74751],3],[[74752,74850],2],[[74851,74862],2],[74863,3],[[74864,74867],2],[74868,2],[[74869,74879],3],[[74880,75075],2],[[75076,77711],3],[[77712,77808],2],[[77809,77810],2],[[77811,77823],3],[[77824,78894],2],[78895,2],[[78896,78904],3],[[78905,78911],3],[[78912,78933],2],[[78934,78943],3],[[78944,82938],2],[[82939,82943],3],[[82944,83526],2],[[83527,90367],3],[[90368,90425],2],[[90426,92159],3],[[92160,92728],2],[[92729,92735],3],[[92736,92766],2],[92767,3],[[92768,92777],2],[[92778,92781],3],[[92782,92783],2],[[92784,92862],2],[92863,3],[[92864,92873],2],[[92874,92879],3],[[92880,92909],2],[[92910,92911],3],[[92912,92916],2],[92917,2],[[92918,92927],3],[[92928,92982],2],[[92983,92991],2],[[92992,92995],2],[[92996,92997],2],[[92998,93007],3],[[93008,93017],2],[93018,3],[[93019,93025],2],[93026,3],[[93027,93047],2],[[93048,93052],3],[[93053,93071],2],[[93072,93503],3],[[93504,93548],2],[[93549,93551],2],[[93552,93561],2],[[93562,93759],3],[93760,1,""],[93761,1,""],[93762,1,""],[93763,1,""],[93764,1,""],[93765,1,""],[93766,1,""],[93767,1,""],[93768,1,""],[93769,1,""],[93770,1,""],[93771,1,""],[93772,1,""],[93773,1,""],[93774,1,""],[93775,1,""],[93776,1,""],[93777,1,""],[93778,1,""],[93779,1,""],[93780,1,""],[93781,1,""],[93782,1,""],[93783,1,""],[93784,1,""],[93785,1,""],[93786,1,""],[93787,1,""],[93788,1,""],[93789,1,""],[93790,1,""],[93791,1,""],[[93792,93823],2],[[93824,93850],2],[[93851,93951],3],[[93952,94020],2],[[94021,94026],2],[[94027,94030],3],[94031,2],[[94032,94078],2],[[94079,94087],2],[[94088,94094],3],[[94095,94111],2],[[94112,94175],3],[94176,2],[94177,2],[94178,2],[94179,2],[94180,2],[[94181,94191],3],[[94192,94193],2],[[94194,94207],3],[[94208,100332],2],[[100333,100337],2],[[100338,100343],2],[[100344,100351],3],[[100352,101106],2],[[101107,101589],2],[[101590,101630],3],[101631,2],[[101632,101640],2],[[101641,110575],3],[[110576,110579],2],[110580,3],[[110581,110587],2],[110588,3],[[110589,110590],2],[110591,3],[[110592,110593],2],[[110594,110878],2],[[110879,110882],2],[[110883,110897],3],[110898,2],[[110899,110927],3],[[110928,110930],2],[[110931,110932],3],[110933,2],[[110934,110947],3],[[110948,110951],2],[[110952,110959],3],[[110960,111355],2],[[111356,113663],3],[[113664,113770],2],[[113771,113775],3],[[113776,113788],2],[[113789,113791],3],[[113792,113800],2],[[113801,113807],3],[[113808,113817],2],[[113818,113819],3],[113820,2],[[113821,113822],2],[113823,2],[[113824,113827],7],[[113828,117759],3],[[117760,117973],2],[117974,1,"a"],[117975,1,"b"],[117976,1,"c"],[117977,1,"d"],[117978,1,"e"],[117979,1,"f"],[117980,1,"g"],[117981,1,"h"],[117982,1,"i"],[117983,1,"j"],[117984,1,"k"],[117985,1,"l"],[117986,1,"m"],[117987,1,"n"],[117988,1,"o"],[117989,1,"p"],[117990,1,"q"],[117991,1,"r"],[117992,1,"s"],[117993,1,"t"],[117994,1,"u"],[117995,1,"v"],[117996,1,"w"],[117997,1,"x"],[117998,1,"y"],[117999,1,"z"],[118e3,1,"0"],[118001,1,"1"],[118002,1,"2"],[118003,1,"3"],[118004,1,"4"],[118005,1,"5"],[118006,1,"6"],[118007,1,"7"],[118008,1,"8"],[118009,1,"9"],[[118010,118015],3],[[118016,118451],2],[[118452,118527],3],[[118528,118573],2],[[118574,118575],3],[[118576,118598],2],[[118599,118607],3],[[118608,118723],2],[[118724,118783],3],[[118784,119029],2],[[119030,119039],3],[[119040,119078],2],[[119079,119080],3],[119081,2],[[119082,119133],2],[119134,1,""],[119135,1,""],[119136,1,""],[119137,1,""],[119138,1,""],[119139,1,""],[119140,1,""],[[119141,119154],2],[[119155,119162],7],[[119163,119226],2],[119227,1,""],[119228,1,""],[119229,1,""],[119230,1,""],[119231,1,""],[119232,1,""],[[119233,119261],2],[[119262,119272],2],[[119273,119274],2],[[119275,119295],3],[[119296,119365],2],[[119366,119487],3],[[119488,119507],2],[[119508,119519],3],[[119520,119539],2],[[119540,119551],3],[[119552,119638],2],[[119639,119647],3],[[119648,119665],2],[[119666,119672],2],[[119673,119807],3],[119808,1,"a"],[119809,1,"b"],[119810,1,"c"],[119811,1,"d"],[119812,1,"e"],[119813,1,"f"],[119814,1,"g"],[119815,1,"h"],[119816,1,"i"],[119817,1,"j"],[119818,1,"k"],[119819,1,"l"],[119820,1,"m"],[119821,1,"n"],[119822,1,"o"],[119823,1,"p"],[119824,1,"q"],[119825,1,"r"],[119826,1,"s"],[119827,1,"t"],[119828,1,"u"],[119829,1,"v"],[119830,1,"w"],[119831,1,"x"],[119832,1,"y"],[119833,1,"z"],[119834,1,"a"],[119835,1,"b"],[119836,1,"c"],[119837,1,"d"],[119838,1,"e"],[119839,1,"f"],[119840,1,"g"],[119841,1,"h"],[119842,1,"i"],[119843,1,"j"],[119844,1,"k"],[119845,1,"l"],[119846,1,"m"],[119847,1,"n"],[119848,1,"o"],[119849,1,"p"],[119850,1,"q"],[119851,1,"r"],[119852,1,"s"],[119853,1,"t"],[119854,1,"u"],[119855,1,"v"],[119856,1,"w"],[119857,1,"x"],[119858,1,"y"],[119859,1,"z"],[119860,1,"a"],[119861,1,"b"],[119862,1,"c"],[119863,1,"d"],[119864,1,"e"],[119865,1,"f"],[119866,1,"g"],[119867,1,"h"],[119868,1,"i"],[119869,1,"j"],[119870,1,"k"],[119871,1,"l"],[119872,1,"m"],[119873,1,"n"],[119874,1,"o"],[119875,1,"p"],[119876,1,"q"],[119877,1,"r"],[119878,1,"s"],[119879,1,"t"],[119880,1,"u"],[119881,1,"v"],[119882,1,"w"],[119883,1,"x"],[119884,1,"y"],[119885,1,"z"],[119886,1,"a"],[119887,1,"b"],[119888,1,"c"],[119889,1,"d"],[119890,1,"e"],[119891,1,"f"],[119892,1,"g"],[119893,3],[119894,1,"i"],[119895,1,"j"],[119896,1,"k"],[119897,1,"l"],[119898,1,"m"],[119899,1,"n"],[119900,1,"o"],[119901,1,"p"],[119902,1,"q"],[119903,1,"r"],[119904,1,"s"],[119905,1,"t"],[119906,1,"u"],[119907,1,"v"],[119908,1,"w"],[119909,1,"x"],[119910,1,"y"],[119911,1,"z"],[119912,1,"a"],[119913,1,"b"],[119914,1,"c"],[119915,1,"d"],[119916,1,"e"],[119917,1,"f"],[119918,1,"g"],[119919,1,"h"],[119920,1,"i"],[119921,1,"j"],[119922,1,"k"],[119923,1,"l"],[119924,1,"m"],[119925,1,"n"],[119926,1,"o"],[119927,1,"p"],[119928,1,"q"],[119929,1,"r"],[119930,1,"s"],[119931,1,"t"],[119932,1,"u"],[119933,1,"v"],[119934,1,"w"],[119935,1,"x"],[119936,1,"y"],[119937,1,"z"],[119938,1,"a"],[119939,1,"b"],[119940,1,"c"],[119941,1,"d"],[119942,1,"e"],[119943,1,"f"],[119944,1,"g"],[119945,1,"h"],[119946,1,"i"],[119947,1,"j"],[119948,1,"k"],[119949,1,"l"],[119950,1,"m"],[119951,1,"n"],[119952,1,"o"],[119953,1,"p"],[119954,1,"q"],[119955,1,"r"],[119956,1,"s"],[119957,1,"t"],[119958,1,"u"],[119959,1,"v"],[119960,1,"w"],[119961,1,"x"],[119962,1,"y"],[119963,1,"z"],[119964,1,"a"],[119965,3],[119966,1,"c"],[119967,1,"d"],[[119968,119969],3],[119970,1,"g"],[[119971,119972],3],[119973,1,"j"],[119974,1,"k"],[[119975,119976],3],[119977,1,"n"],[119978,1,"o"],[119979,1,"p"],[119980,1,"q"],[119981,3],[119982,1,"s"],[119983,1,"t"],[119984,1,"u"],[119985,1,"v"],[119986,1,"w"],[119987,1,"x"],[119988,1,"y"],[119989,1,"z"],[119990,1,"a"],[119991,1,"b"],[119992,1,"c"],[119993,1,"d"],[119994,3],[119995,1,"f"],[119996,3],[119997,1,"h"],[119998,1,"i"],[119999,1,"j"],[12e4,1,"k"],[120001,1,"l"],[120002,1,"m"],[120003,1,"n"],[120004,3],[120005,1,"p"],[120006,1,"q"],[120007,1,"r"],[120008,1,"s"],[120009,1,"t"],[120010,1,"u"],[120011,1,"v"],[120012,1,"w"],[120013,1,"x"],[120014,1,"y"],[120015,1,"z"],[120016,1,"a"],[120017,1,"b"],[120018,1,"c"],[120019,1,"d"],[120020,1,"e"],[120021,1,"f"],[120022,1,"g"],[120023,1,"h"],[120024,1,"i"],[120025,1,"j"],[120026,1,"k"],[120027,1,"l"],[120028,1,"m"],[120029,1,"n"],[120030,1,"o"],[120031,1,"p"],[120032,1,"q"],[120033,1,"r"],[120034,1,"s"],[120035,1,"t"],[120036,1,"u"],[120037,1,"v"],[120038,1,"w"],[120039,1,"x"],[120040,1,"y"],[120041,1,"z"],[120042,1,"a"],[120043,1,"b"],[120044,1,"c"],[120045,1,"d"],[120046,1,"e"],[120047,1,"f"],[120048,1,"g"],[120049,1,"h"],[120050,1,"i"],[120051,1,"j"],[120052,1,"k"],[120053,1,"l"],[120054,1,"m"],[120055,1,"n"],[120056,1,"o"],[120057,1,"p"],[120058,1,"q"],[120059,1,"r"],[120060,1,"s"],[120061,1,"t"],[120062,1,"u"],[120063,1,"v"],[120064,1,"w"],[120065,1,"x"],[120066,1,"y"],[120067,1,"z"],[120068,1,"a"],[120069,1,"b"],[120070,3],[120071,1,"d"],[120072,1,"e"],[120073,1,"f"],[120074,1,"g"],[[120075,120076],3],[120077,1,"j"],[120078,1,"k"],[120079,1,"l"],[120080,1,"m"],[120081,1,"n"],[120082,1,"o"],[120083,1,"p"],[120084,1,"q"],[120085,3],[120086,1,"s"],[120087,1,"t"],[120088,1,"u"],[120089,1,"v"],[120090,1,"w"],[120091,1,"x"],[120092,1,"y"],[120093,3],[120094,1,"a"],[120095,1,"b"],[120096,1,"c"],[120097,1,"d"],[120098,1,"e"],[120099,1,"f"],[120100,1,"g"],[120101,1,"h"],[120102,1,"i"],[120103,1,"j"],[120104,1,"k"],[120105,1,"l"],[120106,1,"m"],[120107,1,"n"],[120108,1,"o"],[120109,1,"p"],[120110,1,"q"],[120111,1,"r"],[120112,1,"s"],[120113,1,"t"],[120114,1,"u"],[120115,1,"v"],[120116,1,"w"],[120117,1,"x"],[120118,1,"y"],[120119,1,"z"],[120120,1,"a"],[120121,1,"b"],[120122,3],[120123,1,"d"],[120124,1,"e"],[120125,1,"f"],[120126,1,"g"],[120127,3],[120128,1,"i"],[120129,1,"j"],[120130,1,"k"],[120131,1,"l"],[120132,1,"m"],[120133,3],[120134,1,"o"],[[120135,120137],3],[120138,1,"s"],[120139,1,"t"],[120140,1,"u"],[120141,1,"v"],[120142,1,"w"],[120143,1,"x"],[120144,1,"y"],[120145,3],[120146,1,"a"],[120147,1,"b"],[120148,1,"c"],[120149,1,"d"],[120150,1,"e"],[120151,1,"f"],[120152,1,"g"],[120153,1,"h"],[120154,1,"i"],[120155,1,"j"],[120156,1,"k"],[120157,1,"l"],[120158,1,"m"],[120159,1,"n"],[120160,1,"o"],[120161,1,"p"],[120162,1,"q"],[120163,1,"r"],[120164,1,"s"],[120165,1,"t"],[120166,1,"u"],[120167,1,"v"],[120168,1,"w"],[120169,1,"x"],[120170,1,"y"],[120171,1,"z"],[120172,1,"a"],[120173,1,"b"],[120174,1,"c"],[120175,1,"d"],[120176,1,"e"],[120177,1,"f"],[120178,1,"g"],[120179,1,"h"],[120180,1,"i"],[120181,1,"j"],[120182,1,"k"],[120183,1,"l"],[120184,1,"m"],[120185,1,"n"],[120186,1,"o"],[120187,1,"p"],[120188,1,"q"],[120189,1,"r"],[120190,1,"s"],[120191,1,"t"],[120192,1,"u"],[120193,1,"v"],[120194,1,"w"],[120195,1,"x"],[120196,1,"y"],[120197,1,"z"],[120198,1,"a"],[120199,1,"b"],[120200,1,"c"],[120201,1,"d"],[120202,1,"e"],[120203,1,"f"],[120204,1,"g"],[120205,1,"h"],[120206,1,"i"],[120207,1,"j"],[120208,1,"k"],[120209,1,"l"],[120210,1,"m"],[120211,1,"n"],[120212,1,"o"],[120213,1,"p"],[120214,1,"q"],[120215,1,"r"],[120216,1,"s"],[120217,1,"t"],[120218,1,"u"],[120219,1,"v"],[120220,1,"w"],[120221,1,"x"],[120222,1,"y"],[120223,1,"z"],[120224,1,"a"],[120225,1,"b"],[120226,1,"c"],[120227,1,"d"],[120228,1,"e"],[120229,1,"f"],[120230,1,"g"],[120231,1,"h"],[120232,1,"i"],[120233,1,"j"],[120234,1,"k"],[120235,1,"l"],[120236,1,"m"],[120237,1,"n"],[120238,1,"o"],[120239,1,"p"],[120240,1,"q"],[120241,1,"r"],[120242,1,"s"],[120243,1,"t"],[120244,1,"u"],[120245,1,"v"],[120246,1,"w"],[120247,1,"x"],[120248,1,"y"],[120249,1,"z"],[120250,1,"a"],[120251,1,"b"],[120252,1,"c"],[120253,1,"d"],[120254,1,"e"],[120255,1,"f"],[120256,1,"g"],[120257,1,"h"],[120258,1,"i"],[120259,1,"j"],[120260,1,"k"],[120261,1,"l"],[120262,1,"m"],[120263,1,"n"],[120264,1,"o"],[120265,1,"p"],[120266,1,"q"],[120267,1,"r"],[120268,1,"s"],[120269,1,"t"],[120270,1,"u"],[120271,1,"v"],[120272,1,"w"],[120273,1,"x"],[120274,1,"y"],[120275,1,"z"],[120276,1,"a"],[120277,1,"b"],[120278,1,"c"],[120279,1,"d"],[120280,1,"e"],[120281,1,"f"],[120282,1,"g"],[120283,1,"h"],[120284,1,"i"],[120285,1,"j"],[120286,1,"k"],[120287,1,"l"],[120288,1,"m"],[120289,1,"n"],[120290,1,"o"],[120291,1,"p"],[120292,1,"q"],[120293,1,"r"],[120294,1,"s"],[120295,1,"t"],[120296,1,"u"],[120297,1,"v"],[120298,1,"w"],[120299,1,"x"],[120300,1,"y"],[120301,1,"z"],[120302,1,"a"],[120303,1,"b"],[120304,1,"c"],[120305,1,"d"],[120306,1,"e"],[120307,1,"f"],[120308,1,"g"],[120309,1,"h"],[120310,1,"i"],[120311,1,"j"],[120312,1,"k"],[120313,1,"l"],[120314,1,"m"],[120315,1,"n"],[120316,1,"o"],[120317,1,"p"],[120318,1,"q"],[120319,1,"r"],[120320,1,"s"],[120321,1,"t"],[120322,1,"u"],[120323,1,"v"],[120324,1,"w"],[120325,1,"x"],[120326,1,"y"],[120327,1,"z"],[120328,1,"a"],[120329,1,"b"],[120330,1,"c"],[120331,1,"d"],[120332,1,"e"],[120333,1,"f"],[120334,1,"g"],[120335,1,"h"],[120336,1,"i"],[120337,1,"j"],[120338,1,"k"],[120339,1,"l"],[120340,1,"m"],[120341,1,"n"],[120342,1,"o"],[120343,1,"p"],[120344,1,"q"],[120345,1,"r"],[120346,1,"s"],[120347,1,"t"],[120348,1,"u"],[120349,1,"v"],[120350,1,"w"],[120351,1,"x"],[120352,1,"y"],[120353,1,"z"],[120354,1,"a"],[120355,1,"b"],[120356,1,"c"],[120357,1,"d"],[120358,1,"e"],[120359,1,"f"],[120360,1,"g"],[120361,1,"h"],[120362,1,"i"],[120363,1,"j"],[120364,1,"k"],[120365,1,"l"],[120366,1,"m"],[120367,1,"n"],[120368,1,"o"],[120369,1,"p"],[120370,1,"q"],[120371,1,"r"],[120372,1,"s"],[120373,1,"t"],[120374,1,"u"],[120375,1,"v"],[120376,1,"w"],[120377,1,"x"],[120378,1,"y"],[120379,1,"z"],[120380,1,"a"],[120381,1,"b"],[120382,1,"c"],[120383,1,"d"],[120384,1,"e"],[120385,1,"f"],[120386,1,"g"],[120387,1,"h"],[120388,1,"i"],[120389,1,"j"],[120390,1,"k"],[120391,1,"l"],[120392,1,"m"],[120393,1,"n"],[120394,1,"o"],[120395,1,"p"],[120396,1,"q"],[120397,1,"r"],[120398,1,"s"],[120399,1,"t"],[120400,1,"u"],[120401,1,"v"],[120402,1,"w"],[120403,1,"x"],[120404,1,"y"],[120405,1,"z"],[120406,1,"a"],[120407,1,"b"],[120408,1,"c"],[120409,1,"d"],[120410,1,"e"],[120411,1,"f"],[120412,1,"g"],[120413,1,"h"],[120414,1,"i"],[120415,1,"j"],[120416,1,"k"],[120417,1,"l"],[120418,1,"m"],[120419,1,"n"],[120420,1,"o"],[120421,1,"p"],[120422,1,"q"],[120423,1,"r"],[120424,1,"s"],[120425,1,"t"],[120426,1,"u"],[120427,1,"v"],[120428,1,"w"],[120429,1,"x"],[120430,1,"y"],[120431,1,"z"],[120432,1,"a"],[120433,1,"b"],[120434,1,"c"],[120435,1,"d"],[120436,1,"e"],[120437,1,"f"],[120438,1,"g"],[120439,1,"h"],[120440,1,"i"],[120441,1,"j"],[120442,1,"k"],[120443,1,"l"],[120444,1,"m"],[120445,1,"n"],[120446,1,"o"],[120447,1,"p"],[120448,1,"q"],[120449,1,"r"],[120450,1,"s"],[120451,1,"t"],[120452,1,"u"],[120453,1,"v"],[120454,1,"w"],[120455,1,"x"],[120456,1,"y"],[120457,1,"z"],[120458,1,"a"],[120459,1,"b"],[120460,1,"c"],[120461,1,"d"],[120462,1,"e"],[120463,1,"f"],[120464,1,"g"],[120465,1,"h"],[120466,1,"i"],[120467,1,"j"],[120468,1,"k"],[120469,1,"l"],[120470,1,"m"],[120471,1,"n"],[120472,1,"o"],[120473,1,"p"],[120474,1,"q"],[120475,1,"r"],[120476,1,"s"],[120477,1,"t"],[120478,1,"u"],[120479,1,"v"],[120480,1,"w"],[120481,1,"x"],[120482,1,"y"],[120483,1,"z"],[120484,1,""],[120485,1,""],[[120486,120487],3],[120488,1,""],[120489,1,""],[120490,1,""],[120491,1,""],[120492,1,""],[120493,1,""],[120494,1,""],[120495,1,""],[120496,1,""],[120497,1,""],[120498,1,""],[120499,1,""],[120500,1,""],[120501,1,""],[120502,1,""],[120503,1,""],[120504,1,""],[120505,1,""],[120506,1,""],[120507,1,""],[120508,1,""],[120509,1,""],[120510,1,""],[120511,1,""],[120512,1,""],[120513,1,""],[120514,1,""],[120515,1,""],[120516,1,""],[120517,1,""],[120518,1,""],[120519,1,""],[120520,1,""],[120521,1,""],[120522,1,""],[120523,1,""],[120524,1,""],[120525,1,""],[120526,1,""],[120527,1,""],[120528,1,""],[120529,1,""],[120530,1,""],[[120531,120532],1,""],[120533,1,""],[120534,1,""],[120535,1,""],[120536,1,""],[120537,1,""],[120538,1,""],[120539,1,""],[120540,1,""],[120541,1,""],[120542,1,""],[120543,1,""],[120544,1,""],[120545,1,""],[120546,1,""],[120547,1,""],[120548,1,""],[120549,1,""],[120550,1,""],[120551,1,""],[120552,1,""],[120553,1,""],[120554,1,""],[120555,1,""],[120556,1,""],[120557,1,""],[120558,1,""],[120559,1,""],[120560,1,""],[120561,1,""],[120562,1,""],[120563,1,""],[120564,1,""],[120565,1,""],[120566,1,""],[120567,1,""],[120568,1,""],[120569,1,""],[120570,1,""],[120571,1,""],[120572,1,""],[120573,1,""],[120574,1,""],[120575,1,""],[120576,1,""],[120577,1,""],[120578,1,""],[120579,1,""],[120580,1,""],[120581,1,""],[120582,1,""],[120583,1,""],[120584,1,""],[120585,1,""],[120586,1,""],[120587,1,""],[120588,1,""],[[120589,120590],1,""],[120591,1,""],[120592,1,""],[120593,1,""],[120594,1,""],[120595,1,""],[120596,1,""],[120597,1,""],[120598,1,""],[120599,1,""],[120600,1,""],[120601,1,""],[120602,1,""],[120603,1,""],[120604,1,""],[120605,1,""],[120606,1,""],[120607,1,""],[120608,1,""],[120609,1,""],[120610,1,""],[120611,1,""],[120612,1,""],[120613,1,""],[120614,1,""],[120615,1,""],[120616,1,""],[120617,1,""],[120618,1,""],[120619,1,""],[120620,1,""],[120621,1,""],[120622,1,""],[120623,1,""],[120624,1,""],[120625,1,""],[120626,1,""],[120627,1,""],[120628,1,""],[120629,1,""],[120630,1,""],[120631,1,""],[120632,1,""],[120633,1,""],[120634,1,""],[120635,1,""],[120636,1,""],[120637,1,""],[120638,1,""],[120639,1,""],[120640,1,""],[120641,1,""],[120642,1,""],[120643,1,""],[120644,1,""],[120645,1,""],[120646,1,""],[[120647,120648],1,""],[120649,1,""],[120650,1,""],[120651,1,""],[120652,1,""],[120653,1,""],[120654,1,""],[120655,1,""],[120656,1,""],[120657,1,""],[120658,1,""],[120659,1,""],[120660,1,""],[120661,1,""],[120662,1,""],[120663,1,""],[120664,1,""],[120665,1,""],[120666,1,""],[120667,1,""],[120668,1,""],[120669,1,""],[120670,1,""],[120671,1,""],[120672,1,""],[120673,1,""],[120674,1,""],[120675,1,""],[120676,1,""],[120677,1,""],[120678,1,""],[120679,1,""],[120680,1,""],[120681,1,""],[120682,1,""],[120683,1,""],[120684,1,""],[120685,1,""],[120686,1,""],[120687,1,""],[120688,1,""],[120689,1,""],[120690,1,""],[120691,1,""],[120692,1,""],[120693,1,""],[120694,1,""],[120695,1,""],[120696,1,""],[120697,1,""],[120698,1,""],[120699,1,""],[120700,1,""],[120701,1,""],[120702,1,""],[120703,1,""],[120704,1,""],[[120705,120706],1,""],[120707,1,""],[120708,1,""],[120709,1,""],[120710,1,""],[120711,1,""],[120712,1,""],[120713,1,""],[120714,1,""],[120715,1,""],[120716,1,""],[120717,1,""],[120718,1,""],[120719,1,""],[120720,1,""],[120721,1,""],[120722,1,""],[120723,1,""],[120724,1,""],[120725,1,""],[120726,1,""],[120727,1,""],[120728,1,""],[120729,1,""],[120730,1,""],[120731,1,""],[120732,1,""],[120733,1,""],[120734,1,""],[120735,1,""],[120736,1,""],[120737,1,""],[120738,1,""],[120739,1,""],[120740,1,""],[120741,1,""],[120742,1,""],[120743,1,""],[120744,1,""],[120745,1,""],[120746,1,""],[120747,1,""],[120748,1,""],[120749,1,""],[120750,1,""],[120751,1,""],[120752,1,""],[120753,1,""],[120754,1,""],[120755,1,""],[120756,1,""],[120757,1,""],[120758,1,""],[120759,1,""],[120760,1,""],[120761,1,""],[120762,1,""],[[120763,120764],1,""],[120765,1,""],[120766,1,""],[120767,1,""],[120768,1,""],[120769,1,""],[120770,1,""],[120771,1,""],[120772,1,""],[120773,1,""],[120774,1,""],[120775,1,""],[120776,1,""],[120777,1,""],[[120778,120779],1,""],[[120780,120781],3],[120782,1,"0"],[120783,1,"1"],[120784,1,"2"],[120785,1,"3"],[120786,1,"4"],[120787,1,"5"],[120788,1,"6"],[120789,1,"7"],[120790,1,"8"],[120791,1,"9"],[120792,1,"0"],[120793,1,"1"],[120794,1,"2"],[120795,1,"3"],[120796,1,"4"],[120797,1,"5"],[120798,1,"6"],[120799,1,"7"],[120800,1,"8"],[120801,1,"9"],[120802,1,"0"],[120803,1,"1"],[120804,1,"2"],[120805,1,"3"],[120806,1,"4"],[120807,1,"5"],[120808,1,"6"],[120809,1,"7"],[120810,1,"8"],[120811,1,"9"],[120812,1,"0"],[120813,1,"1"],[120814,1,"2"],[120815,1,"3"],[120816,1,"4"],[120817,1,"5"],[120818,1,"6"],[120819,1,"7"],[120820,1,"8"],[120821,1,"9"],[120822,1,"0"],[120823,1,"1"],[120824,1,"2"],[120825,1,"3"],[120826,1,"4"],[120827,1,"5"],[120828,1,"6"],[120829,1,"7"],[120830,1,"8"],[120831,1,"9"],[[120832,121343],2],[[121344,121398],2],[[121399,121402],2],[[121403,121452],2],[[121453,121460],2],[121461,2],[[121462,121475],2],[121476,2],[[121477,121483],2],[[121484,121498],3],[[121499,121503],2],[121504,3],[[121505,121519],2],[[121520,122623],3],[[122624,122654],2],[[122655,122660],3],[[122661,122666],2],[[122667,122879],3],[[122880,122886],2],[122887,3],[[122888,122904],2],[[122905,122906],3],[[122907,122913],2],[122914,3],[[122915,122916],2],[122917,3],[[122918,122922],2],[[122923,122927],3],[122928,1,""],[122929,1,""],[122930,1,""],[122931,1,""],[122932,1,""],[122933,1,""],[122934,1,""],[122935,1,""],[122936,1,""],[122937,1,""],[122938,1,""],[122939,1,""],[122940,1,""],[122941,1,""],[122942,1,""],[122943,1,""],[122944,1,""],[122945,1,""],[122946,1,""],[122947,1,""],[122948,1,""],[122949,1,""],[122950,1,""],[122951,1,""],[122952,1,""],[122953,1,""],[122954,1,""],[122955,1,""],[122956,1,""],[122957,1,""],[122958,1,""],[122959,1,""],[122960,1,""],[122961,1,""],[122962,1,""],[122963,1,""],[122964,1,""],[122965,1,""],[122966,1,""],[122967,1,""],[122968,1,""],[122969,1,""],[122970,1,""],[122971,1,""],[122972,1,""],[122973,1,""],[122974,1,""],[122975,1,""],[122976,1,""],[122977,1,""],[122978,1,""],[122979,1,""],[122980,1,""],[122981,1,""],[122982,1,""],[122983,1,""],[122984,1,""],[122985,1,""],[122986,1,""],[122987,1,""],[122988,1,""],[122989,1,""],[[122990,123022],3],[123023,2],[[123024,123135],3],[[123136,123180],2],[[123181,123183],3],[[123184,123197],2],[[123198,123199],3],[[123200,123209],2],[[123210,123213],3],[123214,2],[123215,2],[[123216,123535],3],[[123536,123566],2],[[123567,123583],3],[[123584,123641],2],[[123642,123646],3],[123647,2],[[123648,124111],3],[[124112,124153],2],[[124154,124367],3],[[124368,124410],2],[[124411,124414],3],[124415,2],[[124416,124895],3],[[124896,124902],2],[124903,3],[[124904,124907],2],[124908,3],[[124909,124910],2],[124911,3],[[124912,124926],2],[124927,3],[[124928,125124],2],[[125125,125126],3],[[125127,125135],2],[[125136,125142],2],[[125143,125183],3],[125184,1,""],[125185,1,""],[125186,1,""],[125187,1,""],[125188,1,""],[125189,1,""],[125190,1,""],[125191,1,""],[125192,1,""],[125193,1,""],[125194,1,""],[125195,1,""],[125196,1,""],[125197,1,""],[125198,1,""],[125199,1,""],[125200,1,""],[125201,1,""],[125202,1,""],[125203,1,""],[125204,1,""],[125205,1,""],[125206,1,""],[125207,1,""],[125208,1,""],[125209,1,""],[125210,1,""],[125211,1,""],[125212,1,""],[125213,1,""],[125214,1,""],[125215,1,""],[125216,1,""],[125217,1,""],[[125218,125258],2],[125259,2],[[125260,125263],3],[[125264,125273],2],[[125274,125277],3],[[125278,125279],2],[[125280,126064],3],[[126065,126132],2],[[126133,126208],3],[[126209,126269],2],[[126270,126463],3],[126464,1,""],[126465,1,""],[126466,1,""],[126467,1,""],[126468,3],[126469,1,""],[126470,1,""],[126471,1,""],[126472,1,""],[126473,1,""],[126474,1,""],[126475,1,""],[126476,1,""],[126477,1,""],[126478,1,""],[126479,1,""],[126480,1,""],[126481,1,""],[126482,1,""],[126483,1,""],[126484,1,""],[126485,1,""],[126486,1,""],[126487,1,""],[126488,1,""],[126489,1,""],[126490,1,""],[126491,1,""],[126492,1,""],[126493,1,""],[126494,1,""],[126495,1,""],[126496,3],[126497,1,""],[126498,1,""],[126499,3],[126500,1,""],[[126501,126502],3],[126503,1,""],[126504,3],[126505,1,""],[126506,1,""],[126507,1,""],[126508,1,""],[126509,1,""],[126510,1,""],[126511,1,""],[126512,1,""],[126513,1,""],[126514,1,""],[126515,3],[126516,1,""],[126517,1,""],[126518,1,""],[126519,1,""],[126520,3],[126521,1,""],[126522,3],[126523,1,""],[[126524,126529],3],[126530,1,""],[[126531,126534],3],[126535,1,""],[126536,3],[126537,1,""],[126538,3],[126539,1,""],[126540,3],[126541,1,""],[126542,1,""],[126543,1,""],[126544,3],[126545,1,""],[126546,1,""],[126547,3],[126548,1,""],[[126549,126550],3],[126551,1,""],[126552,3],[126553,1,""],[126554,3],[126555,1,""],[126556,3],[126557,1,""],[126558,3],[126559,1,""],[126560,3],[126561,1,""],[126562,1,""],[126563,3],[126564,1,""],[[126565,126566],3],[126567,1,""],[126568,1,""],[126569,1,""],[126570,1,""],[126571,3],[126572,1,""],[126573,1,""],[126574,1,""],[126575,1,""],[126576,1,""],[126577,1,""],[126578,1,""],[126579,3],[126580,1,""],[126581,1,""],[126582,1,""],[126583,1,""],[126584,3],[126585,1,""],[126586,1,""],[126587,1,""],[126588,1,""],[126589,3],[126590,1,""],[126591,3],[126592,1,""],[126593,1,""],[126594,1,""],[126595,1,""],[126596,1,""],[126597,1,""],[126598,1,""],[126599,1,""],[126600,1,""],[126601,1,""],[126602,3],[126603,1,""],[126604,1,""],[126605,1,""],[126606,1,""],[126607,1,""],[126608,1,""],[126609,1,""],[126610,1,""],[126611,1,""],[126612,1,""],[126613,1,""],[126614,1,""],[126615,1,""],[126616,1,""],[126617,1,""],[126618,1,""],[126619,1,""],[[126620,126624],3],[126625,1,""],[126626,1,""],[126627,1,""],[126628,3],[126629,1,""],[126630,1,""],[126631,1,""],[126632,1,""],[126633,1,""],[126634,3],[126635,1,""],[126636,1,""],[126637,1,""],[126638,1,""],[126639,1,""],[126640,1,""],[126641,1,""],[126642,1,""],[126643,1,""],[126644,1,""],[126645,1,""],[126646,1,""],[126647,1,""],[126648,1,""],[126649,1,""],[126650,1,""],[126651,1,""],[[126652,126703],3],[[126704,126705],2],[[126706,126975],3],[[126976,127019],2],[[127020,127023],3],[[127024,127123],2],[[127124,127135],3],[[127136,127150],2],[[127151,127152],3],[[127153,127166],2],[127167,2],[127168,3],[[127169,127183],2],[127184,3],[[127185,127199],2],[[127200,127221],2],[[127222,127231],3],[127232,3],[127233,1,"0,"],[127234,1,"1,"],[127235,1,"2,"],[127236,1,"3,"],[127237,1,"4,"],[127238,1,"5,"],[127239,1,"6,"],[127240,1,"7,"],[127241,1,"8,"],[127242,1,"9,"],[[127243,127244],2],[[127245,127247],2],[127248,1,"(a)"],[127249,1,"(b)"],[127250,1,"(c)"],[127251,1,"(d)"],[127252,1,"(e)"],[127253,1,"(f)"],[127254,1,"(g)"],[127255,1,"(h)"],[127256,1,"(i)"],[127257,1,"(j)"],[127258,1,"(k)"],[127259,1,"(l)"],[127260,1,"(m)"],[127261,1,"(n)"],[127262,1,"(o)"],[127263,1,"(p)"],[127264,1,"(q)"],[127265,1,"(r)"],[127266,1,"(s)"],[127267,1,"(t)"],[127268,1,"(u)"],[127269,1,"(v)"],[127270,1,"(w)"],[127271,1,"(x)"],[127272,1,"(y)"],[127273,1,"(z)"],[127274,1,"s"],[127275,1,"c"],[127276,1,"r"],[127277,1,"cd"],[127278,1,"wz"],[127279,2],[127280,1,"a"],[127281,1,"b"],[127282,1,"c"],[127283,1,"d"],[127284,1,"e"],[127285,1,"f"],[127286,1,"g"],[127287,1,"h"],[127288,1,"i"],[127289,1,"j"],[127290,1,"k"],[127291,1,"l"],[127292,1,"m"],[127293,1,"n"],[127294,1,"o"],[127295,1,"p"],[127296,1,"q"],[127297,1,"r"],[127298,1,"s"],[127299,1,"t"],[127300,1,"u"],[127301,1,"v"],[127302,1,"w"],[127303,1,"x"],[127304,1,"y"],[127305,1,"z"],[127306,1,"hv"],[127307,1,"mv"],[127308,1,"sd"],[127309,1,"ss"],[127310,1,"ppv"],[127311,1,"wc"],[[127312,127318],2],[127319,2],[[127320,127326],2],[127327,2],[[127328,127337],2],[127338,1,"mc"],[127339,1,"md"],[127340,1,"mr"],[[127341,127343],2],[[127344,127352],2],[127353,2],[127354,2],[[127355,127356],2],[[127357,127358],2],[127359,2],[[127360,127369],2],[[127370,127373],2],[[127374,127375],2],[127376,1,"dj"],[[127377,127386],2],[[127387,127404],2],[127405,2],[[127406,127461],3],[[127462,127487],2],[127488,1,""],[127489,1,""],[127490,1,""],[[127491,127503],3],[127504,1,""],[127505,1,""],[127506,1,""],[127507,1,""],[127508,1,""],[127509,1,""],[127510,1,""],[127511,1,""],[127512,1,""],[127513,1,""],[127514,1,""],[127515,1,""],[127516,1,""],[127517,1,""],[127518,1,""],[127519,1,""],[127520,1,""],[127521,1,""],[127522,1,""],[127523,1,""],[127524,1,""],[127525,1,""],[127526,1,""],[127527,1,""],[127528,1,""],[127529,1,""],[127530,1,""],[127531,1,""],[127532,1,""],[127533,1,""],[127534,1,""],[127535,1,""],[127536,1,""],[127537,1,""],[127538,1,""],[127539,1,""],[127540,1,""],[127541,1,""],[127542,1,""],[127543,1,""],[127544,1,""],[127545,1,""],[127546,1,""],[127547,1,""],[[127548,127551],3],[127552,1,""],[127553,1,""],[127554,1,""],[127555,1,""],[127556,1,""],[127557,1,""],[127558,1,""],[127559,1,""],[127560,1,""],[[127561,127567],3],[127568,1,""],[127569,1,""],[[127570,127583],3],[[127584,127589],2],[[127590,127743],3],[[127744,127776],2],[[127777,127788],2],[[127789,127791],2],[[127792,127797],2],[127798,2],[[127799,127868],2],[127869,2],[[127870,127871],2],[[127872,127891],2],[[127892,127903],2],[[127904,127940],2],[127941,2],[[127942,127946],2],[[127947,127950],2],[[127951,127955],2],[[127956,127967],2],[[127968,127984],2],[[127985,127991],2],[[127992,127999],2],[[128e3,128062],2],[128063,2],[128064,2],[128065,2],[[128066,128247],2],[128248,2],[[128249,128252],2],[[128253,128254],2],[128255,2],[[128256,128317],2],[[128318,128319],2],[[128320,128323],2],[[128324,128330],2],[[128331,128335],2],[[128336,128359],2],[[128360,128377],2],[128378,2],[[128379,128419],2],[128420,2],[[128421,128506],2],[[128507,128511],2],[128512,2],[[128513,128528],2],[128529,2],[[128530,128532],2],[128533,2],[128534,2],[128535,2],[128536,2],[128537,2],[128538,2],[128539,2],[[128540,128542],2],[128543,2],[[128544,128549],2],[[128550,128551],2],[[128552,128555],2],[128556,2],[128557,2],[[128558,128559],2],[[128560,128563],2],[128564,2],[[128565,128576],2],[[128577,128578],2],[[128579,128580],2],[[128581,128591],2],[[128592,128639],2],[[128640,128709],2],[[128710,128719],2],[128720,2],[[128721,128722],2],[[128723,128724],2],[128725,2],[[128726,128727],2],[[128728,128731],3],[128732,2],[[128733,128735],2],[[128736,128748],2],[[128749,128751],3],[[128752,128755],2],[[128756,128758],2],[[128759,128760],2],[128761,2],[128762,2],[[128763,128764],2],[[128765,128767],3],[[128768,128883],2],[[128884,128886],2],[[128887,128890],3],[[128891,128895],2],[[128896,128980],2],[[128981,128984],2],[128985,2],[[128986,128991],3],[[128992,129003],2],[[129004,129007],3],[129008,2],[[129009,129023],3],[[129024,129035],2],[[129036,129039],3],[[129040,129095],2],[[129096,129103],3],[[129104,129113],2],[[129114,129119],3],[[129120,129159],2],[[129160,129167],3],[[129168,129197],2],[[129198,129199],3],[[129200,129201],2],[[129202,129211],2],[[129212,129215],3],[[129216,129217],2],[[129218,129279],3],[[129280,129291],2],[129292,2],[[129293,129295],2],[[129296,129304],2],[[129305,129310],2],[129311,2],[[129312,129319],2],[[129320,129327],2],[129328,2],[[129329,129330],2],[[129331,129342],2],[129343,2],[[129344,129355],2],[129356,2],[[129357,129359],2],[[129360,129374],2],[[129375,129387],2],[[129388,129392],2],[129393,2],[129394,2],[[129395,129398],2],[[129399,129400],2],[129401,2],[129402,2],[129403,2],[[129404,129407],2],[[129408,129412],2],[[129413,129425],2],[[129426,129431],2],[[129432,129442],2],[[129443,129444],2],[[129445,129450],2],[[129451,129453],2],[[129454,129455],2],[[129456,129465],2],[[129466,129471],2],[129472,2],[[129473,129474],2],[[129475,129482],2],[129483,2],[129484,2],[[129485,129487],2],[[129488,129510],2],[[129511,129535],2],[[129536,129619],2],[[129620,129631],3],[[129632,129645],2],[[129646,129647],3],[[129648,129651],2],[129652,2],[[129653,129655],2],[[129656,129658],2],[[129659,129660],2],[[129661,129663],3],[[129664,129666],2],[[129667,129670],2],[[129671,129672],2],[129673,2],[[129674,129678],3],[129679,2],[[129680,129685],2],[[129686,129704],2],[[129705,129708],2],[[129709,129711],2],[[129712,129718],2],[[129719,129722],2],[[129723,129725],2],[129726,2],[129727,2],[[129728,129730],2],[[129731,129733],2],[129734,2],[[129735,129741],3],[[129742,129743],2],[[129744,129750],2],[[129751,129753],2],[[129754,129755],2],[129756,2],[[129757,129758],3],[129759,2],[[129760,129767],2],[129768,2],[129769,2],[[129770,129775],3],[[129776,129782],2],[[129783,129784],2],[[129785,129791],3],[[129792,129938],2],[129939,3],[[129940,129994],2],[[129995,130031],2],[130032,1,"0"],[130033,1,"1"],[130034,1,"2"],[130035,1,"3"],[130036,1,"4"],[130037,1,"5"],[130038,1,"6"],[130039,1,"7"],[130040,1,"8"],[130041,1,"9"],[[130042,131069],3],[[131070,131071],3],[[131072,173782],2],[[173783,173789],2],[[173790,173791],2],[[173792,173823],3],[[173824,177972],2],[[177973,177976],2],[177977,2],[[177978,177983],3],[[177984,178205],2],[[178206,178207],3],[[178208,183969],2],[[183970,183983],3],[[183984,191456],2],[[191457,191471],3],[[191472,192093],2],[[192094,194559],3],[194560,1,""],[194561,1,""],[194562,1,""],[194563,1,""],[194564,1,""],[194565,1,""],[194566,1,""],[194567,1,""],[194568,1,""],[194569,1,""],[194570,1,""],[194571,1,""],[194572,1,""],[194573,1,""],[194574,1,""],[194575,1,""],[194576,1,""],[194577,1,""],[194578,1,""],[194579,1,""],[194580,1,""],[194581,1,""],[194582,1,""],[194583,1,""],[194584,1,""],[194585,1,""],[194586,1,""],[194587,1,""],[194588,1,""],[194589,1,""],[194590,1,""],[194591,1,""],[194592,1,""],[194593,1,""],[194594,1,""],[194595,1,""],[194596,1,""],[194597,1,""],[194598,1,""],[194599,1,""],[194600,1,""],[194601,1,""],[194602,1,""],[194603,1,""],[194604,1,""],[194605,1,""],[194606,1,""],[194607,1,""],[194608,1,""],[[194609,194611],1,""],[194612,1,""],[194613,1,""],[194614,1,""],[194615,1,""],[194616,1,""],[194617,1,""],[194618,1,""],[194619,1,""],[194620,1,""],[194621,1,""],[194622,1,""],[194623,1,""],[194624,1,""],[194625,1,""],[194626,1,""],[194627,1,""],[194628,1,""],[[194629,194630],1,""],[194631,1,""],[194632,1,""],[194633,1,""],[194634,1,""],[194635,1,""],[194636,1,""],[194637,1,""],[194638,1,""],[194639,1,""],[194640,1,""],[194641,1,""],[194642,1,""],[194643,1,""],[194644,1,""],[194645,1,""],[194646,1,""],[194647,1,""],[194648,1,""],[194649,1,""],[194650,1,""],[194651,1,""],[194652,1,""],[194653,1,""],[194654,1,""],[194655,1,""],[194656,1,""],[194657,1,""],[194658,1,""],[194659,1,""],[194660,1,""],[194661,1,""],[194662,1,""],[194663,1,""],[194664,1,""],[194665,1,""],[[194666,194667],1,""],[194668,1,""],[194669,1,""],[194670,1,""],[194671,1,""],[194672,1,""],[194673,1,""],[194674,1,""],[194675,1,""],[194676,1,""],[194677,1,""],[194678,1,""],[194679,1,""],[194680,1,""],[194681,1,""],[194682,1,""],[194683,1,""],[194684,1,""],[194685,1,""],[194686,1,""],[194687,1,""],[194688,1,""],[194689,1,""],[194690,1,""],[194691,1,""],[194692,1,""],[194693,1,""],[194694,1,""],[194695,1,""],[194696,1,""],[194697,1,""],[194698,1,""],[194699,1,""],[194700,1,""],[194701,1,""],[194702,1,""],[194703,1,""],[194704,1,""],[[194705,194706],1,""],[194707,1,""],[[194708,194709],1,""],[194710,1,""],[194711,1,""],[194712,1,""],[194713,1,""],[194714,1,""],[194715,1,""],[194716,1,""],[194717,1,""],[194718,1,""],[194719,1,""],[194720,1,""],[194721,1,""],[194722,1,""],[194723,1,""],[194724,1,""],[194725,1,""],[194726,1,""],[194727,1,""],[194728,1,""],[194729,1,""],[194730,1,""],[194731,1,""],[194732,1,""],[194733,1,""],[194734,1,""],[194735,1,""],[194736,1,""],[194737,1,""],[194738,1,""],[194739,1,""],[194740,1,""],[194741,1,""],[194742,1,""],[194743,1,""],[194744,1,""],[194745,1,""],[194746,1,""],[194747,1,""],[194748,1,""],[194749,1,""],[194750,1,""],[194751,1,""],[194752,1,""],[194753,1,""],[194754,1,""],[194755,1,""],[194756,1,""],[194757,1,""],[194758,1,""],[194759,1,""],[194760,1,""],[194761,1,""],[194762,1,""],[194763,1,""],[194764,1,""],[194765,1,""],[194766,1,""],[194767,1,""],[194768,1,""],[194769,1,""],[194770,1,""],[194771,1,""],[194772,1,""],[194773,1,""],[194774,1,""],[194775,1,""],[194776,1,""],[194777,1,""],[194778,1,""],[194779,1,""],[194780,1,""],[194781,1,""],[194782,1,""],[194783,1,""],[194784,1,""],[194785,1,""],[194786,1,""],[194787,1,""],[194788,1,""],[194789,1,""],[194790,1,""],[194791,1,""],[194792,1,""],[194793,1,""],[194794,1,""],[194795,1,""],[194796,1,""],[194797,1,""],[194798,1,""],[194799,1,""],[194800,1,""],[194801,1,""],[194802,1,""],[194803,1,""],[194804,1,""],[194805,1,""],[194806,1,""],[194807,1,""],[194808,1,""],[194809,1,""],[194810,1,""],[194811,1,""],[194812,1,""],[194813,1,""],[194814,1,""],[194815,1,""],[194816,1,""],[194817,1,""],[194818,1,""],[194819,1,""],[194820,1,""],[194821,1,""],[194822,1,""],[194823,1,""],[194824,1,""],[194825,1,""],[194826,1,""],[194827,1,""],[194828,1,""],[194829,1,""],[194830,1,""],[194831,1,""],[194832,1,""],[194833,1,""],[194834,1,""],[194835,1,""],[194836,1,""],[194837,1,""],[194838,1,""],[194839,1,""],[194840,1,""],[194841,1,""],[194842,1,""],[194843,1,""],[194844,1,""],[194845,1,""],[194846,1,""],[194847,1,""],[194848,1,""],[194849,1,""],[194850,1,""],[194851,1,""],[194852,1,""],[194853,1,""],[194854,1,""],[194855,1,""],[194856,1,""],[194857,1,""],[194858,1,""],[194859,1,""],[[194860,194861],1,""],[194862,1,""],[194863,1,""],[194864,1,""],[194865,1,""],[194866,1,""],[194867,1,""],[194868,1,""],[194869,1,""],[194870,1,""],[194871,1,""],[194872,1,""],[194873,1,""],[194874,1,""],[194875,1,""],[194876,1,""],[194877,1,""],[194878,1,""],[194879,1,""],[194880,1,""],[194881,1,""],[194882,1,""],[194883,1,""],[194884,1,""],[194885,1,""],[[194886,194887],1,""],[194888,1,""],[194889,1,""],[194890,1,""],[194891,1,""],[194892,1,""],[194893,1,""],[194894,1,""],[194895,1,""],[194896,1,""],[194897,1,""],[194898,1,""],[194899,1,""],[194900,1,""],[194901,1,""],[194902,1,""],[194903,1,""],[194904,1,""],[194905,1,""],[194906,1,""],[194907,1,""],[194908,1,""],[[194909,194910],1,""],[194911,1,""],[194912,1,""],[194913,1,""],[194914,1,""],[194915,1,""],[194916,1,""],[194917,1,""],[194918,1,""],[194919,1,""],[194920,1,""],[194921,1,""],[194922,1,""],[194923,1,""],[194924,1,""],[194925,1,""],[194926,1,""],[194927,1,""],[194928,1,""],[194929,1,""],[194930,1,""],[194931,1,""],[194932,1,""],[194933,1,""],[194934,1,""],[194935,1,""],[194936,1,""],[194937,1,""],[194938,1,""],[194939,1,""],[194940,1,""],[194941,1,""],[194942,1,""],[194943,1,""],[194944,1,""],[194945,1,""],[194946,1,""],[194947,1,""],[194948,1,""],[194949,1,""],[194950,1,""],[194951,1,""],[194952,1,""],[194953,1,""],[194954,1,""],[194955,1,""],[194956,1,""],[194957,1,""],[194958,1,""],[194959,1,""],[194960,1,""],[194961,1,""],[194962,1,""],[194963,1,""],[194964,1,""],[194965,1,""],[194966,1,""],[194967,1,""],[194968,1,""],[194969,1,""],[194970,1,""],[194971,1,""],[194972,1,""],[194973,1,""],[194974,1,""],[194975,1,""],[194976,1,""],[194977,1,""],[194978,1,""],[194979,1,""],[194980,1,""],[194981,1,""],[194982,1,""],[194983,1,""],[194984,1,""],[194985,1,""],[194986,1,""],[194987,1,""],[194988,1,""],[194989,1,""],[194990,1,""],[194991,1,""],[194992,1,""],[194993,1,""],[194994,1,""],[194995,1,""],[194996,1,""],[194997,1,""],[194998,1,""],[194999,1,""],[195e3,1,""],[195001,1,""],[195002,1,""],[195003,1,""],[195004,1,""],[195005,1,""],[195006,1,""],[195007,1,""],[195008,1,""],[195009,1,""],[195010,1,""],[195011,1,""],[195012,1,""],[195013,1,""],[195014,1,""],[195015,1,""],[195016,1,""],[195017,1,""],[195018,1,""],[195019,1,""],[195020,1,""],[195021,1,""],[195022,1,""],[195023,1,""],[195024,1,""],[195025,1,""],[195026,1,""],[195027,1,""],[195028,1,""],[195029,1,""],[195030,1,""],[195031,1,""],[195032,1,""],[195033,1,""],[195034,1,""],[195035,1,""],[195036,1,""],[195037,1,""],[195038,1,""],[195039,1,""],[195040,1,""],[195041,1,""],[195042,1,""],[195043,1,""],[195044,1,""],[195045,1,""],[195046,1,""],[195047,1,""],[195048,1,""],[195049,1,""],[195050,1,""],[195051,1,""],[195052,1,""],[195053,1,""],[195054,1,""],[195055,1,""],[195056,1,""],[195057,1,""],[195058,1,""],[195059,1,""],[195060,1,""],[195061,1,""],[195062,1,""],[195063,1,""],[195064,1,""],[195065,1,""],[195066,1,""],[195067,1,""],[195068,1,""],[195069,1,""],[[195070,195071],1,""],[195072,1,""],[195073,1,""],[195074,1,""],[195075,1,""],[195076,1,""],[195077,1,""],[195078,1,""],[195079,1,""],[195080,1,""],[195081,1,""],[195082,1,""],[195083,1,""],[195084,1,""],[195085,1,""],[195086,1,""],[195087,1,""],[195088,1,""],[195089,1,""],[195090,1,""],[195091,1,""],[195092,1,""],[195093,1,""],[195094,1,""],[195095,1,""],[195096,1,""],[195097,1,""],[195098,1,""],[195099,1,""],[195100,1,""],[195101,1,""],[[195102,196605],3],[[196606,196607],3],[[196608,201546],2],[[201547,201551],3],[[201552,205743],2],[[205744,262141],3],[[262142,262143],3],[[262144,327677],3],[[327678,327679],3],[[327680,393213],3],[[393214,393215],3],[[393216,458749],3],[[458750,458751],3],[[458752,524285],3],[[524286,524287],3],[[524288,589821],3],[[589822,589823],3],[[589824,655357],3],[[655358,655359],3],[[655360,720893],3],[[720894,720895],3],[[720896,786429],3],[[786430,786431],3],[[786432,851965],3],[[851966,851967],3],[[851968,917501],3],[[917502,917503],3],[917504,3],[917505,3],[[917506,917535],3],[[917536,917631],3],[[917632,917759],3],[[917760,917999],7],[[918e3,983037],3],[[983038,983039],3],[[983040,1048573],3],[[1048574,1048575],3],[[1048576,1114109],3],[[1114110,1114111],3]],Gr={};function Hr(){if(Nr)return Pr;Nr=1;const e=Fr,t=$r(),n=qr,{STATUS_MAPPING:r}=(xr||(xr=1,Gr.STATUS_MAPPING={mapped:1,valid:2,disallowed:3,deviation:6,ignored:7}),Gr);function o(e){return/[^\x00-\x7F]/u.test(e)}function i(e){let t=0,r=n.length-1;for(;t<=r;){const o=Math.floor((t+r)/2),i=n[o],s=Array.isArray(i[0])?i[0][0]:i[0],u=Array.isArray(i[0])?i[0][1]:i[0];if(s<=e&&u>=e)return i.slice(1);s>e?r=o-1:t=o+1}return null}function s(e,{checkHyphens:n,checkBidi:o,checkJoiners:s,transitionalProcessing:u,useSTD3ASCIIRules:a,isBidi:c}){if(0===e.length)return!0;if(e.normalize("NFC")!==e)return!1;const l=Array.from(e);if(n&&("-"===l[2]&&"-"===l[3]||e.startsWith("-")||e.endsWith("-")))return!1;if(!n&&e.startsWith("xn--"))return!1;if(e.includes("."))return!1;if(t.combiningMarks.test(l[0]))return!1;for(const e of l){const t=e.codePointAt(0),[n]=i(t);if(u){if(n!==r.valid)return!1}else if(n!==r.valid&&n!==r.deviation)return!1;if(a&&t<=127&&!/^[a-z][0-9]-$/u.test(e))return!1}if(s){let e=0;for(const[n,r]of l.entries())if(""===r||""===r){if(n>0){if(t.combiningClassVirama.test(l[n-1]))continue;if(""===r){const r=l.indexOf("",n+1),o=r<0?l.slice(e):l.slice(e,r);if(t.validZWNJ.test(o.join(""))){e=n+1;continue}}}return!1}}if(o&&c){let n;if(t.bidiS1LTR.test(l[0]))n=!1;else{if(!t.bidiS1RTL.test(l[0]))return!1;n=!0}if(n){if(!t.bidiS2.test(e)||!t.bidiS3.test(e)||t.bidiS4EN.test(e)&&t.bidiS4AN.test(e))return!1}else if(!t.bidiS5.test(e)||!t.bidiS6.test(e))return!1}return!0}function u(n,u){let a=function(e,{transitionalProcessing:t}){let n="";for(const o of e){const[e,s]=i(o.codePointAt(0));switch(e){case r.disallowed:n+=o;break;case r.ignored:break;case r.mapped:n+=t&&""===o?"ss":s;break;case r.deviation:n+=t?s:o;break;case r.valid:n+=o}}return n}(n,u);a=a.normalize("NFC");const c=a.split("."),l=function(n){const r=n.map((t=>{if(t.startsWith("xn--"))try{return e.decode(t.substring(4))}catch{return""}return t})).join(".");return t.bidiDomain.test(r)}(c);let h=!1;for(const[t,n]of c.entries()){let r=n,i=u.transitionalProcessing;if(r.startsWith("xn--")){if(o(r)){h=!0;continue}try{r=e.decode(r.substring(4))}catch{if(!u.ignoreInvalidPunycode){h=!0;continue}}c[t]=r,""!==r&&o(r)||(h=!0),i=!1}if(h)continue;s(r,{...u,transitionalProcessing:i,isBidi:l})||(h=!0)}return{string:c.join("."),error:h}}return Pr={toASCII:function(t,{checkHyphens:n=!1,checkBidi:r=!1,checkJoiners:i=!1,useSTD3ASCIIRules:s=!1,verifyDNSLength:a=!1,transitionalProcessing:c=!1,ignoreInvalidPunycode:l=!1}={}){const h=u(t,{checkHyphens:n,checkBidi:r,checkJoiners:i,useSTD3ASCIIRules:s,transitionalProcessing:c,ignoreInvalidPunycode:l});let p=h.string.split(".");if(p=p.map((t=>{if(o(t))try{return`xn--${e.encode(t)}`}catch{h.error=!0}return t})),a){const e=p.join(".").length;(e>253||0===e)&&(h.error=!0);for(let e=0;e<p.length;++e)if(p[e].length>63||0===p[e].length){h.error=!0;break}}return h.error?null:p.join(".")},toUnicode:function(e,{checkHyphens:t=!1,checkBidi:n=!1,checkJoiners:r=!1,useSTD3ASCIIRules:o=!1,transitionalProcessing:i=!1,ignoreInvalidPunycode:s=!1}={}){const a=u(e,{checkHyphens:t,checkBidi:n,checkJoiners:r,useSTD3ASCIIRules:o,transitionalProcessing:i,ignoreInvalidPunycode:s});return{domain:a.string,error:a.error}}}}function Kr(){if(Rr)return Ir;function e(e){return e>=48&&e<=57}function t(e){return e>=65&&e<=90||e>=97&&e<=122}return Rr=1,Ir={isASCIIDigit:e,isASCIIAlpha:t,isASCIIAlphanumeric:function(n){return t(n)||e(n)},isASCIIHex:function(t){return e(t)||t>=65&&t<=70||t>=97&&t<=102}}}function Yr(){if(jr)return kr;jr=1;const e=new TextEncoder,t=new TextDecoder("utf-8",{ignoreBOM:!0});return kr={utf8Encode:function(t){return e.encode(t)},utf8DecodeWithoutBOM:function(e){return t.decode(e)}},kr}function Qr(){if(Ur)return Lr;Ur=1;const{isASCIIHex:e}=Kr(),{utf8Encode:t}=Yr();function n(e){return e.codePointAt(0)}function r(e){let t=e.toString(16).toUpperCase();return 1===t.length&&(t=`0${t}`),`%${t}`}function o(t){const n=new Uint8Array(t.byteLength);let r=0;for(let o=0;o<t.byteLength;++o){const i=t[o];if(37!==i)n[r++]=i;else if(37!==i||e(t[o+1])&&e(t[o+2])){const e=parseInt(String.fromCodePoint(t[o+1],t[o+2]),16);n[r++]=e,o+=2}else n[r++]=i}return n.slice(0,r)}function i(e){return e<=31||e>126}const s=new Set([n(" "),n('"'),n("<"),n(">"),n("`")]);const u=new Set([n(" "),n('"'),n("#"),n("<"),n(">")]);function a(e){return i(e)||u.has(e)}const c=new Set([n("?"),n("`"),n("{"),n("}"),n("^")]);function l(e){return a(e)||c.has(e)}const h=new Set([n("/"),n(":"),n(";"),n("="),n("@"),n("["),n("\\"),n("]"),n("|")]);function p(e){return l(e)||h.has(e)}const d=new Set([n("$"),n("%"),n("&"),n("+"),n(",")]);const f=new Set([n("!"),n("'"),n("("),n(")"),n("~")]);function m(e,n){const o=t(e);let i="";for(const e of o)n(e)?i+=r(e):i+=String.fromCharCode(e);return i}return Lr={isC0ControlPercentEncode:i,isFragmentPercentEncode:function(e){return i(e)||s.has(e)},isQueryPercentEncode:a,isSpecialQueryPercentEncode:function(e){return a(e)||e===n("'")},isPathPercentEncode:l,isUserinfoPercentEncode:p,isURLEncodedPercentEncode:function(e){return function(e){return p(e)||d.has(e)}(e)||f.has(e)},percentDecodeString:function(e){return o(t(e))},percentDecodeBytes:o,utf8PercentEncodeString:function(e,t,n=!1){let r="";for(const o of e)r+=n&&" "===o?"+":m(o,t);return r},utf8PercentEncodeCodePoint:function(e,t){return m(String.fromCodePoint(e),t)}}}function Jr(){return Vr||(Vr=1,function(e){const t=Hr(),n=Kr(),{utf8DecodeWithoutBOM:r}=Yr(),{percentDecodeString:o,utf8PercentEncodeCodePoint:i,utf8PercentEncodeString:s,isC0ControlPercentEncode:u,isFragmentPercentEncode:a,isQueryPercentEncode:c,isSpecialQueryPercentEncode:l,isPathPercentEncode:h,isUserinfoPercentEncode:p}=Qr();function d(e){return e.codePointAt(0)}const f={ftp:21,file:null,http:80,https:443,ws:80,wss:443},m=Symbol("failure");function y(e){return[...e].length}function g(e,t){const n=e[t];return isNaN(n)?void 0:String.fromCodePoint(n)}function E(e){return"."===e||"%2e"===e.toLowerCase()}function A(e){return 2===e.length&&n.isASCIIAlpha(e.codePointAt(0))&&(":"===e[1]||"|"===e[1])}function b(e){return-1!==e.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|\/|:|<|>|\?|@|\[|\\|\]|\^|\|/u)}function _(e){return void 0!==f[e]}function O(e){return _(e.scheme)}function C(e){return!_(e.scheme)}function w(e){return f[e]}function S(e){if(""===e)return m;let t=10;if(e.length>=2&&"0"===e.charAt(0)&&"x"===e.charAt(1).toLowerCase()?(e=e.substring(2),t=16):e.length>=2&&"0"===e.charAt(0)&&(e=e.substring(1),t=8),""===e)return 0;let n=/[^0-7]/u;return 10===t&&(n=/[^0-9]/u),16===t&&(n=/[^0-9A-Fa-f]/u),n.test(e)?m:parseInt(e,t)}function v(e,i=!1){if("["===e[0])return"]"!==e[e.length-1]?m:function(e){const t=[0,0,0,0,0,0,0,0];let r=0,o=null,i=0;if((e=Array.from(e,(e=>e.codePointAt(0))))[i]===d(":")){if(e[i+1]!==d(":"))return m;i+=2,++r,o=r}for(;i<e.length;){if(8===r)return m;if(e[i]===d(":")){if(null!==o)return m;++i,++r,o=r;continue}let s=0,u=0;for(;u<4&&n.isASCIIHex(e[i]);)s=16*s+parseInt(g(e,i),16),++i,++u;if(e[i]===d(".")){if(0===u)return m;if(i-=u,r>6)return m;let o=0;for(;void 0!==e[i];){let s=null;if(o>0){if(!(e[i]===d(".")&&o<4))return m;++i}if(!n.isASCIIDigit(e[i]))return m;for(;n.isASCIIDigit(e[i]);){const t=parseInt(g(e,i));if(null===s)s=t;else{if(0===s)return m;s=10*s+t}if(s>255)return m;++i}t[r]=256*t[r]+s,++o,2!==o&&4!==o||++r}if(4!==o)return m;break}if(e[i]===d(":")){if(++i,void 0===e[i])return m}else if(void 0!==e[i])return m;t[r]=s,++r}if(null!==o){let e=r-o;for(r=7;0!==r&&e>0;){const n=t[o+e-1];t[o+e-1]=t[r],t[r]=n,--r,--e}}else if(null===o&&8!==r)return m;return t}(e.substring(1,e.length-1));if(i)return function(e){if(b(e))return m;return s(e,u)}(e);const a=function(e,n=!1){const r=t.toASCII(e,{checkHyphens:n,checkBidi:!0,checkJoiners:!0,useSTD3ASCIIRules:n,transitionalProcessing:!1,verifyDNSLength:n,ignoreInvalidPunycode:!1});if(null===r)return m;if(!n){if(""===r)return m;if(function(e){return b(e)||-1!==e.search(/[\u0000-\u001F]|%|\u007F/u)}(r))return m}return r}(r(o(e)));return a===m?m:function(e){const t=e.split(".");if(""===t[t.length-1]){if(1===t.length)return!1;t.pop()}const n=t[t.length-1];if(S(n)!==m)return!0;if(/^[0-9]+$/u.test(n))return!0;return!1}(a)?function(e){const t=e.split(".");if(""===t[t.length-1]&&t.length>1&&t.pop(),t.length>4)return m;const n=[];for(const e of t){const t=S(e);if(t===m)return m;n.push(t)}for(let e=0;e<n.length-1;++e)if(n[e]>255)return m;if(n[n.length-1]>=256**(5-n.length))return m;let r=n.pop(),o=0;for(const e of n)r+=e*256**(3-o),++o;return r}(a):a}function D(e){return"number"==typeof e?function(e){let t="",n=e;for(let e=1;e<=4;++e)t=String(n%256)+t,4!==e&&(t=`.${t}`),n=Math.floor(n/256);return t}(e):e instanceof Array?`[${function(e){let t="";const n=function(e){let t=null,n=1,r=null,o=0;for(let i=0;i<e.length;++i)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n?r:t}(e);let r=!1;for(let o=0;o<=7;++o)r&&0===e[o]||(r&&(r=!1),n!==o?(t+=e[o].toString(16),7!==o&&(t+=":")):(t+=0===o?"::":":",r=!0));return t}(e)}]`:e}function M(e){const{path:t}=e;0!==t.length&&("file"===e.scheme&&1===t.length&&function(e){return/^[A-Za-z]:$/u.test(e)}(t[0])||t.pop())}function T(e){return""!==e.username||""!==e.password}function B(e){return"string"==typeof e.path}function F(e,t,n,r,o){if(this.pointer=0,this.input=e,this.base=t||null,this.encodingOverride=n||"utf-8",this.stateOverride=o,this.url=r,this.failure=!1,this.parseError=!1,!this.url){this.url={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null};const e=function(e){let t=0,n=e.length;for(;t<n&&!(e.charCodeAt(t)>32);++t);for(;n>t&&!(e.charCodeAt(n-1)>32);--n);return e.substring(t,n)}(this.input);e!==this.input&&(this.parseError=!0),this.input=e}const i=function(e){return e.replace(/\u0009|\u000A|\u000D/gu,"")}(this.input);for(i!==this.input&&(this.parseError=!0),this.input=i,this.state=o||"scheme start",this.buffer="",this.atFlag=!1,this.arrFlag=!1,this.passwordTokenSeenFlag=!1,this.input=Array.from(this.input,(e=>e.codePointAt(0)));this.pointer<=this.input.length;++this.pointer){const e=this.input[this.pointer],t=isNaN(e)?void 0:String.fromCodePoint(e),n=this[`parse ${this.state}`](e,t);if(!n)break;if(n===m){this.failure=!0;break}}}F.prototype["parse scheme start"]=function(e,t){if(n.isASCIIAlpha(e))this.buffer+=t.toLowerCase(),this.state="scheme";else{if(this.stateOverride)return this.parseError=!0,m;this.state="no scheme",--this.pointer}return!0},F.prototype["parse scheme"]=function(e,t){if(n.isASCIIAlphanumeric(e)||e===d("+")||e===d("-")||e===d("."))this.buffer+=t.toLowerCase();else if(e===d(":")){if(this.stateOverride){if(O(this.url)&&!_(this.buffer))return!1;if(!O(this.url)&&_(this.buffer))return!1;if((T(this.url)||null!==this.url.port)&&"file"===this.buffer)return!1;if("file"===this.url.scheme&&""===this.url.host)return!1}if(this.url.scheme=this.buffer,this.stateOverride)return this.url.port===w(this.url.scheme)&&(this.url.port=null),!1;this.buffer="","file"===this.url.scheme?(this.input[this.pointer+1]===d("/")&&this.input[this.pointer+2]===d("/")||(this.parseError=!0),this.state="file"):O(this.url)&&null!==this.base&&this.base.scheme===this.url.scheme?this.state="special relative or authority":O(this.url)?this.state="special authority slashes":this.input[this.pointer+1]===d("/")?(this.state="path or authority",++this.pointer):(this.url.path="",this.state="opaque path")}else{if(this.stateOverride)return this.parseError=!0,m;this.buffer="",this.state="no scheme",this.pointer=-1}return!0},F.prototype["parse no scheme"]=function(e){return null===this.base||B(this.base)&&e!==d("#")?m:(B(this.base)&&e===d("#")?(this.url.scheme=this.base.scheme,this.url.path=this.base.path,this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):"file"===this.base.scheme?(this.state="file",--this.pointer):(this.state="relative",--this.pointer),!0)},F.prototype["parse special relative or authority"]=function(e){return e===d("/")&&this.input[this.pointer+1]===d("/")?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="relative",--this.pointer),!0},F.prototype["parse path or authority"]=function(e){return e===d("/")?this.state="authority":(this.state="path",--this.pointer),!0},F.prototype["parse relative"]=function(e){return this.url.scheme=this.base.scheme,e===d("/")?this.state="relative slash":O(this.url)&&e===d("\\")?(this.parseError=!0,this.state="relative slash"):(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query,e===d("?")?(this.url.query="",this.state="query"):e===d("#")?(this.url.fragment="",this.state="fragment"):isNaN(e)||(this.url.query=null,this.url.path.pop(),this.state="path",--this.pointer)),!0},F.prototype["parse relative slash"]=function(e){return!O(this.url)||e!==d("/")&&e!==d("\\")?e===d("/")?this.state="authority":(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.state="path",--this.pointer):(e===d("\\")&&(this.parseError=!0),this.state="special authority ignore slashes"),!0},F.prototype["parse special authority slashes"]=function(e){return e===d("/")&&this.input[this.pointer+1]===d("/")?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="special authority ignore slashes",--this.pointer),!0},F.prototype["parse special authority ignore slashes"]=function(e){return e!==d("/")&&e!==d("\\")?(this.state="authority",--this.pointer):this.parseError=!0,!0},F.prototype["parse authority"]=function(e,t){if(e===d("@")){this.parseError=!0,this.atFlag&&(this.buffer=`%40${this.buffer}`),this.atFlag=!0;const e=y(this.buffer);for(let t=0;t<e;++t){const e=this.buffer.codePointAt(t);if(e===d(":")&&!this.passwordTokenSeenFlag){this.passwordTokenSeenFlag=!0;continue}const n=i(e,p);this.passwordTokenSeenFlag?this.url.password+=n:this.url.username+=n}this.buffer=""}else if(isNaN(e)||e===d("/")||e===d("?")||e===d("#")||O(this.url)&&e===d("\\")){if(this.atFlag&&""===this.buffer)return this.parseError=!0,m;this.pointer-=y(this.buffer)+1,this.buffer="",this.state="host"}else this.buffer+=t;return!0},F.prototype["parse hostname"]=F.prototype["parse host"]=function(e,t){if(this.stateOverride&&"file"===this.url.scheme)--this.pointer,this.state="file host";else if(e!==d(":")||this.arrFlag)if(isNaN(e)||e===d("/")||e===d("?")||e===d("#")||O(this.url)&&e===d("\\")){if(--this.pointer,O(this.url)&&""===this.buffer)return this.parseError=!0,m;if(this.stateOverride&&""===this.buffer&&(T(this.url)||null!==this.url.port))return this.parseError=!0,!1;const e=v(this.buffer,C(this.url));if(e===m)return m;if(this.url.host=e,this.buffer="",this.state="path start",this.stateOverride)return!1}else e===d("[")?this.arrFlag=!0:e===d("]")&&(this.arrFlag=!1),this.buffer+=t;else{if(""===this.buffer)return this.parseError=!0,m;if("hostname"===this.stateOverride)return!1;const e=v(this.buffer,C(this.url));if(e===m)return m;this.url.host=e,this.buffer="",this.state="port"}return!0},F.prototype["parse port"]=function(e,t){if(n.isASCIIDigit(e))this.buffer+=t;else{if(!(isNaN(e)||e===d("/")||e===d("?")||e===d("#")||O(this.url)&&e===d("\\")||this.stateOverride))return this.parseError=!0,m;if(""!==this.buffer){const e=parseInt(this.buffer);if(e>65535)return this.parseError=!0,m;this.url.port=e===w(this.url.scheme)?null:e,this.buffer=""}if(this.stateOverride)return!1;this.state="path start",--this.pointer}return!0};const $=new Set([d("/"),d("\\"),d("?"),d("#")]);function x(e,t){const r=e.length-t;return r>=2&&(o=e[t],i=e[t+1],n.isASCIIAlpha(o)&&(i===d(":")||i===d("|")))&&(2===r||$.has(e[t+2]));var o,i}function P(e){if(B(e))return e.path;let t="";for(const n of e.path)t+=`/${n}`;return t}F.prototype["parse file"]=function(e){return this.url.scheme="file",this.url.host="",e===d("/")||e===d("\\")?(e===d("\\")&&(this.parseError=!0),this.state="file slash"):null!==this.base&&"file"===this.base.scheme?(this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query,e===d("?")?(this.url.query="",this.state="query"):e===d("#")?(this.url.fragment="",this.state="fragment"):isNaN(e)||(this.url.query=null,x(this.input,this.pointer)?(this.parseError=!0,this.url.path=[]):M(this.url),this.state="path",--this.pointer)):(this.state="path",--this.pointer),!0},F.prototype["parse file slash"]=function(e){return e===d("/")||e===d("\\")?(e===d("\\")&&(this.parseError=!0),this.state="file host"):(null!==this.base&&"file"===this.base.scheme&&(!x(this.input,this.pointer)&&function(e){return 2===e.length&&n.isASCIIAlpha(e.codePointAt(0))&&":"===e[1]}(this.base.path[0])&&this.url.path.push(this.base.path[0]),this.url.host=this.base.host),this.state="path",--this.pointer),!0},F.prototype["parse file host"]=function(e,t){if(isNaN(e)||e===d("/")||e===d("\\")||e===d("?")||e===d("#"))if(--this.pointer,!this.stateOverride&&A(this.buffer))this.parseError=!0,this.state="path";else if(""===this.buffer){if(this.url.host="",this.stateOverride)return!1;this.state="path start"}else{let e=v(this.buffer,C(this.url));if(e===m)return m;if("localhost"===e&&(e=""),this.url.host=e,this.stateOverride)return!1;this.buffer="",this.state="path start"}else this.buffer+=t;return!0},F.prototype["parse path start"]=function(e){return O(this.url)?(e===d("\\")&&(this.parseError=!0),this.state="path",e!==d("/")&&e!==d("\\")&&--this.pointer):this.stateOverride||e!==d("?")?this.stateOverride||e!==d("#")?void 0!==e?(this.state="path",e!==d("/")&&--this.pointer):this.stateOverride&&null===this.url.host&&this.url.path.push(""):(this.url.fragment="",this.state="fragment"):(this.url.query="",this.state="query"),!0},F.prototype["parse path"]=function(e){return isNaN(e)||e===d("/")||O(this.url)&&e===d("\\")||!this.stateOverride&&(e===d("?")||e===d("#"))?(O(this.url)&&e===d("\\")&&(this.parseError=!0),!function(e){return".."===(e=e.toLowerCase())||"%2e."===e||".%2e"===e||"%2e%2e"===e}(this.buffer)?!E(this.buffer)||e===d("/")||O(this.url)&&e===d("\\")?E(this.buffer)||("file"===this.url.scheme&&0===this.url.path.length&&A(this.buffer)&&(this.buffer=`${this.buffer[0]}:`),this.url.path.push(this.buffer)):this.url.path.push(""):(M(this.url),e===d("/")||O(this.url)&&e===d("\\")||this.url.path.push("")),this.buffer="",e===d("?")&&(this.url.query="",this.state="query"),e===d("#")&&(this.url.fragment="",this.state="fragment")):(e!==d("%")||n.isASCIIHex(this.input[this.pointer+1])&&n.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=i(e,h)),!0},F.prototype["parse opaque path"]=function(e){if(e===d("?"))this.url.query="",this.state="query";else if(e===d("#"))this.url.fragment="",this.state="fragment";else if(e===d(" ")){const e=this.input[this.pointer+1];e===d("?")||e===d("#")?this.url.path+="%20":this.url.path+=" "}else isNaN(e)||e===d("%")||(this.parseError=!0),e!==d("%")||n.isASCIIHex(this.input[this.pointer+1])&&n.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),isNaN(e)||(this.url.path+=i(e,u));return!0},F.prototype["parse query"]=function(e,t){if(O(this.url)&&"ws"!==this.url.scheme&&"wss"!==this.url.scheme||(this.encodingOverride="utf-8"),!this.stateOverride&&e===d("#")||isNaN(e)){const t=O(this.url)?l:c;this.url.query+=s(this.buffer,t),this.buffer="",e===d("#")&&(this.url.fragment="",this.state="fragment")}else isNaN(e)||(e!==d("%")||n.isASCIIHex(this.input[this.pointer+1])&&n.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=t);return!0},F.prototype["parse fragment"]=function(e){return isNaN(e)||(e!==d("%")||n.isASCIIHex(this.input[this.pointer+1])&&n.isASCIIHex(this.input[this.pointer+2])||(this.parseError=!0),this.url.fragment+=i(e,a)),!0},e.exports.serializeURL=function(e,t){let n=`${e.scheme}:`;return null!==e.host&&(n+="//",""===e.username&&""===e.password||(n+=e.username,""!==e.password&&(n+=`:${e.password}`),n+="@"),n+=D(e.host),null!==e.port&&(n+=`:${e.port}`)),null===e.host&&!B(e)&&e.path.length>1&&""===e.path[0]&&(n+="/."),n+=P(e),null!==e.query&&(n+=`?${e.query}`),t||null===e.fragment||(n+=`#${e.fragment}`),n},e.exports.serializePath=P,e.exports.serializeURLOrigin=function(t){switch(t.scheme){case"blob":{const n=e.exports.parseURL(P(t));return null===n||"http"!==n.scheme&&"https"!==n.scheme?"null":e.exports.serializeURLOrigin(n)}case"ftp":case"http":case"https":case"ws":case"wss":return function(e){let t=`${e.scheme}://`;return t+=D(e.host),null!==e.port&&(t+=`:${e.port}`),t}({scheme:t.scheme,host:t.host,port:t.port});default:return"null"}},e.exports.basicURLParse=function(e,t){void 0===t&&(t={});const n=new F(e,t.baseURL,t.encodingOverride,t.url,t.stateOverride);return n.failure?null:n.url},e.exports.setTheUsername=function(e,t){e.username=s(t,p)},e.exports.setThePassword=function(e,t){e.password=s(t,p)},e.exports.serializeHost=D,e.exports.cannotHaveAUsernamePasswordPort=function(e){return null===e.host||""===e.host||"file"===e.scheme},e.exports.hasAnOpaquePath=B,e.exports.serializeInteger=function(e){return String(e)},e.exports.parseURL=function(t,n){return void 0===n&&(n={}),e.exports.basicURLParse(t,{baseURL:n.baseURL,encodingOverride:n.encodingOverride})}}(cr)),cr.exports}function Xr(){if(Wr)return zr;Wr=1;const{utf8Encode:e,utf8DecodeWithoutBOM:t}=Yr(),{percentDecodeBytes:n,utf8PercentEncodeString:r,isURLEncodedPercentEncode:o}=Qr();function i(e){return e.codePointAt(0)}function s(e,t,n){let r=e.indexOf(t);for(;r>=0;)e[r]=n,r=e.indexOf(t,r+1);return e}return zr={parseUrlencodedString:function(r){return function(e){const r=function(e,t){const n=[];let r=0,o=e.indexOf(t);for(;o>=0;)n.push(e.slice(r,o)),r=o+1,o=e.indexOf(t,r);return r!==e.length&&n.push(e.slice(r)),n}(e,i("&")),o=[];for(const e of r){if(0===e.length)continue;let r,u;const a=e.indexOf(i("="));a>=0?(r=e.slice(0,a),u=e.slice(a+1)):(r=e,u=new Uint8Array(0)),r=s(r,43,32),u=s(u,43,32);const c=t(n(r)),l=t(n(u));o.push([c,l])}return o}(e(r))},serializeUrlencoded:function(e){let t="";for(const[n,i]of e.entries()){0!==n&&(t+="&"),t+=`${r(i[0],o,!0)}=${r(i[1],o,!0)}`}return t}},zr}cr.exports;var Zr,eo={},to={};var no,ro,oo,io,so,uo,ao={};function co(){return ro||(ro=1,function(e){const t=or(),n=ur(),r=function(){if(Zr)return to;Zr=1;const e=or(),t=ur();return to.convert=(n,r,{context:o="The provided value"}={})=>{if("function"!=typeof r)throw new n.TypeError(o+" is not a function");function i(...i){const s=t.tryWrapperForImpl(this);let u;for(let e=0;e<i.length;e++)i[e]=t.tryWrapperForImpl(i[e]);return u=Reflect.apply(r,s,i),u=e.any(u,{context:o,globals:n}),u}return i.construct=(...i)=>{for(let e=0;e<i.length;e++)i[e]=t.tryWrapperForImpl(i[e]);let s=Reflect.construct(r,i);return s=e.any(s,{context:o,globals:n}),s},i[t.wrapperSymbol]=r,i.objectReference=r,i},to}(),o=n.newObjectInRealm,i=n.implSymbol,s=n.ctorRegistrySymbol,u="URLSearchParams";function a(e,t){let r;return void 0!==t&&(r=t.prototype),n.isObject(r)||(r=e[s].URLSearchParams.prototype),Object.create(r)}e.is=e=>n.isObject(e)&&n.hasOwn(e,i)&&e[i]instanceof l.implementation,e.isImpl=e=>n.isObject(e)&&e instanceof l.implementation,e.convert=(t,r,{context:o="The provided value"}={})=>{if(e.is(r))return n.implForWrapper(r);throw new t.TypeError(`${o} is not of type 'URLSearchParams'.`)},e.createDefaultIterator=(e,t,r)=>{const o=e[s]["URLSearchParams Iterator"],i=Object.create(o);return Object.defineProperty(i,n.iterInternalSymbol,{value:{target:t,kind:r,index:0},configurable:!0}),i},e.create=(t,n,r)=>{const o=a(t);return e.setup(o,t,n,r)},e.createImpl=(t,r,o)=>{const i=e.create(t,r,o);return n.implForWrapper(i)},e._internalSetup=(e,t)=>{},e.setup=(t,r,o=[],s={})=>(s.wrapper=t,e._internalSetup(t,r),Object.defineProperty(t,i,{value:new l.implementation(r,o,s),configurable:!0}),t[i][n.wrapperSymbol]=t,l.init&&l.init(t[i]),t),e.new=(t,r)=>{const o=a(t,r);return e._internalSetup(o,t),Object.defineProperty(o,i,{value:Object.create(l.implementation.prototype),configurable:!0}),o[i][n.wrapperSymbol]=o,l.init&&l.init(o[i]),o[i]};const c=new Set(["Window","Worker"]);e.install=(s,a)=>{if(!a.some((e=>c.has(e))))return;const l=n.initCtorRegistry(s);class h{constructor(){const r=[];{let e=arguments[0];if(void 0!==e)if(n.isObject(e))if(void 0!==e[Symbol.iterator]){if(!n.isObject(e))throw new s.TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence is not an iterable object.");{const r=[],o=e;for(let e of o){if(!n.isObject(e))throw new s.TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence's element is not an iterable object.");{const n=[],r=e;for(let e of r)e=t.USVString(e,{context:"Failed to construct 'URLSearchParams': parameter 1 sequence's element's element",globals:s}),n.push(e);e=n}r.push(e)}e=r}}else{if(!n.isObject(e))throw new s.TypeError("Failed to construct 'URLSearchParams': parameter 1 record is not an object.");{const n=Object.create(null);for(const r of Reflect.ownKeys(e)){const o=Object.getOwnPropertyDescriptor(e,r);if(o&&o.enumerable){let o=r;o=t.USVString(o,{context:"Failed to construct 'URLSearchParams': parameter 1 record's key",globals:s});let i=e[r];i=t.USVString(i,{context:"Failed to construct 'URLSearchParams': parameter 1 record's value",globals:s}),n[o]=i}}e=n}}else e=t.USVString(e,{context:"Failed to construct 'URLSearchParams': parameter 1",globals:s});else e="";r.push(e)}return e.setup(Object.create(new.target.prototype),s,r)}append(r,o){const u=null!=this?this:s;if(!e.is(u))throw new s.TypeError("'append' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<2)throw new s.TypeError(`Failed to execute 'append' on 'URLSearchParams': 2 arguments required, but only ${arguments.length} present.`);const a=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'append' on 'URLSearchParams': parameter 1",globals:s}),a.push(e)}{let e=arguments[1];e=t.USVString(e,{context:"Failed to execute 'append' on 'URLSearchParams': parameter 2",globals:s}),a.push(e)}return n.tryWrapperForImpl(u[i].append(...a))}delete(r){const o=null!=this?this:s;if(!e.is(o))throw new s.TypeError("'delete' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<1)throw new s.TypeError(`Failed to execute 'delete' on 'URLSearchParams': 1 argument required, but only ${arguments.length} present.`);const u=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'delete' on 'URLSearchParams': parameter 1",globals:s}),u.push(e)}{let e=arguments[1];void 0!==e&&(e=t.USVString(e,{context:"Failed to execute 'delete' on 'URLSearchParams': parameter 2",globals:s})),u.push(e)}return n.tryWrapperForImpl(o[i].delete(...u))}get(n){const r=null!=this?this:s;if(!e.is(r))throw new s.TypeError("'get' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<1)throw new s.TypeError(`Failed to execute 'get' on 'URLSearchParams': 1 argument required, but only ${arguments.length} present.`);const o=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'get' on 'URLSearchParams': parameter 1",globals:s}),o.push(e)}return r[i].get(...o)}getAll(r){const o=null!=this?this:s;if(!e.is(o))throw new s.TypeError("'getAll' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<1)throw new s.TypeError(`Failed to execute 'getAll' on 'URLSearchParams': 1 argument required, but only ${arguments.length} present.`);const u=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'getAll' on 'URLSearchParams': parameter 1",globals:s}),u.push(e)}return n.tryWrapperForImpl(o[i].getAll(...u))}has(n){const r=null!=this?this:s;if(!e.is(r))throw new s.TypeError("'has' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<1)throw new s.TypeError(`Failed to execute 'has' on 'URLSearchParams': 1 argument required, but only ${arguments.length} present.`);const o=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'has' on 'URLSearchParams': parameter 1",globals:s}),o.push(e)}{let e=arguments[1];void 0!==e&&(e=t.USVString(e,{context:"Failed to execute 'has' on 'URLSearchParams': parameter 2",globals:s})),o.push(e)}return r[i].has(...o)}set(r,o){const u=null!=this?this:s;if(!e.is(u))throw new s.TypeError("'set' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<2)throw new s.TypeError(`Failed to execute 'set' on 'URLSearchParams': 2 arguments required, but only ${arguments.length} present.`);const a=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'set' on 'URLSearchParams': parameter 1",globals:s}),a.push(e)}{let e=arguments[1];e=t.USVString(e,{context:"Failed to execute 'set' on 'URLSearchParams': parameter 2",globals:s}),a.push(e)}return n.tryWrapperForImpl(u[i].set(...a))}sort(){const t=null!=this?this:s;if(!e.is(t))throw new s.TypeError("'sort' called on an object that is not a valid instance of URLSearchParams.");return n.tryWrapperForImpl(t[i].sort())}toString(){const t=null!=this?this:s;if(!e.is(t))throw new s.TypeError("'toString' called on an object that is not a valid instance of URLSearchParams.");return t[i].toString()}keys(){if(!e.is(this))throw new s.TypeError("'keys' called on an object that is not a valid instance of URLSearchParams.");return e.createDefaultIterator(s,this,"key")}values(){if(!e.is(this))throw new s.TypeError("'values' called on an object that is not a valid instance of URLSearchParams.");return e.createDefaultIterator(s,this,"value")}entries(){if(!e.is(this))throw new s.TypeError("'entries' called on an object that is not a valid instance of URLSearchParams.");return e.createDefaultIterator(s,this,"key+value")}forEach(t){if(!e.is(this))throw new s.TypeError("'forEach' called on an object that is not a valid instance of URLSearchParams.");if(arguments.length<1)throw new s.TypeError("Failed to execute 'forEach' on 'iterable': 1 argument required, but only 0 present.");t=r.convert(s,t,{context:"Failed to execute 'forEach' on 'iterable': The callback provided as parameter 1"});const o=arguments[1];let u=Array.from(this[i]),a=0;for(;a<u.length;){const[e,r]=u[a].map(n.tryWrapperForImpl);t.call(o,r,e,this),u=Array.from(this[i]),a++}}get size(){const t=null!=this?this:s;if(!e.is(t))throw new s.TypeError("'get size' called on an object that is not a valid instance of URLSearchParams.");return t[i].size}}Object.defineProperties(h.prototype,{append:{enumerable:!0},delete:{enumerable:!0},get:{enumerable:!0},getAll:{enumerable:!0},has:{enumerable:!0},set:{enumerable:!0},sort:{enumerable:!0},toString:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0},forEach:{enumerable:!0},size:{enumerable:!0},[Symbol.toStringTag]:{value:"URLSearchParams",configurable:!0},[Symbol.iterator]:{value:h.prototype.entries,configurable:!0,writable:!0}}),l[u]=h,l["URLSearchParams Iterator"]=Object.create(l["%IteratorPrototype%"],{[Symbol.toStringTag]:{configurable:!0,value:"URLSearchParams Iterator"}}),n.define(l["URLSearchParams Iterator"],{next(){const e=this&&this[n.iterInternalSymbol];if(!e)throw new s.TypeError("next() called on a value that is not a URLSearchParams iterator object");const{target:t,kind:r,index:u}=e,a=Array.from(t[i]);if(u>=a.length)return o(s,{value:void 0,done:!0});const c=a[u];return e.index=u+1,o(s,n.iteratorResult(c.map(n.tryWrapperForImpl),r))}}),Object.defineProperty(s,u,{configurable:!0,writable:!0,value:h})};const l=function(){if(no)return ao;no=1;const e=Xr();return ao.implementation=class{constructor(t,n,{doNotStripQMark:r=!1}){let o=n[0];if(this._list=[],this._url=null,r||"string"!=typeof o||"?"!==o[0]||(o=o.slice(1)),Array.isArray(o))for(const e of o){if(2!==e.length)throw new TypeError("Failed to construct 'URLSearchParams': parameter 1 sequence's element does not contain exactly two elements.");this._list.push([e[0],e[1]])}else if("object"==typeof o&&null===Object.getPrototypeOf(o))for(const e of Object.keys(o)){const t=o[e];this._list.push([e,t])}else this._list=e.parseUrlencodedString(o)}_updateSteps(){if(null!==this._url){let t=e.serializeUrlencoded(this._list);""===t&&(t=null),this._url._url.query=t}}get size(){return this._list.length}append(e,t){this._list.push([e,t]),this._updateSteps()}delete(e,t){let n=0;for(;n<this._list.length;)this._list[n][0]!==e||void 0!==t&&this._list[n][1]!==t?n++:this._list.splice(n,1);this._updateSteps()}get(e){for(const t of this._list)if(t[0]===e)return t[1];return null}getAll(e){const t=[];for(const n of this._list)n[0]===e&&t.push(n[1]);return t}has(e,t){for(const n of this._list)if(n[0]===e&&(void 0===t||n[1]===t))return!0;return!1}set(e,t){let n=!1,r=0;for(;r<this._list.length;)this._list[r][0]===e?n?this._list.splice(r,1):(n=!0,this._list[r][1]=t,r++):r++;n||this._list.push([e,t]),this._updateSteps()}sort(){this._list.sort(((e,t)=>e[0]<t[0]?-1:e[0]>t[0]?1:0)),this._updateSteps()}[Symbol.iterator](){return this._list[Symbol.iterator]()}toString(){return e.serializeUrlencoded(this._list)}},ao}()}(eo)),eo}function lo(){return io||(io=1,function(e){const t=or(),n=ur(),r=n.implSymbol,o=n.ctorRegistrySymbol;function i(e,t){let r;return void 0!==t&&(r=t.prototype),n.isObject(r)||(r=e[o].URL.prototype),Object.create(r)}e.is=e=>n.isObject(e)&&n.hasOwn(e,r)&&e[r]instanceof u.implementation,e.isImpl=e=>n.isObject(e)&&e instanceof u.implementation,e.convert=(t,r,{context:o="The provided value"}={})=>{if(e.is(r))return n.implForWrapper(r);throw new t.TypeError(`${o} is not of type 'URL'.`)},e.create=(t,n,r)=>{const o=i(t);return e.setup(o,t,n,r)},e.createImpl=(t,r,o)=>{const i=e.create(t,r,o);return n.implForWrapper(i)},e._internalSetup=(e,t)=>{},e.setup=(t,o,i=[],s={})=>(s.wrapper=t,e._internalSetup(t,o),Object.defineProperty(t,r,{value:new u.implementation(o,i,s),configurable:!0}),t[r][n.wrapperSymbol]=t,u.init&&u.init(t[r]),t),e.new=(t,o)=>{const s=i(t,o);return e._internalSetup(s,t),Object.defineProperty(s,r,{value:Object.create(u.implementation.prototype),configurable:!0}),s[r][n.wrapperSymbol]=s,u.init&&u.init(s[r]),s[r]};const s=new Set(["Window","Worker"]);e.install=(o,i)=>{if(!i.some((e=>s.has(e))))return;const a=n.initCtorRegistry(o);class c{constructor(n){if(arguments.length<1)throw new o.TypeError(`Failed to construct 'URL': 1 argument required, but only ${arguments.length} present.`);const r=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to construct 'URL': parameter 1",globals:o}),r.push(e)}{let e=arguments[1];void 0!==e&&(e=t.USVString(e,{context:"Failed to construct 'URL': parameter 2",globals:o})),r.push(e)}return e.setup(Object.create(new.target.prototype),o,r)}toJSON(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'toJSON' called on an object that is not a valid instance of URL.");return t[r].toJSON()}get href(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get href' called on an object that is not a valid instance of URL.");return t[r].href}set href(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set href' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'href' property on 'URL': The provided value",globals:o}),i[r].href=n}toString(){if(!e.is(this))throw new o.TypeError("'toString' called on an object that is not a valid instance of URL.");return this[r].href}get origin(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get origin' called on an object that is not a valid instance of URL.");return t[r].origin}get protocol(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get protocol' called on an object that is not a valid instance of URL.");return t[r].protocol}set protocol(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set protocol' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'protocol' property on 'URL': The provided value",globals:o}),i[r].protocol=n}get username(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get username' called on an object that is not a valid instance of URL.");return t[r].username}set username(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set username' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'username' property on 'URL': The provided value",globals:o}),i[r].username=n}get password(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get password' called on an object that is not a valid instance of URL.");return t[r].password}set password(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set password' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'password' property on 'URL': The provided value",globals:o}),i[r].password=n}get host(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get host' called on an object that is not a valid instance of URL.");return t[r].host}set host(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set host' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'host' property on 'URL': The provided value",globals:o}),i[r].host=n}get hostname(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get hostname' called on an object that is not a valid instance of URL.");return t[r].hostname}set hostname(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set hostname' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'hostname' property on 'URL': The provided value",globals:o}),i[r].hostname=n}get port(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get port' called on an object that is not a valid instance of URL.");return t[r].port}set port(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set port' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'port' property on 'URL': The provided value",globals:o}),i[r].port=n}get pathname(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get pathname' called on an object that is not a valid instance of URL.");return t[r].pathname}set pathname(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set pathname' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'pathname' property on 'URL': The provided value",globals:o}),i[r].pathname=n}get search(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get search' called on an object that is not a valid instance of URL.");return t[r].search}set search(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set search' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'search' property on 'URL': The provided value",globals:o}),i[r].search=n}get searchParams(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get searchParams' called on an object that is not a valid instance of URL.");return n.getSameObject(this,"searchParams",(()=>n.tryWrapperForImpl(t[r].searchParams)))}get hash(){const t=null!=this?this:o;if(!e.is(t))throw new o.TypeError("'get hash' called on an object that is not a valid instance of URL.");return t[r].hash}set hash(n){const i=null!=this?this:o;if(!e.is(i))throw new o.TypeError("'set hash' called on an object that is not a valid instance of URL.");n=t.USVString(n,{context:"Failed to set the 'hash' property on 'URL': The provided value",globals:o}),i[r].hash=n}static parse(e){if(arguments.length<1)throw new o.TypeError(`Failed to execute 'parse' on 'URL': 1 argument required, but only ${arguments.length} present.`);const r=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'parse' on 'URL': parameter 1",globals:o}),r.push(e)}{let e=arguments[1];void 0!==e&&(e=t.USVString(e,{context:"Failed to execute 'parse' on 'URL': parameter 2",globals:o})),r.push(e)}return n.tryWrapperForImpl(u.implementation.parse(o,...r))}static canParse(e){if(arguments.length<1)throw new o.TypeError(`Failed to execute 'canParse' on 'URL': 1 argument required, but only ${arguments.length} present.`);const n=[];{let e=arguments[0];e=t.USVString(e,{context:"Failed to execute 'canParse' on 'URL': parameter 1",globals:o}),n.push(e)}{let e=arguments[1];void 0!==e&&(e=t.USVString(e,{context:"Failed to execute 'canParse' on 'URL': parameter 2",globals:o})),n.push(e)}return u.implementation.canParse(...n)}}Object.defineProperties(c.prototype,{toJSON:{enumerable:!0},href:{enumerable:!0},toString:{enumerable:!0},origin:{enumerable:!0},protocol:{enumerable:!0},username:{enumerable:!0},password:{enumerable:!0},host:{enumerable:!0},hostname:{enumerable:!0},port:{enumerable:!0},pathname:{enumerable:!0},search:{enumerable:!0},searchParams:{enumerable:!0},hash:{enumerable:!0},[Symbol.toStringTag]:{value:"URL",configurable:!0}}),Object.defineProperties(c,{parse:{enumerable:!0},canParse:{enumerable:!0}}),a.URL=c,Object.defineProperty(o,"URL",{configurable:!0,writable:!0,value:c}),i.includes("Window")&&Object.defineProperty(o,"webkitURL",{configurable:!0,writable:!0,value:c})};const u=function(){if(oo)return ar;oo=1;const e=Jr(),t=Xr(),n=co();return ar.implementation=class r{constructor(t,[r,o]){let i=null;if(void 0!==o&&(i=e.basicURLParse(o),null===i))throw new TypeError(`Invalid base URL: ${o}`);const s=e.basicURLParse(r,{baseURL:i});if(null===s)throw new TypeError(`Invalid URL: ${r}`);const u=null!==s.query?s.query:"";this._url=s,this._query=n.createImpl(t,[u],{doNotStripQMark:!0}),this._query._url=this}static parse(e,t,n){try{return new r(e,[t,n])}catch{return null}}static canParse(t,n){let r=null;return(void 0===n||(r=e.basicURLParse(n),null!==r))&&null!==e.basicURLParse(t,{baseURL:r})}get href(){return e.serializeURL(this._url)}set href(n){const r=e.basicURLParse(n);if(null===r)throw new TypeError(`Invalid URL: ${n}`);this._url=r,this._query._list.splice(0);const{query:o}=r;null!==o&&(this._query._list=t.parseUrlencodedString(o))}get origin(){return e.serializeURLOrigin(this._url)}get protocol(){return`${this._url.scheme}:`}set protocol(t){e.basicURLParse(`${t}:`,{url:this._url,stateOverride:"scheme start"})}get username(){return this._url.username}set username(t){e.cannotHaveAUsernamePasswordPort(this._url)||e.setTheUsername(this._url,t)}get password(){return this._url.password}set password(t){e.cannotHaveAUsernamePasswordPort(this._url)||e.setThePassword(this._url,t)}get host(){const t=this._url;return null===t.host?"":null===t.port?e.serializeHost(t.host):`${e.serializeHost(t.host)}:${e.serializeInteger(t.port)}`}set host(t){e.hasAnOpaquePath(this._url)||e.basicURLParse(t,{url:this._url,stateOverride:"host"})}get hostname(){return null===this._url.host?"":e.serializeHost(this._url.host)}set hostname(t){e.hasAnOpaquePath(this._url)||e.basicURLParse(t,{url:this._url,stateOverride:"hostname"})}get port(){return null===this._url.port?"":e.serializeInteger(this._url.port)}set port(t){e.cannotHaveAUsernamePasswordPort(this._url)||(""===t?this._url.port=null:e.basicURLParse(t,{url:this._url,stateOverride:"port"}))}get pathname(){return e.serializePath(this._url)}set pathname(t){e.hasAnOpaquePath(this._url)||(this._url.path=[],e.basicURLParse(t,{url:this._url,stateOverride:"path start"}))}get search(){return null===this._url.query||""===this._url.query?"":`?${this._url.query}`}set search(n){const r=this._url;if(""===n)return r.query=null,void(this._query._list=[]);const o="?"===n[0]?n.substring(1):n;r.query="",e.basicURLParse(o,{url:r,stateOverride:"query"}),this._query._list=t.parseUrlencodedString(o)}get searchParams(){return this._query}get hash(){return null===this._url.fragment||""===this._url.fragment?"":`#${this._url.fragment}`}set hash(t){if(""===t)return void(this._url.fragment=null);const n="#"===t[0]?t.substring(1):t;this._url.fragment="",e.basicURLParse(n,{url:this._url,stateOverride:"fragment"})}toJSON(){return this.href}},ar}()}(nr)),nr}function ho(){if(uo)return er;uo=1;const{URL:e,URLSearchParams:t}=function(){if(so)return tr;so=1;const e=lo(),t=co();return tr.URL=e,tr.URLSearchParams=t,tr}(),n=Jr(),r=Qr(),o={Array:Array,Object:Object,Promise:Promise,String:String,TypeError:TypeError};return e.install(o,["Window"]),t.install(o,["Window"]),er.URL=o.URL,er.URLSearchParams=o.URLSearchParams,er.parseURL=n.parseURL,er.basicURLParse=n.basicURLParse,er.serializeURL=n.serializeURL,er.serializePath=n.serializePath,er.serializeHost=n.serializeHost,er.serializeInteger=n.serializeInteger,er.serializeURLOrigin=n.serializeURLOrigin,er.setTheUsername=n.setTheUsername,er.setThePassword=n.setThePassword,er.cannotHaveAUsernamePasswordPort=n.cannotHaveAUsernamePasswordPort,er.hasAnOpaquePath=n.hasAnOpaquePath,er.percentDecodeString=r.percentDecodeString,er.percentDecodeBytes=r.percentDecodeBytes,er}var po,fo,mo={};function yo(){return fo||(fo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CommaAndColonSeparatedRecord=e.ConnectionString=e.redactConnectionString=void 0;const t=ho(),n=function(){if(po)return mo;po=1;var e=mo&&mo.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),t=mo&&mo.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=mo&&mo.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var o in n)"default"!==o&&Object.prototype.hasOwnProperty.call(n,o)&&e(r,n,o);return t(r,n),r};Object.defineProperty(mo,"__esModule",{value:!0}),mo.redactConnectionString=mo.redactValidConnectionString=void 0;const r=n(yo());return mo.redactValidConnectionString=function(e,t){var n,o;const i=e.clone(),s=null!==(n=null==t?void 0:t.replacementString)&&void 0!==n?n:"_credentials_",u=null===(o=null==t?void 0:t.redactUsernames)||void 0===o||o;if((i.username||i.password)&&u?(i.username=s,i.password=""):i.password&&(i.password=s),i.searchParams.has("authMechanismProperties")){const e=new r.CommaAndColonSeparatedRecord(i.searchParams.get("authMechanismProperties"));e.get("AWS_SESSION_TOKEN")&&(e.set("AWS_SESSION_TOKEN",s),i.searchParams.set("authMechanismProperties",e.toString()))}return i.searchParams.has("tlsCertificateKeyFilePassword")&&i.searchParams.set("tlsCertificateKeyFilePassword",s),i.searchParams.has("proxyUsername")&&u&&i.searchParams.set("proxyUsername",s),i.searchParams.has("proxyPassword")&&i.searchParams.set("proxyPassword",s),i},mo.redactConnectionString=function(e,t){var n,o;const i=null!==(n=null==t?void 0:t.replacementString)&&void 0!==n?n:"<credentials>",s=null===(o=null==t?void 0:t.redactUsernames)||void 0===o||o;let u;try{u=new r.default(e)}catch(e){}if(u)return t={...t,replacementString:"___credentials___"},u.redact(t).toString().replace(/___credentials___/g,i);const a=i,c=[e=>e.replace(s?/(\/\/)(.*)(@)/g:/(\/\/[^@]*:)(.*)(@)/g,`$1${a}$3`),e=>e.replace(/(AWS_SESSION_TOKEN(:|%3A))([^,&]+)/gi,`$1${a}`),e=>e.replace(/(tlsCertificateKeyFilePassword=)([^&]+)/gi,`$1${a}`),e=>s?e.replace(/(proxyUsername=)([^&]+)/gi,`$1${a}`):e,e=>e.replace(/(proxyPassword=)([^&]+)/gi,`$1${a}`)];for(const t of c)e=t(e);return e},mo}();Object.defineProperty(e,"redactConnectionString",{enumerable:!0,get:function(){return n.redactConnectionString}});const r="__this_is_a_placeholder__";const o=/^(?<protocol>[^/]+):\/\/(?:(?<username>[^:@]*)(?::(?<password>[^@]*))?@)?(?<hosts>(?!:)[^/?@]*)(?<rest>.*)/;class i extends Map{delete(e){return super.delete(this._normalizeKey(e))}get(e){return super.get(this._normalizeKey(e))}has(e){return super.has(this._normalizeKey(e))}set(e,t){return super.set(this._normalizeKey(e),t)}_normalizeKey(e){e=`${e}`;for(const t of this.keys())if(t.toLowerCase()===e.toLowerCase()){e=t;break}return e}}class s extends t.URL{}class u extends Error{get name(){return"MongoParseError"}}class a extends s{constructor(e,t={}){var n;const{looseValidation:s}=t;if(!s&&(!(c=e).startsWith("mongodb://")&&!c.startsWith("mongodb+srv://")))throw new u('Invalid scheme, expected connection string to start with "mongodb://" or "mongodb+srv://"');var c;const l=e.match(o);if(!l)throw new u(`Invalid connection string "${e}"`);const{protocol:h,username:p,password:d,hosts:f,rest:m}=null!==(n=l.groups)&&void 0!==n?n:{};if(!s){if(!h||!f)throw new u(`Protocol and host list are required in "${e}"`);try{decodeURIComponent(null!=p?p:""),decodeURIComponent(null!=d?d:"")}catch(e){throw new u(e.message)}const t=/[:/?#[\]@]/gi;if(null==p?void 0:p.match(t))throw new u(`Username contains unescaped characters ${p}`);if(!p||!d){const t=e.replace(`${h}://`,"");if(t.startsWith("@")||t.startsWith(":"))throw new u("URI contained empty userinfo section")}if(null==d?void 0:d.match(t))throw new u("Password contains unescaped characters")}let y="";"string"==typeof p&&(y+=p),"string"==typeof d&&(y+=`:${d}`),y&&(y+="@");try{super(`${h.toLowerCase()}://${y}${r}${m}`)}catch(n){throw s&&new a(e,{...t,looseValidation:!1}),"string"==typeof n.message&&(n.message=n.message.replace(r,f)),n}if(this._hosts=f.split(","),!s){if(this.isSRV&&1!==this.hosts.length)throw new u("mongodb+srv URI cannot have multiple service names");if(this.isSRV&&this.hosts.some((e=>e.includes(":"))))throw new u("mongodb+srv URI cannot have port number")}var g;this.pathname||(this.pathname="/"),Object.setPrototypeOf(this.searchParams,(g=this.searchParams.constructor,class extends g{append(e,t){return super.append(this._normalizeKey(e),t)}delete(e){return super.delete(this._normalizeKey(e))}get(e){return super.get(this._normalizeKey(e))}getAll(e){return super.getAll(this._normalizeKey(e))}has(e){return super.has(this._normalizeKey(e))}set(e,t){return super.set(this._normalizeKey(e),t)}keys(){return super.keys()}values(){return super.values()}entries(){return super.entries()}[Symbol.iterator](){return super[Symbol.iterator]()}_normalizeKey(e){return i.prototype._normalizeKey.call(this,e)}}).prototype)}get host(){return r}set host(e){throw new Error("No single host for connection string")}get hostname(){return r}set hostname(e){throw new Error("No single host for connection string")}get port(){return""}set port(e){throw new Error("No single host for connection string")}get href(){return this.toString()}set href(e){throw new Error("Cannot set href for connection strings")}get isSRV(){return this.protocol.includes("srv")}get hosts(){return this._hosts}set hosts(e){this._hosts=e}toString(){return super.toString().replace(r,this.hosts.join(","))}clone(){return new a(this.toString(),{looseValidation:!0})}redact(e){return(0,n.redactValidConnectionString)(this,e)}typedSearchParams(){return this.searchParams}[Symbol.for("nodejs.util.inspect.custom")](){const{href:e,origin:t,protocol:n,username:r,password:o,hosts:i,pathname:s,search:u,searchParams:a,hash:c}=this;return{href:e,origin:t,protocol:n,username:r,password:o,hosts:i,pathname:s,search:u,searchParams:a,hash:c}}}e.ConnectionString=a;e.CommaAndColonSeparatedRecord=class extends i{constructor(e){super();for(const t of(null!=e?e:"").split(",")){if(!t)continue;const e=t.indexOf(":");-1===e?this.set(t,""):this.set(t.slice(0,e),t.slice(e+1))}}toString(){return[...this].map((e=>e.join(":"))).join(",")}},e.default=a}(Zn)),Zn}var go,Eo={},Ao={name:"mongodb",version:"6.15.0",description:"The official MongoDB driver for Node.js",main:"lib/index.js",files:["lib","src","etc/prepare.js","mongodb.d.ts","tsconfig.json"],types:"mongodb.d.ts",repository:{type:"git",url:"git@github.com:mongodb/node-mongodb-native.git"},keywords:["mongodb","driver","official"],author:{name:"The MongoDB NodeJS Team",email:"dbx-node@mongodb.com"},dependencies:{"@mongodb-js/saslprep":"^1.1.9",bson:"^6.10.3","mongodb-connection-string-url":"^3.0.0"},peerDependencies:{"@aws-sdk/credential-providers":"^3.188.0","@mongodb-js/zstd":"^1.1.0 || ^2.0.0","gcp-metadata":"^5.2.0",kerberos:"^2.0.1","mongodb-client-encryption":">=6.0.0 <7",snappy:"^7.2.2",socks:"^2.7.1"},peerDependenciesMeta:{"@aws-sdk/credential-providers":{optional:!0},"@mongodb-js/zstd":{optional:!0},kerberos:{optional:!0},snappy:{optional:!0},"mongodb-client-encryption":{optional:!0},"gcp-metadata":{optional:!0},socks:{optional:!0}},devDependencies:{"@aws-sdk/credential-providers":"^3.632.0","@iarna/toml":"^2.2.5","@istanbuljs/nyc-config-typescript":"^1.0.2","@microsoft/api-extractor":"^7.49.2","@microsoft/tsdoc-config":"^0.17.1","@mongodb-js/zstd":"^2.0.0","@types/chai":"^4.3.17","@types/chai-subset":"^1.3.5","@types/express":"^4.17.21","@types/kerberos":"^1.1.5","@types/mocha":"^10.0.9","@types/node":"^22.13.0","@types/saslprep":"^1.0.3","@types/semver":"^7.5.8","@types/sinon":"^17.0.3","@types/sinon-chai":"^3.2.12","@types/whatwg-url":"^11.0.5","@typescript-eslint/eslint-plugin":"8.4.0","@typescript-eslint/parser":"8.4.0",chai:"^4.4.1","chai-subset":"^1.6.0",chalk:"^4.1.2",eslint:"9.9.0","eslint-config-prettier":"^9.1.0","eslint-plugin-mocha":"^10.4.1","eslint-plugin-prettier":"^5.2.3","eslint-plugin-simple-import-sort":"^12.1.1","eslint-plugin-tsdoc":"^0.4.0","eslint-plugin-unused-imports":"^4.1.4",express:"^4.21.2","gcp-metadata":"^5.3.0","js-yaml":"^4.1.0",mocha:"^10.8.2","mocha-sinon":"^2.1.2","mongodb-client-encryption":"^6.3.0","mongodb-legacy":"^6.1.3",nyc:"^15.1.0",prettier:"^3.4.2",semver:"^7.7.0",sinon:"^18.0.0","sinon-chai":"^3.7.0",snappy:"^7.2.2",socks:"^2.8.1","source-map-support":"^0.5.21","ts-node":"^10.9.2",tsd:"^0.31.2",typescript:"5.5","typescript-cached-transpile":"^0.0.6","v8-heapsnapshot":"^1.3.1",yargs:"^17.7.2"},license:"Apache-2.0",engines:{node:">=16.20.1"},bugs:{url:"https://jira.mongodb.org/projects/NODE/issues/"},homepage:"https://github.com/mongodb/node-mongodb-native",scripts:{"build:evergreen":"node .evergreen/generate_evergreen_tasks.js","build:ts":"node ./node_modules/typescript/bin/tsc","build:dts":"npm run build:ts && api-extractor run && node etc/clean_definition_files.cjs && ESLINT_USE_FLAT_CONFIG=false eslint --no-ignore --fix mongodb.d.ts lib/beta.d.ts","build:docs":"./etc/docs/build.ts","build:typedoc":"typedoc","build:nightly":"node ./.github/scripts/nightly.mjs","check:bench":"npm --prefix test/benchmarks/driver_bench start","check:coverage":"nyc npm run test:all","check:integration-coverage":"nyc npm run check:test","check:lambda":"mocha --config test/mocha_lambda.js test/integration/node-specific/examples/handler.test.js","check:lambda:aws":"mocha --config test/mocha_lambda.js test/integration/node-specific/examples/aws_handler.test.js","check:lint":"npm run build:dts && npm run check:dts && npm run check:eslint && npm run check:tsd","check:eslint":"npm run build:dts && ESLINT_USE_FLAT_CONFIG=false eslint -v && ESLINT_USE_FLAT_CONFIG=false eslint --max-warnings=0 --ext '.js,.ts' src test","check:tsd":"tsd --version && tsd","check:dependencies":"mocha test/action/dependency.test.ts","check:dts":"node ./node_modules/typescript/bin/tsc --noEmit mongodb.d.ts && tsd","check:search-indexes":"nyc mocha --config test/mocha_mongodb.js test/manual/search-index-management.prose.test.ts","check:test":"mocha --config test/mocha_mongodb.js test/integration","check:unit":"mocha test/unit","check:ts":"node ./node_modules/typescript/bin/tsc -v && node ./node_modules/typescript/bin/tsc --noEmit","check:atlas":"mocha --config test/manual/mocharc.js test/manual/atlas_connectivity.test.ts","check:resource-management":"mocha --config test/manual/mocharc.js test/manual/resource_management.test.ts","check:drivers-atlas-testing":"mocha --config test/mocha_mongodb.js test/atlas/drivers_atlas_testing.test.ts","check:adl":"mocha --config test/mocha_mongodb.js test/manual/atlas-data-lake-testing","check:aws":"nyc mocha --config test/mocha_mongodb.js test/integration/auth/mongodb_aws.test.ts","check:oidc-auth":"mocha --config test/mocha_mongodb.js test/integration/auth/auth.spec.test.ts","check:oidc-test":"mocha --config test/mocha_mongodb.js test/integration/auth/mongodb_oidc.prose.test.ts","check:oidc-azure":"mocha --config test/mocha_mongodb.js test/integration/auth/mongodb_oidc_azure.prose.05.test.ts","check:oidc-gcp":"mocha --config test/mocha_mongodb.js test/integration/auth/mongodb_oidc_gcp.prose.06.test.ts","check:oidc-k8s":"mocha --config test/mocha_mongodb.js test/integration/auth/mongodb_oidc_k8s.prose.07.test.ts","check:kerberos":"nyc mocha --config test/manual/mocharc.js test/manual/kerberos.test.ts","check:tls":"mocha --config test/manual/mocharc.js test/manual/tls_support.test.ts","check:ldap":"nyc mocha --config test/manual/mocharc.js test/manual/ldap.test.ts","check:socks5":"mocha --config test/manual/mocharc.js test/manual/socks5.test.ts","check:csfle":"mocha --config test/mocha_mongodb.js test/integration/client-side-encryption","check:snappy":"mocha test/unit/assorted/snappy.test.js","check:x509":"mocha test/manual/x509_auth.test.ts","fix:eslint":"npm run check:eslint -- --fix",prepare:"node etc/prepare.js","preview:docs":"ts-node etc/docs/preview.ts",test:"npm run check:lint && npm run test:all","test:all":"npm run check:unit && npm run check:test","update:docs":"npm run build:docs -- --yes"},tsd:{directory:"test/types",compilerOptions:{strict:!0,target:"esnext",module:"commonjs",moduleResolution:"node"}}};function bo(){if(go)return Eo;go=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.LimitedSizeDocument=void 0,Eo.makeClientMetadata=function(n){const o=new s(512),{appName:u=""}=n;if(u.length>0){const e=Buffer.byteLength(u,"utf8")<=128?n.appName:Buffer.from(u,"utf8").subarray(0,128).toString("utf8");o.ifItFitsItSits("application",{name:e})}const{name:c="",version:l="",platform:h=""}=n.driverInfo,p={name:c.length>0?`nodejs|${c}`:"nodejs",version:l.length>0?`${i}|${l}`:i};if(!o.ifItFitsItSits("driver",p))throw new r.MongoInvalidArgumentError("Unable to include driverInfo name and version, metadata cannot exceed 512 bytes");let d=function(){if("Deno"in globalThis){return`Deno v${"string"==typeof Deno?.version?.deno?Deno?.version?.deno:"0.0.0-unknown"}, ${e.endianness()}`}if("Bun"in globalThis){return`Bun v${"string"==typeof Bun?.version?Bun?.version:"0.0.0-unknown"}, ${e.endianness()}`}return`Node.js ${t.version}, ${e.endianness()}`}();h.length>0&&(d=`${d}|${h}`);if(!o.ifItFitsItSits("platform",d))throw new r.MongoInvalidArgumentError("Unable to include driverInfo platform, metadata cannot exceed 512 bytes");const f=(new Map).set("name",t.platform).set("architecture",t.arch).set("version",e.release()).set("type",e.type());if(!o.ifItFitsItSits("os",f))for(const e of f.keys()){if(f.delete(e),0===f.size)break;if(o.ifItFitsItSits("os",f))break}const m=a();if(null!=m&&!o.ifItFitsItSits("env",m))for(const e of m.keys()){if(m.delete(e),0===m.size)break;if(o.ifItFitsItSits("env",m))break}return o.toObject()},Eo.addContainerMetadata=async function(e){const n=await async function(){const e={};u??=(0,o.fileIsAccessible)("/.dockerenv");const n=await u,{KUBERNETES_SERVICE_HOST:r=""}=t.env,i=r.length>0;n&&(e.runtime="docker");i&&(e.orchestrator="kubernetes");return e}();if(0===Object.keys(n).length)return e;const r=new s(512),i={...e?.env,container:n};for(const[t,n]of Object.entries(e))"env"!==t?r.ifItFitsItSits(t,n):r.ifItFitsItSits("env",i)||r.ifItFitsItSits("env",n);"env"in e||r.ifItFitsItSits("env",i);return r.toObject()},Eo.getFAASEnv=a;const e=c,t=l,n=F(),r=P(),o=fe(),i=Ao.version;class s{constructor(e){this.maxSize=e,this.document=new Map,this.documentSize=5}ifItFitsItSits(e,t){const r=n.BSON.serialize((new Map).set(e,t)).byteLength-5;return!(r+this.documentSize>this.maxSize)&&(this.documentSize+=r,this.document.set(e,t),!0)}toObject(){return n.BSON.deserialize(n.BSON.serialize(this.document),{promoteLongs:!1,promoteBuffers:!1,promoteValues:!1,useBigInt64:!1})}}let u;function a(){const{AWS_EXECUTION_ENV:e="",AWS_LAMBDA_RUNTIME_API:r="",FUNCTIONS_WORKER_RUNTIME:o="",K_SERVICE:i="",FUNCTION_NAME:s="",VERCEL:u="",AWS_LAMBDA_FUNCTION_MEMORY_SIZE:a="",AWS_REGION:c="",FUNCTION_MEMORY_MB:l="",FUNCTION_REGION:h="",FUNCTION_TIMEOUT_SEC:p="",VERCEL_REGION:d=""}=t.env,f=e.startsWith("AWS_Lambda_")||r.length>0,m=o.length>0,y=i.length>0||s.length>0,g=u.length>0,E=new Map;return!g||m||y?f&&!(m||y||g)?(c.length>0&&E.set("region",c),a.length>0&&Number.isInteger(+a)&&E.set("memory_mb",new n.Int32(a)),E.set("name","aws.lambda"),E):m&&!(y||f||g)?(E.set("name","azure.func"),E):y&&!(m||f||g)?(h.length>0&&E.set("region",h),l.length>0&&Number.isInteger(+l)&&E.set("memory_mb",new n.Int32(l)),p.length>0&&Number.isInteger(+p)&&E.set("timeout_sec",new n.Int32(p)),E.set("name","gcp.func"),E):null:(d.length>0&&E.set("region",d),E.set("name","vercel"),E)}return Eo.LimitedSizeDocument=s,Eo}var _o,Oo,Co={},wo={};function So(){if(_o)return wo;_o=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.OpCompressedRequest=wo.OpMsgResponse=wo.OpMsgRequest=wo.DocumentSequence=wo.OpReply=wo.OpQueryRequest=void 0;const e=F(),t=P(),n=vo(),r=H();let o=0;const i=e.BSON.onDemand.ByteUtils.encodeUTF8Into;class s{constructor(e,n,r){this.databaseName=e,this.query=n,this.moreToCome=!1;const o=`${e}.$cmd`;if("string"!=typeof e)throw new t.MongoRuntimeError("Database name must be a string for a query");if(null==n)throw new t.MongoRuntimeError("A query document must be specified for query");if(-1!==o.indexOf("\0"))throw new t.MongoRuntimeError("Namespace cannot contain a null character");this.ns=o,this.numberToSkip=r.numberToSkip||0,this.numberToReturn=r.numberToReturn||0,this.returnFieldSelector=r.returnFieldSelector||void 0,this.requestId=r.requestId??s.getRequestId(),this.pre32Limit=r.pre32Limit,this.serializeFunctions="boolean"==typeof r.serializeFunctions&&r.serializeFunctions,this.ignoreUndefined="boolean"==typeof r.ignoreUndefined&&r.ignoreUndefined,this.maxBsonSize=r.maxBsonSize||16777216,this.checkKeys="boolean"==typeof r.checkKeys&&r.checkKeys,this.batchSize=this.numberToReturn,this.tailable=!1,this.secondaryOk="boolean"==typeof r.secondaryOk&&r.secondaryOk,this.oplogReplay=!1,this.noCursorTimeout=!1,this.awaitData=!1,this.exhaust=!1,this.partial=!1}incRequestId(){this.requestId=o++}nextRequestId(){return o+1}static getRequestId(){return++o}toBin(){const t=[];let n=null,o=0;this.tailable&&(o|=2),this.secondaryOk&&(o|=4),this.oplogReplay&&(o|=8),this.noCursorTimeout&&(o|=16),this.awaitData&&(o|=32),this.exhaust&&(o|=64),this.partial&&(o|=128),this.batchSize!==this.numberToReturn&&(this.numberToReturn=this.batchSize);const i=Buffer.alloc(20+Buffer.byteLength(this.ns)+1+4+4);t.push(i);const s=e.serialize(this.query,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined});t.push(s),this.returnFieldSelector&&Object.keys(this.returnFieldSelector).length>0&&(n=e.serialize(this.returnFieldSelector,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined}),t.push(n));const u=i.length+s.length+(n?n.length:0);let a=4;return i[3]=u>>24&255,i[2]=u>>16&255,i[1]=u>>8&255,i[0]=255&u,i[a+3]=this.requestId>>24&255,i[a+2]=this.requestId>>16&255,i[a+1]=this.requestId>>8&255,i[a]=255&this.requestId,a+=4,i[a+3]=0,i[a+2]=0,i[a+1]=0,i[a]=0,a+=4,i[a+3]=r.OP_QUERY>>24&255,i[a+2]=r.OP_QUERY>>16&255,i[a+1]=r.OP_QUERY>>8&255,i[a]=255&r.OP_QUERY,a+=4,i[a+3]=o>>24&255,i[a+2]=o>>16&255,i[a+1]=o>>8&255,i[a]=255&o,a+=4,a=a+i.write(this.ns,a,"utf8")+1,i[a-1]=0,i[a+3]=this.numberToSkip>>24&255,i[a+2]=this.numberToSkip>>16&255,i[a+1]=this.numberToSkip>>8&255,i[a]=255&this.numberToSkip,a+=4,i[a+3]=this.numberToReturn>>24&255,i[a+2]=this.numberToReturn>>16&255,i[a+1]=this.numberToReturn>>8&255,i[a]=255&this.numberToReturn,a+=4,t}}wo.OpQueryRequest=s;wo.OpReply=class{constructor(e,t,n,r){this.index=0,this.sections=[],this.moreToCome=!1,this.parsed=!1,this.raw=e,this.data=n,this.opts=r??{useBigInt64:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!1,bsonRegExp:!1},this.length=t.length,this.requestId=t.requestId,this.responseTo=t.responseTo,this.opCode=t.opCode,this.fromCompressed=t.fromCompressed,this.useBigInt64="boolean"==typeof this.opts.useBigInt64&&this.opts.useBigInt64,this.promoteLongs="boolean"!=typeof this.opts.promoteLongs||this.opts.promoteLongs,this.promoteValues="boolean"!=typeof this.opts.promoteValues||this.opts.promoteValues,this.promoteBuffers="boolean"==typeof this.opts.promoteBuffers&&this.opts.promoteBuffers,this.bsonRegExp="boolean"==typeof this.opts.bsonRegExp&&this.opts.bsonRegExp}isParsed(){return this.parsed}parse(){if(this.parsed)return this.sections[0];if(this.index=20,this.responseFlags=this.data.readInt32LE(0),this.cursorId=new e.Long(this.data.readInt32LE(4),this.data.readInt32LE(8)),this.startingFrom=this.data.readInt32LE(12),this.numberReturned=this.data.readInt32LE(16),this.numberReturned<0||this.numberReturned>2**32-1)throw new RangeError(`OP_REPLY numberReturned is an invalid array length ${this.numberReturned}`);this.cursorNotFound=!!(1&this.responseFlags),this.queryFailure=!!(2&this.responseFlags),this.shardConfigStale=!!(4&this.responseFlags),this.awaitCapable=!!(8&this.responseFlags);for(let e=0;e<this.numberReturned;e++){const e=this.data[this.index]|this.data[this.index+1]<<8|this.data[this.index+2]<<16|this.data[this.index+3]<<24,t=this.data.subarray(this.index,this.index+e);this.sections.push(t),this.index=this.index+e}return this.parsed=!0,this.sections[0]}};class u{constructor(t,n){this.field=t,this.documents=[],this.chunks=[],this.serializedDocumentsLength=0;const r=Buffer.allocUnsafe(5+this.field.length+1);if(r[0]=1,i(r,`${this.field}\0`,5),this.chunks.push(r),this.header=r,n)for(const t of n)this.push(t,e.serialize(t))}push(e,t){return this.serializedDocumentsLength+=t.length,this.documents.push(e),this.chunks.push(t),this.header?.writeInt32LE(4+this.field.length+1+this.serializedDocumentsLength,1),this.serializedDocumentsLength+this.header.length}toBin(){return Buffer.concat(this.chunks)}}wo.DocumentSequence=u;class a{constructor(e,n,r){if(this.databaseName=e,this.command=n,this.options=r,null==n)throw new t.MongoInvalidArgumentError("Query document must be specified for query");this.command.$db=e,this.options=r??{},this.requestId=r.requestId?r.requestId:a.getRequestId(),this.serializeFunctions="boolean"==typeof r.serializeFunctions&&r.serializeFunctions,this.ignoreUndefined="boolean"==typeof r.ignoreUndefined&&r.ignoreUndefined,this.checkKeys="boolean"==typeof r.checkKeys&&r.checkKeys,this.maxBsonSize=r.maxBsonSize||16777216,this.checksumPresent=!1,this.moreToCome=r.moreToCome??0===n.writeConcern?.w,this.exhaustAllowed="boolean"==typeof r.exhaustAllowed&&r.exhaustAllowed}toBin(){const e=[];let t=0;this.checksumPresent&&(t|=1),this.moreToCome&&(t|=2),this.exhaustAllowed&&(t|=65536);const n=Buffer.alloc(20);e.push(n);let o=n.length;const i=this.command;return o+=this.makeSections(e,i),n.writeInt32LE(o,0),n.writeInt32LE(this.requestId,4),n.writeInt32LE(0,8),n.writeInt32LE(r.OP_MSG,12),n.writeUInt32LE(t,16),e}makeSections(e,t){const n=this.extractDocumentSequences(t),r=Buffer.allocUnsafe(1);r[0]=0;const o=this.serializeBson(t);return e.push(r),e.push(o),e.push(n),r.length+o.length+n.length}extractDocumentSequences(e){const t=[];for(const[n,r]of Object.entries(e))r instanceof u&&(t.push(r.toBin()),delete e[n]);return t.length>0?Buffer.concat(t):Buffer.alloc(0)}serializeBson(t){return e.serialize(t,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined})}static getRequestId(){return o=o+1&2147483647,o}}wo.OpMsgRequest=a;wo.OpMsgResponse=class{constructor(e,t,n,r){this.index=0,this.sections=[],this.parsed=!1,this.raw=e,this.data=n,this.opts=r??{useBigInt64:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!1,bsonRegExp:!1},this.length=t.length,this.requestId=t.requestId,this.responseTo=t.responseTo,this.opCode=t.opCode,this.fromCompressed=t.fromCompressed,this.responseFlags=n.readInt32LE(0),this.checksumPresent=!!(1&this.responseFlags),this.moreToCome=!!(2&this.responseFlags),this.exhaustAllowed=!!(65536&this.responseFlags),this.useBigInt64="boolean"==typeof this.opts.useBigInt64&&this.opts.useBigInt64,this.promoteLongs="boolean"!=typeof this.opts.promoteLongs||this.opts.promoteLongs,this.promoteValues="boolean"!=typeof this.opts.promoteValues||this.opts.promoteValues,this.promoteBuffers="boolean"==typeof this.opts.promoteBuffers&&this.opts.promoteBuffers,this.bsonRegExp="boolean"==typeof this.opts.bsonRegExp&&this.opts.bsonRegExp}isParsed(){return this.parsed}parse(){if(this.parsed)return this.sections[0];for(this.index=4;this.index<this.data.length;){const e=this.data.readUInt8(this.index++);if(0===e){const e=this.data.readUInt32LE(this.index),t=this.data.subarray(this.index,this.index+e);this.sections.push(t),this.index+=e}else if(1===e)throw new t.MongoRuntimeError("OP_MSG Payload Type 1 detected unsupported protocol")}return this.parsed=!0,this.sections[0]}};return wo.OpCompressedRequest=class{constructor(e,t){this.command=e,this.options=t}static canCompress(e){const t=e instanceof a?e.command:e.query,r=Object.keys(t)[0];return!n.uncompressibleCommands.has(r)}async toBin(){const e=Buffer.concat(this.command.toBin()),t=e.slice(16),o=e.readInt32LE(12),i=await(0,n.compress)(this.options,t),s=Buffer.alloc(16);s.writeInt32LE(25+i.length,0),s.writeInt32LE(this.command.requestId,4),s.writeInt32LE(0,8),s.writeInt32LE(r.OP_COMPRESSED,12);const u=Buffer.alloc(9);return u.writeInt32LE(o,0),u.writeInt32LE(t.length,4),u.writeUInt8(n.Compressor[this.options.agreedCompressor],8),[s,u,i]}},wo}function vo(){return Oo||(Oo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uncompressibleCommands=e.Compressor=void 0,e.compress=async function(e,t){const n={};switch(e.agreedCompressor){case"snappy":return f??=m(),await f.compress(t);case"zstd":if(g(),"kModuleError"in d)throw d.kModuleError;return await d.compress(t,c);case"zlib":return e.zlibCompressionLevel&&(n.level=e.zlibCompressionLevel),await p(t,n);default:throw new s.MongoInvalidArgumentError(`Unknown compressor ${e.agreedCompressor} failed to compress`)}},e.decompress=y,e.compressCommand=async function(e,t){const n="none"!==t.agreedCompressor&&u.OpCompressedRequest.canCompress(e)?new u.OpCompressedRequest(e,{agreedCompressor:t.agreedCompressor??"none",zlibCompressionLevel:t.zlibCompressionLevel??0}):e,r=await n.toBin();return Buffer.concat(r)},e.decompressResponse=async function(e){const t={length:e.readInt32LE(0),requestId:e.readInt32LE(4),responseTo:e.readInt32LE(8),opCode:e.readInt32LE(12)};if(t.opCode!==a.OP_COMPRESSED){const n=t.opCode===a.OP_MSG?u.OpMsgResponse:u.OpReply,r=e.subarray(E);return new n(e,t,r)}const n={...t,fromCompressed:!0,opCode:e.readInt32LE(E),length:e.readInt32LE(E+4)},r=e[E+8],o=e.slice(E+9),i=n.opCode===a.OP_MSG?u.OpMsgResponse:u.OpReply,c=await y(r,o);if(c.length!==n.length)throw new s.MongoDecompressionError("Message body and message header must be the same length");return new i(e,n,c)};const t=n,r=h,o=z(),i=Ln(),s=P(),u=So(),a=H();e.Compressor=Object.freeze({none:0,snappy:1,zlib:2,zstd:3}),e.uncompressibleCommands=new Set([o.LEGACY_HELLO_COMMAND,"saslStart","saslContinue","getnonce","authenticate","createUser","updateUser","copydbSaslStart","copydbgetnonce","copydb"]);const c=3,l=(0,t.promisify)(r.inflate.bind(r)),p=(0,t.promisify)(r.deflate.bind(r));let d,f=null;function m(){if(null==f){const e=(0,i.getSnappy)();if("kModuleError"in e)throw e.kModuleError;f=e}return f}async function y(t,n){if(t!==e.Compressor.snappy&&t!==e.Compressor.zstd&&t!==e.Compressor.zlib&&t!==e.Compressor.none)throw new s.MongoDecompressionError(`Server sent message compressed using an unsupported compressor. (Received compressor ID ${t})`);switch(t){case e.Compressor.snappy:return f??=m(),await f.uncompress(n,{asBuffer:!0});case e.Compressor.zstd:if(g(),"kModuleError"in d)throw d.kModuleError;return await d.decompress(n);case e.Compressor.zlib:return await l(n);default:return n}}function g(){d||(d=(0,i.getZstdLibrary)())}const E=16}(Co)),Co}var Do,Mo={},To={},Bo={},Fo={};function $o(){if(Do)return Fo;Do=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.hmacSha256Hook=Fo.hmacSha512Hook=Fo.aes256CtrDecryptHook=Fo.aes256CtrEncryptHook=Fo.aes256CbcDecryptHook=Fo.aes256CbcEncryptHook=void 0,Fo.makeAES256Hook=t,Fo.randomHook=function(t,n){try{e.randomFillSync(t,0,n)}catch(e){return e}return n},Fo.sha256Hook=function(t,n){let r;try{r=e.createHash("sha256").update(t).digest()}catch(e){return e}return r.copy(n),r.length},Fo.makeHmacHook=n,Fo.signRsaSha256Hook=function(t,n,r){let o;try{const r=e.createSign("sha256WithRSAEncryption"),i=Buffer.from(`-----BEGIN PRIVATE KEY-----\n${t.toString("base64")}\n-----END PRIVATE KEY-----\n`);o=r.update(n).end().sign(i)}catch(e){return e}return o.copy(r),o.length};const e=r;function t(t,n){return function(r,o,i,s){let u;try{const s=e[t](n,r,o);s.setAutoPadding(!1),u=s.update(i);const a=s.final();a.length>0&&(u=Buffer.concat([u,a]))}catch(e){return e}return u.copy(s),u.length}}function n(t){return(n,r,o)=>{let i;try{i=e.createHmac(t,n).update(r).digest()}catch(e){return e}return i.copy(o),i.length}}return Fo.aes256CbcEncryptHook=t("createCipheriv","aes-256-cbc"),Fo.aes256CbcDecryptHook=t("createDecipheriv","aes-256-cbc"),Fo.aes256CtrEncryptHook=t("createCipheriv","aes-256-ctr"),Fo.aes256CtrDecryptHook=t("createDecipheriv","aes-256-ctr"),Fo.hmacSha512Hook=n("sha512"),Fo.hmacSha256Hook=n("sha256"),Fo}var xo,Po={};function No(){if(xo)return Po;xo=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.MongoCryptKMSRequestNetworkTimeoutError=Po.MongoCryptAzureKMSRequestError=Po.MongoCryptCreateEncryptedCollectionError=Po.MongoCryptCreateDataKeyError=Po.MongoCryptInvalidArgumentError=Po.MongoCryptError=void 0;const e=P();class t extends e.MongoError{constructor(e,t={}){super(e,t)}get name(){return"MongoCryptError"}}Po.MongoCryptError=t;Po.MongoCryptInvalidArgumentError=class extends t{constructor(e){super(e)}get name(){return"MongoCryptInvalidArgumentError"}};Po.MongoCryptCreateDataKeyError=class extends t{constructor(e,{cause:t}){super(`Unable to complete creating data keys: ${t.message}`,{cause:t}),this.encryptedFields=e}get name(){return"MongoCryptCreateDataKeyError"}};Po.MongoCryptCreateEncryptedCollectionError=class extends t{constructor(e,{cause:t}){super(`Unable to create collection: ${t.message}`,{cause:t}),this.encryptedFields=e}get name(){return"MongoCryptCreateEncryptedCollectionError"}};Po.MongoCryptAzureKMSRequestError=class extends t{constructor(e,t){super(e),this.body=t}get name(){return"MongoCryptAzureKMSRequestError"}};return Po.MongoCryptKMSRequestNetworkTimeoutError=class extends t{get name(){return"MongoCryptKMSRequestNetworkTimeoutError"}},Po}var Io,Ro,ko={},jo={},Lo={};function Uo(){if(Io)return Lo;Io=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.LegacyAWSTemporaryCredentialProvider=Lo.AWSSDKCredentialProvider=Lo.AWSTemporaryCredentialProvider=void 0;const e=Ln(),t=P(),n=fe(),r="http://169.254.169.254",o="/latest/meta-data/iam/security-credentials";class i{static get awsSDK(){return i._awsSDK??=(0,e.getAwsCredentialProvider)(),i._awsSDK}static get isAWSSDKInstalled(){return!("kModuleError"in i.awsSDK)}}Lo.AWSTemporaryCredentialProvider=i;Lo.AWSSDKCredentialProvider=class extends i{constructor(e){super(),e&&(this._provider=e)}get provider(){if("kModuleError"in i.awsSDK)throw i.awsSDK.kModuleError;if(this._provider)return this._provider;let{AWS_STS_REGIONAL_ENDPOINTS:e="",AWS_REGION:t=""}=process.env;e=e.toLowerCase(),t=t.toLowerCase();const n=0!==t.length&&0!==e.length,r=new Set(["ap-northeast-1","ap-south-1","ap-southeast-1","ap-southeast-2","aws-global","ca-central-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),o="regional"===e||"legacy"===e&&!r.has(t);return this._provider=n&&o?i.awsSDK.fromNodeProviderChain({clientConfig:{region:t}}):i.awsSDK.fromNodeProviderChain(),this._provider}async getCredentials(){try{const e=await this.provider();return{AccessKeyId:e.accessKeyId,SecretAccessKey:e.secretAccessKey,Token:e.sessionToken,Expiration:e.expiration}}catch(e){throw new t.MongoAWSError(e.message,{cause:e})}}};return Lo.LegacyAWSTemporaryCredentialProvider=class extends i{async getCredentials(){if(process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI)return await(0,n.request)(`http://169.254.170.2${process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI}`);const e=await(0,n.request)(`${r}/latest/api/token`,{method:"PUT",json:!1,headers:{"X-aws-ec2-metadata-token-ttl-seconds":30}}),t=await(0,n.request)(`${r}/${o}`,{json:!1,headers:{"X-aws-ec2-metadata-token":e}});return await(0,n.request)(`${r}/${o}/${t}`,{headers:{"X-aws-ec2-metadata-token":e}})}},Lo}var Vo,zo={};function Wo(){return Vo||(Vo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.tokenCache=e.AzureCredentialCache=e.AZURE_BASE_URL=void 0,e.addAzureParams=i,e.prepareRequest=s,e.fetchAzureKMSToken=u,e.loadAzureCredentials=async function(t){const n=await e.tokenCache.getToken();return{...t,azure:n}};const t=P(),n=fe(),r=No();e.AZURE_BASE_URL="http://169.254.169.254/metadata/identity/oauth2/token?";class o{constructor(){this.cachedToken=null}async getToken(){return(null==this.cachedToken||this.needsRefresh(this.cachedToken))&&(this.cachedToken=await this._getToken()),{accessToken:this.cachedToken.accessToken}}needsRefresh(e){return e.expiresOnTimestamp-Date.now()<=6e3}resetCache(){this.cachedToken=null}_getToken(){return u()}}function i(e,t,n){return e.searchParams.append("api-version","2018-02-01"),e.searchParams.append("resource",t),n&&e.searchParams.append("client_id",n),e}function s(t){const n=new URL(t.url?.toString()??e.AZURE_BASE_URL);i(n,"https://vault.azure.net");return{headers:{...t.headers,"Content-Type":"application/json",Metadata:!0},url:n}}async function u(e={}){const{headers:o,url:i}=s(e);try{const e=await(0,n.get)(i,{headers:o});return await async function(e){const{status:t,body:n}=e,o=(()=>{try{return JSON.parse(n)}catch{throw new r.MongoCryptAzureKMSRequestError("Malformed JSON body in GET request.")}})();if(200!==t)throw new r.MongoCryptAzureKMSRequestError("Unable to complete request.",o);if(!o.access_token)throw new r.MongoCryptAzureKMSRequestError("Malformed response body - missing field `access_token`.");if(!o.expires_in)throw new r.MongoCryptAzureKMSRequestError("Malformed response body - missing field `expires_in`.");const i=1e3*Number(o.expires_in);if(Number.isNaN(i))throw new r.MongoCryptAzureKMSRequestError("Malformed response body - unable to parse int from `expires_in` field.");return{accessToken:o.access_token,expiresOnTimestamp:Date.now()+i}}(e)}catch(e){if(e instanceof t.MongoNetworkTimeoutError)throw new r.MongoCryptAzureKMSRequestError(`[Azure KMS] ${e.message}`);throw e}}e.AzureCredentialCache=o,e.tokenCache=new o}(zo)),zo}var qo,Go,Ho={};function Ko(){if(Go)return ko;Go=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.isEmptyCredentials=r,ko.refreshKMSCredentials=async function(o,i){let s=o;r("aws",o)&&(s=await(0,e.loadAWSCredentials)(s,i?.aws));r("gcp",o)&&(s=await(0,n.loadGCPCredentials)(s));r("azure",o)&&(s=await(0,t.loadAzureCredentials)(s));return s};const e=function(){if(Ro)return jo;Ro=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.loadAWSCredentials=async function(t,n){const r=new e.AWSSDKCredentialProvider(n),{SecretAccessKey:o="",AccessKeyId:i="",Token:s}=await r.getCredentials(),u={secretAccessKey:o,accessKeyId:i};return null!=s&&(u.sessionToken=s),{...t,aws:u}};const e=Uo();return jo}(),t=Wo(),n=function(){if(qo)return Ho;qo=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.loadGCPCredentials=async function(t){const n=(0,e.getGcpMetadata)();if("kModuleError"in n)return t;const{access_token:r}=await n.instance({property:"service-accounts/default/token"});return{...t,gcp:{accessToken:r}}};const e=Ln();return Ho}();function r(e,t){const n=t[e];return null!=n&&("object"==typeof n&&0===Object.keys(n).length)}return ko}var Yo,Qo,Jo={};function Xo(){if(Yo)return Jo;Yo=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.StateMachine=void 0;const e=d,t=p,n=f,r=F(),o=Ju(),i=Ln(),s=P(),u=Ce(),a=fe(),c=Zo(),l=No();let h=null;const m=new Map([[0,"MONGOCRYPT_CTX_ERROR"],[1,"MONGOCRYPT_CTX_NEED_MONGO_COLLINFO"],[2,"MONGOCRYPT_CTX_NEED_MONGO_MARKINGS"],[3,"MONGOCRYPT_CTX_NEED_MONGO_KEYS"],[7,"MONGOCRYPT_CTX_NEED_KMS_CREDENTIALS"],[4,"MONGOCRYPT_CTX_NEED_KMS"],[5,"MONGOCRYPT_CTX_READY"],[6,"MONGOCRYPT_CTX_DONE"]]),y=["tlsInsecure","tlsAllowInvalidCertificates","tlsAllowInvalidHostnames","tlsDisableOCSPEndpointCheck","tlsDisableCertificateRevocationCheck"];function g(e){process.env.MONGODB_CRYPT_DEBUG&&console.error(e)}let E;return Jo.StateMachine=class{constructor(e,t=(0,r.pluckBSONSerializeOptions)(e)){this.options=e,this.bsonOptions=t}async execute(e,t,n){const o=e._keyVaultNamespace,i=e._keyVaultClient,s=e._metaDataClient,u=e._mongocryptdClient,a=e._mongocryptdManager;let c=null;const h=()=>t.status,p=()=>t.state;for(;6!==p()&&0!==p();)switch(n.signal?.throwIfAborted(),g(`[context#${t.id}] ${m.get(p())||p()}`),p()){case 1:{const e=(0,r.deserialize)(t.nextMongoOperation());if(!s)throw new l.MongoCryptError("unreachable state machine state: entered MONGOCRYPT_CTX_NEED_MONGO_COLLINFO but metadata client is undefined");const o=this.fetchCollectionInfo(s,t.ns,e,n);for await(const e of o)if(t.addMongoOperationResponse((0,r.serialize)(e)),0===p())break;if(0===p())break;t.finishMongoOperation();break}case 2:{const e=t.nextMongoOperation();if(0===p())break;if(!u)throw new l.MongoCryptError("unreachable state machine state: entered MONGOCRYPT_CTX_NEED_MONGO_MARKINGS but mongocryptdClient is undefined");const r=a?await a.withRespawn(this.markCommand.bind(this,u,t.ns,e,n)):await this.markCommand(u,t.ns,e,n);t.addMongoOperationResponse(r),t.finishMongoOperation();break}case 3:{const e=t.nextMongoOperation(),s=await this.fetchKeys(i,o,e,n);0===s.length&&(c=E??=(0,r.serialize)({v:[]}));for await(const e of s)t.addMongoOperationResponse((0,r.serialize)(e));t.finishMongoOperation();break}case 7:{const n=await e.askForKMSCredentials();t.provideKMSProviders((0,r.serialize)(n));break}case 4:await Promise.all(this.requests(t,n)),t.finishKMSRequests();break;case 5:{const e=t.finalize();if(0===p()){const e=h().message||"Finalization error";throw new l.MongoCryptError(e)}c=e;break}default:throw new l.MongoCryptError(`Unknown state: ${p()}`)}if(0===p()||null==c){const e=h().message;throw e||g("unidentifiable error in MongoCrypt - received an error status from `libmongocrypt` but received no error message."),new l.MongoCryptError(e??"unidentifiable error in MongoCrypt - received an error status from `libmongocrypt` but received no error message.")}return c}async kmsRequest(e,r){const o=e.endpoint.split(":"),p=null!=o[1]?Number.parseInt(o[1],10):443,d={host:o[0],servername:o[0],port:p,...(0,c.autoSelectSocketOptions)(this.options.socketOptions||{})},f=e.message,m=new a.BufferPool;let y,g;function E(){for(const e of[g,y])e&&e.destroy()}function A(e){return new l.MongoCryptError("KMS request failed",{cause:e})}function b(){return new l.MongoCryptError("KMS request closed")}const _=this.options.tlsOptions;if(_){const t=e.kmsProvider,n=_[t];if(n){const e=this.validateTlsOptions(t,n);if(e)throw e;try{await this.setTlsOptions(n,d)}catch(e){throw A(e)}}}let O;try{if(this.options.proxyOptions&&this.options.proxyOptions.proxyHost){y=new t.Socket;const{promise:e,reject:n,resolve:r}=(0,a.promiseWithResolvers)();y.once("error",(e=>n(A(e)))).once("close",(()=>n(b()))).once("connect",(()=>r()));const o={...d,host:this.options.proxyOptions.proxyHost,port:this.options.proxyOptions.proxyPort||1080};y.connect(o),await e;try{h??=function(){if(null==h){const e=(0,i.getSocks)();if("kModuleError"in e)throw e.kModuleError;h=e}return h}(),d.socket=(await h.SocksClient.createConnection({existing_socket:y,command:"connect",destination:{host:d.host,port:d.port},proxy:{host:"iLoveJavaScript",port:0,type:5,userId:this.options.proxyOptions.proxyUsername,password:this.options.proxyOptions.proxyPassword}})).socket}catch(e){throw A(e)}}g=n.connect(d,(()=>{g.write(f)}));const{promise:o,reject:s,resolve:c}=(0,a.promiseWithResolvers)();O=(0,a.addAbortListener)(r?.signal,(function(){E(),s(this.reason)})),g.once("error",(e=>s(A(e)))).once("close",(()=>s(b()))).on("data",(t=>{for(m.append(t);e.bytesNeeded>0&&m.length;){const t=Math.min(e.bytesNeeded,m.length);e.addResponse(m.read(t))}e.bytesNeeded<=0&&c()})),await(r?.timeoutContext?.csotEnabled()?Promise.all([o,u.Timeout.expires(r.timeoutContext?.remainingTimeMS)]):o)}catch(e){if(e instanceof u.TimeoutError)throw new s.MongoOperationTimeoutError("KMS request timed out");throw e}finally{E(),O?.[a.kDispose]()}}*requests(e,t){for(let n=e.nextKMSRequest();null!=n;n=e.nextKMSRequest())yield this.kmsRequest(n,t)}validateTlsOptions(e,t){const n=Object.keys(t);for(const t of y)if(n.includes(t))return new l.MongoCryptError(`Insecure TLS options prohibited for ${e}: ${t}`)}async setTlsOptions(t,n){if(t.tlsCertificateKeyFile){const r=await e.readFile(t.tlsCertificateKeyFile);n.cert=n.key=r}t.tlsCAFile&&(n.ca=await e.readFile(t.tlsCAFile)),t.tlsCertificateKeyFilePassword&&(n.passphrase=t.tlsCertificateKeyFilePassword)}fetchCollectionInfo(e,t,n,r){const{db:i}=a.MongoDBCollectionNamespace.fromString(t);return e.db(i).listCollections(n,{promoteLongs:!1,promoteValues:!1,timeoutContext:r?.timeoutContext&&new o.CursorTimeoutContext(r?.timeoutContext,Symbol()),signal:r?.signal,nameOnly:!1})}async markCommand(e,t,n,o){const{db:i}=a.MongoDBCollectionNamespace.fromString(t),s={promoteLongs:!1,promoteValues:!1},u=(0,r.deserialize)(n,s),c={timeoutMS:void 0,signal:void 0};o?.timeoutContext?.csotEnabled()&&(c.timeoutMS=o.timeoutContext.remainingTimeMS),o?.signal&&(c.signal=o.signal);const l=await e.db(i).command(u,{...s,...c});return(0,r.serialize)(l,this.bsonOptions)}fetchKeys(e,t,n,i){const{db:s,collection:u}=a.MongoDBCollectionNamespace.fromString(t),c={timeoutContext:void 0,signal:void 0};return null!=i?.timeoutContext&&(c.timeoutContext=new o.CursorTimeoutContext(i.timeoutContext,Symbol())),null!=i?.signal&&(c.signal=i.signal),e.db(s).collection(u,{readConcern:{level:"majority"}}).find((0,r.deserialize)(n),c).toArray()}},Jo}function Zo(){if(Qo)return Bo;Qo=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.ClientEncryption=void 0,Bo.autoSelectSocketOptions=c;const e=F(),t=Ln(),n=Ce(),r=fe(),o=$o(),i=No(),s=Ko(),u=Xo();class a{static getMongoCrypt(){const e=(0,t.getMongoDBClientEncryption)();if("kModuleError"in e)throw e.kModuleError;return e.MongoCrypt}constructor(t,n){this._client=t,this._proxyOptions=n.proxyOptions??{},this._tlsOptions=n.tlsOptions??{},this._kmsProviders=n.kmsProviders||{};const{timeoutMS:u}=(0,r.resolveTimeoutOptions)(t,n);if(this._timeoutMS=u,this._credentialProviders=n.credentialProviders,n.credentialProviders?.aws&&!(0,s.isEmptyCredentials)("aws",this._kmsProviders))throw new i.MongoCryptInvalidArgumentError("Can only provide a custom AWS credential provider when the state machine is configured for automatic AWS credential fetching");if(null==n.keyVaultNamespace)throw new i.MongoCryptInvalidArgumentError("Missing required option `keyVaultNamespace`");const c={...n,cryptoCallbacks:o,kmsProviders:Buffer.isBuffer(this._kmsProviders)?this._kmsProviders:(0,e.serialize)(this._kmsProviders)};this._keyVaultNamespace=n.keyVaultNamespace,this._keyVaultClient=n.keyVaultClient||t;const l=a.getMongoCrypt();this._mongoCrypt=new l(c)}async createDataKey(t,o={}){if(o.keyAltNames&&!Array.isArray(o.keyAltNames))throw new i.MongoCryptInvalidArgumentError(`Option "keyAltNames" must be an array of strings, but was of type ${typeof o.keyAltNames}.`);let s,a;o.keyAltNames&&o.keyAltNames.length>0&&(s=o.keyAltNames.map(((t,n)=>{if("string"!=typeof t)throw new i.MongoCryptInvalidArgumentError(`Option "keyAltNames" must be an array of strings, but item at index ${n} was of type ${typeof t}`);return(0,e.serialize)({keyAltName:t})}))),o.keyMaterial&&(a=(0,e.serialize)({keyMaterial:o.keyMaterial}));const l=(0,e.serialize)({provider:t,...o.masterKey}),h=this._mongoCrypt.makeDataKeyContext(l,{keyAltNames:s,keyMaterial:a}),p=new u.StateMachine({proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:c(this._client.s.options)}),d=o?.timeoutContext??n.TimeoutContext.create((0,r.resolveTimeoutOptions)(this._client,{timeoutMS:this._timeoutMS})),f=(0,e.deserialize)(await p.execute(this,h,{timeoutContext:d})),{db:m,collection:y}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace),{insertedId:g}=await this._keyVaultClient.db(m).collection(y).insertOne(f,{writeConcern:{w:"majority"},timeoutMS:d?.csotEnabled()?d?.getRemainingTimeMSOrThrow():void 0});return g}async rewrapManyDataKey(t,o){let i;if(o){const t=Object.assign({provider:o.provider},o.masterKey);i=(0,e.serialize)(t)}const s=(0,e.serialize)(t),a=this._mongoCrypt.makeRewrapManyDataKeyContext(s,i),l=new u.StateMachine({proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:c(this._client.s.options)}),h=n.TimeoutContext.create((0,r.resolveTimeoutOptions)(this._client,{timeoutMS:this._timeoutMS})),{v:p}=(0,e.deserialize)(await l.execute(this,a,{timeoutContext:h}));if(0===p.length)return{};const{db:d,collection:f}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace),m=p.map((e=>({updateOne:{filter:{_id:e._id},update:{$set:{masterKey:e.masterKey,keyMaterial:e.keyMaterial},$currentDate:{updateDate:!0}}}})));return{bulkWriteResult:await this._keyVaultClient.db(d).collection(f).bulkWrite(m,{writeConcern:{w:"majority"},timeoutMS:h.csotEnabled()?h?.remainingTimeMS:void 0})}}async deleteKey(e){const{db:t,collection:n}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace);return await this._keyVaultClient.db(t).collection(n).deleteOne({_id:e},{writeConcern:{w:"majority"},timeoutMS:this._timeoutMS})}getKeys(){const{db:e,collection:t}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace);return this._keyVaultClient.db(e).collection(t).find({},{readConcern:{level:"majority"},timeoutMS:this._timeoutMS})}async getKey(e){const{db:t,collection:n}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace);return await this._keyVaultClient.db(t).collection(n).findOne({_id:e},{readConcern:{level:"majority"},timeoutMS:this._timeoutMS})}async getKeyByAltName(e){const{db:t,collection:n}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace);return await this._keyVaultClient.db(t).collection(n).findOne({keyAltNames:e},{readConcern:{level:"majority"},timeoutMS:this._timeoutMS})}async addKeyAltName(e,t){const{db:n,collection:o}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace);return await this._keyVaultClient.db(n).collection(o).findOneAndUpdate({_id:e},{$addToSet:{keyAltNames:t}},{writeConcern:{w:"majority"},returnDocument:"before",timeoutMS:this._timeoutMS})}async removeKeyAltName(e,t){const{db:n,collection:o}=r.MongoDBCollectionNamespace.fromString(this._keyVaultNamespace),i=[{$set:{keyAltNames:{$cond:[{$eq:["$keyAltNames",[t]]},"$$REMOVE",{$filter:{input:"$keyAltNames",cond:{$ne:["$$this",t]}}}]}}}];return await this._keyVaultClient.db(n).collection(o).findOneAndUpdate({_id:e},i,{writeConcern:{w:"majority"},returnDocument:"before",timeoutMS:this._timeoutMS})}async createEncryptedCollection(e,t,o){const{provider:s,masterKey:u,createCollectionOptions:{encryptedFields:{...a},...c}}=o,l=null!=this._timeoutMS?n.TimeoutContext.create((0,r.resolveTimeoutOptions)(this._client,{timeoutMS:this._timeoutMS})):void 0;if(Array.isArray(a.fields)){const e=a.fields.map((async e=>null==e||"object"!=typeof e||null!=e.keyId?e:{...e,keyId:await this.createDataKey(s,{masterKey:u,timeoutContext:l?.csotEnabled()?l?.clone():void 0})})),t=await Promise.allSettled(e);a.fields=t.map(((e,t)=>"fulfilled"===e.status?e.value:a.fields[t]));const n=t.find((e=>"rejected"===e.status));if(null!=n)throw new i.MongoCryptCreateDataKeyError(a,{cause:n.reason})}try{return{collection:await e.createCollection(t,{...c,encryptedFields:a,timeoutMS:l?.csotEnabled()?l?.getRemainingTimeMSOrThrow():void 0}),encryptedFields:a}}catch(e){throw new i.MongoCryptCreateEncryptedCollectionError(a,{cause:e})}}async encrypt(e,t){return await this._encrypt(e,!1,t)}async encryptExpression(e,t){return await this._encrypt(e,!0,t)}async decrypt(t){const o=(0,e.serialize)({v:t}),i=this._mongoCrypt.makeExplicitDecryptionContext(o),s=new u.StateMachine({proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:c(this._client.s.options)}),a=null!=this._timeoutMS?n.TimeoutContext.create((0,r.resolveTimeoutOptions)(this._client,{timeoutMS:this._timeoutMS})):void 0,{v:l}=(0,e.deserialize)(await s.execute(this,i,{timeoutContext:a}));return l}async askForKMSCredentials(){return await(0,s.refreshKMSCredentials)(this._kmsProviders,this._credentialProviders)}static get libmongocryptVersion(){return a.getMongoCrypt().libmongocryptVersion}async _encrypt(t,o,s){const{algorithm:a,keyId:l,keyAltName:h,contentionFactor:p,queryType:d,rangeOptions:f}=s,m={expressionMode:o,algorithm:a};if(l&&(m.keyId=l.buffer),h){if(l)throw new i.MongoCryptInvalidArgumentError('"options" cannot contain both "keyId" and "keyAltName"');if("string"!=typeof h)throw new i.MongoCryptInvalidArgumentError('"options.keyAltName" must be of type string, but was of type '+typeof h);m.keyAltName=(0,e.serialize)({keyAltName:h})}"number"!=typeof p&&"bigint"!=typeof p||(m.contentionFactor=p),"string"==typeof d&&(m.queryType=d),"object"==typeof f&&(m.rangeOptions=(0,e.serialize)(f));const y=(0,e.serialize)({v:t}),g=new u.StateMachine({proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:c(this._client.s.options)}),E=this._mongoCrypt.makeExplicitEncryptionContext(y,m),A=null!=this._timeoutMS?n.TimeoutContext.create((0,r.resolveTimeoutOptions)(this._client,{timeoutMS:this._timeoutMS})):void 0,{v:b}=(0,e.deserialize)(await g.execute(this,E,{timeoutContext:A}));return b}}function c(e){const t={autoSelectFamily:!0};return"autoSelectFamily"in e&&(t.autoSelectFamily=e.autoSelectFamily),"autoSelectFamilyAttemptTimeout"in e&&(t.autoSelectFamilyAttemptTimeout=e.autoSelectFamilyAttemptTimeout),t}return Bo.ClientEncryption=a,Bo}var ei,ti,ni,ri={};function oi(){if(ti)return To;var e;ti=1,Object.defineProperty(To,"__esModule",{value:!0}),To.AutoEncrypter=To.AutoEncryptionLoggerLevel=void 0;const t=p,n=F(),r=z(),o=Ln(),i=P(),s=Yu(),u=fe(),a=Zo(),c=$o(),l=No(),h=function(){if(ei)return ri;ei=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.MongocryptdManager=void 0;const e=P();class t{constructor(e={}){this.spawnPath="",this.spawnArgs=[],this.uri="string"==typeof e.mongocryptdURI&&e.mongocryptdURI.length>0?e.mongocryptdURI:t.DEFAULT_MONGOCRYPTD_URI,this.bypassSpawn=!!e.mongocryptdBypassSpawn,Object.hasOwn(e,"mongocryptdSpawnPath")&&e.mongocryptdSpawnPath&&(this.spawnPath=e.mongocryptdSpawnPath),Object.hasOwn(e,"mongocryptdSpawnArgs")&&Array.isArray(e.mongocryptdSpawnArgs)&&(this.spawnArgs=this.spawnArgs.concat(e.mongocryptdSpawnArgs)),this.spawnArgs.filter((e=>"string"==typeof e)).every((e=>e.indexOf("--idleShutdownTimeoutSecs")<0))&&this.spawnArgs.push("--idleShutdownTimeoutSecs","60")}async spawn(){const e=this.spawnPath||"mongocryptd",{spawn:t}=m;this._child=t(e,this.spawnArgs,{stdio:"ignore",detached:!0}),this._child.on("error",(()=>{})),this._child.unref()}async withRespawn(t){try{return await t()}catch(t){if(!(t instanceof e.MongoNetworkTimeoutError)||this.bypassSpawn)throw t}return await this.spawn(),await t()}}return ri.MongocryptdManager=t,t.DEFAULT_MONGOCRYPTD_URI="mongodb://localhost:27020",ri}(),d=Ko(),f=Xo();To.AutoEncryptionLoggerLevel=Object.freeze({FatalError:0,Error:1,Warning:2,Info:3,Trace:4});class y{static getMongoCrypt(){const e=(0,o.getMongoDBClientEncryption)();if("kModuleError"in e)throw e.kModuleError;return e.MongoCrypt}constructor(r,o){if(this[e]=!1,this._client=r,this._bypassEncryption=!0===o.bypassAutoEncryption,this._keyVaultNamespace=o.keyVaultNamespace||"admin.datakeys",this._keyVaultClient=o.keyVaultClient||r,this._metaDataClient=o.metadataClient||r,this._proxyOptions=o.proxyOptions||{},this._tlsOptions=o.tlsOptions||{},this._kmsProviders=o.kmsProviders||{},this._credentialProviders=o.credentialProviders,o.credentialProviders?.aws&&!(0,d.isEmptyCredentials)("aws",this._kmsProviders))throw new l.MongoCryptInvalidArgumentError("Can only provide a custom AWS credential provider when the state machine is configured for automatic AWS credential fetching");const i={enableMultipleCollinfo:!0,cryptoCallbacks:c};o.schemaMap&&(i.schemaMap=Buffer.isBuffer(o.schemaMap)?o.schemaMap:(0,n.serialize)(o.schemaMap)),o.encryptedFieldsMap&&(i.encryptedFieldsMap=Buffer.isBuffer(o.encryptedFieldsMap)?o.encryptedFieldsMap:(0,n.serialize)(o.encryptedFieldsMap)),i.kmsProviders=Buffer.isBuffer(this._kmsProviders)?this._kmsProviders:(0,n.serialize)(this._kmsProviders),o.options?.logger&&(i.logger=o.options.logger),o.extraOptions&&o.extraOptions.cryptSharedLibPath&&(i.cryptSharedLibPath=o.extraOptions.cryptSharedLibPath),o.bypassQueryAnalysis&&(i.bypassQueryAnalysis=o.bypassQueryAnalysis),this._bypassMongocryptdAndCryptShared=this._bypassEncryption||!!o.bypassQueryAnalysis,o.extraOptions&&o.extraOptions.cryptSharedLibSearchPaths?i.cryptSharedLibSearchPaths=o.extraOptions.cryptSharedLibSearchPaths:this._bypassMongocryptdAndCryptShared||(i.cryptSharedLibSearchPaths=["$SYSTEM"]);const u=y.getMongoCrypt();if(this._mongocrypt=new u(i),this._contextCounter=0,o.extraOptions&&o.extraOptions.cryptSharedLibRequired&&!this.cryptSharedLibVersionInfo)throw new l.MongoCryptInvalidArgumentError("`cryptSharedLibRequired` set but no crypt_shared library loaded");if(!this._bypassMongocryptdAndCryptShared&&!this.cryptSharedLibVersionInfo){this._mongocryptdManager=new h.MongocryptdManager(o.extraOptions);const e={serverSelectionTimeoutMS:1e4};null!=o.extraOptions&&"string"==typeof o.extraOptions.mongocryptdURI||t.getDefaultAutoSelectFamily||(e.family=4),t.getDefaultAutoSelectFamily&&Object.assign(e,(0,a.autoSelectSocketOptions)(this._client.s?.options??{})),this._mongocryptdClient=new s.MongoClient(this._mongocryptdManager.uri,e)}}async init(){if(!this._bypassMongocryptdAndCryptShared&&!this.cryptSharedLibVersionInfo){if(!this._mongocryptdManager)throw new i.MongoRuntimeError("Reached impossible state: mongocryptdManager is undefined when neither bypassSpawn nor the shared lib are specified.");if(!this._mongocryptdClient)throw new i.MongoRuntimeError("Reached impossible state: mongocryptdClient is undefined when neither bypassSpawn nor the shared lib are specified.");this._mongocryptdManager.bypassSpawn||await this._mongocryptdManager.spawn();try{return await this._mongocryptdClient.connect()}catch(e){const{message:t}=e;if(t&&(t.match(/timed out after/)||t.match(/ENOTFOUND/)))throw new i.MongoRuntimeError("Unable to connect to `mongocryptd`, please make sure it is running or in your PATH for auto-spawn",{cause:e});throw e}}}async teardown(e){await(this._mongocryptdClient?.close(e))}async encrypt(e,t,r={}){if(r.signal?.throwIfAborted(),this._bypassEncryption)return t;const o=Buffer.isBuffer(t)?t:(0,n.serialize)(t,r),i=this._mongocrypt.makeEncryptionContext(u.MongoDBCollectionNamespace.fromString(e).db,o);i.id=this._contextCounter++,i.ns=e,i.document=t;const s=new f.StateMachine({promoteValues:!1,promoteLongs:!1,proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:(0,a.autoSelectSocketOptions)(this._client.s.options)});return(0,n.deserialize)(await s.execute(this,i,r),{promoteValues:!1,promoteLongs:!1})}async decrypt(e,t={}){t.signal?.throwIfAborted();const n=this._mongocrypt.makeDecryptionContext(e);n.id=this._contextCounter++;const r=new f.StateMachine({...t,proxyOptions:this._proxyOptions,tlsOptions:this._tlsOptions,socketOptions:(0,a.autoSelectSocketOptions)(this._client.s.options)});return await r.execute(this,n,t)}async askForKMSCredentials(){return await(0,d.refreshKMSCredentials)(this._kmsProviders,this._credentialProviders)}get cryptSharedLibVersionInfo(){return this._mongocrypt.cryptSharedLibVersionInfo}static get libmongocryptVersion(){return y.getMongoCrypt().libmongocryptVersion}}return To.AutoEncrypter=y,e=r.kDecorateResult,To}var ii,si={},ui={},ai={},ci={},li={};function hi(){if(ii)return li;ii=1,Object.defineProperty(li,"__esModule",{value:!0}),li.ConnectionPoolMetrics=void 0;class e{constructor(){this.txnConnections=0,this.cursorConnections=0,this.otherConnections=0}markPinned(t){t===e.TXN?this.txnConnections+=1:t===e.CURSOR?this.cursorConnections+=1:this.otherConnections+=1}markUnpinned(t){t===e.TXN?this.txnConnections-=1:t===e.CURSOR?this.cursorConnections-=1:this.otherConnections-=1}info(e){return`Timed out while checking out a connection from connection pool: maxPoolSize: ${e}, connections in use by cursors: ${this.cursorConnections}, connections in use by transactions: ${this.txnConnections}, connections in use by other operations: ${this.otherConnections}`}reset(){this.txnConnections=0,this.cursorConnections=0,this.otherConnections=0}}return li.ConnectionPoolMetrics=e,e.TXN="txn",e.CURSOR="cursor",e.OTHER="other",li}var pi,di,fi,mi={},yi={},gi={};function Ei(){if(pi)return gi;pi=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.ServerDescription=void 0,gi.parseServerType=s,gi.compareTopologyVersion=u;const e=F(),t=P(),n=fe(),r=ne(),o=new Set([r.ServerType.RSPrimary,r.ServerType.Standalone,r.ServerType.Mongos,r.ServerType.LoadBalancer]),i=new Set([r.ServerType.RSPrimary,r.ServerType.RSSecondary,r.ServerType.Mongos,r.ServerType.Standalone,r.ServerType.LoadBalancer]);function s(e,t){return t?.loadBalanced?r.ServerType.LoadBalancer:e&&e.ok?e.isreplicaset?r.ServerType.RSGhost:e.msg&&"isdbgrid"===e.msg?r.ServerType.Mongos:e.setName?e.hidden?r.ServerType.RSOther:e.isWritablePrimary?r.ServerType.RSPrimary:e.secondary?r.ServerType.RSSecondary:e.arbiterOnly?r.ServerType.RSArbiter:r.ServerType.RSOther:r.ServerType.Standalone:r.ServerType.Unknown}function u(t,n){if(null==t||null==n)return-1;if(!t.processId.equals(n.processId))return-1;const r="bigint"==typeof t.counter?e.Long.fromBigInt(t.counter):e.Long.isLong(t.counter)?t.counter:e.Long.fromNumber(t.counter),o="bigint"==typeof n.counter?e.Long.fromBigInt(n.counter):e.Long.isLong(n.counter)?n.counter:e.Long.fromNumber(n.counter);return r.compare(o)}return gi.ServerDescription=class{constructor(e,r,o={}){if(null==e||""===e)throw new t.MongoRuntimeError("ServerDescription must be provided with a non-empty address");this.address="string"==typeof e?n.HostAddress.fromString(e).toString():e.toString(),this.type=s(r,o),this.hosts=r?.hosts?.map((e=>e.toLowerCase()))??[],this.passives=r?.passives?.map((e=>e.toLowerCase()))??[],this.arbiters=r?.arbiters?.map((e=>e.toLowerCase()))??[],this.tags=r?.tags??{},this.minWireVersion=r?.minWireVersion??0,this.maxWireVersion=r?.maxWireVersion??0,this.roundTripTime=o?.roundTripTime??-1,this.minRoundTripTime=o?.minRoundTripTime??0,this.lastUpdateTime=(0,n.now)(),this.lastWriteDate=r?.lastWrite?.lastWriteDate??0,this.error=o.error??null,this.error,this.topologyVersion=this.error?.topologyVersion??r?.topologyVersion??null,this.setName=r?.setName??null,this.setVersion=r?.setVersion??null,this.electionId=r?.electionId??null,this.logicalSessionTimeoutMinutes=r?.logicalSessionTimeoutMinutes??null,this.maxMessageSizeBytes=r?.maxMessageSizeBytes??null,this.maxWriteBatchSize=r?.maxWriteBatchSize??null,this.maxBsonObjectSize=r?.maxBsonObjectSize??null,this.primary=r?.primary??null,this.me=r?.me?.toLowerCase()??null,this.$clusterTime=r?.$clusterTime??null,this.iscryptd=Boolean(r?.iscryptd)}get hostAddress(){return n.HostAddress.fromString(this.address)}get allHosts(){return this.hosts.concat(this.arbiters).concat(this.passives)}get isReadable(){return this.type===r.ServerType.RSSecondary||this.isWritable}get isDataBearing(){return i.has(this.type)}get isWritable(){return o.has(this.type)}get host(){const e=`:${this.port}`.length;return this.address.slice(0,-e)}get port(){const e=this.address.split(":").pop();return e?Number.parseInt(e,10):27017}equals(e){const t=this.topologyVersion===e?.topologyVersion||0===u(this.topologyVersion,e?.topologyVersion),r=null!=this.electionId&&null!=e?.electionId?0===(0,n.compareObjectId)(this.electionId,e.electionId):this.electionId===e?.electionId;return null!=e&&e.iscryptd===this.iscryptd&&(0,n.errorStrictEqual)(this.error,e.error)&&this.type===e.type&&this.minWireVersion===e.minWireVersion&&(0,n.arrayStrictEqual)(this.hosts,e.hosts)&&function(e,t){const n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((n=>t[n]===e[n]))}(this.tags,e.tags)&&this.setName===e.setName&&this.setVersion===e.setVersion&&r&&this.primary===e.primary&&this.logicalSessionTimeoutMinutes===e.logicalSessionTimeoutMinutes&&t}},gi}function Ai(){if(di)return yi;di=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.TopologyDescription=void 0;const e=F(),t=H(),n=P(),r=fe(),o=ne(),i=Ei(),s=t.MIN_SUPPORTED_SERVER_VERSION,u=t.MAX_SUPPORTED_SERVER_VERSION,a=t.MIN_SUPPORTED_WIRE_VERSION,c=t.MAX_SUPPORTED_WIRE_VERSION,l=new Set([o.ServerType.Mongos,o.ServerType.Unknown]),h=new Set([o.ServerType.Mongos,o.ServerType.Standalone]),p=new Set([o.ServerType.RSSecondary,o.ServerType.RSArbiter,o.ServerType.RSOther]);class d{constructor(e,t=null,n=null,r=null,i=null,l=null,h=null){h=h??{},this.type=e??o.TopologyType.Unknown,this.servers=t??new Map,this.stale=!1,this.compatible=!0,this.heartbeatFrequencyMS=h.heartbeatFrequencyMS??0,this.localThresholdMS=h.localThresholdMS??15,this.setName=n??null,this.maxElectionId=i??null,this.maxSetVersion=r??null,this.commonWireVersion=l??0;for(const e of this.servers.values())if(e.type!==o.ServerType.Unknown&&e.type!==o.ServerType.LoadBalancer&&(e.minWireVersion>c&&(this.compatible=!1,this.compatibilityError=`Server at ${e.address} requires wire version ${e.minWireVersion}, but this version of the driver only supports up to ${c} (MongoDB ${u})`),e.maxWireVersion<a)){this.compatible=!1,this.compatibilityError=`Server at ${e.address} reports wire version ${e.maxWireVersion}, but this version of the driver requires at least ${a} (MongoDB ${s}).`;break}this.logicalSessionTimeoutMinutes=null;for(const[,e]of this.servers)if(e.isReadable){if(null==e.logicalSessionTimeoutMinutes){this.logicalSessionTimeoutMinutes=null;break}if(null==this.logicalSessionTimeoutMinutes){this.logicalSessionTimeoutMinutes=e.logicalSessionTimeoutMinutes;continue}this.logicalSessionTimeoutMinutes=Math.min(this.logicalSessionTimeoutMinutes,e.logicalSessionTimeoutMinutes)}}updateFromSrvPollingEvent(e,t=0){const n=e.hostnames(),o=new Set(this.servers.keys()),s=new Set(n),u=new Set;for(const e of o)s.delete(e),n.has(e)||u.add(e);if(0===s.size&&0===u.size)return this;const a=new Map(this.servers);for(const e of u)a.delete(e);if(s.size>0)if(0===t)for(const e of s)a.set(e,new i.ServerDescription(e));else if(a.size<t){const e=(0,r.shuffle)(s,t-a.size);for(const t of e)a.set(t,new i.ServerDescription(t))}return new d(this.type,a,this.setName,this.maxSetVersion,this.maxElectionId,this.commonWireVersion,{heartbeatFrequencyMS:this.heartbeatFrequencyMS,localThresholdMS:this.localThresholdMS})}update(e){const t=e.address;let{type:r,setName:s,maxSetVersion:u,maxElectionId:a,commonWireVersion:c}=this;const y=e.type,g=new Map(this.servers);if(0!==e.maxWireVersion&&(c=null==c?e.maxWireVersion:Math.min(c,e.maxWireVersion)),"string"==typeof e.setName&&"string"==typeof s&&e.setName!==s&&(r===o.TopologyType.Single?e=new i.ServerDescription(t):g.delete(t)),g.set(t,e),r===o.TopologyType.Single)return new d(o.TopologyType.Single,g,s,u,a,c,{heartbeatFrequencyMS:this.heartbeatFrequencyMS,localThresholdMS:this.localThresholdMS});if(r===o.TopologyType.Unknown&&(y===o.ServerType.Standalone&&1!==this.servers.size?g.delete(t):r=function(e){switch(e){case o.ServerType.Standalone:return o.TopologyType.Single;case o.ServerType.Mongos:return o.TopologyType.Sharded;case o.ServerType.RSPrimary:return o.TopologyType.ReplicaSetWithPrimary;case o.ServerType.RSOther:case o.ServerType.RSSecondary:return o.TopologyType.ReplicaSetNoPrimary;default:return o.TopologyType.Unknown}}(y)),r===o.TopologyType.Sharded&&(l.has(y)||g.delete(t)),r===o.TopologyType.ReplicaSetNoPrimary)if(h.has(y)&&g.delete(t),y===o.ServerType.RSPrimary){const t=f(g,e,s,u,a);r=t[0],s=t[1],u=t[2],a=t[3]}else if(p.has(y)){const t=function(e,t,n=null){const r=o.TopologyType.ReplicaSetNoPrimary;if(n=n??t.setName,n!==t.setName)return e.delete(t.address),[r,n];t.allHosts.forEach((t=>{e.has(t)||e.set(t,new i.ServerDescription(t))})),t.me&&t.address!==t.me&&e.delete(t.address);return[r,n]}(g,e,s);r=t[0],s=t[1]}if(r===o.TopologyType.ReplicaSetWithPrimary)if(h.has(y))g.delete(t),r=m(g);else if(y===o.ServerType.RSPrimary){const t=f(g,e,s,u,a);r=t[0],s=t[1],u=t[2],a=t[3]}else r=p.has(y)?function(e,t,r=null){if(null==r)throw new n.MongoRuntimeError('Argument "setName" is required if connected to a replica set');(r!==t.setName||t.me&&t.address!==t.me)&&e.delete(t.address);return m(e)}(g,e,s):m(g);return new d(r,g,s,u,a,c,{heartbeatFrequencyMS:this.heartbeatFrequencyMS,localThresholdMS:this.localThresholdMS})}get error(){const e=Array.from(this.servers.values()).filter((e=>e.error));return e.length>0?e[0].error:null}get hasKnownServers(){return Array.from(this.servers.values()).some((e=>e.type!==o.ServerType.Unknown))}get hasDataBearingServers(){return Array.from(this.servers.values()).some((e=>e.isDataBearing))}hasServer(e){return this.servers.has(e)}toJSON(){return e.EJSON.serialize(this)}}function f(e,t,s=null,u=null,a=null){const c=(e,t,n)=>`primary marked stale due to electionId/setVersion mismatch: server setVersion: ${e.setVersion}, server electionId: ${e.electionId}, topology setVersion: ${t}, topology electionId: ${n}`;if((s=s||t.setName)!==t.setName)return e.delete(t.address),[m(e),s,u,a];if(t.maxWireVersion>=17){const o=(0,r.compareObjectId)(a,t.electionId),l=0===o,h=-1===o,p=(u??-1)<=(t.setVersion??-1);if(!(h||l&&p))return e.set(t.address,new i.ServerDescription(t.address,void 0,{error:new n.MongoStalePrimaryError(c(t,u,a))})),[m(e),s,u,a];a=t.electionId,u=t.setVersion}else{const o=t.electionId?t.electionId:null;if(t.setVersion&&o){if(u&&a&&(u>t.setVersion||(0,r.compareObjectId)(a,o)>0))return e.set(t.address,new i.ServerDescription(t.address,void 0,{error:new n.MongoStalePrimaryError(c(t,u,a))})),[m(e),s,u,a];a=t.electionId}null!=t.setVersion&&(null==u||t.setVersion>u)&&(u=t.setVersion)}for(const[r,s]of e)if(s.type===o.ServerType.RSPrimary&&s.address!==t.address){e.set(r,new i.ServerDescription(s.address,void 0,{error:new n.MongoStalePrimaryError("primary marked stale due to discovery of newer primary")}));break}t.allHosts.forEach((t=>{e.has(t)||e.set(t,new i.ServerDescription(t))}));const l=Array.from(e.keys()),h=t.allHosts;return l.filter((e=>-1===h.indexOf(e))).forEach((t=>{e.delete(t)})),[m(e),s,u,a]}function m(e){for(const t of e.values())if(t.type===o.ServerType.RSPrimary)return o.TopologyType.ReplicaSetWithPrimary;return o.TopologyType.ReplicaSetNoPrimary}return yi.TopologyDescription=d,yi}function bi(){if(fi)return mi;fi=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.getReadPreference=function(n){let r=n?.readPreference??t.ReadPreference.primary;"string"==typeof r&&(r=t.ReadPreference.fromString(r));if(!(r instanceof t.ReadPreference))throw new e.MongoInvalidArgumentError('Option "readPreference" must be a ReadPreference instance');return r},mi.isSharded=function(e){if(null==e)return!1;if(e.description&&e.description.type===n.ServerType.Mongos)return!0;if(e.description&&e.description instanceof r.TopologyDescription){return Array.from(e.description.servers.values()).some((e=>e.type===n.ServerType.Mongos))}return!1};const e=P(),t=Z(),n=ne(),r=Ai();return mi}var _i,Oi,Ci={};function wi(){return _i||(_i=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Transaction=e.TxnState=void 0,e.isTransactionCommand=function(e){return!(!e.commitTransaction&&!e.abortTransaction)};const t=P(),n=Q(),r=Z(),o=de();e.TxnState=Object.freeze({NO_TRANSACTION:"NO_TRANSACTION",STARTING_TRANSACTION:"STARTING_TRANSACTION",TRANSACTION_IN_PROGRESS:"TRANSACTION_IN_PROGRESS",TRANSACTION_COMMITTED:"TRANSACTION_COMMITTED",TRANSACTION_COMMITTED_EMPTY:"TRANSACTION_COMMITTED_EMPTY",TRANSACTION_ABORTED:"TRANSACTION_ABORTED"});const i={[e.TxnState.NO_TRANSACTION]:[e.TxnState.NO_TRANSACTION,e.TxnState.STARTING_TRANSACTION],[e.TxnState.STARTING_TRANSACTION]:[e.TxnState.TRANSACTION_IN_PROGRESS,e.TxnState.TRANSACTION_COMMITTED,e.TxnState.TRANSACTION_COMMITTED_EMPTY,e.TxnState.TRANSACTION_ABORTED],[e.TxnState.TRANSACTION_IN_PROGRESS]:[e.TxnState.TRANSACTION_IN_PROGRESS,e.TxnState.TRANSACTION_COMMITTED,e.TxnState.TRANSACTION_ABORTED],[e.TxnState.TRANSACTION_COMMITTED]:[e.TxnState.TRANSACTION_COMMITTED,e.TxnState.TRANSACTION_COMMITTED_EMPTY,e.TxnState.STARTING_TRANSACTION,e.TxnState.NO_TRANSACTION],[e.TxnState.TRANSACTION_ABORTED]:[e.TxnState.STARTING_TRANSACTION,e.TxnState.NO_TRANSACTION],[e.TxnState.TRANSACTION_COMMITTED_EMPTY]:[e.TxnState.TRANSACTION_COMMITTED_EMPTY,e.TxnState.NO_TRANSACTION]},s=new Set([e.TxnState.STARTING_TRANSACTION,e.TxnState.TRANSACTION_IN_PROGRESS]),u=new Set([e.TxnState.TRANSACTION_COMMITTED,e.TxnState.TRANSACTION_COMMITTED_EMPTY,e.TxnState.TRANSACTION_ABORTED]);e.Transaction=class{constructor(i){i=i??{},this.state=e.TxnState.NO_TRANSACTION,this.options={};const s=o.WriteConcern.fromOptions(i);if(s){if(0===s.w)throw new t.MongoTransactionError("Transactions do not support unacknowledged write concern");this.options.writeConcern=s}i.readConcern&&(this.options.readConcern=n.ReadConcern.fromOptions(i)),i.readPreference&&(this.options.readPreference=r.ReadPreference.fromOptions(i)),i.maxCommitTimeMS&&(this.options.maxTimeMS=i.maxCommitTimeMS),this._pinnedServer=void 0,this._recoveryToken=void 0}get server(){return this._pinnedServer}get recoveryToken(){return this._recoveryToken}get isPinned(){return!!this.server}get isStarting(){return this.state===e.TxnState.STARTING_TRANSACTION}get isActive(){return s.has(this.state)}get isCommitted(){return u.has(this.state)}transition(n){const r=i[this.state];if(r&&r.includes(n))return this.state=n,void(this.state!==e.TxnState.NO_TRANSACTION&&this.state!==e.TxnState.STARTING_TRANSACTION&&this.state!==e.TxnState.TRANSACTION_ABORTED||this.unpinServer());throw new t.MongoRuntimeError(`Attempted illegal state transition from [${this.state}] to [${n}]`)}pinServer(e){this.isActive&&(this._pinnedServer=e)}unpinServer(){this._pinnedServer=void 0}}}(Ci)),Ci}function Si(){if(Oi)return ci;Oi=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.ServerSessionPool=ci.ServerSession=ci.ClientSession=void 0,ci.maybeClearPinnedConnection=_,ci.applySession=function(t,n,r){if(t.hasEnded)return new o.MongoExpiredSessionError;const i=t.serverSession;if(null==i)return new o.MongoRuntimeError("Unable to acquire server session");if(0===r.writeConcern?.w)return t&&t.explicit?new o.MongoAPIError("Cannot have explicit session with unacknowledged writes"):void 0;i.lastUse=(0,f.now)(),n.lsid=i.id;const s=t.inTransaction()||(0,d.isTransactionCommand)(n),u=!!r.willRetryWrite;(u||s)&&(i.txnNumber+=t.txnNumberIncrement,t.txnNumberIncrement=0,n.txnNumber=e.Long.fromNumber(i.txnNumber));if(!s)return t.transaction.state!==d.TxnState.NO_TRANSACTION&&t.transaction.transition(d.TxnState.NO_TRANSACTION),void(t.supports.causalConsistency&&t.operationTime&&(0,f.commandSupportsReadConcern)(n)?(n.readConcern=n.readConcern||{},Object.assign(n.readConcern,{afterClusterTime:t.operationTime})):t.snapshotEnabled&&(n.readConcern=n.readConcern||{level:a.ReadConcernLevel.snapshot},null!=t.snapshotTime&&Object.assign(n.readConcern,{atClusterTime:t.snapshotTime})));if(n.autocommit=!1,t.transaction.state===d.TxnState.STARTING_TRANSACTION){t.transaction.transition(d.TxnState.TRANSACTION_IN_PROGRESS),n.startTransaction=!0;const e=t.transaction.options.readConcern||t?.clientOptions?.readConcern;e&&(n.readConcern=e),t.supports.causalConsistency&&t.operationTime&&(n.readConcern=n.readConcern||{},Object.assign(n.readConcern,{afterClusterTime:t.operationTime}))}return},ci.updateSessionFromResponse=function(e,t){t.$clusterTime&&(0,h._advanceClusterTime)(e,t.$clusterTime);t.operationTime&&e&&e.supports.causalConsistency&&e.advanceOperationTime(t.operationTime);t.recoveryToken&&e&&e.inTransaction()&&(e.transaction._recoveryToken=t.recoveryToken);if(e?.snapshotEnabled&&null==e.snapshotTime){const n=t.atClusterTime;n&&(e.snapshotTime=n)}};const e=F(),t=hi(),n=bi(),r=z(),o=P(),i=ye(),s=Me(),u=cn(),a=Q(),c=Z(),l=Qu(),h=ne(),p=Ce(),d=wi(),f=fe(),m=de();class y extends i.TypedEventEmitter{constructor(e,t,n,r){if(super(),this.timeoutContext=null,this.on("error",f.noop),null==e)throw new o.MongoRuntimeError("ClientSession requires a MongoClient");if(null==t||!(t instanceof w))throw new o.MongoRuntimeError("ClientSession requires a ServerSessionPool");if(n=n??{},this.snapshotEnabled=!0===n.snapshot,!0===n.causalConsistency&&this.snapshotEnabled)throw new o.MongoInvalidArgumentError('Properties "causalConsistency" and "snapshot" are mutually exclusive');this.client=e,this.sessionPool=t,this.hasEnded=!1,this.clientOptions=r,this.timeoutMS=n.defaultTimeoutMS??e.s.options?.timeoutMS,this.explicit=!!n.explicit,this._serverSession=this.explicit?this.sessionPool.acquire():null,this.txnNumberIncrement=0;const i=this.explicit&&!0!==n.snapshot;this.supports={causalConsistency:n.causalConsistency??i},this.clusterTime=n.initialClusterTime,this.operationTime=void 0,this.owner=n.owner,this.defaultTransactionOptions={...n.defaultTransactionOptions},this.transaction=new d.Transaction}get id(){return this.serverSession?.id}get serverSession(){let e=this._serverSession;if(null==e){if(this.explicit)throw new o.MongoRuntimeError("Unexpected null serverSession for an explicit session");if(this.hasEnded)throw new o.MongoRuntimeError("Unexpected null serverSession for an ended implicit session");e=this.sessionPool.acquire(),this._serverSession=e}return e}get loadBalanced(){return this.client.topology?.description.type===h.TopologyType.LoadBalanced}pin(e){if(this.pinnedConnection)throw TypeError("Cannot pin multiple connections to the same session");this.pinnedConnection=e,e.emit(r.PINNED,this.inTransaction()?t.ConnectionPoolMetrics.TXN:t.ConnectionPoolMetrics.CURSOR)}unpin(e){if(this.loadBalanced)return _(this,e);this.transaction.unpinServer()}get isPinned(){return this.loadBalanced?!!this.pinnedConnection:this.transaction.isPinned}async endSession(e){try{this.inTransaction()&&await this.abortTransaction({...e,throwTimeout:!0})}catch(e){if("MongoOperationTimeoutError"===e.name)throw e;(0,f.squashError)(e)}finally{if(!this.hasEnded){const e=this.serverSession;null!=e&&(this.sessionPool.release(e),this._serverSession=new C(e)),this.hasEnded=!0,this.emit("ended",this)}_(this,{force:!0,...e})}}async asyncDispose(){await this.endSession({force:!0})}advanceOperationTime(e){null!=this.operationTime?e.greaterThan(this.operationTime)&&(this.operationTime=e):this.operationTime=e}advanceClusterTime(e){if(!e||"object"!=typeof e)throw new o.MongoInvalidArgumentError("input cluster time must be an object");if(!e.clusterTime||"Timestamp"!==e.clusterTime._bsontype)throw new o.MongoInvalidArgumentError('input cluster time "clusterTime" property must be a valid BSON Timestamp');if(!e.signature||"Binary"!==e.signature.hash?._bsontype||"bigint"!=typeof e.signature.keyId&&"number"!=typeof e.signature.keyId&&"Long"!==e.signature.keyId?._bsontype)throw new o.MongoInvalidArgumentError('input cluster time must have a valid "signature" property with BSON Binary hash and BSON Long keyId');(0,h._advanceClusterTime)(this,e)}equals(e){return e instanceof y&&(null!=this.id&&null!=e.id&&f.ByteUtils.equals(this.id.id.buffer,e.id.id.buffer))}incrementTransactionNumber(){this.txnNumberIncrement+=1}inTransaction(){return this.transaction.isActive}startTransaction(e){if(this.snapshotEnabled)throw new o.MongoCompatibilityError("Transactions are not supported in snapshot sessions");if(this.inTransaction())throw new o.MongoTransactionError("Transaction already in progress");this.isPinned&&this.transaction.isCommitted&&this.unpin();const t=(0,f.maxWireVersion)(this.client.topology);if((0,n.isSharded)(this.client.topology)&&null!=t&&t<8)throw new o.MongoCompatibilityError("Transactions are not supported on sharded clusters in MongoDB < 4.2.");this.commitAttempted=!1,this.incrementTransactionNumber(),this.transaction=new d.Transaction({readConcern:e?.readConcern??this.defaultTransactionOptions.readConcern??this.clientOptions?.readConcern,writeConcern:e?.writeConcern??this.defaultTransactionOptions.writeConcern??this.clientOptions?.writeConcern,readPreference:e?.readPreference??this.defaultTransactionOptions.readPreference??this.clientOptions?.readPreference,maxCommitTimeMS:e?.maxCommitTimeMS??this.defaultTransactionOptions.maxCommitTimeMS}),this.transaction.transition(d.TxnState.STARTING_TRANSACTION)}async commitTransaction(e){if(this.transaction.state===d.TxnState.NO_TRANSACTION)throw new o.MongoTransactionError("No transaction started");if(this.transaction.state===d.TxnState.STARTING_TRANSACTION||this.transaction.state===d.TxnState.TRANSACTION_COMMITTED_EMPTY)return void this.transaction.transition(d.TxnState.TRANSACTION_COMMITTED_EMPTY);if(this.transaction.state===d.TxnState.TRANSACTION_ABORTED)throw new o.MongoTransactionError("Cannot call commitTransaction after calling abortTransaction");const t={commitTransaction:1},n="number"==typeof e?.timeoutMS?e.timeoutMS:"number"==typeof this.timeoutMS?this.timeoutMS:null,r=this.transaction.options.writeConcern??this.clientOptions?.writeConcern;if(null!=r)if(null==n&&null==this.timeoutContext)m.WriteConcern.apply(t,{wtimeoutMS:1e4,w:"majority",...r});else{const e=Object.keys(r);(e.length>2||!e.includes("wtimeoutMS")&&!e.includes("wTimeoutMS"))&&m.WriteConcern.apply(t,{...r,wtimeoutMS:void 0})}(this.transaction.state===d.TxnState.TRANSACTION_COMMITTED||this.commitAttempted)&&(null==n&&null==this.timeoutContext?m.WriteConcern.apply(t,{wtimeoutMS:1e4,...r,w:"majority"}):m.WriteConcern.apply(t,{w:"majority",...r,wtimeoutMS:void 0})),"number"==typeof this.transaction.options.maxTimeMS&&(t.maxTimeMS=this.transaction.options.maxTimeMS),this.transaction.recoveryToken&&(t.recoveryToken=this.transaction.recoveryToken);const i=new u.RunAdminCommandOperation(t,{session:this,readPreference:c.ReadPreference.primary,bypassPinningCheck:!0}),a=this.timeoutContext??("number"==typeof n?p.TimeoutContext.create({serverSelectionTimeoutMS:this.clientOptions.serverSelectionTimeoutMS,socketTimeoutMS:this.clientOptions.socketTimeoutMS,timeoutMS:n}):null);try{return await(0,s.executeOperation)(this.client,i,a),void(this.commitAttempted=void 0)}catch(e){if(this.commitAttempted=!0,e instanceof o.MongoError&&(0,o.isRetryableWriteError)(e)){m.WriteConcern.apply(t,{wtimeoutMS:1e4,...r,w:"majority"}),this.unpin({force:!0});try{return void await(0,s.executeOperation)(this.client,new u.RunAdminCommandOperation(t,{session:this,readPreference:c.ReadPreference.primary,bypassPinningCheck:!0}),a)}catch(e){throw A(e)&&e.addErrorLabel(o.MongoErrorLabel.UnknownTransactionCommitResult),E(e)&&this.unpin({error:e}),e}}throw A(e)&&e.addErrorLabel(o.MongoErrorLabel.UnknownTransactionCommitResult),E(e)&&this.unpin({error:e}),e}finally{this.transaction.transition(d.TxnState.TRANSACTION_COMMITTED)}}async abortTransaction(e){if(this.transaction.state===d.TxnState.NO_TRANSACTION)throw new o.MongoTransactionError("No transaction started");if(this.transaction.state===d.TxnState.STARTING_TRANSACTION)return void this.transaction.transition(d.TxnState.TRANSACTION_ABORTED);if(this.transaction.state===d.TxnState.TRANSACTION_ABORTED)throw new o.MongoTransactionError("Cannot call abortTransaction twice");if(this.transaction.state===d.TxnState.TRANSACTION_COMMITTED||this.transaction.state===d.TxnState.TRANSACTION_COMMITTED_EMPTY)throw new o.MongoTransactionError("Cannot call abortTransaction after calling commitTransaction");const t={abortTransaction:1},n="number"==typeof e?.timeoutMS?e.timeoutMS:this.timeoutContext?.csotEnabled()?this.timeoutContext.timeoutMS:"number"==typeof this.timeoutMS?this.timeoutMS:null,r=null!=n?p.TimeoutContext.create({timeoutMS:n,serverSelectionTimeoutMS:this.clientOptions.serverSelectionTimeoutMS,socketTimeoutMS:this.clientOptions.socketTimeoutMS}):null,i=this.transaction.options.writeConcern??this.clientOptions?.writeConcern;null!=i&&null==n&&m.WriteConcern.apply(t,{wtimeoutMS:1e4,w:"majority",...i}),this.transaction.recoveryToken&&(t.recoveryToken=this.transaction.recoveryToken);const a=new u.RunAdminCommandOperation(t,{session:this,readPreference:c.ReadPreference.primary,bypassPinningCheck:!0});try{return await(0,s.executeOperation)(this.client,a,r),void this.unpin()}catch(t){if(this.unpin(),"MongoRuntimeError"===t.name)throw t;if(e?.throwTimeout&&"MongoOperationTimeoutError"===t.name)throw t;if(t instanceof o.MongoError&&(0,o.isRetryableWriteError)(t))try{return void await(0,s.executeOperation)(this.client,a,r)}catch(t){if("MongoRuntimeError"===t.name)throw t;if(e?.throwTimeout&&"MongoOperationTimeoutError"===t.name)throw t}}finally{this.transaction.transition(d.TxnState.TRANSACTION_ABORTED),this.loadBalanced&&_(this,{force:!1})}}toBSON(){throw new o.MongoRuntimeError("ClientSession cannot be serialized to BSON.")}async withTransaction(e,t){const n=12e4,r=t?.timeoutMS??this.timeoutMS??null;this.timeoutContext=null!=r?p.TimeoutContext.create({timeoutMS:r,serverSelectionTimeoutMS:this.clientOptions.serverSelectionTimeoutMS,socketTimeoutMS:this.clientOptions.socketTimeoutMS}):null;const i=this.timeoutContext?.csotEnabled()?this.timeoutContext.start:(0,f.now)();let s,u=!1;try{for(;!u;){this.startTransaction(t);try{const t=e(this);if(!(0,f.isPromiseLike)(t))throw new o.MongoInvalidArgumentError("Function provided to `withTransaction` must return a Promise");if(s=await t,this.transaction.state===d.TxnState.NO_TRANSACTION||this.transaction.state===d.TxnState.TRANSACTION_COMMITTED||this.transaction.state===d.TxnState.TRANSACTION_ABORTED)return s}catch(e){if(!(e instanceof o.MongoError)||e instanceof o.MongoInvalidArgumentError)throw await this.abortTransaction(),e;if(this.transaction.state!==d.TxnState.STARTING_TRANSACTION&&this.transaction.state!==d.TxnState.TRANSACTION_IN_PROGRESS||await this.abortTransaction(),e.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError)&&(null!=this.timeoutContext||(0,f.now)()-i<n))continue;throw e}for(;!u;)try{await this.commitTransaction(),u=!0}catch(e){if(!O(e)&&e.hasErrorLabel(o.MongoErrorLabel.UnknownTransactionCommitResult)&&(null!=this.timeoutContext||(0,f.now)()-i<n))continue;if(e.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError)&&(null!=this.timeoutContext||(0,f.now)()-i<n))break;throw e}}return s}finally{this.timeoutContext=null}}}ci.ClientSession=y,(0,l.configureResourceManagement)(y.prototype);const g=new Set(["CannotSatisfyWriteConcern","UnknownReplWriteConcern","UnsatisfiableWriteConcern"]);function E(e){if(e instanceof o.MongoError)if((0,o.isRetryableWriteError)(e)||e instanceof o.MongoWriteConcernError||O(e)){if(b(e))return!0}else if(e.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError))return!0;return!1}function A(e){let t=(0,o.isRetryableWriteError)(e);return t||=e instanceof o.MongoWriteConcernError,t||=O(e),t&&=b(e),t}function b(e){const t=e instanceof o.MongoServerError&&e.codeName&&g.has(e.codeName);return O(e)||!t&&e.code!==o.MONGODB_ERROR_CODES.UnsatisfiableWriteConcern&&e.code!==o.MONGODB_ERROR_CODES.UnknownReplWriteConcern}function _(e,n){const i=e.pinnedConnection,s=n?.error;if(e.inTransaction()&&s&&s instanceof o.MongoError&&s.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError))return;const u=e.client.topology;if(i&&null!=u){const o=Array.from(u.s.servers.values())[0];(null==n?.error||n?.force)&&(o.pool.checkIn(i),e.pinnedConnection=void 0,i.emit(r.UNPINNED,e.transaction.state!==d.TxnState.NO_TRANSACTION?t.ConnectionPoolMetrics.TXN:t.ConnectionPoolMetrics.CURSOR),n?.forceClear&&o.pool.clear({serviceId:i.serviceId}))}}function O(e){return null!=e&&e instanceof o.MongoServerError&&(e.code===o.MONGODB_ERROR_CODES.MaxTimeMSExpired||e.writeConcernError?.code===o.MONGODB_ERROR_CODES.MaxTimeMSExpired)}class C{constructor(t){if(null!=t){const n=Buffer.allocUnsafe(16);return n.set(t.id.id.buffer),this.id={id:new e.Binary(n,t.id.id.sub_type)},this.lastUse=t.lastUse,this.txnNumber=t.txnNumber,void(this.isDirty=t.isDirty)}this.id={id:new e.Binary((0,f.uuidV4)(),e.Binary.SUBTYPE_UUID)},this.lastUse=(0,f.now)(),this.txnNumber=0,this.isDirty=!1}hasTimedOut(e){return Math.round((0,f.calculateDurationInMs)(this.lastUse)%864e5%36e5/6e4)>e-1}}ci.ServerSession=C;class w{constructor(e){if(null==e)throw new o.MongoRuntimeError("ServerSessionPool requires a MongoClient");this.client=e,this.sessions=new f.List}acquire(){const e=this.client.topology?.logicalSessionTimeoutMinutes??10;let t=null;for(;this.sessions.length>0;){const n=this.sessions.shift();if(null!=n&&(this.client.topology?.loadBalanced||!n.hasTimedOut(e))){t=n;break}}return null==t&&(t=new C),t}release(e){const t=this.client.topology?.logicalSessionTimeoutMinutes??10;if(this.client.topology?.loadBalanced&&!t&&this.sessions.unshift(e),t&&(this.sessions.prune((e=>e.hasTimedOut(t))),!e.hasTimedOut(t))){if(e.isDirty)return;this.sessions.unshift(e)}}}return ci.ServerSessionPool=w,ci}var vi,Di={};function Mi(){return vi||(vi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SENSITIVE_COMMANDS=e.CommandFailedEvent=e.CommandSucceededEvent=e.CommandStartedEvent=void 0;const t=z(),n=fe(),r=So();e.CommandStartedEvent=class{constructor(n,r,o){this.name=t.COMMAND_STARTED;const s=l(r),a=i(s),{address:c,connectionId:p,serviceId:d}=h(n);e.SENSITIVE_COMMANDS.has(a)&&(this.commandObj={},this.commandObj[a]=!0),this.address=c,this.connectionId=p,this.serviceId=d,this.requestId=r.requestId,this.databaseName=r.databaseName,this.commandName=a,this.command=u(a,s,s),this.serverConnectionId=o}get hasServiceId(){return!!this.serviceId}};e.CommandSucceededEvent=class{constructor(e,r,o,s,a){this.name=t.COMMAND_SUCCEEDED;const c=l(r),p=i(c),{address:d,connectionId:f,serviceId:m}=h(e);this.address=d,this.connectionId=f,this.serviceId=m,this.requestId=r.requestId,this.commandName=p,this.duration=(0,n.calculateDurationInMs)(s),this.reply=u(p,c,function(e){if(!e)return e;return e.result?e.result:e}(o)),this.serverConnectionId=a}get hasServiceId(){return!!this.serviceId}};e.CommandFailedEvent=class{constructor(e,r,o,s,a){this.name=t.COMMAND_FAILED;const c=l(r),p=i(c),{address:d,connectionId:f,serviceId:m}=h(e);this.address=d,this.connectionId=f,this.serviceId=m,this.requestId=r.requestId,this.commandName=p,this.duration=(0,n.calculateDurationInMs)(s),this.failure=u(p,c,o),this.serverConnectionId=a}get hasServiceId(){return!!this.serviceId}},e.SENSITIVE_COMMANDS=new Set(["authenticate","saslStart","saslContinue","getnonce","createUser","updateUser","copydbgetnonce","copydbsaslstart","copydb"]);const o=new Set(["hello",t.LEGACY_HELLO_COMMAND,t.LEGACY_HELLO_COMMAND_CAMEL_CASE]),i=e=>Object.keys(e)[0],s=e=>e.ns.split(".")[1],u=(t,n,r)=>e.SENSITIVE_COMMANDS.has(t)||o.has(t)&&n.speculativeAuthenticate?{}:r,a={$query:"filter",$orderby:"sort",$hint:"hint",$comment:"comment",$maxScan:"maxScan",$max:"max",$min:"min",$returnKey:"returnKey",$showDiskLoc:"showRecordId",$maxTimeMS:"maxTimeMS",$snapshot:"snapshot"},c={numberToSkip:"skip",numberToReturn:"batchSize",returnFieldSelector:"projection"};function l(e){if(e instanceof r.OpMsgRequest){const t={...e.command};return t.ops instanceof r.DocumentSequence&&(t.ops=t.ops.documents),t.nsInfo instanceof r.DocumentSequence&&(t.nsInfo=t.nsInfo.documents),t}if(e.query?.$query){let t;return"admin.$cmd"===e.ns?t=Object.assign({},e.query.$query):(t={find:s(e)},Object.keys(a).forEach((n=>{null!=e.query[n]&&(t[a[n]]={...e.query[n]})}))),Object.keys(c).forEach((n=>{const r=n;null!=e[r]&&(t[c[r]]=e[r])})),t}let t={};const n={...e};return e.query&&(t={...e.query},n.query=t),e.query?t:n}function h(e){let t;return"id"in e&&(t=e.id),{address:e.address,serviceId:e.serviceId,connectionId:t}}}(Di)),Di}var Ti,Bi={};var Fi,$i,xi,Pi={};function Ni(){if($i)return ai;$i=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.CryptoConnection=ai.SizedMessageTransform=ai.Connection=void 0,ai.hasSessionSupport=function(e){const t=e.description;return null!=t.logicalSessionTimeoutMinutes};const t=e,n=s,r=F(),o=z(),i=P(),u=me(),a=ye(),c=Z(),l=ne(),h=Si(),p=Ce(),d=fe(),f=Mi(),m=So(),y=function(){if(Ti)return Bi;Ti=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.StreamDescription=void 0;const e=F(),t=ne(),n=Ei(),r=["minWireVersion","maxWireVersion","maxBsonObjectSize","maxMessageSizeBytes","maxWriteBatchSize","logicalSessionTimeoutMinutes"];return Bi.StreamDescription=class{constructor(e,n){this.hello=null,this.address=e,this.type=t.ServerType.Unknown,this.minWireVersion=void 0,this.maxWireVersion=void 0,this.maxBsonObjectSize=16777216,this.maxMessageSizeBytes=48e6,this.maxWriteBatchSize=1e5,this.logicalSessionTimeoutMinutes=n?.logicalSessionTimeoutMinutes,this.loadBalanced=!!n?.loadBalanced,this.compressors=n&&n.compressors&&Array.isArray(n.compressors)?n.compressors:[],this.serverConnectionId=null}receiveResponse(e){if(null!=e){this.hello=e,this.type=(0,n.parseServerType)(e),this.serverConnectionId="connectionId"in e?this.parseServerConnectionID(e.connectionId):null;for(const t of r)null!=e[t]&&(this[t]=e[t]),"__nodejs_mock_server__"in e&&(this.__nodejs_mock_server__=e.__nodejs_mock_server__);e.compression&&(this.compressor=this.compressors.filter((t=>e.compression?.includes(t)))[0])}}parseServerConnectionID(t){return e.Long.isLong(t)?t.toBigInt():BigInt(t)}},Bi}(),g=vo(),E=function(){if(Fi)return Pi;Fi=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.onData=function(t,{timeoutContext:n,signal:r}){r?.throwIfAborted();const o=new e.List,i=new e.List;let s=null,u=!1;const a={next(){const t=o.shift();if(null!=t)return Promise.resolve({value:t,done:!1});if(null!=s){const e=Promise.reject(s);return s=null,e}if(u)return d();const{promise:n,resolve:r,reject:a}=(0,e.promiseWithResolvers)();return i.push({resolve:r,reject:a}),n},return:()=>d(),throw:e=>(p(e),Promise.resolve({value:void 0,done:!0})),[Symbol.asyncIterator](){return this}};t.on("data",h),t.on("error",p);const c=(0,e.addAbortListener)(r,(function(){p(this.reason)})),l=n?.timeoutForSocketRead;return l?.throwIfExpired(),l?.then(void 0,p),a;function h(e){const t=i.shift();null!=t?t.resolve({value:e,done:!1}):o.push(e)}function p(e){const t=i.shift();null!=t?t.reject(e):s=e,d()}function d(){t.off("data",h),t.off("error",p),c?.[e.kDispose](),u=!0,l?.clear();const n={value:void 0,done:u};for(const e of i)e.resolve(n);return Promise.resolve(n)}};const e=fe();return Pi}(),A=pe(),b=bi();class _ extends a.TypedEventEmitter{constructor(e,t){super(),this.lastHelloMS=-1,this.helloOk=!1,this.delayedTimeoutId=null,this.closed=!1,this.clusterTime=null,this.error=null,this.dataEvents=null,this.on("error",d.noop),this.socket=e,this.id=t.id,this.address=function(e,t){if(t.proxyHost)return t.hostAddress.toString();const{remoteAddress:n,remotePort:r}=e;return"string"==typeof n&&"number"==typeof r?d.HostAddress.fromHostPort(n,r).toString():(0,d.uuidV4)().toString("hex")}(e,t),this.socketTimeoutMS=t.socketTimeoutMS??0,this.monitorCommands=t.monitorCommands,this.serverApi=t.serverApi,this.mongoLogger=t.mongoLogger,this.established=!1,this.description=new y.StreamDescription(this.address,t),this.generation=t.generation,this.lastUseTime=(0,d.now)(),this.messageStream=this.socket.on("error",this.onError.bind(this)).pipe(new O({connection:this})).on("error",this.onError.bind(this)),this.socket.on("close",this.onClose.bind(this)),this.socket.on("timeout",this.onTimeout.bind(this)),this.messageStream.pause()}get hello(){return this.description.hello}set hello(e){this.description.receiveResponse(e),Object.freeze(this.description)}get serviceId(){return this.hello?.serviceId}get loadBalanced(){return this.description.loadBalanced}get idleTime(){return(0,d.calculateDurationInMs)(this.lastUseTime)}get hasSessionSupport(){return null!=this.description.logicalSessionTimeoutMinutes}get supportsOpMsg(){return null!=this.description&&(0,d.maxWireVersion)(this)>=6&&!this.description.__nodejs_mock_server__}get shouldEmitAndLogCommand(){return(this.monitorCommands||this.established&&!this.authContext?.reauthenticating&&this.mongoLogger?.willLog(u.MongoLoggableComponent.COMMAND,u.SeverityLevel.DEBUG))??!1}markAvailable(){this.lastUseTime=(0,d.now)()}onError(e){this.cleanup(e)}onClose(){const e=`connection ${this.id} to ${this.address} closed`;this.cleanup(new i.MongoNetworkError(e))}onTimeout(){this.delayedTimeoutId=(0,n.setTimeout)((()=>{const e=`connection ${this.id} to ${this.address} timed out`,t=null==this.hello;this.cleanup(new i.MongoNetworkTimeoutError(e,{beforeHandshake:t}))}),1).unref()}destroy(){if(this.closed)return;this.removeAllListeners(_.PINNED),this.removeAllListeners(_.UNPINNED);const e=`connection ${this.id} to ${this.address} closed`;this.cleanup(new i.MongoNetworkError(e))}cleanup(e){this.closed||(this.socket.destroy(),this.error=e,this.dataEvents?.throw(e).then(void 0,d.squashError),this.closed=!0,this.emit(_.CLOSE))}prepareCommand(e,t,n){let r={...t};const o=(0,b.getReadPreference)(n),s=n?.session;let u=this.clusterTime;if(this.serverApi){const{version:e,strict:t,deprecationErrors:n}=this.serverApi;r.apiVersion=e,null!=t&&(r.apiStrict=t),null!=n&&(r.apiDeprecationErrors=n)}if(this.hasSessionSupport&&s){s.clusterTime&&u&&s.clusterTime.clusterTime.greaterThan(u.clusterTime)&&(u=s.clusterTime);const e=(0,h.applySession)(s,r,n);if(e)throw e}else if(s?.explicit)throw new i.MongoCompatibilityError("Current topology does not support sessions");u&&(r.$clusterTime=u),this.description.type!==l.ServerType.Standalone&&((0,b.isSharded)(this)||this.description.loadBalanced||!this.supportsOpMsg||!0!==n.directConnection||"primary"!==o?.mode?(0,b.isSharded)(this)&&!this.supportsOpMsg&&"primary"!==o?.mode?r={$query:r,$readPreference:o.toJSON()}:"primary"!==o?.mode&&(r.$readPreference=o.toJSON()):r.$readPreference=c.ReadPreference.primaryPreferred.toJSON());const a={numberToSkip:0,numberToReturn:-1,checkKeys:!1,secondaryOk:o.secondaryOk(),...n};n.timeoutContext?.addMaxTimeMSToCommand(r,n);return this.supportsOpMsg?new m.OpMsgRequest(e,r,a):new m.OpQueryRequest(e,r,a)}async*sendWire(e,t,n){this.throwIfAborted();const r=t.socketTimeoutMS??t?.timeoutContext?.getSocketTimeoutMS()??this.socketTimeoutMS;this.socket.setTimeout(r);try{if(await this.writeCommand(e,{agreedCompressor:this.description.compressor??"none",zlibCompressionLevel:this.description.zlibCompressionLevel,timeoutContext:t.timeoutContext,signal:t.signal}),t.noResponse||e.moreToCome)return void(yield A.MongoDBResponse.empty);if(this.throwIfAborted(),t.timeoutContext?.csotEnabled()&&null!=t.timeoutContext.minRoundTripTime&&t.timeoutContext.remainingTimeMS<t.timeoutContext.minRoundTripTime)throw new i.MongoOperationTimeoutError("Server roundtrip time is greater than the time remaining");for await(const e of this.readMany(t)){this.socket.setTimeout(0);const t=e.parse(),o=(n??A.MongoDBResponse).make(t);yield o,this.throwIfAborted(),this.socket.setTimeout(r)}}finally{this.socket.setTimeout(0)}}async*sendCommand(e,t,n,r){n?.signal?.throwIfAborted();const o=this.prepareCommand(e.db,t,n);let s=0;this.shouldEmitAndLogCommand&&(s=(0,d.now)(),this.emitAndLogCommand(this.monitorCommands,_.COMMAND_STARTED,o.databaseName,this.established,new f.CommandStartedEvent(this,o,this.description.serverConnectionId)));const u=null!=n.documentsReturnedIn&&n.raw?{...n,raw:!1,fieldsAsRaw:{[n.documentsReturnedIn]:!0}}:n;let a,c;try{for await(a of(this.throwIfAborted(),this.sendWire(o,n,r))){if(c=void 0,null!=n.session&&(0,h.updateSessionFromResponse)(n.session,a),a.$clusterTime&&(this.clusterTime=a.$clusterTime,this.emit(_.CLUSTER_TIME_RECEIVED,a.$clusterTime)),0===a.ok){if(n.timeoutContext?.csotEnabled()&&a.isMaxTimeExpiredError)throw new i.MongoOperationTimeoutError("Server reported a timeout error",{cause:new i.MongoServerError(c??=a.toObject(u))});throw new i.MongoServerError(c??=a.toObject(u))}this.shouldEmitAndLogCommand&&this.emitAndLogCommand(this.monitorCommands,_.COMMAND_SUCCEEDED,o.databaseName,this.established,new f.CommandSucceededEvent(this,o,n.noResponse?void 0:o.moreToCome?{ok:1}:c??=a.toObject(u),s,this.description.serverConnectionId)),null==r?yield c??=a.toObject(u):yield a,this.throwIfAborted()}}catch(e){throw this.shouldEmitAndLogCommand&&this.emitAndLogCommand(this.monitorCommands,_.COMMAND_FAILED,o.databaseName,this.established,new f.CommandFailedEvent(this,o,e,s,this.description.serverConnectionId)),e}}async command(e,t,n={},r){this.throwIfAborted(),n.signal?.throwIfAborted();for await(const o of this.sendCommand(e,t,n,r)){if(n.timeoutContext?.csotEnabled())if(A.MongoDBResponse.is(o)){if(o.isMaxTimeExpiredError)throw new i.MongoOperationTimeoutError("Server reported a timeout error",{cause:new i.MongoServerError(o.toObject())})}else if(Array.isArray(o?.writeErrors)&&o.writeErrors.some((e=>e?.code===i.MONGODB_ERROR_CODES.MaxTimeMSExpired))||o?.writeConcernError?.code===i.MONGODB_ERROR_CODES.MaxTimeMSExpired)throw new i.MongoOperationTimeoutError("Server reported a timeout error",{cause:new i.MongoServerError(o)});return o}throw new i.MongoUnexpectedServerResponseError("Unable to get response from server")}exhaustCommand(e,t,n,r){(async()=>{this.throwIfAborted();for await(const o of this.sendCommand(e,t,n))r(void 0,o),this.throwIfAborted();throw new i.MongoUnexpectedServerResponseError("Server ended moreToCome unexpectedly")})().then(void 0,r)}throwIfAborted(){if(this.error)throw this.error}async writeCommand(e,t){const n="none"!==t.agreedCompressor&&m.OpCompressedRequest.canCompress(e)?new m.OpCompressedRequest(e,{agreedCompressor:t.agreedCompressor??"none",zlibCompressionLevel:t.zlibCompressionLevel??0}):e,r=Buffer.concat(await n.toBin());if(t.timeoutContext?.csotEnabled()&&null!=t.timeoutContext.minRoundTripTime&&t.timeoutContext.remainingTimeMS<t.timeoutContext.minRoundTripTime)throw new i.MongoOperationTimeoutError("Server roundtrip time is greater than the time remaining");if(this.socket.write(r))return;const o=(0,d.once)(this.socket,"drain",t),s=t?.timeoutContext?.timeoutForSocketWrite,u=s?Promise.race([o,s]):o;try{return await u}catch(e){if(p.TimeoutError.is(e)){const e=new i.MongoOperationTimeoutError("Timed out at socket write");throw this.onError(e),e}throw e===t.signal?.reason&&this.onError(e),e}finally{s?.clear()}}async*readMany(e){try{this.dataEvents=(0,E.onData)(this.messageStream,e),this.messageStream.resume();for await(const e of this.dataEvents){const t=await(0,g.decompressResponse)(e);if(yield t,!t.moreToCome)return}}catch(t){if(p.TimeoutError.is(t)){const e=new i.MongoOperationTimeoutError(`Timed out during socket read (${t.duration}ms)`);throw this.dataEvents=null,this.onError(e),e}throw t===e.signal?.reason&&this.onError(t),t}finally{this.dataEvents=null,this.messageStream.pause(),this.throwIfAborted()}}}ai.Connection=_,_.COMMAND_STARTED=o.COMMAND_STARTED,_.COMMAND_SUCCEEDED=o.COMMAND_SUCCEEDED,_.COMMAND_FAILED=o.COMMAND_FAILED,_.CLUSTER_TIME_RECEIVED=o.CLUSTER_TIME_RECEIVED,_.CLOSE=o.CLOSE,_.PINNED=o.PINNED,_.UNPINNED=o.UNPINNED;class O extends t.Transform{constructor({connection:e}){super({writableObjectMode:!1,readableObjectMode:!0}),this.bufferPool=new d.BufferPool,this.connection=e}_transform(e,t,r){null!=this.connection.delayedTimeoutId&&((0,n.clearTimeout)(this.connection.delayedTimeoutId),this.connection.delayedTimeoutId=null),this.bufferPool.append(e);const o=this.bufferPool.getInt32();if(null==o)return r();if(o<0)return r(new i.MongoParseError(`Invalid message size: ${o}, too small`));if(o>this.bufferPool.length)return r();return r(null,this.bufferPool.read(o))}}ai.SizedMessageTransform=O;return ai.CryptoConnection=class extends _{constructor(e,t){super(e,t),this.autoEncrypter=t.autoEncrypter}async command(e,t,n,s){const{autoEncrypter:u}=this;if(!u)throw new i.MongoMissingDependencyError("No AutoEncrypter available for encryption",{dependencyName:"n/a"});const a=(0,d.maxWireVersion)(this);if(0===a)return await super.command(e,t,n,s);if(a<8)throw new i.MongoCompatibilityError("Auto-encryption requires a minimum MongoDB version of 4.2");const c=t.find||t.findAndModify?t.sort:null,l=t.createIndexes?t.indexes.map((e=>e.key)):null,h=await u.encrypt(e.toString(),t,n);if(null!=c&&(t.find||t.findAndModify)&&(h.sort=c),null!=l&&t.createIndexes)for(const[e,t]of l.entries())h.indexes[e].key=t;const p=await super.command(e,h,n,s??A.MongoDBResponse),f=await u.decrypt(p.toBytes(),n),m=s?.make(f)??(0,r.deserialize)(f,n);return u[o.kDecorateResult]&&(null==s?(0,d.decorateDecryptionResult)(m,p.toObject(),!0):m instanceof A.CursorResponse&&(m.encryptedResponse=p)),m}},ai}function Ii(){return xi||(xi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LEGAL_TCP_SOCKET_OPTIONS=e.LEGAL_TLS_SOCKET_OPTIONS=void 0,e.connect=async function(e){let t=null;try{return t=h(e,await g(e)),await d(t,e),t}catch(e){throw t?.destroy(),e}},e.makeConnection=h,e.performInitialHandshake=d,e.prepareHandshakeDocument=m,e.makeSocket=g;const t=p,n=f,r=z(),o=Ln(),i=P(),s=fe(),u=Wn(),a=Yn(),c=Ni(),l=H();function h(e,t){let n=e.connectionType??c.Connection;return e.autoEncrypter&&(n=c.CryptoConnection),new n(t,e)}async function d(e,t){const n=t.credentials;if(n&&n.mechanism!==a.AuthMechanism.MONGODB_DEFAULT&&!t.authProviders.getOrCreateProvider(n.mechanism,n.mechanismProperties))throw new i.MongoInvalidArgumentError(`AuthMechanism '${n.mechanism}' not supported`);const o=new u.AuthContext(e,n,t);e.authContext=o;const c=await m(o),h={...t,raw:!1};"number"==typeof t.connectTimeoutMS&&(h.socketTimeoutMS=t.connectTimeoutMS);const p=(new Date).getTime(),d=await async function(t,n){try{return await e.command((0,s.ns)("admin.$cmd"),t,n)}catch(e){throw e instanceof i.MongoError&&e.addErrorLabel(i.MongoErrorLabel.HandshakeError),e}}(c,h);"isWritablePrimary"in d||(d.isWritablePrimary=d[r.LEGACY_HELLO_COMMAND]),d.helloOk&&(e.helloOk=!0);const f=function(e,t){const n=Number(e.maxWireVersion),r=Number(e.minWireVersion),o=!Number.isNaN(n)&&n>=l.MIN_SUPPORTED_WIRE_VERSION,s=!Number.isNaN(r)&&r<=l.MAX_SUPPORTED_WIRE_VERSION;if(o){if(s)return null;const n=`Server at ${t.hostAddress} reports minimum wire version ${JSON.stringify(e.minWireVersion)}, but this version of the Node.js Driver requires at most ${l.MAX_SUPPORTED_WIRE_VERSION} (MongoDB ${l.MAX_SUPPORTED_SERVER_VERSION})`;return new i.MongoCompatibilityError(n)}const u=`Server at ${t.hostAddress} reports maximum wire version ${JSON.stringify(e.maxWireVersion)??0}, but this version of the Node.js Driver requires at least ${l.MIN_SUPPORTED_WIRE_VERSION} (MongoDB ${l.MIN_SUPPORTED_SERVER_VERSION})`;return new i.MongoCompatibilityError(u)}(d,t);if(f)throw f;if(t.loadBalanced&&!d.serviceId)throw new i.MongoCompatibilityError("Driver attempted to initialize in load balancing mode, but the server does not support this mode.");if(e.hello=d,e.lastHelloMS=(new Date).getTime()-p,!d.arbiterOnly&&n){o.response=d;const r=n.resolveAuthMechanism(d),s=t.authProviders.getOrCreateProvider(r.mechanism,r.mechanismProperties);if(!s)throw new i.MongoInvalidArgumentError(`No AuthProvider for ${r.mechanism} defined.`);try{await s.auth(o)}catch(t){throw t instanceof i.MongoError&&(t.addErrorLabel(i.MongoErrorLabel.HandshakeError),(0,i.needsRetryableWriteLabel)(t,d.maxWireVersion,e.description.type)&&t.addErrorLabel(i.MongoErrorLabel.RetryableWriteError)),t}}e.established=!0}async function m(e){const t=e.options,n=t.compressors?t.compressors:[],{serverApi:o}=e.connection,s=await t.extendedMetadata,u={[o?.version||!0===t.loadBalanced?"hello":r.LEGACY_HELLO_COMMAND]:1,helloOk:!0,client:s,compression:n};!0===t.loadBalanced&&(u.loadBalanced=!0);const c=e.credentials;if(c){if(c.mechanism===a.AuthMechanism.MONGODB_DEFAULT&&c.username){u.saslSupportedMechs=`${c.source}.${c.username}`;const t=e.options.authProviders.getOrCreateProvider(a.AuthMechanism.MONGODB_SCRAM_SHA256,c.mechanismProperties);if(!t)throw new i.MongoInvalidArgumentError(`No AuthProvider for ${a.AuthMechanism.MONGODB_SCRAM_SHA256} defined.`);return await t.prepare(u,e)}const t=e.options.authProviders.getOrCreateProvider(c.mechanism,c.mechanismProperties);if(!t)throw new i.MongoInvalidArgumentError(`No AuthProvider for ${c.mechanism} defined.`);return await t.prepare(u,e)}return u}function y(t){const n=t.hostAddress;if(!n)throw new i.MongoInvalidArgumentError('Option "hostAddress" is required');const r={};for(const n of e.LEGAL_TCP_SOCKET_OPTIONS)null!=t[n]&&(r[n]=t[n]);if("string"==typeof n.socketPath)return r.path=n.socketPath,r;if("string"==typeof n.host)return r.host=n.host,r.port=n.port,r;throw new i.MongoRuntimeError(`Unexpected HostAddress ${JSON.stringify(n)}`)}async function g(r){const u=r.tls??!1,a=r.noDelay??!0,c=r.connectTimeoutMS??3e4,l=r.existingSocket;let h;if(null!=r.proxyHost)return await async function(e){const t=s.HostAddress.fromHostPort(e.proxyHost??"",e.proxyPort??1080),n=await g({...e,hostAddress:t,tls:!1,proxyHost:void 0}),r=y(e);if("string"!=typeof r.host||"number"!=typeof r.port)throw new i.MongoInvalidArgumentError("Can only make Socks5 connections to TCP hosts");let u;E??=function(){if(null==E){const e=(0,o.getSocks)();if("kModuleError"in e)throw e.kModuleError;E=e}return E}();try{u=(await E.SocksClient.createConnection({existing_socket:n,timeout:e.connectTimeoutMS,command:"connect",destination:{host:r.host,port:r.port},proxy:{host:"iLoveJavaScript",port:0,type:5,userId:e.proxyUsername||void 0,password:e.proxyPassword||void 0}})).socket}catch(e){throw new i.MongoNetworkError(i.MongoError.buildErrorMessage(e),{cause:e})}return await g({...e,existingSocket:u,proxyHost:void 0})}({...r,connectTimeoutMS:c});if(u){const o=n.connect(function(n){const r=y(n);for(const t of e.LEGAL_TLS_SOCKET_OPTIONS)null!=n[t]&&(r[t]=n[t]);return n.existingSocket&&(r.socket=n.existingSocket),null==r.servername&&r.host&&!t.isIP(r.host)&&(r.servername=r.host),r}(r));"function"==typeof o.disableRenegotiation&&o.disableRenegotiation(),h=o}else h=l||t.createConnection(y(r));h.setKeepAlive(!0,3e5),h.setTimeout(c),h.setNoDelay(a);let p=null;const{promise:d,resolve:f,reject:m}=(0,s.promiseWithResolvers)();if(l)f(h);else{const e=performance.now(),t=u?"secureConnect":"connect";h.once(t,(()=>f(h))).once("error",(e=>m(new i.MongoNetworkError(i.MongoError.buildErrorMessage(e),{cause:e})))).once("timeout",(()=>{m(new i.MongoNetworkTimeoutError(`Socket '${t}' timed out after ${performance.now()-e|0}ms (connectTimeoutMS: ${c})`))})).once("close",(()=>m(new i.MongoNetworkError(`Socket closed after ${performance.now()-e|0} during connection establishment`)))),null!=r.cancellationToken&&(p=()=>m(new i.MongoNetworkError("Socket connection establishment was cancelled after "+(performance.now()-e|0))),r.cancellationToken.once("cancel",p))}try{return h=await d,h}catch(e){throw h.destroy(),e}finally{h.setTimeout(0),null!=p&&r.cancellationToken?.removeListener("cancel",p)}}e.LEGAL_TLS_SOCKET_OPTIONS=["allowPartialTrustChain","ALPNProtocols","ca","cert","checkServerIdentity","ciphers","crl","ecdhCurve","key","minDHSize","passphrase","pfx","rejectUnauthorized","secureContext","secureProtocol","servername","session"],e.LEGAL_TCP_SOCKET_OPTIONS=["autoSelectFamily","autoSelectFamilyAttemptTimeout","family","hints","localAddress","localPort","lookup"];let E=null}(ui)),ui}var Ri,ki={};function ji(){if(Ri)return ki;Ri=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.ServerHeartbeatFailedEvent=ki.ServerHeartbeatSucceededEvent=ki.ServerHeartbeatStartedEvent=ki.TopologyClosedEvent=ki.TopologyOpeningEvent=ki.TopologyDescriptionChangedEvent=ki.ServerClosedEvent=ki.ServerOpeningEvent=ki.ServerDescriptionChangedEvent=void 0;const e=z();ki.ServerDescriptionChangedEvent=class{constructor(t,n,r,o){this.name=e.SERVER_DESCRIPTION_CHANGED,this.topologyId=t,this.address=n,this.previousDescription=r,this.newDescription=o}};ki.ServerOpeningEvent=class{constructor(t,n){this.name=e.SERVER_OPENING,this.topologyId=t,this.address=n}};ki.ServerClosedEvent=class{constructor(t,n){this.name=e.SERVER_CLOSED,this.topologyId=t,this.address=n}};ki.TopologyDescriptionChangedEvent=class{constructor(t,n,r){this.name=e.TOPOLOGY_DESCRIPTION_CHANGED,this.topologyId=t,this.previousDescription=n,this.newDescription=r}};ki.TopologyOpeningEvent=class{constructor(t){this.name=e.TOPOLOGY_OPENING,this.topologyId=t}};ki.TopologyClosedEvent=class{constructor(t){this.name=e.TOPOLOGY_CLOSED,this.topologyId=t}};ki.ServerHeartbeatStartedEvent=class{constructor(t,n){this.name=e.SERVER_HEARTBEAT_STARTED,this.connectionId=t,this.awaited=n}};ki.ServerHeartbeatSucceededEvent=class{constructor(t,n,r,o){this.name=e.SERVER_HEARTBEAT_SUCCEEDED,this.connectionId=t,this.duration=n,this.reply=r??{},this.awaited=o}};return ki.ServerHeartbeatFailedEvent=class{constructor(t,n,r,o){this.name=e.SERVER_HEARTBEAT_FAILED,this.connectionId=t,this.duration=n,this.failure=r,this.awaited=o}},ki}var Li,Ui={},Vi={},zi={};function Wi(){if(Li)return zi;Li=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.ConnectionPoolClearedEvent=zi.ConnectionCheckedInEvent=zi.ConnectionCheckedOutEvent=zi.ConnectionCheckOutFailedEvent=zi.ConnectionCheckOutStartedEvent=zi.ConnectionClosedEvent=zi.ConnectionReadyEvent=zi.ConnectionCreatedEvent=zi.ConnectionPoolClosedEvent=zi.ConnectionPoolReadyEvent=zi.ConnectionPoolCreatedEvent=zi.ConnectionPoolMonitoringEvent=void 0;const e=z(),t=fe();class n{constructor(e){this.time=new Date,this.address=e.address}}zi.ConnectionPoolMonitoringEvent=n;zi.ConnectionPoolCreatedEvent=class extends n{constructor(t){super(t),this.name=e.CONNECTION_POOL_CREATED;const{maxConnecting:n,maxPoolSize:r,minPoolSize:o,maxIdleTimeMS:i,waitQueueTimeoutMS:s}=t.options;this.options={maxConnecting:n,maxPoolSize:r,minPoolSize:o,maxIdleTimeMS:i,waitQueueTimeoutMS:s}}};zi.ConnectionPoolReadyEvent=class extends n{constructor(t){super(t),this.name=e.CONNECTION_POOL_READY}};zi.ConnectionPoolClosedEvent=class extends n{constructor(t){super(t),this.name=e.CONNECTION_POOL_CLOSED}};zi.ConnectionCreatedEvent=class extends n{constructor(t,n){super(t),this.name=e.CONNECTION_CREATED,this.connectionId=n.id}};zi.ConnectionReadyEvent=class extends n{constructor(n,r,o){super(n),this.name=e.CONNECTION_READY,this.durationMS=(0,t.now)()-o,this.connectionId=r.id}};zi.ConnectionClosedEvent=class extends n{constructor(t,n,r,o){super(t),this.name=e.CONNECTION_CLOSED,this.connectionId=n.id,this.reason=r,this.serviceId=n.serviceId,this.error=o??null}};zi.ConnectionCheckOutStartedEvent=class extends n{constructor(t){super(t),this.name=e.CONNECTION_CHECK_OUT_STARTED}};zi.ConnectionCheckOutFailedEvent=class extends n{constructor(n,r,o,i){super(n),this.name=e.CONNECTION_CHECK_OUT_FAILED,this.durationMS=(0,t.now)()-o,this.reason=r,this.error=i}};zi.ConnectionCheckedOutEvent=class extends n{constructor(n,r,o){super(n),this.name=e.CONNECTION_CHECKED_OUT,this.durationMS=(0,t.now)()-o,this.connectionId=r.id}};zi.ConnectionCheckedInEvent=class extends n{constructor(t,n){super(t),this.name=e.CONNECTION_CHECKED_IN,this.connectionId=n.id}};return zi.ConnectionPoolClearedEvent=class extends n{constructor(t,n={}){super(t),this.name=e.CONNECTION_POOL_CLEARED,this.serviceId=n.serviceId,this.interruptInUseConnections=n.interruptInUseConnections}},zi}var qi,Gi,Hi,Ki,Yi,Qi={};function Ji(){if(qi)return Qi;qi=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.WaitQueueTimeoutError=Qi.PoolClearedOnNetworkError=Qi.PoolClearedError=Qi.PoolClosedError=void 0;const e=P();class t extends e.MongoDriverError{constructor(e){super("Attempted to check out a connection from closed connection pool"),this.address=e.address}get name(){return"MongoPoolClosedError"}}Qi.PoolClosedError=t;class n extends e.MongoNetworkError{constructor(t,n){super(n||`Connection pool for ${t.address} was cleared because another operation failed with: "${t.serverError?.message}"`,t.serverError?{cause:t.serverError}:void 0),this.address=t.address,this.addErrorLabel(e.MongoErrorLabel.PoolRequstedRetry)}get name(){return"MongoPoolClearedError"}}Qi.PoolClearedError=n;Qi.PoolClearedOnNetworkError=class extends n{constructor(e){super(e,`Connection to ${e.address} interrupted due to server monitor timeout`)}get name(){return"PoolClearedOnNetworkError"}};class r extends e.MongoDriverError{constructor(e,t){super(e),this.address=t}get name(){return"MongoWaitQueueTimeoutError"}}return Qi.WaitQueueTimeoutError=r,Qi}function Xi(){if(Hi)return Ui;Hi=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Server=void 0;const e=Ni(),t=(Gi||(Gi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionPool=e.PoolState=void 0;const t=s,n=z(),r=P(),o=ye(),i=Ce(),u=fe(),a=Ii(),c=Ni(),l=Wi(),h=Ji(),p=hi();e.PoolState=Object.freeze({paused:"paused",ready:"ready",closed:"closed"});class d extends o.TypedEventEmitter{constructor(t,n){if(super(),this.on("error",u.noop),this.options=Object.freeze({connectionType:c.Connection,...n,maxPoolSize:n.maxPoolSize??100,minPoolSize:n.minPoolSize??0,maxConnecting:n.maxConnecting??2,maxIdleTimeMS:n.maxIdleTimeMS??0,waitQueueTimeoutMS:n.waitQueueTimeoutMS??0,minPoolSizeCheckFrequencyMS:n.minPoolSizeCheckFrequencyMS??100,autoEncrypter:n.autoEncrypter}),this.options.minPoolSize>this.options.maxPoolSize)throw new r.MongoInvalidArgumentError("Connection pool minimum size must not be greater than maximum pool size");this.poolState=e.PoolState.paused,this.server=t,this.connections=new u.List,this.pending=0,this.checkedOut=new Set,this.minPoolSizeTimer=void 0,this.generation=0,this.serviceGenerations=new Map,this.connectionCounter=(0,u.makeCounter)(1),this.cancellationToken=new o.CancellationToken,this.cancellationToken.setMaxListeners(1/0),this.waitQueue=new u.List,this.metrics=new p.ConnectionPoolMetrics,this.processingWaitQueue=!1,this.mongoLogger=this.server.topology.client?.mongoLogger,this.component="connection",process.nextTick((()=>{this.emitAndLog(d.CONNECTION_POOL_CREATED,new l.ConnectionPoolCreatedEvent(this))}))}get address(){return this.options.hostAddress.toString()}get closed(){return this.poolState===e.PoolState.closed}get totalConnectionCount(){return this.availableConnectionCount+this.pendingConnectionCount+this.currentCheckedOutCount}get availableConnectionCount(){return this.connections.length}get pendingConnectionCount(){return this.pending}get currentCheckedOutCount(){return this.checkedOut.size}get waitQueueSize(){return this.waitQueue.length}get loadBalanced(){return this.options.loadBalanced}get serverError(){return this.server.description.error}get checkedOutConnections(){return this.checkedOut}waitQueueErrorMetrics(){return this.metrics.info(this.options.maxPoolSize)}ready(){this.poolState===e.PoolState.paused&&(this.poolState=e.PoolState.ready,this.emitAndLog(d.CONNECTION_POOL_READY,new l.ConnectionPoolReadyEvent(this)),(0,t.clearTimeout)(this.minPoolSizeTimer),this.ensureMinPoolSize())}async checkOut(e){const t=(0,u.now)();this.emitAndLog(d.CONNECTION_CHECK_OUT_STARTED,new l.ConnectionCheckOutStartedEvent(this));const{promise:n,resolve:o,reject:s}=(0,u.promiseWithResolvers)(),a=e.timeoutContext.connectionCheckoutTimeout,c={resolve:o,reject:s,cancelled:!1,checkoutTime:t},p=(0,u.addAbortListener)(e.signal,(function(){c.cancelled=!0,s(this.reason)}));this.waitQueue.push(c),process.nextTick((()=>this.processWaitQueue()));try{return a?.throwIfExpired(),await(a?Promise.race([n,a]):n)}catch(t){if(i.TimeoutError.is(t)){a?.clear(),c.cancelled=!0,this.emitAndLog(d.CONNECTION_CHECK_OUT_FAILED,new l.ConnectionCheckOutFailedEvent(this,"timeout",c.checkoutTime));const t=new h.WaitQueueTimeoutError(this.loadBalanced?this.waitQueueErrorMetrics():"Timed out while checking out a connection from connection pool",this.address);if(e.timeoutContext.csotEnabled())throw new r.MongoOperationTimeoutError("Timed out during connection checkout",{cause:t});throw t}throw t}finally{p?.[u.kDispose](),a?.clear()}}checkIn(e){if(!this.checkedOut.has(e))return;const t=this.closed,n=this.connectionIsStale(e),r=!!(t||n||e.closed);if(r||(e.markAvailable(),this.connections.unshift(e)),this.checkedOut.delete(e),this.emitAndLog(d.CONNECTION_CHECKED_IN,new l.ConnectionCheckedInEvent(this,e)),r){const n=e.closed?"error":t?"poolClosed":"stale";this.destroyConnection(e,n)}process.nextTick((()=>this.processWaitQueue()))}clear(t={}){if(this.closed)return;if(this.loadBalanced){const{serviceId:e}=t;if(!e)throw new r.MongoRuntimeError("ConnectionPool.clear() called in load balanced mode with no serviceId.");const n=e.toHexString(),o=this.serviceGenerations.get(n);if(null==o)throw new r.MongoRuntimeError("Service generations are required in load balancer mode.");return this.serviceGenerations.set(n,o+1),void this.emitAndLog(d.CONNECTION_POOL_CLEARED,new l.ConnectionPoolClearedEvent(this,{serviceId:e}))}const n=t.interruptInUseConnections??!1,o=this.generation;this.generation+=1;const i=this.poolState===e.PoolState.paused;this.poolState=e.PoolState.paused,this.clearMinPoolSizeTimer(),i||this.emitAndLog(d.CONNECTION_POOL_CLEARED,new l.ConnectionPoolClearedEvent(this,{interruptInUseConnections:n})),n&&process.nextTick((()=>this.interruptInUseConnections(o))),this.processWaitQueue()}interruptInUseConnections(e){for(const t of this.checkedOut)t.generation<=e&&(t.onError(new h.PoolClearedOnNetworkError(this)),this.checkIn(t))}close(){if(!this.closed){this.cancellationToken.emit("cancel"),"function"==typeof this.connectionCounter.return&&this.connectionCounter.return(void 0),this.poolState=e.PoolState.closed,this.clearMinPoolSizeTimer(),this.processWaitQueue();for(const e of this.connections)this.emitAndLog(d.CONNECTION_CLOSED,new l.ConnectionClosedEvent(this,e,"poolClosed")),e.destroy();this.connections.clear(),this.emitAndLog(d.CONNECTION_POOL_CLOSED,new l.ConnectionPoolClosedEvent(this))}}async reauthenticate(e){const t=e.authContext;if(!t)throw new r.MongoRuntimeError("No auth context found on connection.");const n=t.credentials;if(!n)throw new r.MongoMissingCredentialsError("Connection is missing credentials when asked to reauthenticate");const o=n.resolveAuthMechanism(e.hello),i=this.server.topology.client.s.authProviders.getOrCreateProvider(o.mechanism,o.mechanismProperties);if(!i)throw new r.MongoMissingCredentialsError(`Reauthenticate failed due to no auth provider for ${n.mechanism}`);await i.reauth(t)}clearMinPoolSizeTimer(){const e=this.minPoolSizeTimer;e&&(0,t.clearTimeout)(e)}destroyConnection(e,t){this.emitAndLog(d.CONNECTION_CLOSED,new l.ConnectionClosedEvent(this,e,t)),e.destroy()}connectionIsStale(e){const t=e.serviceId;if(this.loadBalanced&&t){const n=t.toHexString(),r=this.serviceGenerations.get(n);return e.generation!==r}return e.generation!==this.generation}connectionIsIdle(e){return!!(this.options.maxIdleTimeMS&&e.idleTime>this.options.maxIdleTimeMS)}destroyConnectionIfPerished(e){const t=this.connectionIsStale(e),n=this.connectionIsIdle(e);if(!t&&!n&&!e.closed)return!1;const r=e.closed?"error":t?"stale":"idle";return this.destroyConnection(e,r),!0}createConnection(t){const o={...this.options,id:this.connectionCounter.next().value,generation:this.generation,cancellationToken:this.cancellationToken,mongoLogger:this.mongoLogger,authProviders:this.server.topology.client.s.authProviders};this.pending++;const i=(0,u.now)();this.emitAndLog(d.CONNECTION_CREATED,new l.ConnectionCreatedEvent(this,{id:o.id})),(0,a.connect)(o).then((r=>{if(this.poolState!==e.PoolState.ready)return this.pending--,r.destroy(),void t(this.closed?new h.PoolClosedError(this):new h.PoolClearedError(this));for(const e of[...n.APM_EVENTS,c.Connection.CLUSTER_TIME_RECEIVED])r.on(e,(t=>this.emit(e,t)));if(this.loadBalanced){r.on(c.Connection.PINNED,(e=>this.metrics.markPinned(e))),r.on(c.Connection.UNPINNED,(e=>this.metrics.markUnpinned(e)));const e=r.serviceId;if(e){let t;const n=e.toHexString();(t=this.serviceGenerations.get(n))?r.generation=t:(this.serviceGenerations.set(n,0),r.generation=0)}}r.markAvailable(),this.emitAndLog(d.CONNECTION_READY,new l.ConnectionReadyEvent(this,r,i)),this.pending--,t(void 0,r)}),(e=>{this.pending--,this.server.handleError(e),this.emitAndLog(d.CONNECTION_CLOSED,new l.ConnectionClosedEvent(this,{id:o.id,serviceId:void 0},"error",e)),(e instanceof r.MongoNetworkError||e instanceof r.MongoServerError)&&(e.connectionGeneration=o.generation),t(e??new r.MongoRuntimeError("Connection creation failed without error"))}))}ensureMinPoolSize(){const n=this.options.minPoolSize;this.poolState===e.PoolState.ready&&0!==n&&(this.connections.prune((e=>this.destroyConnectionIfPerished(e))),this.totalConnectionCount<n&&this.pendingConnectionCount<this.options.maxConnecting?this.createConnection(((n,r)=>{!n&&r&&(this.connections.push(r),process.nextTick((()=>this.processWaitQueue()))),this.poolState===e.PoolState.ready&&((0,t.clearTimeout)(this.minPoolSizeTimer),this.minPoolSizeTimer=(0,t.setTimeout)((()=>this.ensureMinPoolSize()),this.options.minPoolSizeCheckFrequencyMS))})):((0,t.clearTimeout)(this.minPoolSizeTimer),this.minPoolSizeTimer=(0,t.setTimeout)((()=>this.ensureMinPoolSize()),this.options.minPoolSizeCheckFrequencyMS)))}processWaitQueue(){if(this.processingWaitQueue)return;for(this.processingWaitQueue=!0;this.waitQueueSize;){const t=this.waitQueue.first();if(!t){this.waitQueue.shift();continue}if(t.cancelled){this.waitQueue.shift();continue}if(this.poolState!==e.PoolState.ready){const e=this.closed?"poolClosed":"connectionError",n=this.closed?new h.PoolClosedError(this):new h.PoolClearedError(this);this.emitAndLog(d.CONNECTION_CHECK_OUT_FAILED,new l.ConnectionCheckOutFailedEvent(this,e,t.checkoutTime,n)),this.waitQueue.shift(),t.reject(n);continue}if(!this.availableConnectionCount)break;const n=this.connections.shift();if(!n)break;this.destroyConnectionIfPerished(n)||(this.checkedOut.add(n),this.emitAndLog(d.CONNECTION_CHECKED_OUT,new l.ConnectionCheckedOutEvent(this,n,t.checkoutTime)),this.waitQueue.shift(),t.resolve(n))}const{maxPoolSize:t,maxConnecting:n}=this.options;for(;this.waitQueueSize>0&&this.pendingConnectionCount<n&&(0===t||this.totalConnectionCount<t);){const e=this.waitQueue.shift();e&&!e.cancelled&&this.createConnection(((t,n)=>{e.cancelled?!t&&n&&this.connections.push(n):t?(this.emitAndLog(d.CONNECTION_CHECK_OUT_FAILED,new l.ConnectionCheckOutFailedEvent(this,"connectionError",e.checkoutTime,t)),e.reject(t)):n&&(this.checkedOut.add(n),this.emitAndLog(d.CONNECTION_CHECKED_OUT,new l.ConnectionCheckedOutEvent(this,n,e.checkoutTime)),e.resolve(n)),process.nextTick((()=>this.processWaitQueue()))}))}this.processingWaitQueue=!1}}e.ConnectionPool=d,d.CONNECTION_POOL_CREATED=n.CONNECTION_POOL_CREATED,d.CONNECTION_POOL_CLOSED=n.CONNECTION_POOL_CLOSED,d.CONNECTION_POOL_CLEARED=n.CONNECTION_POOL_CLEARED,d.CONNECTION_POOL_READY=n.CONNECTION_POOL_READY,d.CONNECTION_CREATED=n.CONNECTION_CREATED,d.CONNECTION_READY=n.CONNECTION_READY,d.CONNECTION_CLOSED=n.CONNECTION_CLOSED,d.CONNECTION_CHECK_OUT_STARTED=n.CONNECTION_CHECK_OUT_STARTED,d.CONNECTION_CHECK_OUT_FAILED=n.CONNECTION_CHECK_OUT_FAILED,d.CONNECTION_CHECKED_OUT=n.CONNECTION_CHECKED_OUT,d.CONNECTION_CHECKED_IN=n.CONNECTION_CHECKED_IN}(Vi)),Vi),n=Ji(),r=z(),o=P(),i=ye(),u=wi(),a=fe(),c=de(),l=ne(),h=Zi(),p=Ei(),d=(0,a.makeStateMachine)({[l.STATE_CLOSED]:[l.STATE_CLOSED,l.STATE_CONNECTING],[l.STATE_CONNECTING]:[l.STATE_CONNECTING,l.STATE_CLOSING,l.STATE_CONNECTED,l.STATE_CLOSED],[l.STATE_CONNECTED]:[l.STATE_CONNECTED,l.STATE_CLOSING,l.STATE_CLOSED],[l.STATE_CLOSING]:[l.STATE_CLOSING,l.STATE_CLOSED]});class f extends i.TypedEventEmitter{constructor(n,o,i){super(),this.on("error",a.noop),this.serverApi=i.serverApi;const s={hostAddress:o.hostAddress,...i};this.topology=n,this.pool=new t.ConnectionPool(this,s),this.s={description:o,options:i,state:l.STATE_CLOSED,operationCount:0};for(const e of[...r.CMAP_EVENTS,...r.APM_EVENTS])this.pool.on(e,(t=>this.emit(e,t)));if(this.pool.on(e.Connection.CLUSTER_TIME_RECEIVED,(e=>{this.clusterTime=e})),this.loadBalanced)this.monitor=null;else{this.monitor=new h.Monitor(this,this.s.options);for(const e of r.HEARTBEAT_EVENTS)this.monitor.on(e,(t=>this.emit(e,t)));this.monitor.on("resetServer",(e=>m(this,e))),this.monitor.on(f.SERVER_HEARTBEAT_SUCCEEDED,(e=>{this.emit(f.DESCRIPTION_RECEIVED,new p.ServerDescription(this.description.hostAddress,e.reply,{roundTripTime:this.monitor?.roundTripTime,minRoundTripTime:this.monitor?.minRoundTripTime})),this.s.state===l.STATE_CONNECTING&&(d(this,l.STATE_CONNECTED),this.emit(f.CONNECT,this))}))}}get clusterTime(){return this.topology.clusterTime}set clusterTime(e){this.topology.clusterTime=e}get description(){return this.s.description}get name(){return this.s.description.address}get autoEncrypter(){if(this.s.options&&this.s.options.autoEncrypter)return this.s.options.autoEncrypter}get loadBalanced(){return this.topology.description.type===l.TopologyType.LoadBalanced}connect(){this.s.state===l.STATE_CLOSED&&(d(this,l.STATE_CONNECTING),this.loadBalanced?(d(this,l.STATE_CONNECTED),this.emit(f.CONNECT,this)):this.monitor?.connect())}destroy(){this.s.state!==l.STATE_CLOSED&&(d(this,l.STATE_CLOSING),this.loadBalanced||this.monitor?.close(),this.pool.close(),d(this,l.STATE_CLOSED),this.emit("closed"))}requestCheck(){this.loadBalanced||this.monitor?.requestCheck()}async command(e,t,{...r},i){if(null==e.db||"string"==typeof e)throw new o.MongoInvalidArgumentError("Namespace must not be a string");if(this.s.state===l.STATE_CLOSING||this.s.state===l.STATE_CLOSED)throw new o.MongoServerClosedError;r.directConnection=this.topology.s.options.directConnection,r.omitReadPreference&&delete r.readPreference,this.description.iscryptd&&(r.omitMaxTimeMS=!0);const s=r.session;let u=s?.pinnedConnection;if(this.incrementOperationCount(),null==u)try{u=await this.pool.checkOut(r),this.loadBalanced&&function(e,t){if(t)return t.inTransaction()||t.transaction.isCommitted&&"commitTransaction"in e||"aggregate"in e||"find"in e||"getMore"in e||"listCollections"in e||"listIndexes"in e||"bulkWrite"in e;return!1}(t,s)&&s?.pin(u)}catch(e){throw this.decrementOperationCount(),e instanceof n.PoolClearedError||this.handleError(e),e}let h=null;try{try{const n=await u.command(e,t,r,i);return(0,c.throwIfWriteConcernError)(n),n}catch(e){throw this.decorateCommandError(u,t,r,e)}}catch(n){if(!(n instanceof o.MongoError&&n.code===o.MONGODB_ERROR_CODES.Reauthenticate))throw n;h=this.pool.reauthenticate(u),h.then(void 0,(e=>{h=null,(0,a.squashError)(e)})),await(0,a.abortable)(h,r),h=null;try{const n=await u.command(e,t,r,i);return(0,c.throwIfWriteConcernError)(n),n}catch(e){throw this.decorateCommandError(u,t,r,e)}}finally{if(this.decrementOperationCount(),s?.pinnedConnection!==u)if(null!=h){const e=()=>{this.pool.checkIn(u)};h.then(e,e)}else this.pool.checkIn(u)}}handleError(e,t){if(!(e instanceof o.MongoError))return;if(e.connectionGeneration&&e.connectionGeneration<this.pool.generation)return;const n=e instanceof o.MongoNetworkError&&!(e instanceof o.MongoNetworkTimeoutError),r=e instanceof o.MongoNetworkError&&e.beforeHandshake,i=e.hasErrorLabel(o.MongoErrorLabel.HandshakeError);if(n||r||i)this.loadBalanced?t&&this.pool.clear({serviceId:t.serviceId}):(e.addErrorLabel(o.MongoErrorLabel.ResetPool),m(this,e));else if((0,o.isSDAMUnrecoverableError)(e)&&function(e,t){const n=t.topologyVersion,r=e.description.topologyVersion;return(0,p.compareTopologyVersion)(r,n)<0}(this,e)){const n=(0,a.maxWireVersion)(this)<=7||(0,o.isNodeShuttingDownError)(e);this.loadBalanced&&t&&n&&this.pool.clear({serviceId:t.serviceId}),this.loadBalanced||(n&&e.addErrorLabel(o.MongoErrorLabel.ResetPool),m(this,e),process.nextTick((()=>this.requestCheck())))}}decorateCommandError(e,t,n,r){if("object"!=typeof r||null==r||!("name"in r))throw new o.MongoRuntimeError("An unexpected error type: "+typeof r);if("AbortError"===r.name&&"cause"in r&&r.cause instanceof o.MongoError&&(r=r.cause),!(r instanceof o.MongoError))return r;if(function(e,t){if(t.serviceId)return t.generation!==e.serviceGenerations.get(t.serviceId.toHexString());return t.generation!==e.generation}(this.pool,e))return r;const i=n?.session;return r instanceof o.MongoNetworkError?(i&&!i.hasEnded&&i.serverSession&&(i.serverSession.isDirty=!0),y(i,t)&&!r.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError)&&r.addErrorLabel(o.MongoErrorLabel.TransientTransactionError),(g(this.topology)||(0,u.isTransactionCommand)(t))&&(0,a.supportsRetryableWrites)(this)&&!y(i,t)&&r.addErrorLabel(o.MongoErrorLabel.RetryableWriteError)):(g(this.topology)||(0,u.isTransactionCommand)(t))&&(0,o.needsRetryableWriteLabel)(r,(0,a.maxWireVersion)(this),this.description.type)&&!y(i,t)&&r.addErrorLabel(o.MongoErrorLabel.RetryableWriteError),i&&i.isPinned&&r.hasErrorLabel(o.MongoErrorLabel.TransientTransactionError)&&i.unpin({force:!0}),this.handleError(r,e),r}decrementOperationCount(){return this.s.operationCount-=1}incrementOperationCount(){return this.s.operationCount+=1}}function m(e,t){e.loadBalanced||(t instanceof o.MongoNetworkError&&!(t instanceof o.MongoNetworkTimeoutError)&&e.monitor?.reset(),e.emit(f.DESCRIPTION_RECEIVED,new p.ServerDescription(e.description.hostAddress,void 0,{error:t})))}function y(e,t){return e&&e.inTransaction()&&!(0,u.isTransactionCommand)(t)}function g(e){return!1!==e.s.options.retryWrites}return Ui.Server=f,f.SERVER_HEARTBEAT_STARTED=r.SERVER_HEARTBEAT_STARTED,f.SERVER_HEARTBEAT_SUCCEEDED=r.SERVER_HEARTBEAT_SUCCEEDED,f.SERVER_HEARTBEAT_FAILED=r.SERVER_HEARTBEAT_FAILED,f.CONNECT=r.CONNECT,f.DESCRIPTION_RECEIVED=r.DESCRIPTION_RECEIVED,f.CLOSED=r.CLOSED,f.ENDED=r.ENDED,Ui}function Zi(){return Ki||(Ki=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RTTSampler=e.MonitorInterval=e.RTTPinger=e.Monitor=e.ServerMonitoringMode=void 0;const t=s,n=F(),r=Ii(),o=bo(),i=z(),u=P(),a=me(),c=ye(),l=fe(),h=ne(),p=ji(),d=Xi(),f="idle",m="monitoring",y=(0,l.makeStateMachine)({[h.STATE_CLOSING]:[h.STATE_CLOSING,f,h.STATE_CLOSED],[h.STATE_CLOSED]:[h.STATE_CLOSED,m],[f]:[f,m,h.STATE_CLOSING],[m]:[m,f,h.STATE_CLOSING]}),g=new Set([h.STATE_CLOSING,h.STATE_CLOSED,m]);function E(e){return e.s.state===h.STATE_CLOSED||e.s.state===h.STATE_CLOSING}e.ServerMonitoringMode=Object.freeze({auto:"auto",poll:"poll",stream:"stream"});class A extends c.TypedEventEmitter{constructor(e,t){super(),this.component=a.MongoLoggableComponent.TOPOLOGY,this.on("error",l.noop),this.server=e,this.connection=null,this.cancellationToken=new c.CancellationToken,this.cancellationToken.setMaxListeners(1/0),this.monitorId=void 0,this.s={state:h.STATE_CLOSED},this.address=e.description.address,this.options=Object.freeze({connectTimeoutMS:t.connectTimeoutMS??1e4,heartbeatFrequencyMS:t.heartbeatFrequencyMS??1e4,minHeartbeatFrequencyMS:t.minHeartbeatFrequencyMS??500,serverMonitoringMode:t.serverMonitoringMode}),this.isRunningInFaasEnv=null!=(0,o.getFAASEnv)(),this.mongoLogger=this.server.topology.client?.mongoLogger,this.rttSampler=new S(10);const n=this.cancellationToken,r={id:"<monitor>",generation:e.pool.generation,cancellationToken:n,hostAddress:e.description.hostAddress,...t,raw:!1,useBigInt64:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!0};delete r.credentials,r.autoEncrypter&&delete r.autoEncrypter,this.connectOptions=Object.freeze(r)}connect(){if(this.s.state!==h.STATE_CLOSED)return;const e=this.options.heartbeatFrequencyMS,t=this.options.minHeartbeatFrequencyMS;this.monitorId=new w(O(this),{heartbeatFrequencyMS:e,minHeartbeatFrequencyMS:t,immediate:!0})}requestCheck(){g.has(this.s.state)||this.monitorId?.wake()}reset(){const e=this.server.description.topologyVersion;if(E(this)||null==e)return;y(this,h.STATE_CLOSING),b(this),y(this,f);const t=this.options.heartbeatFrequencyMS,n=this.options.minHeartbeatFrequencyMS;this.monitorId=new w(O(this),{heartbeatFrequencyMS:t,minHeartbeatFrequencyMS:n})}close(){E(this)||(y(this,h.STATE_CLOSING),b(this),this.emit("close"),y(this,h.STATE_CLOSED))}get roundTripTime(){return this.rttSampler.average()}get minRoundTripTime(){return this.rttSampler.min()}get latestRtt(){return this.rttSampler.last}addRttSample(e){this.rttSampler.addSample(e)}clearRttSamples(){this.rttSampler.clear()}}function b(e){e.monitorId?.stop(),e.monitorId=void 0,e.rttPinger?.close(),e.rttPinger=void 0,e.cancellationToken.emit("cancel"),e.connection?.destroy(),e.connection=null,e.clearRttSamples()}function _(t,n){if(null==n)return!1;const r=t.options.serverMonitoringMode;return r!==e.ServerMonitoringMode.poll&&(r===e.ServerMonitoringMode.stream||!t.isRunningInFaasEnv)}function O(e){return o=>{function s(){E(e)||y(e,f),o()}e.s.state!==m?(y(e,m),function(e,t){let o,s;const a=e.server.description.topologyVersion,c=_(e,a);function h(n){e.connection?.destroy(),e.connection=null,e.emitAndLogHeartbeat(d.Server.SERVER_HEARTBEAT_FAILED,e.server.topology.s.id,void 0,new p.ServerHeartbeatFailedEvent(e.address,(0,l.calculateDurationInMs)(o),n,s));const r=n instanceof u.MongoError?n:new u.MongoError(u.MongoError.buildErrorMessage(n),{cause:n});r.addErrorLabel(u.MongoErrorLabel.ResetPool),r instanceof u.MongoNetworkTimeoutError&&r.addErrorLabel(u.MongoErrorLabel.InterruptInUseConnections),e.emit("resetServer",r),t(n)}function f(n){"isWritablePrimary"in n||(n.isWritablePrimary=n[i.LEGACY_HELLO_COMMAND]);const r=c&&e.rttPinger?e.rttPinger.latestRtt??(0,l.calculateDurationInMs)(o):(0,l.calculateDurationInMs)(o);e.addRttSample(r),e.emitAndLogHeartbeat(d.Server.SERVER_HEARTBEAT_SUCCEEDED,e.server.topology.s.id,n.connectionId,new p.ServerHeartbeatSucceededEvent(e.address,r,n,c)),c?(e.emitAndLogHeartbeat(d.Server.SERVER_HEARTBEAT_STARTED,e.server.topology.s.id,void 0,new p.ServerHeartbeatStartedEvent(e.address,!0)),o=(0,l.now)()):(e.rttPinger?.close(),e.rttPinger=void 0,t(void 0,n))}e.emitAndLogHeartbeat(d.Server.SERVER_HEARTBEAT_STARTED,e.server.topology.s.id,void 0,new p.ServerHeartbeatStartedEvent(e.address,c));const{connection:m}=e;if(m&&!m.closed){const{serverApi:t,helloOk:r}=m,u=e.options.connectTimeoutMS,p=e.options.heartbeatFrequencyMS,d={[t?.version||r?"hello":i.LEGACY_HELLO_COMMAND]:1,...c&&a?{maxAwaitTimeMS:p,topologyVersion:(y=a,{processId:y.processId,counter:n.Long.isLong(y.counter)?y.counter:n.Long.fromNumber(y.counter)})}:{}},g=c?{socketTimeoutMS:u?u+p:0,exhaustAllowed:!0}:{socketTimeoutMS:u};return c&&null==e.rttPinger&&(e.rttPinger=new C(e)),o=(0,l.now)(),c?(s=!0,m.exhaustCommand((0,l.ns)("admin.$cmd"),d,g,((e,t)=>e?h(e):f(t)))):(s=!1,void m.command((0,l.ns)("admin.$cmd"),d,g).then(f,h))}var y;(async()=>{const t=await(0,r.makeSocket)(e.connectOptions),n=(0,r.makeConnection)(e.connectOptions,t);o=(0,l.now)();try{return await(0,r.performInitialHandshake)(n,e.connectOptions),n}catch(e){throw n.destroy(),e}})().then((n=>{if(E(e))return void n.destroy();const r=(0,l.calculateDurationInMs)(o);e.addRttSample(r),e.connection=n,e.emitAndLogHeartbeat(d.Server.SERVER_HEARTBEAT_SUCCEEDED,e.server.topology.s.id,n.hello?.connectionId,new p.ServerHeartbeatSucceededEvent(e.address,r,n.hello,_(e,n.hello?.topologyVersion))),t(void 0,n.hello)}),(t=>{e.connection=null,s=!1,h(t)}))}(e,((n,r)=>{if(n&&e.server.description.type===h.ServerType.Unknown)return s();_(e,r?.topologyVersion)&&(0,t.setTimeout)((()=>{E(e)||e.monitorId?.wake()}),0),s()}))):process.nextTick(o)}}e.Monitor=A;class C{constructor(e){this.connection=void 0,this.cancellationToken=e.cancellationToken,this.closed=!1,this.monitor=e,this.latestRtt=e.latestRtt??void 0;const n=e.options.heartbeatFrequencyMS;this.monitorId=(0,t.setTimeout)((()=>this.measureRoundTripTime()),n)}get roundTripTime(){return this.monitor.roundTripTime}get minRoundTripTime(){return this.monitor.minRoundTripTime}close(){this.closed=!0,(0,t.clearTimeout)(this.monitorId),this.connection?.destroy(),this.connection=void 0}measureAndReschedule(e,n){this.closed?n?.destroy():(null==this.connection&&(this.connection=n),this.latestRtt=(0,l.calculateDurationInMs)(e),this.monitorId=(0,t.setTimeout)((()=>this.measureRoundTripTime()),this.monitor.options.heartbeatFrequencyMS))}measureRoundTripTime(){const e=(0,l.now)();if(this.closed)return;const t=this.connection;if(null==t)return void(0,r.connect)(this.monitor.connectOptions).then((t=>{this.measureAndReschedule(e,t)}),(()=>{this.connection=void 0}));const n=t.serverApi?.version||t.helloOk?"hello":i.LEGACY_HELLO_COMMAND;t.command((0,l.ns)("admin.$cmd"),{[n]:1},void 0).then((()=>this.measureAndReschedule(e)),(()=>{this.connection?.destroy(),this.connection=void 0}))}}e.RTTPinger=C;class w{constructor(e,n={}){this.isExpeditedCallToFnScheduled=!1,this.stopped=!1,this.isExecutionInProgress=!1,this.hasExecutedOnce=!1,this._executeAndReschedule=()=>{this.stopped||(this.timerId&&(0,t.clearTimeout)(this.timerId),this.isExpeditedCallToFnScheduled=!1,this.isExecutionInProgress=!0,this.fn((()=>{this.lastExecutionEnded=(0,l.now)(),this.isExecutionInProgress=!1,this._reschedule(this.heartbeatFrequencyMS)})))},this.fn=e,this.lastExecutionEnded=-1/0,this.heartbeatFrequencyMS=n.heartbeatFrequencyMS??1e3,this.minHeartbeatFrequencyMS=n.minHeartbeatFrequencyMS??500,n.immediate?this._executeAndReschedule():this._reschedule(void 0)}wake(){const e=(0,l.now)()-this.lastExecutionEnded;return e<0?this._executeAndReschedule():this.isExecutionInProgress||this.isExpeditedCallToFnScheduled?void 0:e<this.minHeartbeatFrequencyMS?(this.isExpeditedCallToFnScheduled=!0,void this._reschedule(this.minHeartbeatFrequencyMS-e)):void this._executeAndReschedule()}stop(){this.stopped=!0,this.timerId&&((0,t.clearTimeout)(this.timerId),this.timerId=void 0),this.lastExecutionEnded=-1/0,this.isExpeditedCallToFnScheduled=!1}toString(){return JSON.stringify(this)}toJSON(){const e=(0,l.now)(),t=e-this.lastExecutionEnded;return{timerId:null!=this.timerId?"set":"cleared",lastCallTime:this.lastExecutionEnded,isExpeditedCheckScheduled:this.isExpeditedCallToFnScheduled,stopped:this.stopped,heartbeatFrequencyMS:this.heartbeatFrequencyMS,minHeartbeatFrequencyMS:this.minHeartbeatFrequencyMS,currentTime:e,timeSinceLastCall:t}}_reschedule(e){this.stopped||(this.timerId&&(0,t.clearTimeout)(this.timerId),this.timerId=(0,t.setTimeout)(this._executeAndReschedule,e||this.heartbeatFrequencyMS))}}e.MonitorInterval=w;class S{constructor(e=10){this.rttSamples=new Float64Array(e),this.length=0,this.writeIndex=0}addSample(e){this.rttSamples[this.writeIndex++]=e,this.length<this.rttSamples.length&&this.length++,this.writeIndex%=this.rttSamples.length}min(){if(this.length<2)return 0;let e=this.rttSamples[0];for(let t=1;t<this.length;t++)this.rttSamples[t]<e&&(e=this.rttSamples[t]);return e}average(){if(0===this.length)return 0;let e=0;for(let t=0;t<this.length;t++)e+=this.rttSamples[t];return e/this.length}get last(){return 0===this.length?null:this.rttSamples[0===this.writeIndex?this.length-1:this.writeIndex-1]}clear(){this.length=0,this.writeIndex=0}}e.RTTSampler=S}(si)),si}function es(){return Yi||(Yi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_OPTIONS=e.OPTIONS=void 0,e.resolveSRVRecord=async function(e){if("string"!=typeof e.srvHost)throw new p.MongoAPIError('Option "srvHost" must not be empty');const t=e.srvHost,n=v(t);n.then(void 0,E.squashError);const r=`_${e.srvServiceName}._tcp.${t}`,u=await S(r);if(0===u.length)throw new p.MongoAPIError("No addresses found at host");for(const{name:e}of u)(0,E.checkParentDomainMatch)(e,t);const a=u.map((e=>E.HostAddress.fromString(`${e.name}:${e.port??27017}`)));let c;$(a,e,!0);try{c=await n}catch(e){if("ENODATA"!==e.code&&"ENOTFOUND"!==e.code)throw e;return a}if(c.length>1)throw new p.MongoParseError("Multiple text records not allowed");const l=new o.URLSearchParams(c[0].join(""));if([...l.keys()].some((e=>!b.includes(e))))throw new p.MongoParseError(`Text record may only set any of: ${b.join(", ")}`);if(b.some((e=>""===l.get(e))))throw new p.MongoParseError("Cannot have empty URI params in DNS TXT Record");const h=l.get("authSource")??void 0,d=l.get("replicaSet")??void 0,f=l.get("loadBalanced")??void 0;!e.userSpecifiedAuthSource&&h&&e.credentials&&!s.AUTH_MECHS_AUTH_SRC_EXTERNAL.has(e.credentials.mechanism)&&(e.credentials=i.MongoCredentials.merge(e.credentials,{source:h}));!e.userSpecifiedReplicaSet&&d&&(e.replicaSet=d);"true"===f&&(e.loadBalanced=!0);if(e.replicaSet&&e.srvMaxHosts>0)throw new p.MongoParseError("Cannot combine replicaSet option with srvMaxHosts");return $(a,e,!0),a},e.parseOptions=function(t,n=void 0,o={}){null==n||n instanceof d.MongoClient||(o=n,n=void 0);if(o.useBigInt64&&"boolean"==typeof o.promoteLongs&&!o.promoteLongs)throw new p.MongoAPIError("Must request either bigint or Long for int64 deserialization");if(o.useBigInt64&&"boolean"==typeof o.promoteValues&&!o.promoteValues)throw new p.MongoAPIError("Must request either bigint or Long for int64 deserialization");const u=new r.default(t),{hosts:a,isSRV:l}=u,m=Object.create(null);m.hosts=l?[]:a.map(E.HostAddress.fromString);const y=new F;if("/"!==u.pathname&&""!==u.pathname){const e=decodeURIComponent("/"===u.pathname[0]?u.pathname.slice(1):u.pathname);e&&y.set("dbName",[e])}if(""!==u.username){const e={username:decodeURIComponent(u.username)};"string"==typeof u.password&&(e.password=decodeURIComponent(u.password)),y.set("auth",[e])}for(const e of u.searchParams.keys()){const t=u.searchParams.getAll(e),n=/readPreferenceTags/i.test(e);if(!n&&t.length>1)throw new p.MongoInvalidArgumentError(`URI option "${e}" cannot appear more than once in the connection string`);if(!n&&t.includes(""))throw new p.MongoAPIError(`URI option "${e}" cannot be specified with no value`);y.has(e)||y.set(e,t)}const g=new F(Object.entries(o).filter((([,e])=>null!=e)));if(y.has("serverApi"))throw new p.MongoParseError("URI cannot contain `serverApi`, it can only be passed to the client");const A=y.get("authMechanismProperties");if(A)for(const e of A)if(/(^|,)ALLOWED_HOSTS:/.test(e))throw new p.MongoParseError("Auth mechanism property ALLOWED_HOSTS is not allowed in the connection string.");if(g.has("loadBalanced"))throw new p.MongoParseError("loadBalanced is only a valid option in the URI");const b=new F,_=new Set([...y.keys(),...g.keys()]);for(const e of _){const t=[],n=g.get(e);null!=n&&t.push(n);const r=y.get(e)??[];t.push(...r),b.set(e,t)}if(b.has("tls")||b.has("ssl")){const e=(b.get("tls")||[]).concat(b.get("ssl")||[]).map(D.bind(null,"tls/ssl"));if(1!==new Set(e).size)throw new p.MongoParseError("All values of tls/ssl must be the same.")}!function(e){if(!e)return;const t=(t,n)=>{if(e.has(t)&&e.has(n))throw new p.MongoAPIError(`The '${t}' option cannot be used with the '${n}' option`)};t("tlsInsecure","tlsAllowInvalidCertificates"),t("tlsInsecure","tlsAllowInvalidHostnames"),t("tlsInsecure","tlsDisableCertificateRevocationCheck"),t("tlsInsecure","tlsDisableOCSPEndpointCheck"),t("tlsAllowInvalidCertificates","tlsDisableCertificateRevocationCheck"),t("tlsAllowInvalidCertificates","tlsDisableOCSPEndpointCheck"),t("tlsDisableCertificateRevocationCheck","tlsDisableOCSPEndpointCheck")}(b);const O=(0,E.setDifference)(_,Array.from(Object.keys(e.OPTIONS)).map((e=>e.toLowerCase())));if(0!==O.size){const e=O.size>1?"options":"option",t=O.size>1?"are":"is";throw new p.MongoParseError(`${e} ${Array.from(O).join(", ")} ${t} not supported`)}for(const[t,n]of Object.entries(e.OPTIONS)){const r=b.get(t);if(r&&0!==r.length){const{deprecated:e}=n;if(e){const n="string"==typeof e?`: ${e}`:"";(0,E.emitWarning)(`${t} is a deprecated option${n}`)}x(m,t,n,r)}else e.DEFAULT_OPTIONS.has(t)&&x(m,t,n,[e.DEFAULT_OPTIONS.get(t)])}if(m.credentials){const e=m.credentials.mechanism===s.AuthMechanism.MONGODB_GSSAPI,t=m.credentials.mechanism===s.AuthMechanism.MONGODB_X509,n=m.credentials.mechanism===s.AuthMechanism.MONGODB_AWS,r=m.credentials.mechanism===s.AuthMechanism.MONGODB_OIDC;if((e||t)&&b.has("authSource")&&"$external"!==m.credentials.source)throw new p.MongoParseError(`authMechanism ${m.credentials.mechanism} requires an authSource of '$external'`);if(e||t||n||r||!m.dbName||b.has("authSource")||(m.credentials=i.MongoCredentials.merge(m.credentials,{source:m.dbName})),n&&m.credentials.username&&!m.credentials.password)throw new p.MongoMissingCredentialsError(`When using ${m.credentials.mechanism} password must be set when a username is specified`);m.credentials.validate(),""===m.credentials.password&&""===m.credentials.username&&m.credentials.mechanism===s.AuthMechanism.MONGODB_DEFAULT&&0===Object.keys(m.credentials.mechanismProperties).length&&delete m.credentials}m.dbName||(m.dbName="test");$(a,m,l),n&&m.autoEncryption&&(h.Encrypter.checkForMongoCrypt(),m.encrypter=new h.Encrypter(n,t,o),m.autoEncrypter=m.encrypter.autoEncrypter);if(m.userSpecifiedAuthSource=g.has("authSource")||y.has("authSource"),m.userSpecifiedReplicaSet=g.has("replicaSet")||y.has("replicaSet"),l){if(m.srvHost=a[0],m.directConnection)throw new p.MongoAPIError("SRV URI does not support directConnection");if(m.srvMaxHosts>0&&"string"==typeof m.replicaSet)throw new p.MongoParseError("Cannot use srvMaxHosts option with replicaSet");const e=!g.has("tls")&&!y.has("tls"),t=!g.has("ssl")&&!y.has("ssl");e&&t&&(m.tls=!0)}else{if(y.has("srvMaxHosts")||g.has("srvMaxHosts")||y.has("srvServiceName")||g.has("srvServiceName"))throw new p.MongoParseError("Cannot use srvMaxHosts or srvServiceName with a non-srv connection string")}if(m.directConnection&&1!==m.hosts.length)throw new p.MongoParseError("directConnection option requires exactly one host");if(!m.proxyHost&&(m.proxyPort||m.proxyUsername||m.proxyPassword))throw new p.MongoParseError("Must specify proxyHost if other proxy options are passed");if(m.proxyUsername&&!m.proxyPassword||!m.proxyUsername&&m.proxyPassword)throw new p.MongoParseError("Can only specify both of proxy username/password or neither");if(["proxyHost","proxyPort","proxyUsername","proxyPassword"].map((e=>y.get(e)??[])).some((e=>e.length>1)))throw new p.MongoParseError("Proxy options cannot be specified multiple times in the connection string");return m.mongoLoggerOptions=f.MongoLogger.resolveOptions({MONGODB_LOG_COMMAND:process.env.MONGODB_LOG_COMMAND,MONGODB_LOG_TOPOLOGY:process.env.MONGODB_LOG_TOPOLOGY,MONGODB_LOG_SERVER_SELECTION:process.env.MONGODB_LOG_SERVER_SELECTION,MONGODB_LOG_CONNECTION:process.env.MONGODB_LOG_CONNECTION,MONGODB_LOG_CLIENT:process.env.MONGODB_LOG_CLIENT,MONGODB_LOG_ALL:process.env.MONGODB_LOG_ALL,MONGODB_LOG_MAX_DOCUMENT_LENGTH:process.env.MONGODB_LOG_MAX_DOCUMENT_LENGTH,MONGODB_LOG_PATH:process.env.MONGODB_LOG_PATH},{mongodbLogPath:m.mongodbLogPath,mongodbLogComponentSeverities:m.mongodbLogComponentSeverities,mongodbLogMaxDocumentLength:m.mongodbLogMaxDocumentLength}),m.metadata=(0,c.makeClientMetadata)(m),m.extendedMetadata=(0,c.addContainerMetadata)(m.metadata).then(void 0,E.squashError),m};const t=a,r=yo(),o=u,i=Qn(),s=Yn(),c=bo(),l=vo(),h=function(){if(ni)return Mo;ni=1,Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.Encrypter=void 0;const e=n,t=oi(),r=z(),o=Ln(),i=P(),s=Yu();return Mo.Encrypter=class{constructor(e,n,r){if("object"!=typeof r.autoEncryption)throw new i.MongoInvalidArgumentError('Option "autoEncryption" must be specified');this.internalClient=null,this.bypassAutoEncryption=!!r.autoEncryption.bypassAutoEncryption,this.needsConnecting=!1,0===r.maxPoolSize&&null==r.autoEncryption.keyVaultClient?r.autoEncryption.keyVaultClient=e:null==r.autoEncryption.keyVaultClient&&(r.autoEncryption.keyVaultClient=this.getInternalClient(e,n,r)),this.bypassAutoEncryption?r.autoEncryption.metadataClient=void 0:0===r.maxPoolSize?r.autoEncryption.metadataClient=e:r.autoEncryption.metadataClient=this.getInternalClient(e,n,r),r.proxyHost&&(r.autoEncryption.proxyOptions={proxyHost:r.proxyHost,proxyPort:r.proxyPort,proxyUsername:r.proxyUsername,proxyPassword:r.proxyPassword}),this.autoEncrypter=new t.AutoEncrypter(e,r.autoEncryption)}getInternalClient(e,t,n){let o=this.internalClient;if(null==o){const i={};for(const e of[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)])["autoEncryption","minPoolSize","servers","caseTranslate","dbName"].includes(e)||Reflect.set(i,e,Reflect.get(n,e));i.minPoolSize=0,o=new s.MongoClient(t,i),this.internalClient=o;for(const t of r.MONGO_CLIENT_EVENTS)for(const n of e.listeners(t))o.on(t,n);e.on("newListener",((e,t)=>{o?.on(e,t)})),this.needsConnecting=!0}return o}async connectInternalClient(){const e=this.internalClient;this.needsConnecting&&null!=e&&(this.needsConnecting=!1,await e.connect())}closeCallback(t,n,r){(0,e.callbackify)(this.close.bind(this))(t,n,r)}async close(e,t){let n;try{await this.autoEncrypter.teardown(t)}catch(e){n=e}const r=this.internalClient;if(null!=r&&e!==r)return await r.close(t);if(null!=n)throw n}static checkForMongoCrypt(){const e=(0,o.getMongoDBClientEncryption)();if("kModuleError"in e)throw new i.MongoMissingDependencyError("Auto-encryption requested, but the module is not installed. Please add `mongodb-client-encryption` as a dependency of your project",{cause:e.kModuleError,dependencyName:"mongodb-client-encryption"})}},Mo}(),p=P(),d=Yu(),f=me(),m=Q(),y=Z(),g=Zi(),E=fe(),A=de(),b=["authSource","replicaSet","loadBalanced"],_="loadBalanced option only supported with a single host in the URI",O="loadBalanced option not supported with a replicaSet option",C="loadBalanced option not supported when directConnection is provided";function w(e){return async function(n){try{return await t.promises[e](n)}catch(r){if(r.code===t.TIMEOUT)return await t.promises[e](n);throw r}}}const S=w("resolveSrv"),v=w("resolveTxt");function D(e,t){if("boolean"==typeof t)return t;switch(t){case"true":return!0;case"false":return!1;default:throw new p.MongoParseError(`${e} must be either "true" or "false"`)}}function M(e,t){const n=(0,E.parseInteger)(t);if(null!=n)return n;throw new p.MongoParseError(`Expected ${e} to be stringified int value, got: ${t}`)}function T(e,t){const n=M(e,t);if(n<0)throw new p.MongoParseError(`${e} can only be a positive int value, got: ${t}`);return n}function*B(e){if(""===e)return;const t=e.split(",");for(const e of t){const[t,n]=e.split(/:(.*)/);if(null==n)throw new p.MongoParseError("Cannot have undefined values in key value pairs");yield[t,n]}}class F extends Map{constructor(e=[]){super(e.map((([e,t])=>[e.toLowerCase(),t])))}has(e){return super.has(e.toLowerCase())}get(e){return super.get(e.toLowerCase())}set(e,t){return super.set(e.toLowerCase(),t)}delete(e){return super.delete(e.toLowerCase())}}function $(e,t,n){if(t.loadBalanced){if(e.length>1)throw new p.MongoParseError(_);if(t.replicaSet)throw new p.MongoParseError(O);if(t.directConnection)throw new p.MongoParseError(C);if(n&&t.srvMaxHosts>0)throw new p.MongoParseError("Cannot limit srv hosts with loadBalanced enabled")}}function x(e,t,n,r){const{target:o,type:i,transform:s}=n,u=o??t;switch(i){case"boolean":e[u]=D(u,r[0]);break;case"int":e[u]=M(u,r[0]);break;case"uint":e[u]=T(u,r[0]);break;case"string":if(null==r[0])break;e[u]=String(r[0]);break;case"record":if(!(0,E.isRecord)(r[0]))throw new p.MongoParseError(`${u} must be an object`);e[u]=r[0];break;case"any":e[u]=r[0];break;default:{if(!s)throw new p.MongoParseError("Descriptors missing a type must define a transform");const t=s({name:u,options:e,values:r});e[u]=t;break}}}e.OPTIONS={appName:{type:"string"},auth:{target:"credentials",transform({name:e,options:t,values:[n]}){if(!(0,E.isRecord)(n,["username","password"]))throw new p.MongoParseError(`${e} must be an object with 'username' and 'password' properties`);return i.MongoCredentials.merge(t.credentials,{username:n.username,password:n.password})}},authMechanism:{target:"credentials",transform({options:e,values:[t]}){const n=Object.values(s.AuthMechanism),[r]=n.filter((e=>e.match(RegExp(String.raw`\b${t}\b`,"i"))));if(!r)throw new p.MongoParseError(`authMechanism one of ${n}, got ${t}`);let o=e.credentials?.source;(r===s.AuthMechanism.MONGODB_PLAIN||s.AUTH_MECHS_AUTH_SRC_EXTERNAL.has(r))&&(o="$external");let u=e.credentials?.password;return r===s.AuthMechanism.MONGODB_X509&&""===u&&(u=void 0),i.MongoCredentials.merge(e.credentials,{mechanism:r,source:o,password:u})}},authMechanismProperties:{target:"credentials",transform({options:e,values:t}){let n=Object.create(null);for(const e of t)if("string"==typeof e)for(const[t,r]of B(e))try{n[t]=D(t,r)}catch{n[t]=r}else{if(!(0,E.isRecord)(e))throw new p.MongoParseError("AuthMechanismProperties must be an object");n={...e}}return i.MongoCredentials.merge(e.credentials,{mechanismProperties:n})}},authSource:{target:"credentials",transform({options:e,values:[t]}){const n=String(t);return i.MongoCredentials.merge(e.credentials,{source:n})}},autoEncryption:{type:"record"},autoSelectFamily:{type:"boolean",default:!0},autoSelectFamilyAttemptTimeout:{type:"uint"},bsonRegExp:{type:"boolean"},serverApi:{target:"serverApi",transform({values:[e]}){const t="string"==typeof e?{version:e}:e,n=t&&t.version;if(!n)throw new p.MongoParseError(`Invalid \`serverApi\` property; must specify a version from the following enum: ["${Object.values(d.ServerApiVersion).join('", "')}"]`);if(!Object.values(d.ServerApiVersion).some((e=>e===n)))throw new p.MongoParseError(`Invalid server API version=${n}; must be in the following enum: ["${Object.values(d.ServerApiVersion).join('", "')}"]`);return t}},checkKeys:{type:"boolean"},compressors:{default:"none",target:"compressors",transform({values:e}){const t=new Set;for(const n of e){const e="string"==typeof n?n.split(","):n;if(!Array.isArray(e))throw new p.MongoInvalidArgumentError("compressors must be an array or a comma-delimited list of strings");for(const n of e){if(!Object.keys(l.Compressor).includes(String(n)))throw new p.MongoInvalidArgumentError(`${n} is not a valid compression mechanism. Must be one of: ${Object.keys(l.Compressor)}.`);t.add(String(n))}}return[...t]}},connectTimeoutMS:{default:3e4,type:"uint"},dbName:{type:"string"},directConnection:{default:!1,type:"boolean"},driverInfo:{default:{},type:"record"},enableUtf8Validation:{type:"boolean",default:!0},family:{transform({name:e,values:[t]}){const n=M(e,t);if(4===n||6===n)return n;throw new p.MongoParseError(`Option 'family' must be 4 or 6 got ${n}.`)}},fieldsAsRaw:{type:"record"},forceServerObjectId:{default:!1,type:"boolean"},fsync:{deprecated:"Please use journal instead",target:"writeConcern",transform({name:e,options:t,values:[n]}){const r=A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,fsync:D(e,n)}});if(!r)throw new p.MongoParseError(`Unable to make a writeConcern from fsync=${n}`);return r}},heartbeatFrequencyMS:{default:1e4,type:"uint"},ignoreUndefined:{type:"boolean"},j:{deprecated:"Please use journal instead",target:"writeConcern",transform({name:e,options:t,values:[n]}){const r=A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,journal:D(e,n)}});if(!r)throw new p.MongoParseError(`Unable to make a writeConcern from journal=${n}`);return r}},journal:{target:"writeConcern",transform({name:e,options:t,values:[n]}){const r=A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,journal:D(e,n)}});if(!r)throw new p.MongoParseError(`Unable to make a writeConcern from journal=${n}`);return r}},loadBalanced:{default:!1,type:"boolean"},localThresholdMS:{default:15,type:"uint"},maxConnecting:{default:2,transform({name:e,values:[t]}){const n=T(e,t);if(0===n)throw new p.MongoInvalidArgumentError("maxConnecting must be > 0 if specified");return n}},maxIdleTimeMS:{default:0,type:"uint"},maxPoolSize:{default:100,type:"uint"},maxStalenessSeconds:{target:"readPreference",transform({name:e,options:t,values:[n]}){const r=T(e,n);return t.readPreference?y.ReadPreference.fromOptions({readPreference:{...t.readPreference,maxStalenessSeconds:r}}):new y.ReadPreference("secondary",void 0,{maxStalenessSeconds:r})}},minInternalBufferSize:{type:"uint"},minPoolSize:{default:0,type:"uint"},minHeartbeatFrequencyMS:{default:500,type:"uint"},monitorCommands:{default:!1,type:"boolean"},name:{target:"driverInfo",transform:({values:[e],options:t})=>({...t.driverInfo,name:String(e)})},noDelay:{default:!0,type:"boolean"},pkFactory:{default:E.DEFAULT_PK_FACTORY,transform({values:[e]}){if((0,E.isRecord)(e,["createPk"])&&"function"==typeof e.createPk)return e;throw new p.MongoParseError(`Option pkFactory must be an object with a createPk function, got ${e}`)}},promoteBuffers:{type:"boolean"},promoteLongs:{type:"boolean"},promoteValues:{type:"boolean"},useBigInt64:{type:"boolean"},proxyHost:{type:"string"},proxyPassword:{type:"string"},proxyPort:{type:"uint"},proxyUsername:{type:"string"},raw:{default:!1,type:"boolean"},readConcern:{transform({values:[e],options:t}){if(e instanceof m.ReadConcern||(0,E.isRecord)(e,["level"]))return m.ReadConcern.fromOptions({...t.readConcern,...e});throw new p.MongoParseError(`ReadConcern must be an object, got ${JSON.stringify(e)}`)}},readConcernLevel:{target:"readConcern",transform:({values:[e],options:t})=>m.ReadConcern.fromOptions({...t.readConcern,level:e})},readPreference:{default:y.ReadPreference.primary,transform({values:[e],options:t}){if(e instanceof y.ReadPreference)return y.ReadPreference.fromOptions({readPreference:{...t.readPreference,...e},...e});if((0,E.isRecord)(e,["mode"])){const n=y.ReadPreference.fromOptions({readPreference:{...t.readPreference,...e},...e});if(n)return n;throw new p.MongoParseError(`Cannot make read preference from ${JSON.stringify(e)}`)}if("string"==typeof e){const n={hedge:t.readPreference?.hedge,maxStalenessSeconds:t.readPreference?.maxStalenessSeconds};return new y.ReadPreference(e,t.readPreference?.tags,n)}throw new p.MongoParseError(`Unknown ReadPreference value: ${e}`)}},readPreferenceTags:{target:"readPreference",transform({values:e,options:t}){const n=Array.isArray(e[0])?e[0]:e,r=[];for(const e of n){const t=Object.create(null);if("string"==typeof e)for(const[n,r]of B(e))t[n]=r;if((0,E.isRecord)(e))for(const[n,r]of Object.entries(e))t[n]=r;r.push(t)}return y.ReadPreference.fromOptions({readPreference:t.readPreference,readPreferenceTags:r})}},replicaSet:{type:"string"},retryReads:{default:!0,type:"boolean"},retryWrites:{default:!0,type:"boolean"},serializeFunctions:{type:"boolean"},serverMonitoringMode:{default:"auto",transform({values:[e]}){if(!Object.values(g.ServerMonitoringMode).includes(e))throw new p.MongoParseError("serverMonitoringMode must be one of `auto`, `poll`, or `stream`");return e}},serverSelectionTimeoutMS:{default:3e4,type:"uint"},servername:{type:"string"},socketTimeoutMS:{default:0,type:"uint"},srvMaxHosts:{type:"uint",default:0},srvServiceName:{type:"string",default:"mongodb"},ssl:{target:"tls",type:"boolean"},timeoutMS:{type:"uint"},tls:{type:"boolean"},tlsAllowInvalidCertificates:{target:"rejectUnauthorized",transform:({name:e,values:[t]})=>!D(e,t)},tlsAllowInvalidHostnames:{target:"checkServerIdentity",transform:({name:e,values:[t]})=>D(e,t)?()=>{}:void 0},tlsCAFile:{type:"string"},tlsCRLFile:{type:"string"},tlsCertificateKeyFile:{type:"string"},tlsCertificateKeyFilePassword:{target:"passphrase",type:"any"},tlsInsecure:{transform({name:e,options:t,values:[n]}){const r=D(e,n);return r?(t.checkServerIdentity=()=>{},t.rejectUnauthorized=!1):(t.checkServerIdentity=t.tlsAllowInvalidHostnames?()=>{}:void 0,t.rejectUnauthorized=!t.tlsAllowInvalidCertificates),r}},w:{target:"writeConcern",transform:({values:[e],options:t})=>A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,w:e}})},waitQueueTimeoutMS:{default:0,type:"uint"},writeConcern:{target:"writeConcern",transform({values:[e],options:t}){if((0,E.isRecord)(e)||e instanceof A.WriteConcern)return A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,...e}});if("majority"===e||"number"==typeof e)return A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,w:e}});throw new p.MongoParseError(`Invalid WriteConcern cannot parse: ${JSON.stringify(e)}`)}},wtimeout:{deprecated:"Please use wtimeoutMS instead",target:"writeConcern",transform({values:[e],options:t}){const n=A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,wtimeout:T("wtimeout",e)}});if(n)return n;throw new p.MongoParseError("Cannot make WriteConcern from wtimeout")}},wtimeoutMS:{target:"writeConcern",transform({values:[e],options:t}){const n=A.WriteConcern.fromOptions({writeConcern:{...t.writeConcern,wtimeoutMS:T("wtimeoutMS",e)}});if(n)return n;throw new p.MongoParseError("Cannot make WriteConcern from wtimeout")}},zlibCompressionLevel:{default:0,type:"int"},mongodbLogPath:{transform({values:[e]}){if(!("string"==typeof e&&["stderr","stdout"].includes(e)||e&&"object"==typeof e&&"write"in e&&"function"==typeof e.write))throw new p.MongoAPIError("Option 'mongodbLogPath' must be of type 'stderr' | 'stdout' | MongoDBLogWritable");return e}},mongodbLogComponentSeverities:{transform({values:[e]}){if("object"!=typeof e||!e)throw new p.MongoAPIError("Option 'mongodbLogComponentSeverities' must be a non-null object");for(const[t,n]of Object.entries(e)){if("string"!=typeof n||"string"!=typeof t)throw new p.MongoAPIError("User input for option 'mongodbLogComponentSeverities' object cannot include a non-string key or value");if(!Object.values(f.MongoLoggableComponent).some((e=>e===t))&&"default"!==t)throw new p.MongoAPIError(`User input for option 'mongodbLogComponentSeverities' contains invalid key: ${t}`);if(!Object.values(f.SeverityLevel).some((e=>e===n)))throw new p.MongoAPIError(`Option 'mongodbLogComponentSeverities' does not support ${n} as a value for ${t}`)}return e}},mongodbLogMaxDocumentLength:{type:"uint"},connectionType:{type:"any"},srvPoller:{type:"any"},allowPartialTrustChain:{type:"any"},minDHSize:{type:"any"},pskCallback:{type:"any"},secureContext:{type:"any"},enableTrace:{type:"any"},requestCert:{type:"any"},rejectUnauthorized:{type:"any"},checkServerIdentity:{type:"any"},ALPNProtocols:{type:"any"},SNICallback:{type:"any"},session:{type:"any"},requestOCSP:{type:"any"},localAddress:{type:"any"},localPort:{type:"any"},hints:{type:"any"},lookup:{type:"any"},ca:{type:"any"},cert:{type:"any"},ciphers:{type:"any"},crl:{type:"any"},ecdhCurve:{type:"any"},key:{type:"any"},passphrase:{type:"any"},pfx:{type:"any"},secureProtocol:{type:"any"},index:{type:"any"},useNewUrlParser:{type:"boolean",deprecated:"useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version"},useUnifiedTopology:{type:"boolean",deprecated:"useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version"},__skipPingOnConnect:{type:"boolean"}},e.DEFAULT_OPTIONS=new F(Object.entries(e.OPTIONS).filter((([,e])=>null!=e.default)).map((([e,t])=>[e,t.default])))}(Xn)),Xn}var ts,ns={},os={};function is(){if(ts)return os;ts=1,Object.defineProperty(os,"__esModule",{value:!0}),os.MongoDBAWS=void 0;const e=F(),t=Ln(),n=P(),r=fe(),o=Wn(),i=Uo(),s=Qn(),u=Yn(),a={useBigInt64:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!1,bsonRegExp:!1};class c extends o.AuthProvider{constructor(e){super(),this.credentialProvider=e,this.credentialFetcher=i.AWSTemporaryCredentialProvider.isAWSSDKInstalled?new i.AWSSDKCredentialProvider(e):new i.LegacyAWSTemporaryCredentialProvider}async auth(o){const{connection:i}=o;if(!o.credentials)throw new n.MongoMissingCredentialsError("AuthContext must provide credentials.");if("kModuleError"in t.aws4)throw t.aws4.kModuleError;const{sign:c}=t.aws4;if((0,r.maxWireVersion)(i)<9)throw new n.MongoCompatibilityError("MONGODB-AWS authentication requires MongoDB version 4.4 or later");o.credentials.username||(o.credentials=await async function(e,t){function r(t){if(!t.AccessKeyId||!t.SecretAccessKey)throw new n.MongoMissingCredentialsError("Could not obtain temporary MONGODB-AWS credentials");return new s.MongoCredentials({username:t.AccessKeyId,password:t.SecretAccessKey,source:e.source,mechanism:u.AuthMechanism.MONGODB_AWS,mechanismProperties:{AWS_SESSION_TOKEN:t.Token}})}return r(await t.getCredentials())}(o.credentials,this.credentialFetcher));const{credentials:h}=o,p=h.username,d=h.password,f=h.mechanismProperties.AWS_SESSION_TOKEN,m=p&&d&&f?{accessKeyId:p,secretAccessKey:d,sessionToken:f}:p&&d?{accessKeyId:p,secretAccessKey:d}:void 0,y=h.source,g=await(0,r.randomBytes)(32),E={saslStart:1,mechanism:"MONGODB-AWS",payload:e.serialize({r:g,p:110},a)},A=await i.command((0,r.ns)(`${y}.$cmd`),E,void 0),b=e.deserialize(A.payload.buffer,a),_=b.h,O=b.s.buffer;if(64!==O.length)throw new n.MongoRuntimeError(`Invalid server nonce length ${O.length}, expected 64`);if(!r.ByteUtils.equals(O.subarray(0,g.byteLength),g))throw new n.MongoRuntimeError("Server nonce does not begin with client nonce");if(_.length<1||_.length>255||-1!==_.indexOf(".."))throw new n.MongoRuntimeError(`Server returned an invalid host: "${_}"`);const C="Action=GetCallerIdentity&Version=2011-06-15",w=c({method:"POST",host:_,region:l(b.h),service:"sts",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":43,"X-MongoDB-Server-Nonce":r.ByteUtils.toBase64(O),"X-MongoDB-GS2-CB-Flag":"n"},path:"/",body:C},m),S={a:w.headers.Authorization,d:w.headers["X-Amz-Date"]};f&&(S.t=f);const v={saslContinue:1,conversationId:A.conversationId,payload:e.serialize(S,a)};await i.command((0,r.ns)(`${y}.$cmd`),v,void 0)}}function l(e){const t=e.split(".");return 1===t.length||"amazonaws"===t[1]?"us-east-1":t[1]}return os.MongoDBAWS=c,os}var ss,us,as,cs={},ls={},hs={},ps={};function ds(){if(ss)return ps;ss=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.finishCommandDocument=function(n,r){if(null!=r)return{saslContinue:1,conversationId:r,payload:new e.Binary(e.BSON.serialize({jwt:n}))};return{saslStart:1,mechanism:t.AuthMechanism.MONGODB_OIDC,payload:new e.Binary(e.BSON.serialize({jwt:n}))}},ps.startCommandDocument=function(n){const r={};n.username&&(r.n=n.username);return{saslStart:1,autoAuthorize:1,mechanism:t.AuthMechanism.MONGODB_OIDC,payload:new e.Binary(e.BSON.serialize(r))}};const e=F(),t=Yn();return ps}function fs(){if(us)return hs;us=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.MachineWorkflow=void 0;const e=y,t=fe(),n=ds();return hs.MachineWorkflow=class{constructor(e){this.cache=e,this.callback=this.withLock(this.getToken.bind(this)),this.lastExecutionTime=Date.now()-100}async execute(e,r){const o=await this.getTokenFromCacheOrEnv(e,r),i=(0,n.finishCommandDocument)(o);await e.command((0,t.ns)(r.source),i,void 0)}async reauthenticate(e,t){this.cache.hasAccessToken&&(e.accessToken===this.cache.getAccessToken()?(this.cache.removeAccessToken(),delete e.accessToken):e.accessToken=this.cache.getAccessToken()),await this.execute(e,t)}async speculativeAuth(e,t){if(!this.cache.hasAccessToken)return{};const r=await this.getTokenFromCacheOrEnv(e,t),o=(0,n.finishCommandDocument)(r);return o.db=t.source,{speculativeAuthenticate:o}}async getTokenFromCacheOrEnv(e,t){if(this.cache.hasAccessToken){const t=this.cache.getAccessToken();return e.accessToken||(e.accessToken=t),t}{const n=await this.callback(t);return this.cache.put({accessToken:n.access_token,expiresInSeconds:n.expires_in}),e.accessToken=n.access_token,n.access_token}}withLock(t){let n=Promise.resolve();return async r=>(await n,n=n.catch((()=>null)).then((async()=>{const n=Date.now()-this.lastExecutionTime;return n<=100&&await(0,e.setTimeout)(100-n),this.lastExecutionTime=Date.now(),await t(r)})),await n)}},hs}function ms(){if(as)return ls;as=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.AzureMachineWorkflow=void 0;const e=Wo(),t=P(),n=fe(),r=fs(),o=Object.freeze({Metadata:"true",Accept:"application/json"});class i extends r.MachineWorkflow{constructor(e){super(e)}async getToken(r){const i=r?.mechanismProperties.TOKEN_RESOURCE,s=r?.username;if(!i)throw new t.MongoAzureError("TOKEN_RESOURCE must be set in the auth mechanism properties when ENVIRONMENT is azure.");const u=await async function(r,i){const s=new URL(e.AZURE_BASE_URL);(0,e.addAzureParams)(s,r,i);const u=await(0,n.get)(s,{headers:o});if(200!==u.status)throw new t.MongoAzureError(`Status code ${u.status} returned from the Azure endpoint. Response body: ${u.body}`);const a=JSON.parse(u.body);return{access_token:a.access_token,expires_in:Number(a.expires_in)}}(i,s);if(null==(a=u)||"object"!=typeof a||!("access_token"in a)||"string"!=typeof a.access_token||!("expires_in"in a)||"number"!=typeof a.expires_in)throw new t.MongoAzureError("Azure endpoint did not return a value with only access_token and expires_in properties");var a;return u}}return ls.AzureMachineWorkflow=i,ls}var ys,gs={};function Es(){if(ys)return gs;ys=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.GCPMachineWorkflow=void 0;const e=P(),t=fe(),n=fs(),r="http://metadata/computeMetadata/v1/instance/service-accounts/default/identity",o=Object.freeze({"Metadata-Flavor":"Google"});class i extends n.MachineWorkflow{constructor(e){super(e)}async getToken(n){const i=n?.mechanismProperties.TOKEN_RESOURCE;if(!i)throw new e.MongoGCPError("TOKEN_RESOURCE must be set in the auth mechanism properties when ENVIRONMENT is gcp.");return await async function(n){const i=new URL(r);i.searchParams.append("audience",n);const s=await(0,t.get)(i,{headers:o});if(200!==s.status)throw new e.MongoGCPError(`Status code ${s.status} returned from the GCP endpoint. Response body: ${s.body}`);return{access_token:s.body}}(i)}}return gs.GCPMachineWorkflow=i,gs}var As,bs={};var _s,Os={};function Cs(){if(_s)return Os;_s=1,Object.defineProperty(Os,"__esModule",{value:!0}),Os.TokenCache=void 0;const e=P();class t extends e.MongoDriverError{}return Os.TokenCache=class{get hasAccessToken(){return!!this.accessToken}get hasRefreshToken(){return!!this.refreshToken}get hasIdpInfo(){return!!this.idpInfo}getAccessToken(){if(!this.accessToken)throw new t("Attempted to get an access token when none exists.");return this.accessToken}getRefreshToken(){if(!this.refreshToken)throw new t("Attempted to get a refresh token when none exists.");return this.refreshToken}getIdpInfo(){if(!this.idpInfo)throw new t("Attempted to get IDP information when none exists.");return this.idpInfo}put(e,t){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expiresInSeconds=e.expiresInSeconds,t&&(this.idpInfo=t)}removeAccessToken(){this.accessToken=void 0}removeRefreshToken(){this.refreshToken=void 0}},Os}var ws,Ss,vs={};function Ds(){return Ss||(Ss=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MongoDBOIDC=e.OIDC_WORKFLOWS=e.OIDC_VERSION=void 0;const t=P(),n=Wn(),r=ms(),i=Es(),s=function(){if(As)return bs;As=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.K8SMachineWorkflow=void 0;const e=d,t=fs(),n="AZURE_FEDERATED_TOKEN_FILE",r="AWS_WEB_IDENTITY_TOKEN_FILE";class o extends t.MachineWorkflow{constructor(e){super(e)}async getToken(){let t;return t=process.env[n]?process.env[n]:process.env[r]?process.env[r]:"/var/run/secrets/kubernetes.io/serviceaccount/token",{access_token:await(0,e.readFile)(t,"utf8")}}}return bs.K8SMachineWorkflow=o,bs}(),u=Cs(),a=function(){if(ws)return vs;ws=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.TokenMachineWorkflow=void 0;const e=o,t=P(),n=fs();class r extends n.MachineWorkflow{constructor(e){super(e)}async getToken(){const n=process.env.OIDC_TOKEN_FILE;if(!n)throw new t.MongoAWSError("OIDC_TOKEN_FILE must be set in the environment.");return{access_token:await e.promises.readFile(n,"utf8")}}}return vs.TokenMachineWorkflow=r,vs}();e.OIDC_VERSION=1,e.OIDC_WORKFLOWS=new Map,e.OIDC_WORKFLOWS.set("test",(()=>new a.TokenMachineWorkflow(new u.TokenCache))),e.OIDC_WORKFLOWS.set("azure",(()=>new r.AzureMachineWorkflow(new u.TokenCache))),e.OIDC_WORKFLOWS.set("gcp",(()=>new i.GCPMachineWorkflow(new u.TokenCache))),e.OIDC_WORKFLOWS.set("k8s",(()=>new s.K8SMachineWorkflow(new u.TokenCache)));class c extends n.AuthProvider{constructor(e){if(super(),!e)throw new t.MongoInvalidArgumentError("No workflow provided to the OIDC auth provider.");this.workflow=e}async auth(e){const{connection:t,reauthenticating:n,response:r}=e;if(r?.speculativeAuthenticate?.done&&!n)return;const o=l(e);n?await this.workflow.reauthenticate(t,o):await this.workflow.execute(t,o,r)}async prepare(e,t){const{connection:n}=t,r=l(t);return{...e,...await this.workflow.speculativeAuth(n,r)}}}function l(e){const{credentials:n}=e;if(!n)throw new t.MongoMissingCredentialsError("AuthContext must provide credentials.");return n}e.MongoDBOIDC=c}(cs)),cs}var Ms,Ts,Bs={},Fs={};function $s(){if(Ms)return Fs;Ms=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.CallbackWorkflow=Fs.AUTOMATED_TIMEOUT_MS=Fs.HUMAN_TIMEOUT_MS=void 0;const e=y,t=P(),n=fe(),r=ds();Fs.HUMAN_TIMEOUT_MS=3e5,Fs.AUTOMATED_TIMEOUT_MS=6e4;const o=["accessToken","expiresInSeconds","refreshToken"];return Fs.CallbackWorkflow=class{constructor(e,t){this.cache=e,this.callback=this.withLock(t),this.lastExecutionTime=Date.now()-100}async speculativeAuth(e,t){if(this.cache.hasAccessToken){const n=this.cache.getAccessToken();e.accessToken=n;const o=(0,r.finishCommandDocument)(n);return o.db=t.source,{speculativeAuthenticate:o}}return{}}async reauthenticate(e,t){this.cache.hasAccessToken&&(e.accessToken===this.cache.getAccessToken()?(this.cache.removeAccessToken(),delete e.accessToken):e.accessToken=this.cache.getAccessToken()),await this.execute(e,t)}async startAuthentication(e,t,o){let i;return i=o?.speculativeAuthenticate?o.speculativeAuthenticate:await e.command((0,n.ns)(t.source),(0,r.startCommandDocument)(t),void 0),i}async finishAuthentication(e,t,o,i){await e.command((0,n.ns)(t.source),(0,r.finishCommandDocument)(o,i),void 0)}async executeAndValidateCallback(e){const n=await this.callback(e);if(null==(r=n)||"object"!=typeof r||!("accessToken"in r)||!Object.getOwnPropertyNames(r).every((e=>o.includes(e))))throw new t.MongoMissingCredentialsError("User provided OIDC callbacks must return a valid object with an accessToken.");var r;return n}withLock(t){let n=Promise.resolve();return async r=>(await n,n=n.catch((()=>null)).then((async()=>{const n=Date.now()-this.lastExecutionTime;return n<=100&&await(0,e.setTimeout)(100-n,{signal:r.timeoutContext}),this.lastExecutionTime=Date.now(),await t(r)})),await n)}},Fs}var xs,Ps={};var Ns,Is={};var Rs,ks,js={};var Ls,Us,Vs,zs,Ws,qs={};function Gs(){if(Us)return Ls;function e(n,r){if(!(this instanceof e))return new e(n,r);this.length=0,this.updates=[],this.path=new Uint16Array(4),this.pages=new Array(32768),this.maxPages=this.pages.length,this.level=0,this.pageSize=n||1024,this.deduplicate=r?r.deduplicate:null,this.zeros=this.deduplicate?t(this.deduplicate.length):null}function t(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}function n(e,t){this.offset=e*t.length,this.buffer=t,this.updated=!1,this.deduplicate=0}return Us=1,Ls=e,e.prototype.updated=function(e){for(;this.deduplicate&&e.buffer[e.deduplicate]===this.deduplicate[e.deduplicate];)if(e.deduplicate++,e.deduplicate===this.deduplicate.length){e.deduplicate=0,e.buffer.equals&&e.buffer.equals(this.deduplicate)&&(e.buffer=this.deduplicate);break}!e.updated&&this.updates&&(e.updated=!0,this.updates.push(e))},e.prototype.lastUpdate=function(){if(!this.updates||!this.updates.length)return null;var e=this.updates.pop();return e.updated=!1,e},e.prototype._array=function(e,t){if(e>=this.maxPages){if(t)return;!function(e,t){for(;e.maxPages<t;){var n=e.pages;e.pages=new Array(32768),e.pages[0]=n,e.level++,e.maxPages*=32768}}(this,e)}var n,r;n=e,r=this.path,n=((n=(n-(r[0]=32767&n))/32768)-(r[1]=32767&n))/32768,r[3]=(n-(r[2]=32767&n))/32768&32767;for(var o=this.pages,i=this.level;i>0;i--){var s=this.path[i],u=o[s];if(!u){if(t)return;u=o[s]=new Array(32768)}o=u}return o},e.prototype.get=function(e,r){var o,i,s=this._array(e,r),u=this.path[0],a=s&&s[u];return a||r||(a=s[u]=new n(e,t(this.pageSize)),e>=this.length&&(this.length=e+1)),a&&a.buffer===this.deduplicate&&this.deduplicate&&!r&&(a.buffer=(o=a.buffer,i=Buffer.allocUnsafe?Buffer.allocUnsafe(o.length):new Buffer(o.length),o.copy(i),i),a.deduplicate=0),a},e.prototype.set=function(e,r){var o=this._array(e,!1),i=this.path[0];if(e>=this.length&&(this.length=e+1),!r||this.zeros&&r.equals&&r.equals(this.zeros))o[i]=void 0;else{this.deduplicate&&r.equals&&r.equals(this.deduplicate)&&(r=this.deduplicate);var s=o[i],u=function(e,n){if(e.length===n)return e;if(e.length>n)return e.slice(0,n);var r=t(n);return e.copy(r),r}(r,this.pageSize);s?s.buffer=u:o[i]=new n(e,u)}},e.prototype.toBuffer=function(){for(var e=new Array(this.length),n=t(this.pageSize),r=0;r<e.length;)for(var o=this._array(r,!0),i=0;i<32768&&r<e.length;i++)e[r++]=o&&o[i]?o[i].buffer:n;return Buffer.concat(e)},Ls}function Hs(){if(zs)return Vs;zs=1;var e=Gs();function t(n){if(!(this instanceof t))return new t(n);if(n||(n={}),Buffer.isBuffer(n)&&(n={buffer:n}),this.pageOffset=n.pageOffset||0,this.pageSize=n.pageSize||1024,this.pages=n.pages||e(this.pageSize),this.byteLength=this.pages.length*this.pageSize,this.length=8*this.byteLength,(r=this.pageSize)&r-1)throw new Error("The page size should be a power of two");var r;if(this._trackUpdates=!!n.trackUpdates,this._pageMask=this.pageSize-1,n.buffer){for(var o=0;o<n.buffer.length;o+=this.pageSize)this.pages.set(o/this.pageSize,n.buffer.slice(o,o+this.pageSize));this.byteLength=n.buffer.length,this.length=8*this.byteLength}}return Vs=t,t.prototype.get=function(e){var t=7&e,n=(e-t)/8;return!!(this.getByte(n)&128>>t)},t.prototype.getByte=function(e){var t=e&this._pageMask,n=(e-t)/this.pageSize,r=this.pages.get(n,!0);return r?r.buffer[t+this.pageOffset]:0},t.prototype.set=function(e,t){var n=7&e,r=(e-n)/8,o=this.getByte(r);return this.setByte(r,t?o|128>>n:o&(255^128>>n))},t.prototype.toBuffer=function(){for(var e=function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}(this.pages.length*this.pageSize),t=0;t<this.pages.length;t++){var n=this.pages.get(t,!0),r=t*this.pageSize;n&&n.buffer.copy(e,r,this.pageOffset,this.pageOffset+this.pageSize)}return e},t.prototype.setByte=function(e,t){var n=e&this._pageMask,r=(e-n)/this.pageSize,o=this.pages.get(r,!1);return n+=this.pageOffset,o.buffer[n]!==t&&(o.buffer[n]=t,e>=this.byteLength&&(this.byteLength=e+1,this.length=8*this.byteLength),this._trackUpdates&&this.pages.updated(o),!0)},Vs}var Ks,Ys,Qs,Js,Xs={};function Zs(){if(Qs)return Ys;Qs=1;var e=Ys&&Ys.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const t=e(function(){if(ks)return Rs;ks=1;const e=e=>e.codePointAt(0);function t(e){const t=[],n=e.length;for(let r=0;r<n;r+=1){const o=e.charCodeAt(r);if(o>=55296&&o<=56319&&n>r+1){const n=e.charCodeAt(r+1);if(n>=56320&&n<=57343){t.push(1024*(o-55296)+n-56320+65536),r+=1;continue}}t.push(o)}return t}function n({unassigned_code_points:n,commonly_mapped_to_nothing:r,non_ASCII_space_characters:o,prohibited_characters:i,bidirectional_r_al:s,bidirectional_l:u},a,c={}){const l=o,h=r;if("string"!=typeof a)throw new TypeError("Expected string.");if(0===a.length)return"";const p=t(a).map((e=>l.get(e)?32:e)).filter((e=>!h.get(e))),d=String.fromCodePoint.apply(null,p).normalize("NFKC"),f=t(d);if(f.some((e=>i.get(e))))throw new Error("Prohibited character, see https://tools.ietf.org/html/rfc4013#section-2.3");if(!0!==c.allowUnassigned&&f.some((e=>n.get(e))))throw new Error("Unassigned code point, see https://tools.ietf.org/html/rfc4013#section-2.5");const m=f.some((e=>s.get(e))),y=f.some((e=>u.get(e)));if(m&&y)throw new Error("String must not contain RandALCat and LCat at the same time, see https://tools.ietf.org/html/rfc3454#section-6");const g=s.get(e(d[0])),E=s.get(e((A=d)[A.length-1]));var A;if(m&&(!g||!E))throw new Error("Bidirectional RandALCat character must be the first and the last character of the string, see https://tools.ietf.org/html/rfc3454#section-6");return d}return n.saslprep=n,n.default=n,Rs=n}()),n=function(){if(Ws)return qs;Ws=1;var e=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qs,"__esModule",{value:!0}),qs.createMemoryCodePoints=function(e){let n=0;function r(){const r=e.readUInt32BE(n);n+=4;const o=e.slice(n,n+r);return n+=r,(0,t.default)({buffer:o})}return{unassigned_code_points:r(),commonly_mapped_to_nothing:r(),non_ASCII_space_characters:r(),prohibited_characters:r(),bidirectional_r_al:r(),bidirectional_l:r()}};const t=e(Hs());return qs}(),r=e(function(){if(Ks)return Xs;Ks=1,Object.defineProperty(Xs,"__esModule",{value:!0});const e=h;return Xs.default=(0,e.gunzipSync)(Buffer.from("H4sIAAAAAAACA+3dTYgcaRkA4LemO9Mhxm0FITnE9Cwr4jHgwgZ22B6YywqCJ0HQg5CL4sGTuOjCtGSF4CkHEW856MlTQHD3EJnWkU0Owh5VxE3LHlYQdNxd2U6mU59UV/d09fw4M2EySSXPAzNdP1/9fX/99bzVNZEN4jisRDulVFnQmLxm1aXF9Id/2/xMxNJ4XZlg576yuYlGt9gupV6xoFf8jhu9YvulVrFlp5XSx+lfvYhORGPXvqIRWSxERKtIm8bKFd10WNfKDS5Fo9jJWrq2+M2IlW+8uHgl/+BsROfPF4v5L7148Ur68Sha6dqZpYiVVy8tvLCWXo80Sf/lS89dGX2wHGvpzoXVn75/YWH5wmqe8uika82ViJXTy83Ve2k5Urozm38wm4/ls6t5uT6yfsTSJ7J3T0VKt8c5ExEXI8aFkH729c3eT+7EC6ca8cVULZUiYacX0R5PNWNxlh9L1y90q5kyzrpyy+9WcvOV6URntqw7La9sNVstXyczWVaWYbaaTYqzOHpr7pyiNT3/YzKuT63Z/FqKZlFTiuXtFM2vVOtIq7jiyKJbWZaOWD0euz0yoV2Z7kY0xq2x0YhfzVpmM5px9nTEH7JZ0ot5u39p0ma75Z472/s/H+2yr2inYyuq7fMvJivH2rM72N/Z3lyL31F2b1ya1P0zn816k2KP6JU9UzseucdQH5YqVeH/lFajSN2udg+TLJ9rksNxlvV2lki19rXKI43TPLejFu4ov7k3nMbhyhfY3Xb37f8BAGCf0eMTOH5szf154KmnNgKcnLb+Fzi2AfXktbN7fJelwTAiO/W5uQ2KINXRYu+znqo/WTAdLadURHmy3qciazd3bra4T3w16/f7t7Ms9U5gfJu10955sx1r3vmhBAAAAAAAgId20J1iZbDowNvIjuH427Gr5l/eiC+8OplZON8sVjx/qr9y+Pj+YRItT+NqAM+kkZs3AAAAAID6yfx1FwCAI97/dCh1/ub6SA0AAAAAAAAAgNoT/wcAAAAAAACA+hP/BwAAAAAAAID6E/8HAAAAAAAAgPoT/wcAAAAAAACA+hP/BwAAAAAAAID6E/8HAAAAAAAAgPoT/wcAAAAAAACA+hP/BwAAAAAAAID6E/8HAAAAAAAAgPoT/wcAAAAAAACA+hutp5SiQpYAAAAAAAAAQO2MIpZiT804flnAE2fhwjOeAZXr76kOAAAAAAAA8FjNf4N/l0NE3U/vuVQskLpSd4/Yh2xu9xTu0tFeeNYsLI2f/VMdNxTzj6Je9E/+6pp6Nn3awW3A54goe4Bss6v+PGsjQGMAAAAAAOBp5XEgwH6e7J7rwEQHRb/XvAMAAAAAAAA8yzoDeQDwVGjIAgAAAAAAAACoPfF/AAAAAAAAAKg/8X8AAAAAAAAAqD/xfwAAAAAAAACoP/F/AAAAAAAAAKg/8X8AAAAAAAAAqD/xfwAAAAAAAACoP/F/AAAAAAAAAKg/8X8AAAAAAAAAqD/xfwAAAAAAAACoP/F/AAAAAAAAAKg/8X8AAAAAAAAAqL/GSkSkClkCAAAAAAAAALXTSAAAAAAAAABA3Y1kAQAAAAAAAADUX8RSXZ9dsHC9+M8Fg2Ex/em1lAZpEBGttcrVjZqLEa+k0XpKw9mG4zWx4ukPUMhkAQAAAAAAABzBqbSe3//rXOS9HxGdo4TqR2XkutCdBu+LaPZw/lBbO7cbHnh2C7N7AIo4evEznllqLqWUp/LnYOtpM2bnOH66wI1+9GO4sOuISwv/TOlumu56FDv3NZhc4mR9v7zYIrafr40j/Cccvj9Xns3t3mu99E7qxUv3bqS0/ouNH/08++RGemfQ+nsx/5uNXsQPGulynPvv3ZTW37zd+1ovrqaYpP/122X6Xpx779Z3zr/3YOPKW1lkaRDf31pPaf3j/msRsVGkL+d/f+/m4sJsPm1cfSsr16e8m9Ldj/KsnyIuR3nXw83Is3EhxLd/2V773ks3m/cj/THKUummdP9qKhIOImuOU0Xjwb3y+oqt735rpTetVbF9n8R4x9crRfO77TKqVOZpDclv5bfK18lMnk+q0K18UpxF/RrGXE0Zxtqx3tWSj+vxbL4XaasfKb0dRbtLW73JsfPGg177H+OmGKlfvS1msllt7JEJm9XOJqXR+Fkfo1H66uy5H1v3Xx5+uJmGLw9jro2u7Loj4PnuR6+f+e3d261+eazNhzrL7X83MohoHpS4PddV8ki1it61//pw1g7z6p1U/26Nm2llST57B5rUvuG0XqSU/rPd7jYrqWcbd+beJQ77BgPMDwn37/8BAGCf0eMTOH4cPlufv9VGgJOzqf8Fjm1APXkd7B7f5dF57GPMaWy/MTvjvNvtXj6h8W2+GXvnzXaseeeHEgAAAAAAAB7aQXeKlcGiadBoEOeLb2dtpGOL2MyOtf391a3P/zD96c3JzIP3t4oV797vrh8+vn+YRL5bBuj/AQAAAABqJvfHXQAAHkX82zfXAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACeAgkAAAAAAAAAqLuRLAAAAAAAAACA2hv9D1iu/VAYaAYA","base64")),Xs}()),o=(0,n.createMemoryCodePoints)(r.default);function i(e,n){return(0,t.default)(o,e,n)}return i.saslprep=i,i.default=i,Ys=i}function eu(){if(Js)return js;Js=1,Object.defineProperty(js,"__esModule",{value:!0}),js.ScramSHA256=js.ScramSHA1=void 0;const e=Zs(),t=r,n=F(),o=P(),i=fe(),s=Wn(),u=Yn();class a extends s.AuthProvider{constructor(e){super(),this.cryptoMethod=e||"sha1"}async prepare(e,t){const n=this.cryptoMethod,r=t.credentials;if(!r)throw new o.MongoMissingCredentialsError("AuthContext must provide credentials.");const s=await(0,i.randomBytes)(24);t.nonce=s;return{...e,speculativeAuthenticate:{...h(n,r,s),db:r.source}}}async auth(e){const{reauthenticating:t,response:n}=e;return n?.speculativeAuthenticate&&!t?await p(this.cryptoMethod,n.speculativeAuthenticate,e):await async function(e,t){const{connection:n,credentials:r}=t;if(!r)throw new o.MongoMissingCredentialsError("AuthContext must provide credentials.");if(!t.nonce)throw new o.MongoInvalidArgumentError("AuthContext must contain a valid nonce property");const s=t.nonce,u=r.source,a=h(e,r,s),c=await n.command((0,i.ns)(`${u}.$cmd`),a,void 0);await p(e,c,t)}(this.cryptoMethod,e)}}function c(e){return e.replace("=","=3D").replace(",","=2C")}function l(e,t){return Buffer.concat([Buffer.from("n=","utf8"),Buffer.from(e,"utf8"),Buffer.from(",r=","utf8"),Buffer.from(t.toString("base64"),"utf8")])}function h(e,t,r){const o=c(t.username);return{saslStart:1,mechanism:"sha1"===e?u.AuthMechanism.MONGODB_SCRAM_SHA1:u.AuthMechanism.MONGODB_SCRAM_SHA256,payload:new n.Binary(Buffer.concat([Buffer.from("n,,","utf8"),l(o,r)])),autoAuthorize:1,options:{skipEmptyExchange:!0}}}async function p(r,s,u){const a=u.connection,h=u.credentials;if(!h)throw new o.MongoMissingCredentialsError("AuthContext must provide credentials.");if(!u.nonce)throw new o.MongoInvalidArgumentError("Unable to continue SCRAM without valid nonce");const p=u.nonce,E=h.source,A=c(h.username),b=h.password,_="sha256"===r?(0,e.saslprep)(b):function(e,n){if("string"!=typeof e)throw new o.MongoInvalidArgumentError("Username must be a string");if("string"!=typeof n)throw new o.MongoInvalidArgumentError("Password must be a string");if(0===n.length)throw new o.MongoInvalidArgumentError("Password cannot be empty");let r;try{r=t.createHash("md5")}catch(e){if(t.getFips())throw new Error("Auth mechanism SCRAM-SHA-1 is not supported in FIPS mode");throw e}return r.update(`${e}:mongo:${n}`,"utf8"),r.digest("hex")}(A,b),O=Buffer.isBuffer(s.payload)?new n.Binary(s.payload):s.payload,C=d(O),w=parseInt(C.i,10);if(w&&w<4096)throw new o.MongoRuntimeError(`Server returned an invalid iteration count ${w}`);const S=C.s,v=C.r;if(v.startsWith("nonce"))throw new o.MongoRuntimeError(`Server returned an invalid nonce: ${v}`);const D=`c=biws,r=${v}`,M=function(e,n,r,o){const i=[e,n.toString("base64"),r].join("_");if(null!=m[i])return m[i];const s=t.pbkdf2Sync(e,n,r,g[o],o);y>=200&&(m={},y=0);return m[i]=s,y+=1,s}(_,Buffer.from(S,"base64"),w,r),T=f(r,M,"Client Key"),B=f(r,M,"Server Key"),F=function(e,n){return t.createHash(e).update(n).digest()}(r,T),$=[l(A,p),O.toString("utf8"),D].join(","),x=[D,`p=${function(e,t){Buffer.isBuffer(e)||(e=Buffer.from(e));Buffer.isBuffer(t)||(t=Buffer.from(t));const n=Math.max(e.length,t.length),r=[];for(let o=0;o<n;o+=1)r.push(e[o]^t[o]);return Buffer.from(r).toString("base64")}(T,f(r,F,$))}`].join(","),P=f(r,B,$),N={saslContinue:1,conversationId:s.conversationId,payload:new n.Binary(Buffer.from(x))},I=await a.command((0,i.ns)(`${E}.$cmd`),N,void 0),R=d(I.payload);if(!function(e,n){if(e.length!==n.length)return!1;if("function"==typeof t.timingSafeEqual)return t.timingSafeEqual(e,n);let r=0;for(let t=0;t<e.length;t++)r|=e[t]^n[t];return 0===r}(Buffer.from(R.v,"base64"),P))throw new o.MongoRuntimeError("Server returned an invalid signature");if(!1!==I.done)return;const k={saslContinue:1,conversationId:I.conversationId,payload:Buffer.alloc(0)};await a.command((0,i.ns)(`${E}.$cmd`),k,void 0)}function d(e){const t={},n=e.toString("utf8").split(",");for(let e=0;e<n.length;e++){const r=(n[e].match(/^([^=]*)=(.*)$/)??[]).slice(1);t[r[0]]=r[1]}return t}function f(e,n,r){return t.createHmac(e,n).update(r).digest()}let m={},y=0;const g={sha256:32,sha1:20};js.ScramSHA1=class extends a{constructor(){super("sha1")}};return js.ScramSHA256=class extends a{constructor(){super("sha256")}},js}var tu,nu,ru={};function ou(){if(nu)return ns;nu=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.MongoClientAuthProviders=void 0;const e=qn(),t=is(),n=Ds(),r=function(){if(Ts)return Bs;Ts=1,Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.AutomatedCallbackWorkflow=void 0;const e=P(),t=Ce(),n=Ds(),r=$s();class o extends r.CallbackWorkflow{constructor(e,t){super(e,t)}async execute(t,n){if(this.cache.hasAccessToken){const r=this.cache.getAccessToken();try{return await this.finishAuthentication(t,n,r)}catch(r){if(r instanceof e.MongoError&&r.code===e.MONGODB_ERROR_CODES.AuthenticationFailed)return this.cache.removeAccessToken(),await this.execute(t,n);throw r}}const r=await this.fetchAccessToken(n);this.cache.put(r),t.accessToken=r.accessToken,await this.finishAuthentication(t,n,r.accessToken)}async fetchAccessToken(o){const i=new AbortController,s={timeoutContext:i.signal,version:n.OIDC_VERSION};o.username&&(s.username=o.username);const u=t.Timeout.expires(r.AUTOMATED_TIMEOUT_MS);try{return await Promise.race([this.executeAndValidateCallback(s),u])}catch(n){if(t.TimeoutError.is(n))throw i.abort(),new e.MongoOIDCError(`OIDC callback timed out after ${r.AUTOMATED_TIMEOUT_MS}ms.`);throw n}finally{u.clear()}}}return Bs.AutomatedCallbackWorkflow=o,Bs}(),o=function(){if(xs)return Ps;xs=1,Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.HumanCallbackWorkflow=void 0;const e=F(),t=P(),n=Ce(),r=Ds(),o=$s();class i extends o.CallbackWorkflow{constructor(e,t){super(e,t)}async execute(n,r){if(this.cache.hasAccessToken){const e=this.cache.getAccessToken();n.accessToken=e;try{return await this.finishAuthentication(n,r,e)}catch(e){if(e instanceof t.MongoError&&e.code===t.MONGODB_ERROR_CODES.AuthenticationFailed)return this.cache.removeAccessToken(),delete n.accessToken,await this.execute(n,r);throw e}}if(this.cache.hasRefreshToken){const e=this.cache.getRefreshToken(),o=await this.fetchAccessToken(this.cache.getIdpInfo(),r,e);this.cache.put(o),n.accessToken=o.accessToken;try{return await this.finishAuthentication(n,r,o.accessToken)}catch(e){if(e instanceof t.MongoError&&e.code===t.MONGODB_ERROR_CODES.AuthenticationFailed)return this.cache.removeRefreshToken(),delete n.accessToken,await this.execute(n,r);throw e}}const o=await this.startAuthentication(n,r),i=o.conversationId,s=e.BSON.deserialize(o.payload.buffer),u=await this.fetchAccessToken(s,r);return this.cache.put(u,s),n.accessToken=u.accessToken,await this.finishAuthentication(n,r,u.accessToken,i)}async fetchAccessToken(e,i,s){const u=new AbortController,a={timeoutContext:u.signal,version:r.OIDC_VERSION,idpInfo:e};i.username&&(a.username=i.username),s&&(a.refreshToken=s);const c=n.Timeout.expires(o.HUMAN_TIMEOUT_MS);try{return await Promise.race([this.executeAndValidateCallback(a),c])}catch(e){if(n.TimeoutError.is(e))throw u.abort(),new t.MongoOIDCError(`OIDC callback timed out after ${o.HUMAN_TIMEOUT_MS}ms.`);throw e}finally{c.clear()}}}return Ps.HumanCallbackWorkflow=i,Ps}(),i=Cs(),s=function(){if(Ns)return Is;Ns=1,Object.defineProperty(Is,"__esModule",{value:!0}),Is.Plain=void 0;const e=F(),t=P(),n=fe(),r=Wn();class o extends r.AuthProvider{async auth(r){const{connection:o,credentials:i}=r;if(!i)throw new t.MongoMissingCredentialsError("AuthContext must provide credentials.");const{username:s,password:u}=i,a={saslStart:1,mechanism:"PLAIN",payload:new e.Binary(Buffer.from(`\0${s}\0${u}`)),autoAuthorize:1};await o.command((0,n.ns)("$external.$cmd"),a,void 0)}}return Is.Plain=o,Is}(),u=Yn(),a=eu(),c=function(){if(tu)return ru;tu=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.X509=void 0;const e=P(),t=fe(),n=Wn();class r extends n.AuthProvider{async prepare(t,n){const{credentials:r}=n;if(!r)throw new e.MongoMissingCredentialsError("AuthContext must provide credentials.");return{...t,speculativeAuthenticate:o(r)}}async auth(n){const r=n.connection,i=n.credentials;if(!i)throw new e.MongoMissingCredentialsError("AuthContext must provide credentials.");const s=n.response;s?.speculativeAuthenticate||await r.command((0,t.ns)("$external.$cmd"),o(i),void 0)}}function o(e){const t={authenticate:1,mechanism:"MONGODB-X509"};return e.username&&(t.user=e.username),t}return ru.X509=r,ru}(),l=P(),h=new Map([[u.AuthMechanism.MONGODB_AWS,({AWS_CREDENTIAL_PROVIDER:e})=>new t.MongoDBAWS(e)],[u.AuthMechanism.MONGODB_CR,()=>{throw new l.MongoInvalidArgumentError("MONGODB-CR is no longer a supported auth mechanism in MongoDB 4.0+")}],[u.AuthMechanism.MONGODB_GSSAPI,()=>new e.GSSAPI],[u.AuthMechanism.MONGODB_OIDC,e=>new n.MongoDBOIDC(function(e){if(e.OIDC_HUMAN_CALLBACK)return new o.HumanCallbackWorkflow(new i.TokenCache,e.OIDC_HUMAN_CALLBACK);if(e.OIDC_CALLBACK)return new r.AutomatedCallbackWorkflow(new i.TokenCache,e.OIDC_CALLBACK);{const t=e.ENVIRONMENT,r=n.OIDC_WORKFLOWS.get(t)?.();if(!r)throw new l.MongoInvalidArgumentError(`Could not load workflow for environment ${e.ENVIRONMENT}`);return r}}(e))],[u.AuthMechanism.MONGODB_PLAIN,()=>new s.Plain],[u.AuthMechanism.MONGODB_SCRAM_SHA1,()=>new a.ScramSHA1],[u.AuthMechanism.MONGODB_SCRAM_SHA256,()=>new a.ScramSHA256],[u.AuthMechanism.MONGODB_X509,()=>new c.X509]]);return ns.MongoClientAuthProviders=class{constructor(){this.existingProviders=new Map}getOrCreateProvider(e,t){const n=this.existingProviders.get(e);if(n)return n;const r=h.get(e);if(!r)throw new l.MongoInvalidArgumentError(`authMechanism ${e} not supported`);const o=r(t);return this.existingProviders.set(e,o),o}},ns}var iu,su={},uu={},au={},cu={},lu={},hu={},pu={};function du(){if(iu)return pu;iu=1,Object.defineProperty(pu,"__esModule",{value:!0}),pu.GridFSBucketReadStream=void 0;const t=e,n=Ju(),r=P(),o=Ce();class i extends t.Readable{constructor(e,t,n,r,i){super({emitClose:!0}),this.s={bytesToTrim:0,bytesToSkip:0,bytesRead:0,chunks:e,expected:0,files:t,filter:r,init:!1,expectedEnd:0,options:{start:0,end:0,...i},readPreference:n,timeoutContext:null!=i?.timeoutMS?new o.CSOTTimeoutContext({timeoutMS:i.timeoutMS,serverSelectionTimeoutMS:0}):void 0}}_read(){this.destroyed||function(e,t){if(e.s.file)return t();e.s.init||(!function(e){const t={};e.s.readPreference&&(t.readPreference=e.s.readPreference);e.s.options&&e.s.options.sort&&(t.sort=e.s.options.sort);e.s.options&&e.s.options.skip&&(t.skip=e.s.options.skip);const o=t=>{if(e.destroyed)return;if(!t){const t=`FileNotFound: file ${e.s.filter._id?e.s.filter._id.toString():e.s.filter.filename} was not found`,n=new r.MongoRuntimeError(t);return n.code="ENOENT",e.destroy(n)}if(t.length<=0)return void e.push(null);if(e.destroyed)return void e.destroy();try{e.s.bytesToSkip=function(e,t,n){if(n&&null!=n.start){if(n.start>t.length)throw new r.MongoInvalidArgumentError(`Stream start (${n.start}) must not be more than the length of the file (${t.length})`);if(n.start<0)throw new r.MongoInvalidArgumentError(`Stream start (${n.start}) must not be negative`);if(null!=n.end&&n.end<n.start)throw new r.MongoInvalidArgumentError(`Stream start (${n.start}) must not be greater than stream end (${n.end})`);return e.s.bytesRead=Math.floor(n.start/t.chunkSize)*t.chunkSize,e.s.expected=Math.floor(n.start/t.chunkSize),n.start-e.s.bytesRead}throw new r.MongoInvalidArgumentError("Start option must be defined")}(e,t,e.s.options)}catch(t){return e.destroy(t)}const o={files_id:t._id};if(e.s.options&&null!=e.s.options.start){const n=Math.floor(e.s.options.start/t.chunkSize);n>0&&(o.n={$gte:n})}let s;try{s=e.s.timeoutContext?.getRemainingTimeMSOrThrow(`Download timed out after ${e.s.timeoutContext?.timeoutMS}ms`)}catch(t){return e.destroy(t)}e.s.cursor=e.s.chunks.find(o,{timeoutMode:null!=e.s.options.timeoutMS?n.CursorTimeoutMode.LIFETIME:void 0,timeoutMS:s}).sort({n:1}),e.s.readPreference&&e.s.cursor.withReadPreference(e.s.readPreference),e.s.expectedEnd=Math.ceil(t.length/t.chunkSize),e.s.file=t;try{e.s.bytesToTrim=function(e,t,n,o){if(o&&null!=o.end){if(o.end>t.length)throw new r.MongoInvalidArgumentError(`Stream end (${o.end}) must not be more than the length of the file (${t.length})`);if(null==o.start||o.start<0)throw new r.MongoInvalidArgumentError(`Stream end (${o.end}) must not be negative`);const i=null!=o.start?Math.floor(o.start/t.chunkSize):0;return n.limit(Math.ceil(o.end/t.chunkSize)-i),e.s.expectedEnd=Math.ceil(o.end/t.chunkSize),Math.ceil(o.end/t.chunkSize)*t.chunkSize-o.end}throw new r.MongoInvalidArgumentError("End option must be defined")}(e,t,e.s.cursor,e.s.options)}catch(t){return e.destroy(t)}e.emit(i.FILE,t)};let s;try{s=e.s.timeoutContext?.getRemainingTimeMSOrThrow(`Download timed out after ${e.s.timeoutContext?.timeoutMS}ms`)}catch(t){return void(e.destroyed||e.destroy(t))}t.timeoutMS=s,e.s.files.findOne(e.s.filter,t).then(o,(t=>{e.destroyed||e.destroy(t)}))}(e),e.s.init=!0);e.once("file",(()=>{t()}))}(this,(()=>function(e){if(e.destroyed)return;if(!e.s.cursor)return;if(!e.s.file)return;const t=t=>{if(e.destroyed)return;if(!t)return e.push(null),void e.s.cursor?.close().then(void 0,(t=>e.destroy(t)));if(!e.s.file)return;const n=e.s.file.length-e.s.bytesRead,o=e.s.expected++,i=Math.min(e.s.file.chunkSize,n);if(t.n>o)return e.destroy(new r.MongoGridFSChunkError(`ChunkIsMissing: Got unexpected n: ${t.n}, expected: ${o}`));if(t.n<o)return e.destroy(new r.MongoGridFSChunkError(`ExtraChunk: Got unexpected n: ${t.n}, expected: ${o}`));let s=Buffer.isBuffer(t.data)?t.data:t.data.buffer;if(s.byteLength!==i)return n<=0?e.destroy(new r.MongoGridFSChunkError(`ExtraChunk: Got unexpected n: ${t.n}, expected file length ${e.s.file.length} bytes but already read ${e.s.bytesRead} bytes`)):e.destroy(new r.MongoGridFSChunkError(`ChunkIsWrongSize: Got unexpected length: ${s.byteLength}, expected: ${i}`));if(e.s.bytesRead+=s.byteLength,0===s.byteLength)return e.push(null);let u=null,a=null;null!=e.s.bytesToSkip&&(u=e.s.bytesToSkip,e.s.bytesToSkip=0);const c=o===e.s.expectedEnd-1,l=e.s.options.end-e.s.bytesToSkip;c&&null!=e.s.bytesToTrim?a=e.s.file.chunkSize-e.s.bytesToTrim:e.s.options.end&&l<t.data.byteLength&&(a=l),null==u&&null==a||(s=s.slice(u||0,a||s.byteLength)),e.push(s)};e.s.cursor.next().then(t,(t=>{e.destroyed||e.destroy(t)}))}(this)))}start(e=0){return s(this),this.s.options.start=e,this}end(e=0){return s(this),this.s.options.end=e,this}async abort(){this.push(null),this.destroy();const e=this.s.timeoutContext?.getRemainingTimeMSOrThrow();await(this.s.cursor?.close({timeoutMS:e}))}}function s(e){if(e.s.init)throw new r.MongoGridFSStreamError("Options cannot be changed after the stream is initialized")}return pu.GridFSBucketReadStream=i,i.FILE="file",pu}var fu,mu,yu={};function gu(){if(fu)return yu;fu=1,Object.defineProperty(yu,"__esModule",{value:!0}),yu.GridFSBucketWriteStream=void 0;const t=e,n=F(),r=Ju(),o=P(),i=Ce(),s=fe(),u=de();class a extends t.Writable{constructor(e,t,r){super(),this.gridFSFile=null,r=r??{},this.bucket=e,this.chunks=e.s._chunksCollection,this.filename=t,this.files=e.s._filesCollection,this.options=r,this.writeConcern=u.WriteConcern.fromOptions(r)||e.s.options.writeConcern,this.done=!1,this.id=r.id?r.id:new n.ObjectId,this.chunkSizeBytes=r.chunkSizeBytes||this.bucket.s.options.chunkSizeBytes,this.bufToStore=Buffer.alloc(this.chunkSizeBytes),this.length=0,this.n=0,this.pos=0,this.state={streamEnd:!1,outstandingRequests:0,errored:!1,aborted:!1},null!=r.timeoutMS&&(this.timeoutContext=new i.CSOTTimeoutContext({timeoutMS:r.timeoutMS,serverSelectionTimeoutMS:(0,s.resolveTimeoutOptions)(this.bucket.s.db.client,{}).serverSelectionTimeoutMS}))}_construct(e){if(this.bucket.s.calledOpenUploadStream)return process.nextTick(e);this.bucket.s.calledOpenUploadStream=!0,async function(e){let t=e.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`);if(null!=await e.files.findOne({},{projection:{_id:1},timeoutMS:t}))return;const n={filename:1,uploadDate:1};let i;t=e.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`);const s={timeoutMode:null!=t?r.CursorTimeoutMode.LIFETIME:void 0,timeoutMS:t};try{i=await e.files.listIndexes(s).toArray()}catch(e){if(!(e instanceof o.MongoError&&e.code===o.MONGODB_ERROR_CODES.NamespaceNotFound))throw e;i=[]}const u=!!i.find((e=>2===Object.keys(e.key).length&&1===e.key.filename&&1===e.key.uploadDate));u||(t=e.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`),await e.files.createIndex(n,{background:!1,timeoutMS:t}));await async function(e){const t={files_id:1,n:1};let n,i;n=e.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`);try{i=await e.chunks.listIndexes({timeoutMode:null!=n?r.CursorTimeoutMode.LIFETIME:void 0,timeoutMS:n}).toArray()}catch(e){if(!(e instanceof o.MongoError&&e.code===o.MONGODB_ERROR_CODES.NamespaceNotFound))throw e;i=[]}const s=!!i.find((e=>2===Object.keys(e.key).length&&1===e.key.files_id&&1===e.key.n));s||(n=e.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`),await e.chunks.createIndex(t,{...e.writeConcern,background:!0,unique:!0,timeoutMS:n}))}(e)}(this).then((()=>{this.bucket.s.checkedIndexes=!0,this.bucket.emit("index"),e()}),(t=>{if(t instanceof o.MongoOperationTimeoutError)return c(this,t,e);(0,s.squashError)(t),e()}))}_write(e,t,n){!function(e,t,n,r){if(p(e,r))return;const i=Buffer.isBuffer(t)?t:Buffer.from(t,n);if(e.length+=i.length,e.pos+i.length<e.chunkSizeBytes)return i.copy(e.bufToStore,e.pos),e.pos+=i.length,void process.nextTick(r);let s=i.length,u=e.chunkSizeBytes-e.pos,a=Math.min(u,i.length),d=0;for(;s>0;){const t=i.length-s;let n;if(i.copy(e.bufToStore,e.pos,t,t+a),e.pos+=a,u-=a,0===u){n=l(e.id,e.n,Buffer.from(e.bufToStore));const t=e.timeoutContext?.remainingTimeMS;if(null!=t&&t<=0)return c(e,new o.MongoOperationTimeoutError(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`),r);if(++e.state.outstandingRequests,++d,p(e,r))return;e.chunks.insertOne(n,{writeConcern:e.writeConcern,timeoutMS:t}).then((()=>{--e.state.outstandingRequests,--d,d||h(e,r)}),(t=>c(e,t,r))),u=e.chunkSizeBytes,e.pos=0,++e.n}s-=a,a=Math.min(u,s)}}(this,e,t,n)}_final(e){if(this.state.streamEnd)return process.nextTick(e);this.state.streamEnd=!0,function(e,t){if(0===e.pos)return h(e,t);const n=Buffer.alloc(e.pos);e.bufToStore.copy(n,0,0,e.pos);const r=l(e.id,e.n,n);if(p(e,t))return;const i=e.timeoutContext?.remainingTimeMS;if(null!=i&&i<=0)return c(e,new o.MongoOperationTimeoutError(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`),t);++e.state.outstandingRequests,e.chunks.insertOne(r,{writeConcern:e.writeConcern,timeoutMS:i}).then((()=>{--e.state.outstandingRequests,h(e,t)}),(n=>c(e,n,t)))}(this,e)}async abort(){if(this.state.streamEnd)throw new o.MongoAPIError("Cannot abort a stream that has already completed");if(this.state.aborted)throw new o.MongoAPIError("Cannot call abort() on a stream twice");this.state.aborted=!0;const e=this.timeoutContext?.getRemainingTimeMSOrThrow(`Upload timed out after ${this.timeoutContext?.timeoutMS}ms`);await this.chunks.deleteMany({files_id:this.id},{timeoutMS:e})}}function c(e,t,n){e.state.errored?process.nextTick(n):(e.state.errored=!0,process.nextTick(n,t))}function l(e,t,r){return{_id:new n.ObjectId,files_id:e,n:t,data:r}}function h(e,t){if(e.done)return process.nextTick(t);if(e.state.streamEnd&&0===e.state.outstandingRequests&&!e.state.errored){e.done=!0;const n=function(e,t,n,r,o,i,s){const u={_id:e,length:t,chunkSize:n,uploadDate:new Date,filename:r};o&&(u.contentType=o);i&&(u.aliases=i);s&&(u.metadata=s);return u}(e.id,e.length,e.chunkSizeBytes,e.filename,e.options.contentType,e.options.aliases,e.options.metadata);if(p(e,t))return;const r=e.timeoutContext?.remainingTimeMS;return null!=r&&r<=0?c(e,new o.MongoOperationTimeoutError(`Upload timed out after ${e.timeoutContext?.timeoutMS}ms`),t):void e.files.insertOne(n,{writeConcern:e.writeConcern,timeoutMS:r}).then((()=>{e.gridFSFile=n,t()}),(n=>c(e,n,t)))}process.nextTick(t)}function p(e,t){return!!e.state.aborted&&(process.nextTick(t,new o.MongoAPIError("Stream has been aborted")),!0)}return yu.GridFSBucketWriteStream=a,yu}var Eu,Au={};function bu(){if(Eu)return Au;Eu=1,Object.defineProperty(Au,"__esModule",{value:!0}),Au.WaitingForSuitableServerEvent=Au.ServerSelectionSucceededEvent=Au.ServerSelectionFailedEvent=Au.ServerSelectionStartedEvent=Au.ServerSelectionEvent=void 0;const e=fe(),t=z();class n{constructor(e,t,n){this.selector=e,this.operation=n,this.topologyDescription=t}}Au.ServerSelectionEvent=n;Au.ServerSelectionStartedEvent=class extends n{constructor(e,n,r){super(e,n,r),this.name=t.SERVER_SELECTION_STARTED,this.message="Server selection started"}};Au.ServerSelectionFailedEvent=class extends n{constructor(e,n,r,o){super(e,n,o),this.name=t.SERVER_SELECTION_FAILED,this.message="Server selection failed",this.failure=r}};Au.ServerSelectionSucceededEvent=class extends n{constructor(n,r,o,i){super(n,r,i),this.name=t.SERVER_SELECTION_SUCCEEDED,this.message="Server selection succeeded";const{host:s,port:u}=e.HostAddress.fromString(o).toHostPort();this.serverHost=s,this.serverPort=u}};return Au.WaitingForSuitableServerEvent=class extends n{constructor(e,n,r,o){super(e,n,o),this.name=t.WAITING_FOR_SUITABLE_SERVER,this.message="Waiting for suitable server to become available",this.remainingTimeMS=r}},Au}var _u,Ou,Cu,wu,Su,vu={};function Du(){if(_u)return vu;_u=1,Object.defineProperty(vu,"__esModule",{value:!0}),vu.SrvPoller=vu.SrvPollingEvent=void 0;const e=a,t=s,n=P(),r=ye(),o=fe();class i{constructor(e){this.srvRecords=e}hostnames(){return new Set(this.srvRecords.map((e=>o.HostAddress.fromSrvRecord(e).toString())))}}vu.SrvPollingEvent=i;class u extends r.TypedEventEmitter{constructor(e){if(super(),this.on("error",o.noop),!e||!e.srvHost)throw new n.MongoRuntimeError("Options for SrvPoller must exist and include srvHost");this.srvHost=e.srvHost,this.srvMaxHosts=e.srvMaxHosts??0,this.srvServiceName=e.srvServiceName??"mongodb",this.rescanSrvIntervalMS=6e4,this.heartbeatFrequencyMS=e.heartbeatFrequencyMS??1e4,this.haMode=!1,this.generation=0,this._timeout=void 0}get srvAddress(){return`_${this.srvServiceName}._tcp.${this.srvHost}`}get intervalMS(){return this.haMode?this.heartbeatFrequencyMS:this.rescanSrvIntervalMS}start(){this._timeout||this.schedule()}stop(){this._timeout&&((0,t.clearTimeout)(this._timeout),this.generation+=1,this._timeout=void 0)}schedule(){this._timeout&&(0,t.clearTimeout)(this._timeout),this._timeout=(0,t.setTimeout)((()=>{this._poll().then(void 0,o.squashError)}),this.intervalMS)}success(e){this.haMode=!1,this.schedule(),this.emit(u.SRV_RECORD_DISCOVERY,new i(e))}failure(){this.haMode=!0,this.schedule()}async _poll(){const t=this.generation;let n;try{n=await e.promises.resolveSrv(this.srvAddress)}catch{return void this.failure()}if(t!==this.generation)return;const r=[];for(const e of n)try{(0,o.checkParentDomainMatch)(e.name,this.srvHost),r.push(e)}catch(e){(0,o.squashError)(e)}r.length?this.success(r):this.failure()}}return vu.SrvPoller=u,u.SRV_RECORD_DISCOVERY="srvRecordDiscovery",vu}function Mu(){return Ou||(Ou=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MongoServerError=e.MongoServerClosedError=e.MongoRuntimeError=e.MongoParseError=e.MongoOperationTimeoutError=e.MongoOIDCError=e.MongoNotConnectedError=e.MongoNetworkTimeoutError=e.MongoNetworkError=e.MongoMissingDependencyError=e.MongoMissingCredentialsError=e.MongoKerberosError=e.MongoInvalidArgumentError=e.MongoGridFSStreamError=e.MongoGridFSChunkError=e.MongoGCPError=e.MongoExpiredSessionError=e.MongoError=e.MongoDriverError=e.MongoDecompressionError=e.MongoCursorInUseError=e.MongoCursorExhaustedError=e.MongoCompatibilityError=e.MongoClientBulkWriteExecutionError=e.MongoClientBulkWriteError=e.MongoClientBulkWriteCursorError=e.MongoChangeStreamError=e.MongoBatchReExecutionError=e.MongoAzureError=e.MongoAWSError=e.MongoAPIError=e.ChangeStreamCursor=e.ClientEncryption=e.MongoBulkWriteError=e.UUID=e.Timestamp=e.ObjectId=e.MinKey=e.MaxKey=e.Long=e.Int32=e.Double=e.Decimal128=e.DBRef=e.Code=e.BSONType=e.BSONSymbol=e.BSONRegExp=e.Binary=e.BSON=void 0,e.CommandStartedEvent=e.CommandFailedEvent=e.WriteConcern=e.ReadPreference=e.ReadConcern=e.TopologyType=e.ServerType=e.ReadPreferenceMode=e.ReadConcernLevel=e.ProfilingLevel=e.ReturnDocument=e.SeverityLevel=e.MongoLoggableComponent=e.ServerApiVersion=e.ExplainVerbosity=e.MongoErrorLabel=e.CursorTimeoutMode=e.CURSOR_FLAGS=e.Compressor=e.AuthMechanism=e.GSSAPICanonicalizationValue=e.AutoEncryptionLoggerLevel=e.BatchType=e.UnorderedBulkOperation=e.OrderedBulkOperation=e.MongoClient=e.ListIndexesCursor=e.ListCollectionsCursor=e.GridFSBucketWriteStream=e.GridFSBucketReadStream=e.GridFSBucket=e.FindCursor=e.ExplainableCursor=e.Db=e.Collection=e.ClientSession=e.ChangeStream=e.CancellationToken=e.AggregationCursor=e.Admin=e.AbstractCursor=e.configureExplicitResourceManagement=e.MongoWriteConcernError=e.MongoUnexpectedServerResponseError=e.MongoTransactionError=e.MongoTopologyClosedError=e.MongoTailableCursorError=e.MongoSystemError=e.MongoStalePrimaryError=e.MongoServerSelectionError=void 0,e.MongoClientAuthProviders=e.MongoCryptKMSRequestNetworkTimeoutError=e.MongoCryptInvalidArgumentError=e.MongoCryptError=e.MongoCryptCreateEncryptedCollectionError=e.MongoCryptCreateDataKeyError=e.MongoCryptAzureKMSRequestError=e.SrvPollingEvent=e.WaitingForSuitableServerEvent=e.ServerSelectionSucceededEvent=e.ServerSelectionStartedEvent=e.ServerSelectionFailedEvent=e.ServerSelectionEvent=e.TopologyOpeningEvent=e.TopologyDescriptionChangedEvent=e.TopologyClosedEvent=e.ServerOpeningEvent=e.ServerHeartbeatSucceededEvent=e.ServerHeartbeatStartedEvent=e.ServerHeartbeatFailedEvent=e.ServerDescriptionChangedEvent=e.ServerClosedEvent=e.ConnectionReadyEvent=e.ConnectionPoolReadyEvent=e.ConnectionPoolMonitoringEvent=e.ConnectionPoolCreatedEvent=e.ConnectionPoolClosedEvent=e.ConnectionPoolClearedEvent=e.ConnectionCreatedEvent=e.ConnectionClosedEvent=e.ConnectionCheckOutStartedEvent=e.ConnectionCheckOutFailedEvent=e.ConnectionCheckedOutEvent=e.ConnectionCheckedInEvent=e.CommandSucceededEvent=void 0;const t=dn();Object.defineProperty(e,"Admin",{enumerable:!0,get:function(){return t.Admin}});const n=Le();Object.defineProperty(e,"OrderedBulkOperation",{enumerable:!0,get:function(){return n.OrderedBulkOperation}});const r=ze();Object.defineProperty(e,"UnorderedBulkOperation",{enumerable:!0,get:function(){return r.UnorderedBulkOperation}});const o=Nn();Object.defineProperty(e,"ChangeStream",{enumerable:!0,get:function(){return o.ChangeStream}});const i=Yt();Object.defineProperty(e,"Collection",{enumerable:!0,get:function(){return i.Collection}});const s=Ju();Object.defineProperty(e,"AbstractCursor",{enumerable:!0,get:function(){return s.AbstractCursor}});const u=Ye();Object.defineProperty(e,"AggregationCursor",{enumerable:!0,get:function(){return u.AggregationCursor}});const a=ut();Object.defineProperty(e,"FindCursor",{enumerable:!0,get:function(){return a.FindCursor}});const c=En();Object.defineProperty(e,"ListCollectionsCursor",{enumerable:!0,get:function(){return c.ListCollectionsCursor}});const l=dt();Object.defineProperty(e,"ListIndexesCursor",{enumerable:!0,get:function(){return l.ListIndexesCursor}});const h=Pn();Object.defineProperty(e,"Db",{enumerable:!0,get:function(){return h.Db}});const p=Xu();Object.defineProperty(e,"ExplainableCursor",{enumerable:!0,get:function(){return p.ExplainableCursor}});const d=function(){if(mu)return hu;mu=1,Object.defineProperty(hu,"__esModule",{value:!0}),hu.GridFSBucket=void 0;const e=P(),t=ye(),n=Ce(),r=fe(),o=de(),i=du(),s=gu(),u={bucketName:"fs",chunkSizeBytes:261120};class a extends t.TypedEventEmitter{constructor(e,t){super(),this.on("error",r.noop),this.setMaxListeners(0);const n=(0,r.resolveOptions)(e,{...u,...t,writeConcern:o.WriteConcern.fromOptions(t)});this.s={db:e,options:n,_chunksCollection:e.collection(n.bucketName+".chunks"),_filesCollection:e.collection(n.bucketName+".files"),checkedIndexes:!1,calledOpenUploadStream:!1}}openUploadStream(e,t){return new s.GridFSBucketWriteStream(this,e,{timeoutMS:this.s.options.timeoutMS,...t})}openUploadStreamWithId(e,t,n){return new s.GridFSBucketWriteStream(this,t,{timeoutMS:this.s.options.timeoutMS,...n,id:e})}openDownloadStream(e,t){return new i.GridFSBucketReadStream(this.s._chunksCollection,this.s._filesCollection,this.s.options.readPreference,{_id:e},{timeoutMS:this.s.options.timeoutMS,...t})}async delete(t,o){const{timeoutMS:i}=(0,r.resolveOptions)(this.s.db,o);let s;i&&(s=new n.CSOTTimeoutContext({timeoutMS:i,serverSelectionTimeoutMS:this.s.db.client.s.options.serverSelectionTimeoutMS}));const{deletedCount:u}=await this.s._filesCollection.deleteOne({_id:t},{timeoutMS:s?.remainingTimeMS}),a=s?.remainingTimeMS;if(null!=a&&a<=0)throw new e.MongoOperationTimeoutError(`Timed out after ${i}ms`);if(await this.s._chunksCollection.deleteMany({files_id:t},{timeoutMS:a}),0===u)throw new e.MongoRuntimeError(`File not found for id ${t}`)}find(e={},t={}){return this.s._filesCollection.find(e,t)}openDownloadStreamByName(e,t){let n,r={uploadDate:-1};return t&&null!=t.revision&&(t.revision>=0?(r={uploadDate:1},n=t.revision):n=-t.revision-1),new i.GridFSBucketReadStream(this.s._chunksCollection,this.s._filesCollection,this.s.options.readPreference,{filename:e},{timeoutMS:this.s.options.timeoutMS,...t,sort:r,skip:n})}async rename(t,n,r){const o={_id:t},i={$set:{filename:n}},{matchedCount:s}=await this.s._filesCollection.updateOne(o,i,r);if(0===s)throw new e.MongoRuntimeError(`File with id ${t} not found`)}async drop(e){const{timeoutMS:t}=(0,r.resolveOptions)(this.s.db,e);let o;if(t&&(o=new n.CSOTTimeoutContext({timeoutMS:t,serverSelectionTimeoutMS:this.s.db.client.s.options.serverSelectionTimeoutMS})),o){await this.s._filesCollection.drop({timeoutMS:o.remainingTimeMS});const e=o.getRemainingTimeMSOrThrow(`Timed out after ${t}ms`);await this.s._chunksCollection.drop({timeoutMS:e})}else await this.s._filesCollection.drop(),await this.s._chunksCollection.drop()}}return hu.GridFSBucket=a,a.INDEX="index",hu}();Object.defineProperty(e,"GridFSBucket",{enumerable:!0,get:function(){return d.GridFSBucket}});const f=du();Object.defineProperty(e,"GridFSBucketReadStream",{enumerable:!0,get:function(){return f.GridFSBucketReadStream}});const m=gu();Object.defineProperty(e,"GridFSBucketWriteStream",{enumerable:!0,get:function(){return m.GridFSBucketWriteStream}});const y=Yu();Object.defineProperty(e,"MongoClient",{enumerable:!0,get:function(){return y.MongoClient}});const g=ye();Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return g.CancellationToken}});const E=Si();Object.defineProperty(e,"ClientSession",{enumerable:!0,get:function(){return E.ClientSession}});var A=F();Object.defineProperty(e,"BSON",{enumerable:!0,get:function(){return A.BSON}});var b=F();Object.defineProperty(e,"Binary",{enumerable:!0,get:function(){return b.Binary}}),Object.defineProperty(e,"BSONRegExp",{enumerable:!0,get:function(){return b.BSONRegExp}}),Object.defineProperty(e,"BSONSymbol",{enumerable:!0,get:function(){return b.BSONSymbol}}),Object.defineProperty(e,"BSONType",{enumerable:!0,get:function(){return b.BSONType}}),Object.defineProperty(e,"Code",{enumerable:!0,get:function(){return b.Code}}),Object.defineProperty(e,"DBRef",{enumerable:!0,get:function(){return b.DBRef}}),Object.defineProperty(e,"Decimal128",{enumerable:!0,get:function(){return b.Decimal128}}),Object.defineProperty(e,"Double",{enumerable:!0,get:function(){return b.Double}}),Object.defineProperty(e,"Int32",{enumerable:!0,get:function(){return b.Int32}}),Object.defineProperty(e,"Long",{enumerable:!0,get:function(){return b.Long}}),Object.defineProperty(e,"MaxKey",{enumerable:!0,get:function(){return b.MaxKey}}),Object.defineProperty(e,"MinKey",{enumerable:!0,get:function(){return b.MinKey}}),Object.defineProperty(e,"ObjectId",{enumerable:!0,get:function(){return b.ObjectId}}),Object.defineProperty(e,"Timestamp",{enumerable:!0,get:function(){return b.Timestamp}}),Object.defineProperty(e,"UUID",{enumerable:!0,get:function(){return b.UUID}});var _=ta();Object.defineProperty(e,"MongoBulkWriteError",{enumerable:!0,get:function(){return _.MongoBulkWriteError}});var O=Zo();Object.defineProperty(e,"ClientEncryption",{enumerable:!0,get:function(){return O.ClientEncryption}});var C=Xt();Object.defineProperty(e,"ChangeStreamCursor",{enumerable:!0,get:function(){return C.ChangeStreamCursor}});var w=P();Object.defineProperty(e,"MongoAPIError",{enumerable:!0,get:function(){return w.MongoAPIError}}),Object.defineProperty(e,"MongoAWSError",{enumerable:!0,get:function(){return w.MongoAWSError}}),Object.defineProperty(e,"MongoAzureError",{enumerable:!0,get:function(){return w.MongoAzureError}}),Object.defineProperty(e,"MongoBatchReExecutionError",{enumerable:!0,get:function(){return w.MongoBatchReExecutionError}}),Object.defineProperty(e,"MongoChangeStreamError",{enumerable:!0,get:function(){return w.MongoChangeStreamError}}),Object.defineProperty(e,"MongoClientBulkWriteCursorError",{enumerable:!0,get:function(){return w.MongoClientBulkWriteCursorError}}),Object.defineProperty(e,"MongoClientBulkWriteError",{enumerable:!0,get:function(){return w.MongoClientBulkWriteError}}),Object.defineProperty(e,"MongoClientBulkWriteExecutionError",{enumerable:!0,get:function(){return w.MongoClientBulkWriteExecutionError}}),Object.defineProperty(e,"MongoCompatibilityError",{enumerable:!0,get:function(){return w.MongoCompatibilityError}}),Object.defineProperty(e,"MongoCursorExhaustedError",{enumerable:!0,get:function(){return w.MongoCursorExhaustedError}}),Object.defineProperty(e,"MongoCursorInUseError",{enumerable:!0,get:function(){return w.MongoCursorInUseError}}),Object.defineProperty(e,"MongoDecompressionError",{enumerable:!0,get:function(){return w.MongoDecompressionError}}),Object.defineProperty(e,"MongoDriverError",{enumerable:!0,get:function(){return w.MongoDriverError}}),Object.defineProperty(e,"MongoError",{enumerable:!0,get:function(){return w.MongoError}}),Object.defineProperty(e,"MongoExpiredSessionError",{enumerable:!0,get:function(){return w.MongoExpiredSessionError}}),Object.defineProperty(e,"MongoGCPError",{enumerable:!0,get:function(){return w.MongoGCPError}}),Object.defineProperty(e,"MongoGridFSChunkError",{enumerable:!0,get:function(){return w.MongoGridFSChunkError}}),Object.defineProperty(e,"MongoGridFSStreamError",{enumerable:!0,get:function(){return w.MongoGridFSStreamError}}),Object.defineProperty(e,"MongoInvalidArgumentError",{enumerable:!0,get:function(){return w.MongoInvalidArgumentError}}),Object.defineProperty(e,"MongoKerberosError",{enumerable:!0,get:function(){return w.MongoKerberosError}}),Object.defineProperty(e,"MongoMissingCredentialsError",{enumerable:!0,get:function(){return w.MongoMissingCredentialsError}}),Object.defineProperty(e,"MongoMissingDependencyError",{enumerable:!0,get:function(){return w.MongoMissingDependencyError}}),Object.defineProperty(e,"MongoNetworkError",{enumerable:!0,get:function(){return w.MongoNetworkError}}),Object.defineProperty(e,"MongoNetworkTimeoutError",{enumerable:!0,get:function(){return w.MongoNetworkTimeoutError}}),Object.defineProperty(e,"MongoNotConnectedError",{enumerable:!0,get:function(){return w.MongoNotConnectedError}}),Object.defineProperty(e,"MongoOIDCError",{enumerable:!0,get:function(){return w.MongoOIDCError}}),Object.defineProperty(e,"MongoOperationTimeoutError",{enumerable:!0,get:function(){return w.MongoOperationTimeoutError}}),Object.defineProperty(e,"MongoParseError",{enumerable:!0,get:function(){return w.MongoParseError}}),Object.defineProperty(e,"MongoRuntimeError",{enumerable:!0,get:function(){return w.MongoRuntimeError}}),Object.defineProperty(e,"MongoServerClosedError",{enumerable:!0,get:function(){return w.MongoServerClosedError}}),Object.defineProperty(e,"MongoServerError",{enumerable:!0,get:function(){return w.MongoServerError}}),Object.defineProperty(e,"MongoServerSelectionError",{enumerable:!0,get:function(){return w.MongoServerSelectionError}}),Object.defineProperty(e,"MongoStalePrimaryError",{enumerable:!0,get:function(){return w.MongoStalePrimaryError}}),Object.defineProperty(e,"MongoSystemError",{enumerable:!0,get:function(){return w.MongoSystemError}}),Object.defineProperty(e,"MongoTailableCursorError",{enumerable:!0,get:function(){return w.MongoTailableCursorError}}),Object.defineProperty(e,"MongoTopologyClosedError",{enumerable:!0,get:function(){return w.MongoTopologyClosedError}}),Object.defineProperty(e,"MongoTransactionError",{enumerable:!0,get:function(){return w.MongoTransactionError}}),Object.defineProperty(e,"MongoUnexpectedServerResponseError",{enumerable:!0,get:function(){return w.MongoUnexpectedServerResponseError}}),Object.defineProperty(e,"MongoWriteConcernError",{enumerable:!0,get:function(){return w.MongoWriteConcernError}});var S=Qu();Object.defineProperty(e,"configureExplicitResourceManagement",{enumerable:!0,get:function(){return S.configureExplicitResourceManagement}});var v=ta();Object.defineProperty(e,"BatchType",{enumerable:!0,get:function(){return v.BatchType}});var D=oi();Object.defineProperty(e,"AutoEncryptionLoggerLevel",{enumerable:!0,get:function(){return D.AutoEncryptionLoggerLevel}});var M=qn();Object.defineProperty(e,"GSSAPICanonicalizationValue",{enumerable:!0,get:function(){return M.GSSAPICanonicalizationValue}});var T=Yn();Object.defineProperty(e,"AuthMechanism",{enumerable:!0,get:function(){return T.AuthMechanism}});var B=vo();Object.defineProperty(e,"Compressor",{enumerable:!0,get:function(){return B.Compressor}});var $=Ju();Object.defineProperty(e,"CURSOR_FLAGS",{enumerable:!0,get:function(){return $.CURSOR_FLAGS}}),Object.defineProperty(e,"CursorTimeoutMode",{enumerable:!0,get:function(){return $.CursorTimeoutMode}});var x=P();Object.defineProperty(e,"MongoErrorLabel",{enumerable:!0,get:function(){return x.MongoErrorLabel}});var N=Xu();Object.defineProperty(e,"ExplainVerbosity",{enumerable:!0,get:function(){return N.ExplainVerbosity}});var I=Yu();Object.defineProperty(e,"ServerApiVersion",{enumerable:!0,get:function(){return I.ServerApiVersion}});var R=me();Object.defineProperty(e,"MongoLoggableComponent",{enumerable:!0,get:function(){return R.MongoLoggableComponent}}),Object.defineProperty(e,"SeverityLevel",{enumerable:!0,get:function(){return R.SeverityLevel}});var k=Mt();Object.defineProperty(e,"ReturnDocument",{enumerable:!0,get:function(){return k.ReturnDocument}});var j=Tn();Object.defineProperty(e,"ProfilingLevel",{enumerable:!0,get:function(){return j.ProfilingLevel}});var L=Q();Object.defineProperty(e,"ReadConcernLevel",{enumerable:!0,get:function(){return L.ReadConcernLevel}});var U=Z();Object.defineProperty(e,"ReadPreferenceMode",{enumerable:!0,get:function(){return U.ReadPreferenceMode}});var V=ne();Object.defineProperty(e,"ServerType",{enumerable:!0,get:function(){return V.ServerType}}),Object.defineProperty(e,"TopologyType",{enumerable:!0,get:function(){return V.TopologyType}});var z=Q();Object.defineProperty(e,"ReadConcern",{enumerable:!0,get:function(){return z.ReadConcern}});var W=Z();Object.defineProperty(e,"ReadPreference",{enumerable:!0,get:function(){return W.ReadPreference}});var q=de();Object.defineProperty(e,"WriteConcern",{enumerable:!0,get:function(){return q.WriteConcern}});var G=Mi();Object.defineProperty(e,"CommandFailedEvent",{enumerable:!0,get:function(){return G.CommandFailedEvent}}),Object.defineProperty(e,"CommandStartedEvent",{enumerable:!0,get:function(){return G.CommandStartedEvent}}),Object.defineProperty(e,"CommandSucceededEvent",{enumerable:!0,get:function(){return G.CommandSucceededEvent}});var H=Wi();Object.defineProperty(e,"ConnectionCheckedInEvent",{enumerable:!0,get:function(){return H.ConnectionCheckedInEvent}}),Object.defineProperty(e,"ConnectionCheckedOutEvent",{enumerable:!0,get:function(){return H.ConnectionCheckedOutEvent}}),Object.defineProperty(e,"ConnectionCheckOutFailedEvent",{enumerable:!0,get:function(){return H.ConnectionCheckOutFailedEvent}}),Object.defineProperty(e,"ConnectionCheckOutStartedEvent",{enumerable:!0,get:function(){return H.ConnectionCheckOutStartedEvent}}),Object.defineProperty(e,"ConnectionClosedEvent",{enumerable:!0,get:function(){return H.ConnectionClosedEvent}}),Object.defineProperty(e,"ConnectionCreatedEvent",{enumerable:!0,get:function(){return H.ConnectionCreatedEvent}}),Object.defineProperty(e,"ConnectionPoolClearedEvent",{enumerable:!0,get:function(){return H.ConnectionPoolClearedEvent}}),Object.defineProperty(e,"ConnectionPoolClosedEvent",{enumerable:!0,get:function(){return H.ConnectionPoolClosedEvent}}),Object.defineProperty(e,"ConnectionPoolCreatedEvent",{enumerable:!0,get:function(){return H.ConnectionPoolCreatedEvent}}),Object.defineProperty(e,"ConnectionPoolMonitoringEvent",{enumerable:!0,get:function(){return H.ConnectionPoolMonitoringEvent}}),Object.defineProperty(e,"ConnectionPoolReadyEvent",{enumerable:!0,get:function(){return H.ConnectionPoolReadyEvent}}),Object.defineProperty(e,"ConnectionReadyEvent",{enumerable:!0,get:function(){return H.ConnectionReadyEvent}});var K=ji();Object.defineProperty(e,"ServerClosedEvent",{enumerable:!0,get:function(){return K.ServerClosedEvent}}),Object.defineProperty(e,"ServerDescriptionChangedEvent",{enumerable:!0,get:function(){return K.ServerDescriptionChangedEvent}}),Object.defineProperty(e,"ServerHeartbeatFailedEvent",{enumerable:!0,get:function(){return K.ServerHeartbeatFailedEvent}}),Object.defineProperty(e,"ServerHeartbeatStartedEvent",{enumerable:!0,get:function(){return K.ServerHeartbeatStartedEvent}}),Object.defineProperty(e,"ServerHeartbeatSucceededEvent",{enumerable:!0,get:function(){return K.ServerHeartbeatSucceededEvent}}),Object.defineProperty(e,"ServerOpeningEvent",{enumerable:!0,get:function(){return K.ServerOpeningEvent}}),Object.defineProperty(e,"TopologyClosedEvent",{enumerable:!0,get:function(){return K.TopologyClosedEvent}}),Object.defineProperty(e,"TopologyDescriptionChangedEvent",{enumerable:!0,get:function(){return K.TopologyDescriptionChangedEvent}}),Object.defineProperty(e,"TopologyOpeningEvent",{enumerable:!0,get:function(){return K.TopologyOpeningEvent}});var Y=bu();Object.defineProperty(e,"ServerSelectionEvent",{enumerable:!0,get:function(){return Y.ServerSelectionEvent}}),Object.defineProperty(e,"ServerSelectionFailedEvent",{enumerable:!0,get:function(){return Y.ServerSelectionFailedEvent}}),Object.defineProperty(e,"ServerSelectionStartedEvent",{enumerable:!0,get:function(){return Y.ServerSelectionStartedEvent}}),Object.defineProperty(e,"ServerSelectionSucceededEvent",{enumerable:!0,get:function(){return Y.ServerSelectionSucceededEvent}}),Object.defineProperty(e,"WaitingForSuitableServerEvent",{enumerable:!0,get:function(){return Y.WaitingForSuitableServerEvent}});var J=Du();Object.defineProperty(e,"SrvPollingEvent",{enumerable:!0,get:function(){return J.SrvPollingEvent}});var X=No();Object.defineProperty(e,"MongoCryptAzureKMSRequestError",{enumerable:!0,get:function(){return X.MongoCryptAzureKMSRequestError}}),Object.defineProperty(e,"MongoCryptCreateDataKeyError",{enumerable:!0,get:function(){return X.MongoCryptCreateDataKeyError}}),Object.defineProperty(e,"MongoCryptCreateEncryptedCollectionError",{enumerable:!0,get:function(){return X.MongoCryptCreateEncryptedCollectionError}}),Object.defineProperty(e,"MongoCryptError",{enumerable:!0,get:function(){return X.MongoCryptError}}),Object.defineProperty(e,"MongoCryptInvalidArgumentError",{enumerable:!0,get:function(){return X.MongoCryptInvalidArgumentError}}),Object.defineProperty(e,"MongoCryptKMSRequestNetworkTimeoutError",{enumerable:!0,get:function(){return X.MongoCryptKMSRequestNetworkTimeoutError}});var ee=ou();Object.defineProperty(e,"MongoClientAuthProviders",{enumerable:!0,get:function(){return ee.MongoClientAuthProviders}})}(lu)),lu}function Tu(){if(wu)return au;wu=1,Object.defineProperty(au,"__esModule",{value:!0}),au.ClientBulkWriteOperation=void 0;const e=(Cu||(Cu=1,t=cu,Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(const n of Object.keys(e))Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})}(Mu())),cu);var t;const n=pe(),r=fe(),o=Zu(),i=De();class s extends o.CommandOperation{get commandName(){return"bulkWrite"}constructor(e,t){super(void 0,t),this.commandBuilder=e,this.options=t,this.ns=new r.MongoDBNamespace("admin","$cmd")}resetBatch(){return this.commandBuilder.resetBatch()}get canRetryWrite(){return this.commandBuilder.isBatchRetryable}async execute(t,r,o){let i;if(t.description.type===e.ServerType.LoadBalancer){if(!r)throw new e.MongoClientBulkWriteExecutionError("Session provided to the client bulk write operation must be present.");{let e;r.pinnedConnection?e=r.pinnedConnection:(e=await t.pool.checkOut({timeoutContext:o}),r.pin(e)),i=this.commandBuilder.buildBatch(e.hello?.maxMessageSizeBytes,e.hello?.maxWriteBatchSize,e.hello?.maxBsonObjectSize)}}else{if(!t.description.maxWriteBatchSize||!t.description.maxMessageSizeBytes||!t.description.maxBsonObjectSize)throw new e.MongoClientBulkWriteExecutionError("In order to execute a client bulk write, both maxWriteBatchSize, maxMessageSizeBytes and maxBsonObjectSize must be provided by the servers hello response.");i=this.commandBuilder.buildBatch(t.description.maxMessageSizeBytes,t.description.maxWriteBatchSize,t.description.maxBsonObjectSize)}return this.canRetryWrite||(this.options.willRetryWrite=!1),await super.executeCommand(t,r,i,o,n.ClientBulkWriteCursorResponse)}}return au.ClientBulkWriteOperation=s,(0,i.defineAspects)(s,[i.Aspect.WRITE_OPERATION,i.Aspect.SKIP_COLLATION,i.Aspect.CURSOR_CREATING,i.Aspect.RETRYABLE,i.Aspect.COMMAND_BATCHING]),au}var Bu,Fu={};function $u(){return Bu||(Bu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.buildReplaceOneOperation=e.buildUpdateManyOperation=e.buildUpdateOneOperation=e.buildDeleteManyOperation=e.buildDeleteOneOperation=e.buildInsertOneOperation=e.ClientBulkWriteCommandBuilder=void 0,e.buildOperation=a;const t=F(),n=So(),r=P(),o=fe();function i(e,t,n){if(t.length>n)throw new r.MongoInvalidArgumentError(`Client bulk write operation ${e} of length ${t.length} exceeds the max bson object size of ${n}`)}e.ClientBulkWriteCommandBuilder=class{constructor(e,t,n){this.models=e,this.options=t,this.pkFactory=n??o.DEFAULT_PK_FACTORY,this.currentModelIndex=0,this.previousModelIndex=0,this.lastOperations=[],this.isBatchRetryable=!0}get errorsOnly(){return!("verboseResults"in this.options)||!this.options.verboseResults}hasNextBatch(){return this.currentModelIndex<this.models.length}resetBatch(){return this.currentModelIndex=this.previousModelIndex,!0}buildBatch(e,n,o){this.isBatchRetryable=!0;let s=0,u=0;const c=this.baseCommand(),l=new Map;for(this.previousModelIndex=this.currentModelIndex;this.currentModelIndex<this.models.length;){const h=this.models[this.currentModelIndex],p=h.namespace,d=l.get(p);if("deleteMany"!==h.name&&"updateMany"!==h.name||(this.isBatchRetryable=!1),null!=d){const u=a(h,d,this.pkFactory);let l;try{l=t.BSON.serialize(u)}catch(e){throw new r.MongoInvalidArgumentError("Could not serialize operation to BSON",{cause:e})}if(i("ops",l,o),!(s+l.length<e&&c.ops.documents.length<n))break;s=1e3+c.ops.push(u,l),this.currentModelIndex++}else{l.set(p,u);const d={ns:p},f=a(h,u,this.pkFactory);let m,y;try{m=t.BSON.serialize(d),y=t.BSON.serialize(f)}catch(e){throw new r.MongoInvalidArgumentError("Could not serialize ns info to BSON",{cause:e})}if(i("nsInfo",m,o),i("ops",y,o),!(s+m.length+y.length<e&&c.ops.documents.length<n))break;s=1e3+c.nsInfo.push(d,m)+c.ops.push(f,y),u++,this.currentModelIndex++}}return this.lastOperations=c.ops.documents,c}baseCommand(){const e={bulkWrite:1,errorsOnly:this.errorsOnly,ordered:this.options.ordered??!0,ops:new n.DocumentSequence("ops"),nsInfo:new n.DocumentSequence("nsInfo")};return null!=this.options.bypassDocumentValidation&&(e.bypassDocumentValidation=this.options.bypassDocumentValidation),this.options.let&&(e.let=this.options.let),void 0!==this.options.comment&&(e.comment=this.options.comment),e}};e.buildInsertOneOperation=(e,t,n)=>{const r={insert:t,document:e.document};return r.document._id=e.document._id??n.createPk(),r};e.buildDeleteOneOperation=(e,t)=>s(e,t,!1);function s(e,t,n){const r={delete:t,multi:n,filter:e.filter};return e.hint&&(r.hint=e.hint),e.collation&&(r.collation=e.collation),r}e.buildDeleteManyOperation=(e,t)=>s(e,t,!0);e.buildUpdateOneOperation=(e,t)=>u(e,t,!1);function u(e,t,n){!function(e){if(!(0,o.hasAtomicOperators)(e))throw new r.MongoAPIError("Client bulk write update models must only contain atomic modifiers (start with $) and must not be empty.")}(e.update);const i={update:t,multi:n,filter:e.filter,updateMods:e.update};return e.hint&&(i.hint=e.hint),e.upsert&&(i.upsert=e.upsert),e.arrayFilters&&(i.arrayFilters=e.arrayFilters),e.collation&&(i.collation=e.collation),i}e.buildUpdateManyOperation=(e,t)=>u(e,t,!0);function a(t,n,r){switch(t.name){case"insertOne":return(0,e.buildInsertOneOperation)(t,n,r);case"deleteOne":return(0,e.buildDeleteOneOperation)(t,n);case"deleteMany":return(0,e.buildDeleteManyOperation)(t,n);case"updateOne":return(0,e.buildUpdateOneOperation)(t,n);case"updateMany":return(0,e.buildUpdateManyOperation)(t,n);case"replaceOne":return(0,e.buildReplaceOneOperation)(t,n)}}e.buildReplaceOneOperation=(e,t)=>{if((0,o.hasAtomicOperators)(e.replacement))throw new r.MongoAPIError("Client bulk write replace models must not contain atomic modifiers (start with $) and must not be empty.");const n={update:t,multi:!1,filter:e.filter,updateMods:e.replacement};return e.hint&&(n.hint=e.hint),e.upsert&&(n.upsert=e.upsert),e.collation&&(n.collation=e.collation),n}}(Fu)),Fu}var xu,Pu,Nu={};function Iu(){if(Pu)return su;Pu=1,Object.defineProperty(su,"__esModule",{value:!0}),su.ClientBulkWriteExecutor=void 0;const e=Ju(),t=function(){if(Su)return uu;Su=1,Object.defineProperty(uu,"__esModule",{value:!0}),uu.ClientBulkWriteCursor=void 0;const e=Tu(),t=Me(),n=fe(),r=Ju();class o extends r.AbstractCursor{constructor(e,t,r={}){super(e,new n.MongoDBNamespace("admin","$cmd"),r),this.commandBuilder=t,this.clientBulkWriteOptions=r}get response(){return this.cursorResponse?this.cursorResponse:null}get operations(){return this.commandBuilder.lastOperations}clone(){const e=(0,n.mergeOptions)({},this.clientBulkWriteOptions);return delete e.session,new o(this.client,this.commandBuilder,{...e})}async _initialize(n){const r=new e.ClientBulkWriteOperation(this.commandBuilder,{...this.clientBulkWriteOptions,...this.cursorOptions,session:n}),o=await(0,t.executeOperation)(this.client,r,this.timeoutContext);return this.cursorResponse=o,{server:r.server,session:n,response:o}}}return uu.ClientBulkWriteCursor=o,uu}(),n=P(),r=Ce(),o=fe(),i=de(),s=Me(),u=Tu(),a=$u(),c=function(){if(xu)return Nu;xu=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.ClientBulkWriteResultsMerger=void 0;const e=Mu(),t=P(),n={acknowledged:!1,insertedCount:0,upsertedCount:0,matchedCount:0,modifiedCount:0,deletedCount:0,insertResults:void 0,updateResults:void 0,deleteResults:void 0};return Nu.ClientBulkWriteResultsMerger=class{static unacknowledged(){return n}constructor(e){this.options=e,this.currentBatchOffset=0,this.writeConcernErrors=[],this.writeErrors=new Map,this.result={acknowledged:!0,insertedCount:0,upsertedCount:0,matchedCount:0,modifiedCount:0,deletedCount:0,insertResults:void 0,updateResults:void 0,deleteResults:void 0},e.verboseResults&&(this.result.insertResults=new Map,this.result.updateResults=new Map,this.result.deleteResults=new Map)}get bulkWriteResult(){return{acknowledged:this.result.acknowledged,insertedCount:this.result.insertedCount,upsertedCount:this.result.upsertedCount,matchedCount:this.result.matchedCount,modifiedCount:this.result.modifiedCount,deletedCount:this.result.deletedCount,insertResults:this.result.insertResults,updateResults:this.result.updateResults,deleteResults:this.result.deleteResults}}async merge(n){let r;try{for await(const e of n)if(1===e.ok)this.options.verboseResults&&this.processDocument(n,e);else{if(this.options.ordered){const n=new t.MongoClientBulkWriteError({message:"Mongo client ordered bulk write encountered a write error."});throw n.writeErrors.set(e.idx+this.currentBatchOffset,{code:e.code,message:e.errmsg}),n.partialResult=this.result,n}this.writeErrors.set(e.idx+this.currentBatchOffset,{code:e.code,message:e.errmsg})}}catch(t){if(!(t instanceof e.MongoWriteConcernError))throw t;{const e=t.result;if(r={insertedCount:e.nInserted,upsertedCount:e.nUpserted,matchedCount:e.nMatched,modifiedCount:e.nModified,deletedCount:e.nDeleted,writeConcernError:e.writeConcernError},this.options.verboseResults&&e.cursor.firstBatch)for(const t of e.cursor.firstBatch)1===t.ok&&this.processDocument(n,t)}}finally{if(n.response){const e=n.response;this.incrementCounts(e)}this.currentBatchOffset+=n.operations.length}if(r){const e=r.writeConcernError;this.incrementCounts(r),this.writeConcernErrors.push({code:e.code,message:e.errmsg})}return this.result}processDocument(e,t){const n=e.operations[t.idx];if("insert"in n&&this.result.insertResults?.set(t.idx+this.currentBatchOffset,{insertedId:n.document._id}),"update"in n){const e={matchedCount:t.n,modifiedCount:t.nModified??0,didUpsert:null!=t.upserted};t.upserted&&(e.upsertedId=t.upserted._id),this.result.updateResults?.set(t.idx+this.currentBatchOffset,e)}"delete"in n&&this.result.deleteResults?.set(t.idx+this.currentBatchOffset,{deletedCount:t.n})}incrementCounts(e){this.result.insertedCount+=e.insertedCount,this.result.upsertedCount+=e.upsertedCount,this.result.matchedCount+=e.matchedCount,this.result.modifiedCount+=e.modifiedCount,this.result.deletedCount+=e.deletedCount}},Nu}();return su.ClientBulkWriteExecutor=class{constructor(e,t,r){if(0===t.length)throw new n.MongoClientBulkWriteExecutionError("No client bulk write models were provided.");if(this.client=e,this.operations=t,this.options={ordered:!0,bypassDocumentValidation:!1,verboseResults:!1,...r},this.options.writeConcern||(this.options.writeConcern=i.WriteConcern.fromOptions(this.client.s.options)),0===this.options.writeConcern?.w){if(this.options.verboseResults)throw new n.MongoInvalidArgumentError("Cannot request unacknowledged write concern and verbose results");if(this.options.ordered)throw new n.MongoInvalidArgumentError("Cannot request unacknowledged write concern and ordered writes")}}async execute(){const i=this.client.s.options.pkFactory,l=new a.ClientBulkWriteCommandBuilder(this.operations,this.options,i),h=(0,o.resolveTimeoutOptions)(this.client,this.options),p=r.TimeoutContext.create(h);if(0===this.options.writeConcern?.w){for(;l.hasNextBatch();){const e=new u.ClientBulkWriteOperation(l,this.options);await(0,s.executeOperation)(this.client,e,p)}return c.ClientBulkWriteResultsMerger.unacknowledged()}{const r=new c.ClientBulkWriteResultsMerger(this.options);for(;l.hasNextBatch();){const o=new e.CursorTimeoutContext(p,Symbol()),i={...this.options,timeoutContext:o,...null!=h.timeoutMS&&{timeoutMode:e.CursorTimeoutMode.LIFETIME}},s=new t.ClientBulkWriteCursor(this.client,l,i);try{await r.merge(s)}catch(e){if(e instanceof n.MongoServerError&&!(e instanceof n.MongoClientBulkWriteError)){const t=new n.MongoClientBulkWriteError({message:"Mongo client bulk write encountered an error during execution"});throw t.cause=e,t.partialResult=r.bulkWriteResult,t}throw e}}if(r.writeConcernErrors.length>0||r.writeErrors.size>0){const e=new n.MongoClientBulkWriteError({message:"Mongo client bulk write encountered errors during execution."});throw e.writeConcernErrors=r.writeConcernErrors,e.writeErrors=r.writeErrors,e.partialResult=r.bulkWriteResult,e}return r.bulkWriteResult}}},su}var Ru,ku,ju,Lu,Uu,Vu,zu,Wu,qu,Gu,Hu={};function Ku(){if(Ru)return Hu;Ru=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.ServerCapabilities=Hu.Topology=void 0;const e=es(),t=z(),n=P(),r=me(),o=ye(),i=Z(),s=Ce(),u=fe(),a=ne(),c=ji(),l=Xi(),h=Ei(),p=be(),d=bu(),f=Du(),m=Ai();let y=0;const g=(0,u.makeStateMachine)({[a.STATE_CLOSED]:[a.STATE_CLOSED,a.STATE_CONNECTING],[a.STATE_CONNECTING]:[a.STATE_CONNECTING,a.STATE_CLOSING,a.STATE_CONNECTED,a.STATE_CLOSED],[a.STATE_CONNECTED]:[a.STATE_CONNECTED,a.STATE_CLOSING,a.STATE_CLOSED],[a.STATE_CLOSING]:[a.STATE_CLOSING,a.STATE_CLOSED]});class E extends o.TypedEventEmitter{constructor(t,r,o){super(),this.on("error",u.noop),this.client=t,o=o??{hosts:[u.HostAddress.fromString("localhost:27017")],...Object.fromEntries(e.DEFAULT_OPTIONS.entries())},"string"==typeof r?r=[u.HostAddress.fromString(r)]:Array.isArray(r)||(r=[r]);const i=[];for(const e of r)if("string"==typeof e)i.push(u.HostAddress.fromString(e));else{if(!(e instanceof u.HostAddress))throw new n.MongoRuntimeError(`Topology cannot be constructed from ${JSON.stringify(e)}`);i.push(e)}const s=function(e){if(e?.directConnection)return a.TopologyType.Single;if(e?.replicaSet)return a.TopologyType.ReplicaSetNoPrimary;if(e?.loadBalanced)return a.TopologyType.LoadBalanced;return a.TopologyType.Unknown}(o),c=y++,l=null==o.srvMaxHosts||0===o.srvMaxHosts||o.srvMaxHosts>=i.length?i:(0,u.shuffle)(i,o.srvMaxHosts),p=new Map;for(const e of l)p.set(e.toString(),new h.ServerDescription(e));this.waitQueue=new u.List,this.s={id:c,options:o,seedlist:i,state:a.STATE_CLOSED,description:new m.TopologyDescription(s,p,o.replicaSet,void 0,void 0,void 0,o),serverSelectionTimeoutMS:o.serverSelectionTimeoutMS,heartbeatFrequencyMS:o.heartbeatFrequencyMS,minHeartbeatFrequencyMS:o.minHeartbeatFrequencyMS,servers:new Map,credentials:o?.credentials,clusterTime:void 0,detectShardedTopology:e=>this.detectShardedTopology(e),detectSrvRecords:e=>this.detectSrvRecords(e)},this.mongoLogger=t.mongoLogger,this.component="topology",o.srvHost&&!o.loadBalanced&&(this.s.srvPoller=o.srvPoller??new f.SrvPoller({heartbeatFrequencyMS:this.s.heartbeatFrequencyMS,srvHost:o.srvHost,srvMaxHosts:o.srvMaxHosts,srvServiceName:o.srvServiceName}),this.on(E.TOPOLOGY_DESCRIPTION_CHANGED,this.s.detectShardedTopology)),this.connectionLock=void 0}detectShardedTopology(e){const t=e.previousDescription.type,n=e.newDescription.type,r=t!==a.TopologyType.Sharded&&n===a.TopologyType.Sharded,o=this.s.srvPoller?.listeners(f.SrvPoller.SRV_RECORD_DISCOVERY),i=!!o?.includes(this.s.detectSrvRecords);r&&!i&&(this.s.srvPoller?.on(f.SrvPoller.SRV_RECORD_DISCOVERY,this.s.detectSrvRecords),this.s.srvPoller?.start())}detectSrvRecords(e){const t=this.s.description;this.s.description=this.s.description.updateFromSrvPollingEvent(e,this.s.options.srvMaxHosts),this.s.description!==t&&(_(this),this.emitAndLog(E.TOPOLOGY_DESCRIPTION_CHANGED,new c.TopologyDescriptionChangedEvent(this.s.id,t,this.s.description)))}get description(){return this.s.description}get loadBalanced(){return this.s.options.loadBalanced}get serverApi(){return this.s.options.serverApi}get capabilities(){return new w(this.lastHello())}async connect(e){this.connectionLock??=this._connect(e);try{return await this.connectionLock,this}finally{this.connectionLock=void 0}}async _connect(e){if(e=e??{},this.s.state===a.STATE_CONNECTED)return this;g(this,a.STATE_CONNECTING),this.emitAndLog(E.TOPOLOGY_OPENING,new c.TopologyOpeningEvent(this.s.id)),this.emitAndLog(E.TOPOLOGY_DESCRIPTION_CHANGED,new c.TopologyDescriptionChangedEvent(this.s.id,new m.TopologyDescription(a.TopologyType.Unknown),this.s.description));const t=Array.from(this.s.description.servers.values());if(this.s.servers=new Map(t.map((e=>[e.address,b(this,e)]))),this.s.options.loadBalanced)for(const e of t){const t=new h.ServerDescription(e.hostAddress,void 0,{loadBalanced:this.s.options.loadBalanced});this.serverUpdateHandler(t)}const n=this.client.s.options.serverSelectionTimeoutMS,r=e.readPreference??i.ReadPreference.primary,o=s.TimeoutContext.create({timeoutMS:void 0,serverSelectionTimeoutMS:n,waitQueueTimeoutMS:this.client.s.options.waitQueueTimeoutMS}),l={operationName:"ping",...e,timeoutContext:o};try{const e=await this.selectServer((0,p.readPreferenceServerSelector)(r),l);return!0!==this.s.options.__skipPingOnConnect&&this.s.credentials?(await e.command((0,u.ns)("admin.$cmd"),{ping:1},{timeoutContext:o}),g(this,a.STATE_CONNECTED),this.emit(E.OPEN,this),this.emit(E.CONNECT,this),this):(g(this,a.STATE_CONNECTED),this.emit(E.OPEN,this),this.emit(E.CONNECT,this),this)}catch(e){throw this.close(),e}}close(){if(this.s.state!==a.STATE_CLOSED&&this.s.state!==a.STATE_CLOSING){for(const e of this.s.servers.values())A(e,this);this.s.servers.clear(),g(this,a.STATE_CLOSING),O(this.waitQueue,new n.MongoTopologyClosedError),this.s.srvPoller&&(this.s.srvPoller.stop(),this.s.srvPoller.removeListener(f.SrvPoller.SRV_RECORD_DISCOVERY,this.s.detectSrvRecords)),this.removeListener(E.TOPOLOGY_DESCRIPTION_CHANGED,this.s.detectShardedTopology),g(this,a.STATE_CLOSED),this.emitAndLog(E.TOPOLOGY_CLOSED,new c.TopologyClosedEvent(this.s.id))}}async selectServer(e,t){let o,c;if("function"!=typeof e)if("string"==typeof e)o=(0,p.readPreferenceServerSelector)(i.ReadPreference.fromString(e));else{let n;e instanceof i.ReadPreference?n=e:(i.ReadPreference.translate(t),n=t.readPreference||i.ReadPreference.primary),o=(0,p.readPreferenceServerSelector)(n)}else o=e;t={serverSelectionTimeoutMS:this.s.serverSelectionTimeoutMS,...t},this.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&this.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionStartedEvent(e,this.description,t.operationName)),c=t.timeoutContext?t.timeoutContext.serverSelectionTimeout:s.Timeout.expires(t.serverSelectionTimeoutMS??0);const l=this.description.type===a.TopologyType.Sharded,h=t.session,f=h&&h.transaction;if(l&&f&&f.server)return this.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&this.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionSucceededEvent(e,this.description,f.server.pool.address,t.operationName)),t.timeoutContext?.clearServerSelectionTimeout&&c?.clear(),f.server;const{promise:m,resolve:y,reject:g}=(0,u.promiseWithResolvers)(),E={serverSelector:o,topologyDescription:this.description,mongoLogger:this.client.mongoLogger,transaction:f,resolve:y,reject:g,cancelled:!1,startTime:(0,u.now)(),operationName:t.operationName,waitingLogged:!1,previousServer:t.previousServer},A=(0,u.addAbortListener)(t.signal,(function(){E.cancelled=!0,g(this.reason)}));this.waitQueue.push(E),C(this);try{c?.throwIfExpired();const e=await(c?Promise.race([m,c]):m);return t.timeoutContext?.csotEnabled()&&0!==e.description.minRoundTripTime&&(t.timeoutContext.minRoundTripTime=e.description.minRoundTripTime),e}catch(o){if(s.TimeoutError.is(o)){E.cancelled=!0;const o=new n.MongoServerSelectionError(`Server selection timed out after ${c?.duration} ms`,this.description);if(this.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&this.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionFailedEvent(e,this.description,o,t.operationName)),t.timeoutContext?.csotEnabled())throw new n.MongoOperationTimeoutError("Timed out during server selection",{cause:o});throw o}throw o}finally{A?.[u.kDispose](),t.timeoutContext?.clearServerSelectionTimeout&&c?.clear()}}serverUpdateHandler(e){if(!this.s.description.hasServer(e.address))return;if(function(e,t){const n=e.servers.get(t.address),r=n?.topologyVersion;return(0,h.compareTopologyVersion)(r,t.topologyVersion)>0}(this.s.description,e))return;const t=this.s.description,r=this.s.description.servers.get(e.address);if(!r)return;const o=e.$clusterTime;o&&(0,a._advanceClusterTime)(this,o);const i=r&&r.equals(e);if(this.s.description=this.s.description.update(e),this.s.description.compatibilityError)this.emit(E.ERROR,new n.MongoCompatibilityError(this.s.description.compatibilityError));else{if(!i){const t=this.s.description.servers.get(e.address);t&&this.emit(E.SERVER_DESCRIPTION_CHANGED,new c.ServerDescriptionChangedEvent(this.s.id,e.address,r,t))}_(this,e),this.waitQueue.length>0&&C(this),i||this.emitAndLog(E.TOPOLOGY_DESCRIPTION_CHANGED,new c.TopologyDescriptionChangedEvent(this.s.id,t,this.s.description))}}auth(e,t){"function"==typeof e&&(t=e,e=void 0),"function"==typeof t&&t(void 0,!0)}get clientMetadata(){return this.s.options.metadata}isConnected(){return this.s.state===a.STATE_CONNECTED}isDestroyed(){return this.s.state===a.STATE_CLOSED}lastHello(){const e=Array.from(this.description.servers.values());if(0===e.length)return{};return e.filter((e=>e.type!==a.ServerType.Unknown))[0]||{maxWireVersion:this.description.commonWireVersion}}get commonWireVersion(){return this.description.commonWireVersion}get logicalSessionTimeoutMinutes(){return this.description.logicalSessionTimeoutMinutes}get clusterTime(){return this.s.clusterTime}set clusterTime(e){this.s.clusterTime=e}}function A(e,n){for(const n of t.LOCAL_SERVER_EVENTS)e.removeAllListeners(n);e.destroy(),n.emitAndLog(E.SERVER_CLOSED,new c.ServerClosedEvent(n.s.id,e.description.address));for(const n of t.SERVER_RELAY_EVENTS)e.removeAllListeners(n)}function b(e,n){e.emitAndLog(E.SERVER_OPENING,new c.ServerOpeningEvent(e.s.id,n.address));const r=new l.Server(e,n,e.s.options);for(const n of t.SERVER_RELAY_EVENTS)r.on(n,(t=>e.emit(n,t)));return r.on(l.Server.DESCRIPTION_RECEIVED,(t=>e.serverUpdateHandler(t))),r.connect(),r}function _(e,t){if(t&&e.s.servers.has(t.address)){const r=e.s.servers.get(t.address);if(r)if(r.s.description=t,t.error instanceof n.MongoError&&t.error.hasErrorLabel(n.MongoErrorLabel.ResetPool)){const e=t.error.hasErrorLabel(n.MongoErrorLabel.InterruptInUseConnections);r.pool.clear({interruptInUseConnections:e})}else if(null==t.error){const n=e.s.description.type;(t.isDataBearing||t.type!==a.ServerType.Unknown&&n===a.TopologyType.Single)&&r.pool.ready()}}for(const t of e.description.servers.values())if(!e.s.servers.has(t.address)){const n=b(e,t);e.s.servers.set(t.address,n)}for(const t of e.s.servers){const n=t[0];if(e.description.hasServer(n))continue;if(!e.s.servers.has(n))continue;const r=e.s.servers.get(n);e.s.servers.delete(n),r&&A(r,e)}}function O(e,t){for(;e.length;){const n=e.shift();n&&(n.cancelled||(n.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&n.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionFailedEvent(n.serverSelector,n.topologyDescription,t,n.operationName)),n.reject(t)))}}function C(e){if(e.s.state===a.STATE_CLOSED)return void O(e.waitQueue,new n.MongoTopologyClosedError);const t=e.description.type===a.TopologyType.Sharded,o=Array.from(e.description.servers.values()),i=e.waitQueue.length;for(let s=0;s<i;++s){const i=e.waitQueue.shift();if(!i)continue;if(i.cancelled)continue;let s,a;try{const t=i.serverSelector,n=i.previousServer;s=t?t(e.description,o,n?[n]:[]):o}catch(t){e.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&e.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionFailedEvent(i.serverSelector,e.description,t,i.operationName)),i.reject(t);continue}if(0===s.length){i.waitingLogged||(e.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.INFORMATIONAL)&&e.client.mongoLogger?.info(r.MongoLoggableComponent.SERVER_SELECTION,new d.WaitingForSuitableServerEvent(i.serverSelector,e.description,0!==e.s.serverSelectionTimeoutMS?e.s.serverSelectionTimeoutMS-((0,u.now)()-i.startTime):-1,i.operationName)),i.waitingLogged=!0),e.waitQueue.push(i);continue}if(1===s.length)a=e.s.servers.get(s[0].address);else{const t=(0,u.shuffle)(s,2),n=e.s.servers.get(t[0].address),r=e.s.servers.get(t[1].address);a=n&&r&&n.s.operationCount<r.s.operationCount?n:r}if(!a){const t=new n.MongoServerSelectionError("server selection returned a server description but the server was not found in the topology",e.description);return e.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&e.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionFailedEvent(i.serverSelector,e.description,t,i.operationName)),void i.reject(t)}const c=i.transaction;t&&c&&c.isActive&&a&&c.pinServer(a),e.client.mongoLogger?.willLog(r.MongoLoggableComponent.SERVER_SELECTION,r.SeverityLevel.DEBUG)&&e.client.mongoLogger?.debug(r.MongoLoggableComponent.SERVER_SELECTION,new d.ServerSelectionSucceededEvent(i.serverSelector,i.topologyDescription,a.pool.address,i.operationName)),i.resolve(a)}if(e.waitQueue.length>0)for(const[,t]of e.s.servers)process.nextTick((function(){return t.requestCheck()}))}Hu.Topology=E,E.SERVER_OPENING=t.SERVER_OPENING,E.SERVER_CLOSED=t.SERVER_CLOSED,E.SERVER_DESCRIPTION_CHANGED=t.SERVER_DESCRIPTION_CHANGED,E.TOPOLOGY_OPENING=t.TOPOLOGY_OPENING,E.TOPOLOGY_CLOSED=t.TOPOLOGY_CLOSED,E.TOPOLOGY_DESCRIPTION_CHANGED=t.TOPOLOGY_DESCRIPTION_CHANGED,E.ERROR=t.ERROR,E.OPEN=t.OPEN,E.CONNECT=t.CONNECT,E.CLOSE=t.CLOSE,E.TIMEOUT=t.TIMEOUT;class w{constructor(e){this.minWireVersion=e.minWireVersion||0,this.maxWireVersion=e.maxWireVersion||0}get hasAggregationCursor(){return this.maxWireVersion>=1}get hasWriteCommands(){return this.maxWireVersion>=2}get hasTextSearch(){return this.minWireVersion>=0}get hasAuthCommands(){return this.maxWireVersion>=1}get hasListCollectionsCommand(){return this.maxWireVersion>=3}get hasListIndexesCommand(){return this.maxWireVersion>=3}get supportsSnapshotReads(){return this.maxWireVersion>=13}get commandsTakeWriteConcern(){return this.maxWireVersion>=5}get commandsTakeCollation(){return this.maxWireVersion>=5}}return Hu.ServerCapabilities=w,Hu}function Yu(){if(ku)return Ie;ku=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.MongoClient=Ie.ServerApiVersion=void 0;const e=o,t=F(),n=Nn(),r=Qn(),i=Yn(),s=es(),u=z(),a=Pn(),c=P(),l=ou(),h=me(),p=ye(),d=Iu(),f=Me(),m=cn(),y=Z(),g=Qu(),E=be(),A=Ku(),b=Si(),_=fe();Ie.ServerApiVersion=Object.freeze({v1:"1"});class O extends p.TypedEventEmitter{constructor(e,n){super(),this.on("error",_.noop),this.options=(0,s.parseOptions)(e,this,n);const r=Object.values(this.options.mongoLoggerOptions.componentSeverities).some((e=>e!==h.SeverityLevel.OFF));this.mongoLogger=r?new h.MongoLogger(this.options.mongoLoggerOptions):void 0;const o=this;this.s={url:e,bsonOptions:(0,t.resolveBSONOptions)(this.options),namespace:(0,_.ns)("admin"),hasBeenClosed:!1,sessionPool:new b.ServerSessionPool(this),activeSessions:new Set,activeCursors:new Set,authProviders:new l.MongoClientAuthProviders,get options(){return o.options},get readConcern(){return o.options.readConcern},get writeConcern(){return o.options.writeConcern},get readPreference(){return o.options.readPreference},get isMongoClient(){return!0}},this.checkForNonGenuineHosts()}async asyncDispose(){await this.close()}checkForNonGenuineHosts(){const e=this.options.hosts.filter((e=>(0,_.isHostMatch)(_.DOCUMENT_DB_CHECK,e.host))),t=(0,_.isHostMatch)(_.DOCUMENT_DB_CHECK,this.options.srvHost),n=this.options.hosts.filter((e=>(0,_.isHostMatch)(_.COSMOS_DB_CHECK,e.host))),r=(0,_.isHostMatch)(_.COSMOS_DB_CHECK,this.options.srvHost);0!==e.length||t?this.mongoLogger?.info("client",_.DOCUMENT_DB_MSG):(0!==n.length||r)&&this.mongoLogger?.info("client",_.COSMOS_DB_MSG)}get serverApi(){return this.options.serverApi&&Object.freeze({...this.options.serverApi})}get monitorCommands(){return this.options.monitorCommands}set monitorCommands(e){this.options.monitorCommands=e}get autoEncrypter(){return this.options.autoEncrypter}get readConcern(){return this.s.readConcern}get writeConcern(){return this.s.writeConcern}get readPreference(){return this.s.readPreference}get bsonOptions(){return this.s.bsonOptions}get timeoutMS(){return this.s.options.timeoutMS}async bulkWrite(e,t){if(this.autoEncrypter)throw new c.MongoInvalidArgumentError("MongoClient bulkWrite does not currently support automatic encryption.");return await new d.ClientBulkWriteExecutor(this,e,(0,_.resolveOptions)(this,t)).execute()}async connect(){if(this.connectionLock)return await this.connectionLock;try{this.connectionLock=this._connect(),await this.connectionLock}finally{this.connectionLock=void 0}return this}async _connect(){if(this.topology&&this.topology.isConnected())return this;const t=this.options;if(t.tls&&("string"==typeof t.tlsCAFile&&(t.ca??=await e.promises.readFile(t.tlsCAFile)),"string"==typeof t.tlsCRLFile&&(t.crl??=await e.promises.readFile(t.tlsCRLFile)),!("string"!=typeof t.tlsCertificateKeyFile||t.key&&t.cert))){const n=await e.promises.readFile(t.tlsCertificateKeyFile);t.key??=n,t.cert??=n}if("string"==typeof t.srvHost){const e=await(0,s.resolveSRVRecord)(t);for(const[n,r]of e.entries())t.hosts[n]=r}if(t.credentials?.mechanism===i.AuthMechanism.MONGODB_OIDC){const e=t.credentials?.mechanismProperties?.ALLOWED_HOSTS||r.DEFAULT_ALLOWED_HOSTS;if(!!!t.credentials?.mechanismProperties?.ENVIRONMENT)for(const n of t.hosts)if(!(0,_.hostMatchesWildcards)(n.toHostPort().host,e))throw new c.MongoInvalidArgumentError(`Host '${n}' is not valid for OIDC authentication with ALLOWED_HOSTS of '${e.join(",")}'`)}this.topology=new A.Topology(this,t.hosts,t),this.topology.once(A.Topology.OPEN,(()=>this.emit("open",this)));for(const e of u.MONGO_CLIENT_EVENTS)this.topology.on(e,((...t)=>this.emit(e,...t)));const n=async()=>{try{await(this.topology?.connect(t))}catch(e){throw this.topology?.close(),e}};return this.autoEncrypter?(await(this.autoEncrypter?.init()),await n(),await t.encrypter.connectInternalClient()):await n(),this}async close(e=!1){if(this.closeLock)return await this.closeLock;try{this.closeLock=this._close(e),await this.closeLock}finally{this.closeLock=void 0}}async _close(e=!1){Object.defineProperty(this.s,"hasBeenClosed",{value:!0,enumerable:!0,configurable:!1,writable:!1});const t=Array.from(this.s.activeCursors,(e=>e.close()));this.s.activeCursors.clear(),await Promise.all(t);const n=Array.from(this.s.activeSessions,(e=>e.endSession()));if(this.s.activeSessions.clear(),await Promise.all(n),null==this.topology)return;const r=(0,E.readPreferenceServerSelector)(y.ReadPreference.primaryPreferred),o=this.topology.description,i=Array.from(o.servers.values());if(0!==r(o,i).length){const e=Array.from(this.s.sessionPool.sessions,(({id:e})=>e));if(0!==e.length)try{await(0,f.executeOperation)(this,new m.RunAdminCommandOperation({endSessions:e},{readPreference:y.ReadPreference.primaryPreferred,noResponse:!0}))}catch(e){(0,_.squashError)(e)}}const s=this.topology;this.topology=void 0,s.close();const{encrypter:u}=this.options;u&&await u.close(this,e)}db(e,t){t=t??{},e||(e=this.s.options.dbName);const n=Object.assign({},this.options,t);return new a.Db(this,e,n)}static async connect(e,t){const n=new this(e,t);return await n.connect()}startSession(e){const t=new b.ClientSession(this,this.s.sessionPool,{explicit:!0,...e},this.options);return this.s.activeSessions.add(t),t.once("ended",(()=>{this.s.activeSessions.delete(t)})),t}async withSession(e,t){const n={owner:Symbol(),..."object"==typeof e?e:{}},r="function"==typeof e?e:t;if(null==r)throw new c.MongoInvalidArgumentError("Missing required callback parameter");const o=this.startSession(n);try{return await r(o)}finally{try{await o.endSession()}catch(e){(0,_.squashError)(e)}}}watch(e=[],t={}){return Array.isArray(e)||(t=e,e=[]),new n.ChangeStream(this,e,(0,_.resolveOptions)(this,t))}}return Ie.MongoClient=O,(0,g.configureResourceManagement)(O.prototype),Ie}function Qu(){if(ju)return Ne;function e(e){Symbol.asyncDispose&&Object.defineProperty(e,Symbol.asyncDispose,{value:async function(){await this.asyncDispose()},enumerable:!1,configurable:!0,writable:!0})}return ju=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.configureResourceManagement=e,Ne.configureExplicitResourceManagement=function(){const{MongoClient:t}=Yu(),{ClientSession:n}=Si(),{AbstractCursor:r}=Ju(),{ChangeStream:o}=Nn();e(t.prototype),e(n.prototype),e(r.prototype),e(o.prototype)},Ne}function Ju(){return Lu||(Lu=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorTimeoutContext=t.AbstractCursor=t.CursorTimeoutMode=t.CURSOR_FLAGS=void 0;const n=e,r=F(),o=P(),i=ye(),s=Me(),u=Fe(),a=function(){if($e)return xe;$e=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.KillCursorsOperation=void 0;const e=P(),t=fe(),n=De();class r extends n.AbstractOperation{constructor(e,t,n,r){super(r),this.ns=t,this.cursorId=e,this.server=n}get commandName(){return"killCursors"}async execute(n,r,o){if(n!==this.server)throw new e.MongoRuntimeError("Killcursor must run on the same server operation began on");const i=this.ns.collection;if(null==i)throw new e.MongoRuntimeError("A collection name must be determined before killCursors");const s={killCursors:i,cursors:[this.cursorId]};try{await n.command(this.ns,s,{session:r,timeoutContext:o})}catch(e){(0,t.squashError)(e)}}}return xe.KillCursorsOperation=r,(0,n.defineAspects)(r,[n.Aspect.MUST_SELECT_SAME_SERVER]),xe}(),c=Q(),l=Z(),h=Qu(),p=Si(),d=Ce(),f=fe();function m(){this.client.s.activeCursors.delete(this)}t.CURSOR_FLAGS=["tailable","oplogReplay","noCursorTimeout","awaitData","exhaust","partial"],t.CursorTimeoutMode=Object.freeze({ITERATION:"iteration",LIFETIME:"cursorLifetime"});class y extends i.TypedEventEmitter{constructor(e,n,i={}){if(super(),this.documents=null,this.hasEmittedClose=!1,this.on("error",f.noop),!e.s.isMongoClient)throw new o.MongoRuntimeError("Cursor must be constructed with MongoClient");if(this.cursorClient=e,this.cursorNamespace=n,this.cursorId=null,this.initialized=!1,this.isClosed=!1,this.isKilled=!1,this.cursorOptions={readPreference:i.readPreference&&i.readPreference instanceof l.ReadPreference?i.readPreference:l.ReadPreference.primary,...(0,r.pluckBSONSerializeOptions)(i),timeoutMS:i?.timeoutContext?.csotEnabled()?i.timeoutContext.timeoutMS:i.timeoutMS,tailable:i.tailable,awaitData:i.awaitData},null!=this.cursorOptions.timeoutMS)if(null==i.timeoutMode)if(i.tailable){if(i.awaitData&&null!=i.maxAwaitTimeMS&&i.maxAwaitTimeMS>=this.cursorOptions.timeoutMS)throw new o.MongoInvalidArgumentError("Cannot specify maxAwaitTimeMS >= timeoutMS for a tailable awaitData cursor");this.cursorOptions.timeoutMode=t.CursorTimeoutMode.ITERATION}else this.cursorOptions.timeoutMode=t.CursorTimeoutMode.LIFETIME;else{if(i.tailable&&i.timeoutMode===t.CursorTimeoutMode.LIFETIME)throw new o.MongoInvalidArgumentError("Cannot set tailable cursor's timeoutMode to LIFETIME");this.cursorOptions.timeoutMode=i.timeoutMode}else if(null!=i.timeoutMode)throw new o.MongoInvalidArgumentError("Cannot set timeoutMode without setting timeoutMS");this.cursorOptions.omitMaxTimeMS=null!=this.cursorOptions.timeoutMS&&(this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&!this.cursorOptions.tailable||this.cursorOptions.tailable&&!this.cursorOptions.awaitData);const s=c.ReadConcern.fromOptions(i);s&&(this.cursorOptions.readConcern=s),"number"==typeof i.batchSize&&(this.cursorOptions.batchSize=i.batchSize),void 0!==i.comment&&(this.cursorOptions.comment=i.comment),"number"==typeof i.maxTimeMS&&(this.cursorOptions.maxTimeMS=i.maxTimeMS),"number"==typeof i.maxAwaitTimeMS&&(this.cursorOptions.maxAwaitTimeMS=i.maxAwaitTimeMS),i.session instanceof p.ClientSession?this.cursorSession=i.session:this.cursorSession=this.cursorClient.startSession({owner:this,explicit:!1}),this.deserializationOptions={...this.cursorOptions,validation:{utf8:!1!==i?.enableUtf8Validation}},this.timeoutContext=i.timeoutContext,this.signal=i.signal,this.abortListener=(0,f.addAbortListener)(this.signal,(()=>{this.close().then(void 0,f.squashError)})),this.trackCursor()}get id(){return this.cursorId??void 0}get isDead(){return(this.cursorId?.isZero()??!1)||this.isClosed||this.isKilled}get client(){return this.cursorClient}get server(){return this.selectedServer}get namespace(){return this.cursorNamespace}get readPreference(){return this.cursorOptions.readPreference}get readConcern(){return this.cursorOptions.readConcern}get session(){return this.cursorSession}set session(e){this.cursorSession=e}get closed(){return this.isClosed&&0===(this.documents?.length??0)}get killed(){return this.isKilled}get loadBalanced(){return!!this.cursorClient.topology?.loadBalanced}async asyncDispose(){await this.close()}trackCursor(){this.cursorClient.s.activeCursors.add(this),this.listeners("close").includes(m)||this.once("close",m)}bufferedCount(){return this.documents?.length??0}readBufferedDocuments(e){const t=[],n=Math.min(e??this.documents?.length??0,this.documents?.length??0);for(let e=0;e<n;e++){const e=this.documents?.shift(this.deserializationOptions);null!=e&&t.push(e)}return t}async*[Symbol.asyncIterator](){if(this.signal?.throwIfAborted(),!this.closed)try{for(;;){if(this.isKilled)return;if(this.closed)return;if(null!=this.cursorId&&this.isDead&&0===(this.documents?.length??0))return;const e=await this.next();if(null===e)return;yield e,this.signal?.throwIfAborted()}}finally{if(!this.isClosed)try{await this.close()}catch(e){(0,f.squashError)(e)}}}stream(e){const t=new g(this),r=(0,f.addAbortListener)(this.signal,(function(){t.destroy(this.reason)}));if(t.once("end",(()=>{r?.[f.kDispose]()})),e?.transform){const r=e.transform,o=t.pipe(new n.Transform({objectMode:!0,highWaterMark:1,transform(e,t,n){try{n(void 0,r(e))}catch(e){n(e)}}}));return t.on("error",(e=>o.emit("error",e))),o}return t}async hasNext(){if(this.signal?.throwIfAborted(),this.cursorId===r.Long.ZERO)return!1;this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&null!=this.cursorId&&this.timeoutContext?.refresh();try{do{if(0!==(this.documents?.length??0))return!0;await this.fetchBatch()}while(!this.isDead||0!==(this.documents?.length??0))}finally{this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&this.timeoutContext?.clear()}return!1}async next(){if(this.signal?.throwIfAborted(),this.cursorId===r.Long.ZERO)throw new o.MongoCursorExhaustedError;this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&null!=this.cursorId&&this.timeoutContext?.refresh();try{do{const e=this.documents?.shift(this.deserializationOptions);if(null!=e)return null!=this.transform?await this.transformDocument(e):e;await this.fetchBatch()}while(!this.isDead||0!==(this.documents?.length??0))}finally{this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&this.timeoutContext?.clear()}return null}async tryNext(){if(this.signal?.throwIfAborted(),this.cursorId===r.Long.ZERO)throw new o.MongoCursorExhaustedError;this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&null!=this.cursorId&&this.timeoutContext?.refresh();try{let e=this.documents?.shift(this.deserializationOptions);if(null!=e)return null!=this.transform?await this.transformDocument(e):e;if(await this.fetchBatch(),e=this.documents?.shift(this.deserializationOptions),null!=e)return null!=this.transform?await this.transformDocument(e):e}finally{this.cursorOptions.timeoutMode===t.CursorTimeoutMode.ITERATION&&this.timeoutContext?.clear()}return null}async forEach(e){if(this.signal?.throwIfAborted(),"function"!=typeof e)throw new o.MongoInvalidArgumentError('Argument "iterator" must be a function');for await(const t of this){if(!1===e(t))break}}async close(e){await this.cleanup(e?.timeoutMS)}async toArray(){this.signal?.throwIfAborted();const e=[];for await(const t of this){e.push(t);const n=this.readBufferedDocuments();if(null!=this.transform)for(const t of n)e.push(await this.transformDocument(t));else e.push(...n)}return e}addCursorFlag(e,n){if(this.throwIfInitialized(),!t.CURSOR_FLAGS.includes(e))throw new o.MongoInvalidArgumentError(`Flag ${e} is not one of ${t.CURSOR_FLAGS}`);if("boolean"!=typeof n)throw new o.MongoInvalidArgumentError(`Flag ${e} must be a boolean value`);return this.cursorOptions[e]=n,this}map(e){this.throwIfInitialized();const t=this.transform;return this.transform=t?n=>e(t(n)):e,this}withReadPreference(e){if(this.throwIfInitialized(),e instanceof l.ReadPreference)this.cursorOptions.readPreference=e;else{if("string"!=typeof e)throw new o.MongoInvalidArgumentError(`Invalid read preference: ${e}`);this.cursorOptions.readPreference=l.ReadPreference.fromString(e)}return this}withReadConcern(e){this.throwIfInitialized();const t=c.ReadConcern.fromOptions({readConcern:e});return t&&(this.cursorOptions.readConcern=t),this}maxTimeMS(e){if(this.throwIfInitialized(),"number"!=typeof e)throw new o.MongoInvalidArgumentError("Argument for maxTimeMS must be a number");return this.cursorOptions.maxTimeMS=e,this}batchSize(e){if(this.throwIfInitialized(),this.cursorOptions.tailable)throw new o.MongoTailableCursorError("Tailable cursor does not support batchSize");if("number"!=typeof e)throw new o.MongoInvalidArgumentError('Operation "batchSize" requires an integer');return this.cursorOptions.batchSize=e,this}rewind(){if(this.timeoutContext&&this.timeoutContext.owner!==this)throw new o.MongoAPIError("Cannot rewind cursor that does not own its timeout context.");this.initialized&&(this.cursorId=null,this.documents?.clear(),this.timeoutContext?.clear(),this.timeoutContext=void 0,this.isClosed=!1,this.isKilled=!1,this.initialized=!1,this.hasEmittedClose=!1,this.trackCursor(),!1===this.cursorSession.explicit&&(this.cursorSession.hasEnded||this.cursorSession.endSession().then(void 0,f.squashError),this.cursorSession=this.cursorClient.startSession({owner:this,explicit:!1})))}async getMore(e){if(null==this.cursorId)throw new o.MongoRuntimeError("Unexpected null cursor id. A cursor creating command should have set this");if(null==this.selectedServer)throw new o.MongoRuntimeError("Unexpected null selectedServer. A cursor creating command should have set this");const t={...this.cursorOptions,session:this.cursorSession,batchSize:e},n=new u.GetMoreOperation(this.cursorNamespace,this.cursorId,this.selectedServer,t);return await(0,s.executeOperation)(this.cursorClient,n,this.timeoutContext)}async cursorInit(){null!=this.cursorOptions.timeoutMS&&(this.timeoutContext??=new E(d.TimeoutContext.create({serverSelectionTimeoutMS:this.client.s.options.serverSelectionTimeoutMS,timeoutMS:this.cursorOptions.timeoutMS}),this));try{const e=await this._initialize(this.cursorSession);this.cursorOptions.omitMaxTimeMS=null!=this.cursorOptions.timeoutMS;const t=e.response;this.selectedServer=e.server,this.cursorId=t.id,this.cursorNamespace=t.ns??this.namespace,this.documents=t,this.initialized=!0}catch(e){throw this.initialized=!0,await this.cleanup(void 0,e),e}this.isDead&&await this.cleanup()}async fetchBatch(){if(this.isClosed)return;if(this.isDead)return void await this.cleanup();if(null==this.cursorId&&(await this.cursorInit(),0!==(this.documents?.length??0)||this.isDead))return;const e=this.cursorOptions.batchSize||1e3;try{const t=await this.getMore(e);this.cursorId=t.id,this.documents=t}catch(e){try{await this.cleanup(void 0,e)}catch(e){(0,f.squashError)(e)}throw e}this.isDead&&await this.cleanup()}async cleanup(e,t){this.abortListener?.[f.kDispose](),this.isClosed=!0;const n=()=>null!=e?(this.timeoutContext?.clear(),new E(d.TimeoutContext.create({serverSelectionTimeoutMS:this.client.s.options.serverSelectionTimeoutMS,timeoutMS:e}),this)):this.timeoutContext?.refreshed();try{if(!this.isKilled&&this.cursorId&&!this.cursorId.isZero()&&this.cursorNamespace&&this.selectedServer&&!this.cursorSession.hasEnded){this.isKilled=!0;const e=this.cursorId;this.cursorId=r.Long.ZERO,await(0,s.executeOperation)(this.cursorClient,new a.KillCursorsOperation(e,this.cursorNamespace,this.selectedServer,{session:this.cursorSession}),n())}}catch(t){(0,f.squashError)(t)}finally{try{this.cursorSession?.owner===this&&await this.cursorSession.endSession({error:t}),this.cursorSession?.inTransaction()||(0,p.maybeClearPinnedConnection)(this.cursorSession,{error:t})}finally{this.emitClose()}}}emitClose(){try{this.hasEmittedClose||0!==(this.documents?.length??0)&&!this.isClosed||this.emit("close")}finally{this.hasEmittedClose=!0}}async transformDocument(e){if(null==this.transform)return e;try{const t=this.transform(e);if(null===t){const e="Cursor returned a `null` document, but the cursor is not exhausted.  Mapping documents to `null` is not supported in the cursor transform.";throw new o.MongoAPIError(e)}return t}catch(e){try{await this.close()}catch(e){(0,f.squashError)(e)}throw e}}throwIfInitialized(){if(this.initialized)throw new o.MongoCursorInUseError}}t.AbstractCursor=y,y.CLOSE="close";class g extends n.Readable{constructor(e){super({objectMode:!0,autoDestroy:!1,highWaterMark:1}),this._readInProgress=!1,this._cursor=e}_read(e){this._readInProgress||(this._readInProgress=!0,this._readNext())}_destroy(e,t){this._cursor.close().then((()=>t(e)),(e=>t(e)))}_readNext(){this._cursor.id!==r.Long.ZERO?this._cursor.next().then((e=>{if(null==e)this.push(null);else if(this.destroyed)this._cursor.close().then(void 0,f.squashError);else{if(this.push(e))return this._readNext();this._readInProgress=!1}}),(e=>e.message.match(/server is closed/)?(this._cursor.close().then(void 0,f.squashError),this.push(null)):e.message.match(/operation was interrupted/)?this.push(null):this.destroy(e))).catch((e=>{this._readInProgress=!1,this.destroy(e)})):this.push(null)}}(0,h.configureResourceManagement)(y.prototype);class E extends d.TimeoutContext{constructor(e,t){super(),this.timeoutContext=e,this.owner=t}get serverSelectionTimeout(){return this.timeoutContext.serverSelectionTimeout}get connectionCheckoutTimeout(){return this.timeoutContext.connectionCheckoutTimeout}get clearServerSelectionTimeout(){return this.timeoutContext.clearServerSelectionTimeout}get timeoutForSocketWrite(){return this.timeoutContext.timeoutForSocketWrite}get timeoutForSocketRead(){return this.timeoutContext.timeoutForSocketRead}csotEnabled(){return this.timeoutContext.csotEnabled()}refresh(){if("symbol"!=typeof this.owner)return this.timeoutContext.refresh()}clear(){if("symbol"!=typeof this.owner)return this.timeoutContext.clear()}get maxTimeMS(){return this.timeoutContext.maxTimeMS}get timeoutMS(){return this.timeoutContext.csotEnabled()?this.timeoutContext.timeoutMS:null}refreshed(){return new E(this.timeoutContext.refreshed(),this.owner)}addMaxTimeMSToCommand(e,t){this.timeoutContext.addMaxTimeMSToCommand(e,t)}getSocketTimeoutMS(){return this.timeoutContext.getSocketTimeoutMS()}}t.CursorTimeoutContext=E}(j)),j}function Xu(){return Uu||(Uu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ExplainableCursor=e.Explain=e.ExplainVerbosity=void 0,e.validateExplainTimeoutOptions=function(e,t){const{maxTimeMS:r,timeoutMS:o}=e;if(null!=o&&(null!=r||null!=t?.maxTimeMS))throw new n.MongoAPIError("Cannot use maxTimeMS with timeoutMS for explain commands.")},e.decorateWithExplain=function(e,t){const{verbosity:n,maxTimeMS:r}=t,o={explain:e,verbosity:n};"number"==typeof r&&(o.maxTimeMS=r);return o};const t=Ju(),n=P();e.ExplainVerbosity=Object.freeze({queryPlanner:"queryPlanner",queryPlannerExtended:"queryPlannerExtended",executionStats:"executionStats",allPlansExecution:"allPlansExecution"});class r{constructor(t,n){this.verbosity="boolean"==typeof t?t?e.ExplainVerbosity.allPlansExecution:e.ExplainVerbosity.queryPlanner:t,this.maxTimeMS=n}static fromOptions({explain:e}={}){if(null==e)return;if("boolean"==typeof e||"string"==typeof e)return new r(e);const{verbosity:t,maxTimeMS:n}=e;return new r(t,n)}}e.Explain=r;class o extends t.AbstractCursor{resolveExplainTimeoutOptions(e,t){let n,r;return null==e&&null==t?(n=void 0,r=void 0):null!=e&&null==t?(n="object"!=typeof e||"verbosity"in e?e:void 0,r="object"==typeof e&&"timeoutMS"in e?e:void 0):(n=e,r=t),{timeout:r,explain:n}}}e.ExplainableCursor=o}(k)),k}function Zu(){if(Vu)return R;Vu=1,Object.defineProperty(R,"__esModule",{value:!0}),R.CommandOperation=void 0;const e=P(),t=Xu(),n=Q(),r=be(),o=fe(),i=de(),s=De();class u extends s.AbstractOperation{constructor(r,u){super(u),this.options=u??{};const a=u?.dbName||u?.authdb;if(this.ns=a?new o.MongoDBNamespace(a,"$cmd"):r?r.s.namespace.withCollection("$cmd"):new o.MongoDBNamespace("admin","$cmd"),this.readConcern=n.ReadConcern.fromOptions(u),this.writeConcern=i.WriteConcern.fromOptions(u),this.hasAspect(s.Aspect.EXPLAINABLE))this.explain=t.Explain.fromOptions(u),this.explain&&(0,t.validateExplainTimeoutOptions)(this.options,this.explain);else if(null!=u?.explain)throw new e.MongoInvalidArgumentError('Option "explain" is not supported on this command')}get canRetryWrite(){return this.hasAspect(s.Aspect.EXPLAINABLE)?null==this.explain:super.canRetryWrite}async executeCommand(e,n,u,a,c){this.server=e;const l={...this.options,...this.bsonOptions,timeoutContext:a,readPreference:this.readPreference,session:n},h=(0,o.maxWireVersion)(e),p=this.session&&this.session.inTransaction();return this.readConcern&&(0,o.commandSupportsReadConcern)(u)&&!p&&Object.assign(u,{readConcern:this.readConcern}),this.trySecondaryWrite&&h<r.MIN_SECONDARY_WRITE_WIRE_VERSION&&(l.omitReadPreference=!0),this.writeConcern&&this.hasAspect(s.Aspect.WRITE_OPERATION)&&!p&&i.WriteConcern.apply(u,this.writeConcern),l.collation&&"object"==typeof l.collation&&!this.hasAspect(s.Aspect.SKIP_COLLATION)&&Object.assign(u,{collation:l.collation}),"number"==typeof l.maxTimeMS&&(u.maxTimeMS=l.maxTimeMS),this.hasAspect(s.Aspect.EXPLAINABLE)&&this.explain&&(u=(0,t.decorateWithExplain)(u,this.explain)),await e.command(this.ns,u,l,c)}}return R.CommandOperation=u,R}function ea(){if(zu)return I;zu=1,Object.defineProperty(I,"__esModule",{value:!0}),I.DeleteManyOperation=I.DeleteOneOperation=I.DeleteOperation=void 0,I.makeDeleteStatement=s;const e=P(),t=Zu(),n=De();class r extends t.CommandOperation{constructor(e,t,n){super(void 0,n),this.options=n,this.ns=e,this.statements=t}get commandName(){return"delete"}get canRetryWrite(){return!1!==super.canRetryWrite&&this.statements.every((e=>null==e.limit||e.limit>0))}async execute(t,n,r){const o=this.options??{},i="boolean"!=typeof o.ordered||o.ordered,s={delete:this.ns.collection,deletes:this.statements,ordered:i};o.let&&(s.let=o.let),void 0!==o.comment&&(s.comment=o.comment);if(this.writeConcern&&0===this.writeConcern.w&&this.statements.find((e=>e.hint)))throw new e.MongoCompatibilityError("hint is not supported with unacknowledged writes");return await super.executeCommand(t,n,s,r)}}I.DeleteOperation=r;class o extends r{constructor(e,t,n){super(e.s.namespace,[s(t,{...n,limit:1})],n)}async execute(t,n,r){const o=await super.execute(t,n,r);if(this.explain)return o;if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,deletedCount:o.n}}}I.DeleteOneOperation=o;class i extends r{constructor(e,t,n){super(e.s.namespace,[s(t,n)],n)}async execute(t,n,r){const o=await super.execute(t,n,r);if(this.explain)return o;if(o.code)throw new e.MongoServerError(o);if(o.writeErrors)throw new e.MongoServerError(o.writeErrors[0]);return{acknowledged:0!==this.writeConcern?.w,deletedCount:o.n}}}function s(e,t){const n={q:e,limit:"number"==typeof t.limit?t.limit:0};return t.collation&&(n.collation=t.collation),t.hint&&(n.hint=t.hint),n}return I.DeleteManyOperation=i,(0,n.defineAspects)(r,[n.Aspect.RETRYABLE,n.Aspect.WRITE_OPERATION]),(0,n.defineAspects)(o,[n.Aspect.RETRYABLE,n.Aspect.WRITE_OPERATION,n.Aspect.EXPLAINABLE,n.Aspect.SKIP_COLLATION]),(0,n.defineAspects)(i,[n.Aspect.WRITE_OPERATION,n.Aspect.EXPLAINABLE,n.Aspect.SKIP_COLLATION]),I}function ta(){return Wu||(Wu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BulkOperationBase=e.BulkWriteShimOperation=e.FindOperators=e.MongoBulkWriteError=e.WriteError=e.WriteConcernError=e.BulkWriteResult=e.Batch=e.BatchType=void 0,e.mergeBatchResults=d;const t=F(),n=P(),r=ea(),o=Me(),i=Ft(),s=De(),u=Kt(),a=fe(),c=de();e.BatchType=Object.freeze({INSERT:1,UPDATE:2,DELETE:3});e.Batch=class{constructor(e,t){this.originalZeroIndex=t,this.currentIndex=0,this.originalIndexes=[],this.batchType=e,this.operations=[],this.size=0,this.sizeBytes=0}};class l{static generateIdMap(e){const t={};for(const n of e)t[n.index]=n._id;return t}constructor(e,t){this.result=e,this.insertedCount=this.result.nInserted??0,this.matchedCount=this.result.nMatched??0,this.modifiedCount=this.result.nModified??0,this.deletedCount=this.result.nRemoved??0,this.upsertedCount=this.result.upserted.length??0,this.upsertedIds=l.generateIdMap(this.result.upserted),this.insertedIds=l.generateIdMap(this.getSuccessfullyInsertedIds(e,t)),Object.defineProperty(this,"result",{value:this.result,enumerable:!1})}get ok(){return this.result.ok}getSuccessfullyInsertedIds(e,t){return 0===e.writeErrors.length?e.insertedIds:t?e.insertedIds.slice(0,e.writeErrors[0].index):e.insertedIds.filter((({index:t})=>!e.writeErrors.some((e=>t===e.index))))}getUpsertedIdAt(e){return this.result.upserted[e]}getRawResponse(){return this.result}hasWriteErrors(){return this.result.writeErrors.length>0}getWriteErrorCount(){return this.result.writeErrors.length}getWriteErrorAt(e){return e<this.result.writeErrors.length?this.result.writeErrors[e]:void 0}getWriteErrors(){return this.result.writeErrors}getWriteConcernError(){if(0!==this.result.writeConcernErrors.length){if(1===this.result.writeConcernErrors.length)return this.result.writeConcernErrors[0];{let e="";for(let t=0;t<this.result.writeConcernErrors.length;t++){e+=this.result.writeConcernErrors[t].errmsg,0===t&&(e+=" and ")}return new h({errmsg:e,code:n.MONGODB_ERROR_CODES.WriteConcernFailed})}}}toString(){return`BulkWriteResult(${t.EJSON.stringify(this.result)})`}isOk(){return 1===this.result.ok}}e.BulkWriteResult=l;class h{constructor(e){this.serverError=e}get code(){return this.serverError.code}get errmsg(){return this.serverError.errmsg}get errInfo(){return this.serverError.errInfo}toJSON(){return this.serverError}toString(){return`WriteConcernError(${this.errmsg})`}}e.WriteConcernError=h;class p{constructor(e){this.err=e}get code(){return this.err.code}get index(){return this.err.index}get errmsg(){return this.err.errmsg}get errInfo(){return this.err.errInfo}getOperation(){return this.err.op}toJSON(){return{code:this.err.code,index:this.err.index,errmsg:this.err.errmsg,op:this.err.op}}toString(){return`WriteError(${JSON.stringify(this.toJSON())})`}}function d(e,t,n,r){if(n?r=n:r&&r.result&&(r=r.result),null==r)return;if(0===r.ok&&1===t.ok){t.ok=0;const n={index:0,code:r.code||0,errmsg:r.message,errInfo:r.errInfo,op:e.operations[0]};return void t.writeErrors.push(new p(n))}if(0===r.ok&&0===t.ok)return;g(e)&&r.n&&(t.nInserted=t.nInserted+r.n),A(e)&&r.n&&(t.nRemoved=t.nRemoved+r.n);let o=0;if(Array.isArray(r.upserted)){o=r.upserted.length;for(let n=0;n<r.upserted.length;n++)t.upserted.push({index:r.upserted[n].index+e.originalZeroIndex,_id:r.upserted[n]._id})}else r.upserted&&(o=1,t.upserted.push({index:e.originalZeroIndex,_id:r.upserted}));if(E(e)&&r.n){const e=r.nModified;t.nUpserted=t.nUpserted+o,t.nMatched=t.nMatched+(r.n-o),t.nModified="number"==typeof e?t.nModified+e:0}if(Array.isArray(r.writeErrors))for(let n=0;n<r.writeErrors.length;n++){const o={index:e.originalIndexes[r.writeErrors[n].index],code:r.writeErrors[n].code,errmsg:r.writeErrors[n].errmsg,errInfo:r.writeErrors[n].errInfo,op:e.operations[r.writeErrors[n].index]};t.writeErrors.push(new p(o))}r.writeConcernError&&t.writeConcernErrors.push(new h(r.writeConcernError))}e.WriteError=p;class f extends n.MongoServerError{constructor(e,t){super(e),this.writeErrors=[],e instanceof h?this.err=e:e instanceof Error||(this.message=e.message,this.code=e.code,this.writeErrors=e.writeErrors??[]),this.result=t,Object.assign(this,e)}get name(){return"MongoBulkWriteError"}get insertedCount(){return this.result.insertedCount}get matchedCount(){return this.result.matchedCount}get modifiedCount(){return this.result.modifiedCount}get deletedCount(){return this.result.deletedCount}get upsertedCount(){return this.result.upsertedCount}get insertedIds(){return this.result.insertedIds}get upsertedIds(){return this.result.upsertedIds}}e.MongoBulkWriteError=f;class m{constructor(e){this.bulkOperation=e}update(t){const n=b(this.bulkOperation);return this.bulkOperation.addToOperationsList(e.BatchType.UPDATE,(0,u.makeUpdateStatement)(n.selector,t,{...n,multi:!0}))}updateOne(t){if(!(0,a.hasAtomicOperators)(t))throw new n.MongoInvalidArgumentError("Update document requires atomic operators");const r=b(this.bulkOperation);return this.bulkOperation.addToOperationsList(e.BatchType.UPDATE,(0,u.makeUpdateStatement)(r.selector,t,{...r,multi:!1}))}replaceOne(t){if((0,a.hasAtomicOperators)(t))throw new n.MongoInvalidArgumentError("Replacement document must not use atomic operators");const r=b(this.bulkOperation);return this.bulkOperation.addToOperationsList(e.BatchType.UPDATE,(0,u.makeUpdateStatement)(r.selector,t,{...r,multi:!1}))}deleteOne(){const t=b(this.bulkOperation);return this.bulkOperation.addToOperationsList(e.BatchType.DELETE,(0,r.makeDeleteStatement)(t.selector,{...t,limit:1}))}delete(){const t=b(this.bulkOperation);return this.bulkOperation.addToOperationsList(e.BatchType.DELETE,(0,r.makeDeleteStatement)(t.selector,{...t,limit:0}))}upsert(){return this.bulkOperation.s.currentOp||(this.bulkOperation.s.currentOp={}),this.bulkOperation.s.currentOp.upsert=!0,this}collation(e){return this.bulkOperation.s.currentOp||(this.bulkOperation.s.currentOp={}),this.bulkOperation.s.currentOp.collation=e,this}arrayFilters(e){return this.bulkOperation.s.currentOp||(this.bulkOperation.s.currentOp={}),this.bulkOperation.s.currentOp.arrayFilters=e,this}hint(e){return this.bulkOperation.s.currentOp||(this.bulkOperation.s.currentOp={}),this.bulkOperation.s.currentOp.hint=e,this}}e.FindOperators=m;class y extends s.AbstractOperation{constructor(e,t){super(t),this.bulkOperation=e}get commandName(){return"bulkWrite"}async execute(e,t,s){return null==this.options.session&&(this.options.session=t),await async function(e,t){if(0===e.s.batches.length)return new l(e.s.bulkResult,e.isOrdered);for(const s of e.s.batches){const c=(0,a.resolveOptions)(e,{...t,ordered:e.isOrdered});!0!==c.bypassDocumentValidation&&delete c.bypassDocumentValidation,!0===e.s.bypassDocumentValidation&&(c.bypassDocumentValidation=!0),!1===e.s.checkKeys&&(c.checkKeys=!1),c.retryWrites&&(E(s)&&(c.retryWrites=c.retryWrites&&!s.operations.some((e=>e.multi))),A(s)&&(c.retryWrites=c.retryWrites&&!s.operations.some((e=>0===e.limit))));const h=g(s)?new i.InsertOperation(e.s.namespace,s.operations,c):E(s)?new u.UpdateOperation(e.s.namespace,s.operations,c):A(s)?new r.DeleteOperation(e.s.namespace,s.operations,c):null;if(null==h)throw new n.MongoRuntimeError(`Unknown batchType: ${s.batchType}`);let p,m=null;try{p=await(0,o.executeOperation)(e.s.collection.client,h,c.timeoutContext)}catch(e){m=e}if(null!=m){if(m instanceof n.MongoWriteConcernError){d(s,e.s.bulkResult,m,p);const t=new l(e.s.bulkResult,e.isOrdered);throw new f({message:m.result.writeConcernError.errmsg,code:m.result.writeConcernError.code},t)}throw new f(m,new l(e.s.bulkResult,e.isOrdered))}d(s,e.s.bulkResult,m,p);const y=new l(e.s.bulkResult,e.isOrdered);e.handleWriteError(y)}e.s.batches.length=0;const s=new l(e.s.bulkResult,e.isOrdered);return e.handleWriteError(s),s}(this.bulkOperation,{...this.options,timeoutContext:s})}}e.BulkWriteShimOperation=y;function g(t){return t.batchType===e.BatchType.INSERT}function E(t){return t.batchType===e.BatchType.UPDATE}function A(t){return t.batchType===e.BatchType.DELETE}function b(e){let{currentOp:t}=e.s;return e.s.currentOp=void 0,t||(t={}),t}e.BulkOperationBase=class{constructor(e,n,r){this.collection=e,this.isOrdered=r;const o=(0,a.getTopology)(e);n=null==n?{}:n;const i=e.s.namespace,s=o.lastHello(),u=!(!o.s.options||!o.s.options.autoEncrypter),l=s&&s.maxBsonObjectSize?s.maxBsonObjectSize:16777216,h=u?2097152:l,p=s&&s.maxWriteBatchSize?s.maxWriteBatchSize:1e3,d=(p-1).toString(10).length+2;let f=Object.assign({},n);f=(0,a.applyRetryableWrites)(f,e.s.db);this.s={bulkResult:{ok:1,writeErrors:[],writeConcernErrors:[],insertedIds:[],nInserted:0,nUpserted:0,nMatched:0,nModified:0,nRemoved:0,upserted:[]},currentBatch:void 0,currentIndex:0,currentBatchSize:0,currentBatchSizeBytes:0,currentInsertBatch:void 0,currentUpdateBatch:void 0,currentRemoveBatch:void 0,batches:[],writeConcern:c.WriteConcern.fromOptions(n),maxBsonObjectSize:l,maxBatchSizeBytes:h,maxWriteBatchSize:p,maxKeySize:d,namespace:i,topology:o,options:f,bsonOptions:(0,t.resolveBSONOptions)(n),currentOp:undefined,executed:!1,collection:e,err:void 0,checkKeys:"boolean"==typeof n.checkKeys&&n.checkKeys},!0===n.bypassDocumentValidation&&(this.s.bypassDocumentValidation=!0)}insert(t){return(0,a.maybeAddIdToDocuments)(this.collection,t,{forceServerObjectId:this.shouldForceServerObjectId()}),this.addToOperationsList(e.BatchType.INSERT,t)}find(e){if(!e)throw new n.MongoInvalidArgumentError("Bulk find operation must specify a selector");return this.s.currentOp={selector:e},new m(this)}raw(t){if(null==t||"object"!=typeof t)throw new n.MongoInvalidArgumentError("Operation must be an object with an operation key");if("insertOne"in t){const n=this.shouldForceServerObjectId(),r=t.insertOne&&null==t.insertOne.document?t.insertOne:t.insertOne.document;return(0,a.maybeAddIdToDocuments)(this.collection,r,{forceServerObjectId:n}),this.addToOperationsList(e.BatchType.INSERT,r)}if("replaceOne"in t||"updateOne"in t||"updateMany"in t){if("replaceOne"in t){if("q"in t.replaceOne)throw new n.MongoInvalidArgumentError("Raw operations are not allowed");const r=(0,u.makeUpdateStatement)(t.replaceOne.filter,t.replaceOne.replacement,{...t.replaceOne,multi:!1});if((0,a.hasAtomicOperators)(r.u))throw new n.MongoInvalidArgumentError("Replacement document must not use atomic operators");return this.addToOperationsList(e.BatchType.UPDATE,r)}if("updateOne"in t){if("q"in t.updateOne)throw new n.MongoInvalidArgumentError("Raw operations are not allowed");const r=(0,u.makeUpdateStatement)(t.updateOne.filter,t.updateOne.update,{...t.updateOne,multi:!1});if(!(0,a.hasAtomicOperators)(r.u))throw new n.MongoInvalidArgumentError("Update document requires atomic operators");return this.addToOperationsList(e.BatchType.UPDATE,r)}if("updateMany"in t){if("q"in t.updateMany)throw new n.MongoInvalidArgumentError("Raw operations are not allowed");const r=(0,u.makeUpdateStatement)(t.updateMany.filter,t.updateMany.update,{...t.updateMany,multi:!0});if(!(0,a.hasAtomicOperators)(r.u))throw new n.MongoInvalidArgumentError("Update document requires atomic operators");return this.addToOperationsList(e.BatchType.UPDATE,r)}}if("deleteOne"in t){if("q"in t.deleteOne)throw new n.MongoInvalidArgumentError("Raw operations are not allowed");return this.addToOperationsList(e.BatchType.DELETE,(0,r.makeDeleteStatement)(t.deleteOne.filter,{...t.deleteOne,limit:1}))}if("deleteMany"in t){if("q"in t.deleteMany)throw new n.MongoInvalidArgumentError("Raw operations are not allowed");return this.addToOperationsList(e.BatchType.DELETE,(0,r.makeDeleteStatement)(t.deleteMany.filter,{...t.deleteMany,limit:0}))}throw new n.MongoInvalidArgumentError("bulkWrite only supports insertOne, updateOne, updateMany, deleteOne, deleteMany")}get length(){return this.s.currentIndex}get bsonOptions(){return this.s.bsonOptions}get writeConcern(){return this.s.writeConcern}get batches(){const e=[...this.s.batches];return this.isOrdered?this.s.currentBatch&&e.push(this.s.currentBatch):(this.s.currentInsertBatch&&e.push(this.s.currentInsertBatch),this.s.currentUpdateBatch&&e.push(this.s.currentUpdateBatch),this.s.currentRemoveBatch&&e.push(this.s.currentRemoveBatch)),e}async execute(e={}){if(this.s.executed)throw new n.MongoBatchReExecutionError;const t=c.WriteConcern.fromOptions(e);if(t&&(this.s.writeConcern=t),this.isOrdered?this.s.currentBatch&&this.s.batches.push(this.s.currentBatch):(this.s.currentInsertBatch&&this.s.batches.push(this.s.currentInsertBatch),this.s.currentUpdateBatch&&this.s.batches.push(this.s.currentUpdateBatch),this.s.currentRemoveBatch&&this.s.batches.push(this.s.currentRemoveBatch)),0===this.s.batches.length)throw new n.MongoInvalidArgumentError("Invalid BulkOperation, Batch cannot be empty");this.s.executed=!0;const r={...this.s.options,...e},i=new y(this,r);return await(0,o.executeOperation)(this.s.collection.client,i,r.timeoutContext)}handleWriteError(e){if(this.s.bulkResult.writeErrors.length>0){const t=this.s.bulkResult.writeErrors[0].errmsg?this.s.bulkResult.writeErrors[0].errmsg:"write operation failed";throw new f({message:t,code:this.s.bulkResult.writeErrors[0].code,writeErrors:this.s.bulkResult.writeErrors},e)}const t=e.getWriteConcernError();if(t)throw new f(t,e)}shouldForceServerObjectId(){return!0===this.s.options.forceServerObjectId||!0===this.s.collection.s.db.options?.forceServerObjectId}}}(D)),D}var na,ra,oa,ia,sa,ua,aa,ca={exports:{}};function la(){return na||(na=1,function(){const e=ca.exports=Object.create(null),t="disconnected",n="connected",r="connecting",o="disconnecting",i="uninitialized";e[0]=t,e[1]=n,e[2]=r,e[3]=o,e[99]=i,e[t]=0,e[n]=1,e[r]=2,e[o]=3,e[i]=99}()),ca.exports}
/*!
 * Centralize this so we can more easily work around issues with people
 * stubbing out `process.nextTick()` in tests using sinon:
 * https://github.com/sinonjs/lolex#automatically-incrementing-mocked-time
 * See gh-6074
 */function ha(){if(oa)return ra;oa=1;const e="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick.bind(process):e=>setTimeout(e,0);return ra=function(t){return e(t)}}function pa(){if(aa)return ua;aa=1;
/*!
	 * ignore
	 */
class e extends Error{}return Object.defineProperty(e.prototype,"name",{value:"MongooseError"}),ua=e}var da,fa,ma,ya,ga,Ea={};function Aa(){return da||(da=1,Ea.arrayAtomicsBackupSymbol=Symbol("mongoose#Array#atomicsBackup"),Ea.arrayAtomicsSymbol=Symbol("mongoose#Array#_atomics"),Ea.arrayParentSymbol=Symbol("mongoose#Array#_parent"),Ea.arrayPathSymbol=Symbol("mongoose#Array#_path"),Ea.arraySchemaSymbol=Symbol("mongoose#Array#_schema"),Ea.documentArrayParent=Symbol("mongoose#documentArrayParent"),Ea.documentIsSelected=Symbol("mongoose#Document#isSelected"),Ea.documentIsModified=Symbol("mongoose#Document#isModified"),Ea.documentModifiedPaths=Symbol("mongoose#Document#modifiedPaths"),Ea.documentSchemaSymbol=Symbol("mongoose#Document#schema"),Ea.getSymbol=Symbol("mongoose#Document#get"),Ea.modelSymbol=Symbol("mongoose#Model"),Ea.objectIdSymbol=Symbol("mongoose#ObjectId"),Ea.populateModelSymbol=Symbol("mongoose#PopulateOptions#Model"),Ea.schemaTypeSymbol=Symbol("mongoose#schemaType"),Ea.sessionNewDocuments=Symbol("mongoose#ClientSession#newDocuments"),Ea.scopeSymbol=Symbol("mongoose#Document#scope"),Ea.validatorErrorSymbol=Symbol("mongoose#validatorError")),Ea}function ba(){if(ma)return fa;ma=1;const e=B().ObjectId,t=Aa().objectIdSymbol;return Object.defineProperty(e.prototype,"_id",{enumerable:!1,configurable:!0,get:function(){return this}}),
/*!
	 * Convenience `valueOf()` to allow comparing ObjectIds using double equals re: gh-7299
	 */
e.prototype.hasOwnProperty("valueOf")||(e.prototype.valueOf=function(){return this.toString()}),e.prototype[t]=!0,fa=e}function _a(){return ga?ya:(ga=1,ya=function(e){if(null!=e&&"function"==typeof e.constructor)return e.constructor.name})}var Oa,Ca,wa,Sa,va,Da={};function Ma(){return Oa||(Oa=1,
/*!
	 * ignore
	 */
Da.internalToObjectOptions={transform:!1,virtuals:!1,getters:!1,_skipDepopulateTopLevel:!0,depopulate:!0,flattenDecimals:!1,useProjection:!1,versionKey:!0,flattenObjectIds:!1}),Da}function Ta(){return wa?Ca:(wa=1,Ca=B().Decimal128)}function Ba(){return va?Sa:(va=1,Sa=new Set(["__proto__","constructor","prototype"]))}var Fa,$a,xa,Pa,Na,Ia,Ra,ka,ja,La,Ua,Va={};function za(){return Fa||(Fa=1,Va.isMongooseArray=function(e){return Array.isArray(e)&&e.isMongooseArray}),Va}function Wa(){if(xa)return $a;xa=1;const e=za().isMongooseArray;return $a=function(t){return null!=t&&(e(t)||null!=t.$__||t.isMongooseBuffer||t.$isMongooseMap)}}function qa(){if(Na)return Pa;Na=1;const e=/^function\s*([^\s(]+)/;return Pa=function(t){return t.name||(t.toString().trim().match(e)||[])[1]}}function Ga(){if(Ra)return Ia;return Ra=1,Ia=function(e,t){return null!=e&&e._bsontype===t}}function Ha(){return ja?ka:(ja=1,ka=function(e){return Buffer.isBuffer(e)||"[object Object]"===Object.prototype.toString.call(e)})}function Ka(){return Ua?La:(Ua=1,La=function(e){if(null==e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!t||"Object"===t.constructor.name})}var Ya,Qa,Ja,Xa,Za,ec,tc,nc={};function rc(){if(Ya)return nc;Ya=1;const e=Symbol("mongoose#trustedSymbol");return nc.trustedSymbol=e,nc.trusted=function(t){return null==t||"object"!=typeof t||(t[e]=!0),t},nc}function oc(){if(Ja)return Qa;Ja=1;const e=Ta(),t=ba(),n=Ba(),r=Wa(),o=qa(),i=Ga(),s=za().isMongooseArray,u=Ha(),a=Ka(),c=Aa(),l=rc().trustedSymbol,h=B();function p(n,l,f){if(null==n)return n;if(i(n,"Double"))return new h.Double(n.value);if("number"==typeof n||"string"==typeof n||"boolean"==typeof n||"bigint"==typeof n)return n;if(Array.isArray(n))return function(e,t){let n=0;const r=e.length,o=new Array(r);for(n=0;n<r;++n)o[n]=p(e[n],t,!0);return o}(s(n)?n.__array:n,l);if(r(n)){if(l&&l.retainDocuments&&null!=n.$__){const e=n.$clone();return null!=n.__index&&(e.__index=n.__index),null!=n.__parentArray&&(e.__parentArray=n.__parentArray),e.$__parent=n.$__parent,e}const e=n.$isSingleNested;if(a(n)&&null!=n.$__&&null!=n._doc)return n._doc;let t;if(t=l&&l.json&&"function"==typeof n.toJSON?n.toJSON(l):n.toObject(l),l&&l.minimize&&!n.constructor.$__required&&e&&0===Object.keys(t).length)return;return t}const m=n.constructor;if(m)switch(o(m)){case"Object":return d(n,l,f);case"Date":return new m(+n);case"RegExp":return function(e){const t=new RegExp(e.source,e.flags);t.lastIndex!==e.lastIndex&&(t.lastIndex=e.lastIndex);return t}(n)}return i(n,"ObjectId")?l&&l.flattenObjectIds?n.toJSON():new t(n.id):i(n,"Decimal128")?l&&l.flattenDecimals?n.toJSON():e.fromString(n.toString()):!m&&u(n)?d(n,l,f):"object"==typeof n&&n[c.schemaTypeSymbol]?n.clone():l&&l.bson&&"function"==typeof n.toBSON?n:"function"==typeof n.valueOf?n.valueOf():d(n,l,f)}
/*!
	 * ignore
	 */
function d(e,t,r){const o=t&&t.minimize,i=t&&t.omitUndefined,s=t&&t._seen,u={};let a;if(s&&s.has(e))return s.get(e);s&&s.set(e,u),l in e&&!1!==t?.copyTrustedSymbol&&(u[l]=e[l]);const c=Object.keys(e),h=c.length;for(let r=0;r<h;++r){const s=c[r];if(n.has(s))continue;const l=p(e[s],t,!1);!1!==o&&!i||void 0!==l?!0===o&&void 0===l||(a||(a=!0),u[s]=l):delete u[s]}return o&&!r?a&&u:u}return Qa=p}function ic(){if(Za)return Xa;Za=1;
/*!
	 * Module dependencies.
	 */
const r=function(){if(sa)return ia;sa=1;
/*!
	 * Module dependencies.
	 */
const e=t.EventEmitter,n=la(),r=ha();function o(t,r,o){void 0===o&&(o={}),this.opts=o,this.name=t,this.collectionName=t,this.conn=r,this.queue=[],this.buffer=!r?._hasOpened,this.emitter=new e,n.connected===this.conn.readyState&&this.onOpen()}return o.prototype.name,o.prototype.collectionName,o.prototype.conn,o.prototype.onOpen=function(){this.buffer=!1,r((()=>this.doQueue()))},o.prototype.onClose=function(){},o.prototype.addQueue=function(e,t){return this.queue.push([e,t]),this},o.prototype.removeQueue=function(e,t){const n=this.queue.findIndex((n=>n[0]===e&&n[1]===t));return-1!==n&&(this.queue.splice(n,1),!0)},o.prototype.doQueue=function(){for(const e of this.queue)"function"==typeof e[0]?e[0].apply(this,e[1]):this[e[0]].apply(this,e[1]);this.queue=[];const e=this;return r((function(){e.emitter.emit("queue")})),this},o.prototype.ensureIndex=function(){throw new Error("Collection#ensureIndex unimplemented by driver")},o.prototype.createIndex=function(){throw new Error("Collection#createIndex unimplemented by driver")},o.prototype.findAndModify=function(){throw new Error("Collection#findAndModify unimplemented by driver")},o.prototype.findOneAndUpdate=function(){throw new Error("Collection#findOneAndUpdate unimplemented by driver")},o.prototype.findOneAndDelete=function(){throw new Error("Collection#findOneAndDelete unimplemented by driver")},o.prototype.findOneAndReplace=function(){throw new Error("Collection#findOneAndReplace unimplemented by driver")},o.prototype.findOne=function(){throw new Error("Collection#findOne unimplemented by driver")},o.prototype.find=function(){throw new Error("Collection#find unimplemented by driver")},o.prototype.insert=function(){throw new Error("Collection#insert unimplemented by driver")},o.prototype.insertOne=function(){throw new Error("Collection#insertOne unimplemented by driver")},o.prototype.insertMany=function(){throw new Error("Collection#insertMany unimplemented by driver")},o.prototype.save=function(){throw new Error("Collection#save unimplemented by driver")},o.prototype.updateOne=function(){throw new Error("Collection#updateOne unimplemented by driver")},o.prototype.updateMany=function(){throw new Error("Collection#updateMany unimplemented by driver")},o.prototype.deleteOne=function(){throw new Error("Collection#deleteOne unimplemented by driver")},o.prototype.deleteMany=function(){throw new Error("Collection#deleteMany unimplemented by driver")},o.prototype.getIndexes=function(){throw new Error("Collection#getIndexes unimplemented by driver")},o.prototype.watch=function(){throw new Error("Collection#watch unimplemented by driver")},
/*!
	 * ignore
	 */
o.prototype._shouldBufferCommands=function(){const e=this.opts;return null!=e.bufferCommands?e.bufferCommands:e&&null!=e.schemaUserProvidedOptions&&null!=e.schemaUserProvidedOptions.bufferCommands?e.schemaUserProvidedOptions.bufferCommands:this.conn._shouldBufferCommands()},
/*!
	 * ignore
	 */
o.prototype._getBufferTimeoutMS=function(){const e=this.conn,t=this.opts;return null!=t.bufferTimeoutMS?t.bufferTimeoutMS:t&&null!=t.schemaUserProvidedOptions&&null!=t.schemaUserProvidedOptions.bufferTimeoutMS?t.schemaUserProvidedOptions.bufferTimeoutMS:e._getBufferTimeoutMS()},
/*!
	 * Module exports.
	 */
ia=o}(),o=pa(),i=Mu().Collection,s=ba(),u=_a(),a=Ma().internalToObjectOptions,c=e,l=n,h=Object.freeze({...a,copyTrustedSymbol:!1});function p(e,t,n){this.collection=null,this.Promise=n.Promise||Promise,this.modelName=n.modelName,delete n.modelName,this._closed=!1,r.apply(this,arguments)}
/*!
	 * Inherit from abstract Collection.
	 */Object.setPrototypeOf(p.prototype,r.prototype),p.prototype.onOpen=function(){return this.collection=this.conn.db.collection(this.name),r.prototype.onOpen.call(this),this.collection},p.prototype.onClose=function(e){r.prototype.onClose.call(this,e)},p.prototype._getCollection=function(){return this.collection?this.collection:null!=this.conn.db?(this.collection=this.conn.db.collection(this.name),this.collection):null};
/*!
	 * ignore
	 */
const d={watch:!0,find:!0,aggregate:!0};function f(e){p.prototype[e]=function(){const t=this._getCollection(),n=Array.from(arguments),r=this,i=r&&r.conn&&r.conn.base&&r.conn.base.options&&r.conn.base.options.debug,u=r&&r.conn&&r.conn.options&&r.conn.options.debug,a=null==u?i:u,l=arguments[arguments.length-1],h=new s;if(this.conn.$wasForceClosed){const e=new o("Connection was force closed");if(n.length>0&&"function"==typeof n[n.length-1])return void n[n.length-1](e);throw e}let p=n,f=null;if(this._shouldBufferCommands()&&this.buffer){let t;this.conn.emit("buffer",{_id:h,modelName:r.modelName,collectionName:r.name,method:e,args:n});let i=n,s=null,u=null;d[e]&&"function"==typeof l?(this.addQueue(e,i),t=l):d[e]?s=new this.Promise(((r,o)=>{t=function(e,t){if(null!=u&&clearTimeout(u),null!=e)return o(e);r(t)},i=n.concat([t]),this.addQueue(e,i)})):"function"==typeof l?(t=function(){return null!=u&&clearTimeout(u),l.apply(this,arguments)},i=n.slice(0,n.length-1).concat([t])):s=new Promise(((r,o)=>{t=function(e,t){if(null!=u&&clearTimeout(u),null!=e)return o(e);r(t)},i=n.concat([t]),this.addQueue(e,i)}));const a=this._getBufferTimeoutMS();return u=setTimeout((()=>{if(this.removeQueue(e,i)){const n="Operation `"+this.name+"."+e+"()` buffering timed out after "+a+"ms",i=new o(n);this.conn.emit("buffer-end",{_id:h,modelName:r.modelName,collectionName:r.name,method:e,error:i}),t(i)}}),a),d[e]||"function"!=typeof l?s:void this.addQueue(e,i)}if(d[e]||"function"!=typeof l||(f=function(t,n){return null!=t?r.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:r.name,method:e,error:t}):r.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:r.name,method:e,result:n}),l.apply(this,arguments)},p=n.slice(0,n.length-1).concat([f])),a)if("function"==typeof a){let t=null;t="function"==typeof n[n.length-1]?n.slice(0,n.length-1):n,a.apply(r,[r.name,e].concat(t))}else if(a instanceof c.Writable)this.$printToStream(r.name,e,n,a);else{const t=null==a.color||a.color,o=null!=a.shell&&a.shell;this.$print(r.name,e,n,t,o)}this.conn.emit("operation-start",{_id:h,modelName:r.modelName,collectionName:this.name,method:e,params:p});try{if(null==t){const t="Cannot call `"+this.name+"."+e+"()` before initial connection is complete if `bufferCommands = false`. Make sure you `await mongoose.connect()` if you have `bufferCommands = false`.";throw new o(t)}if(d[e]&&"function"==typeof l){const n=t[e].apply(t,p.slice(0,p.length-1));return this.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:this.name,method:e,result:n}),l.call(this,null,n)}const n=t[e].apply(t,p);return null!=n&&"function"==typeof n.then?n.then((t=>("function"==typeof l?l(null,t):this.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:this.name,method:e,result:t}),t)),(t=>{if("function"!=typeof l)throw this.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:this.name,method:e,error:t}),t;l(t)})):n}catch(t){if("function"==typeof l)return l(t);throw this.conn.emit("operation-end",{_id:h,modelName:r.modelName,collectionName:this.name,method:e,error:t}),t}}}for(const e of Object.getOwnPropertyNames(i.prototype)){void 0===Object.getOwnPropertyDescriptor(i.prototype,e).get&&("function"==typeof i.prototype[e]&&f(e))}function m(e){const t={inspect:function(){return e}};return l.inspect.custom&&(t[l.inspect.custom]=t.inspect),t}function y(e){return A(e,!0)}function g(e,t){e[t]=m('ObjectId("'+e[t].toHexString()+'")')}function E(e,t,n){e[t]=m(n?'ISODate("'+e[t].toUTCString()+'")':'new Date("'+e[t].toUTCString()+'")')}function A(e,t,n,r){if(e&&"function"==typeof e.toBSON&&(e=e.toBSON()),null==e)return e;const o=oc();let i=t?e:o(e,h);const s=u(i);if("Binary"===s)i="BinData("+i.sub_type+', "'+i.toString("base64")+'")';else if("ObjectId"===s)i=m('ObjectId("'+i.toHexString()+'")');else if("Date"===s)i=m('new Date("'+i.toUTCString()+'")');else if("Object"===s){const e=Object.keys(i),t=e.length;let n;for(let o=0;o<t;++o)if(n=e[o],i[n]){let e;if("function"==typeof i[n].toBSON)try{i[n]=i[n].toBSON()}catch(t){e=t}const t=u(i[n]);if("Binary"===t)i[n]="BinData("+i[n].sub_type+', "'+i[n].buffer.toString("base64")+'")';else if("Object"===t)i[n]=A(i[n],!0);else if("ObjectId"===t)g(i,n);else if("Date"===t)E(i,n,r);else if("ClientSession"===t)i[n]=m('ClientSession("'+(i[n]&&i[n].id&&i[n].id.id&&i[n].id.id.buffer||"").toString("hex")+'")');else if(Array.isArray(i[n]))i[n]=i[n].map(y);else if(null!=e)throw e}}return t?i:l.inspect(i,!1,10,n).replace(/\n/g,"").replace(/\s{2,}/g," ")}return p.prototype.$print=function(e,t,n,r,o){const i=r?"[0;36mMongoose:[0m ":"Mongoose: ",s=[e,t].join("."),u=[];for(let e=n.length-1;e>=0;--e)(this.$format(n[e])||u.length)&&u.unshift(this.$format(n[e],r,o));const a="("+u.join(", ")+")";console.info(i+s+a)},p.prototype.$printToStream=function(e,t,n,r){const o=[e,t].join("."),i=[];for(let e=n.length-1;e>=0;--e)(this.$format(n[e])||i.length)&&i.unshift(this.$format(n[e]));const s="("+i.join(", ")+")";r.write(o+s,"utf8")},p.prototype.$format=function(e,t,n){const r=typeof e;return"function"===r||"undefined"===r?"":A(e,!1,t,n)},p.prototype.getIndexes=p.prototype.indexInformation,
/*!
	 * Module exports.
	 */
Xa=p}function sc(){if(tc)return ec;tc=1;
/*!
	 * Module dependencies.
	 */
const e=t.EventEmitter,n=pa(),r=["close","change","end","error","resumeTokenChanged"];
/*!
	 * ignore
	 */
return ec=
/*!
	 * ignore
	 */
class extends e{constructor(e,t,n){if(super(),this.driverChangeStream=null,this.closed=!1,this.bindedEvents=!1,this.pipeline=t,this.options=n,this.errored=!1,n&&n.hydrate&&!n.model)throw new Error("Cannot create change stream with `hydrate: true` unless calling `Model.watch()`");let r=null;if(this.$driverChangeStreamPromise=new Promise(((t,n)=>{try{e(((e,r)=>{if(null!=e)return this.errored=!0,this.emit("error",e),n(e);this.driverChangeStream=r,this.emit("ready"),t()}))}catch(e){r=e,this.errored=!0,this.emit("error",e),n(e)}})),null!=r)throw r}_bindEvents(){this.bindedEvents||(this.bindedEvents=!0,null!=this.driverChangeStream?(this.driverChangeStream.on("close",(()=>{this.closed=!0})),r.forEach((e=>{this.driverChangeStream.on(e,(t=>{null!=t&&null!=t.fullDocument&&this.options&&this.options.hydrate&&(t.fullDocument=this.options.model.hydrate(t.fullDocument)),this.emit(e,t)}))}))):this.$driverChangeStreamPromise.then((()=>{this.driverChangeStream.on("close",(()=>{this.closed=!0})),r.forEach((e=>{this.driverChangeStream.on(e,(t=>{null!=t&&null!=t.fullDocument&&this.options&&this.options.hydrate&&(t.fullDocument=this.options.model.hydrate(t.fullDocument)),this.emit(e,t)}))}))}),(()=>{})))}hasNext(e){if(this.errored)throw new n("Cannot call hasNext() on errored ChangeStream");return this.driverChangeStream.hasNext(e)}next(e){if(this.errored)throw new n("Cannot call next() on errored ChangeStream");if(this.options&&this.options.hydrate){if(null!=e){const t=e;e=(e,n)=>null!=e?t(e):(null!=n.fullDocument&&(n.fullDocument=this.options.model.hydrate(n.fullDocument)),t(null,n))}let t=this.driverChangeStream.next(e);return t&&"function"==typeof t.then&&(t=t.then((e=>(null!=e.fullDocument&&(e.fullDocument=this.options.model.hydrate(e.fullDocument)),e)))),t}return this.driverChangeStream.next(e)}addListener(e,t){if(this.errored)throw new n("Cannot call addListener() on errored ChangeStream");return this._bindEvents(),super.addListener(e,t)}on(e,t){if(this.errored)throw new n("Cannot call on() on errored ChangeStream");return this._bindEvents(),super.on(e,t)}once(e,t){if(this.errored)throw new n("Cannot call once() on errored ChangeStream");return this._bindEvents(),super.once(e,t)}_queue(e){this.once("ready",(()=>e()))}close(){return this.closed=!0,this.driverChangeStream?this.driverChangeStream.close():this.$driverChangeStreamPromise.then((()=>this.driverChangeStream.close()),(()=>{}))}},ec}var uc,ac,cc={exports:{}};function lc(){if(ac)return uc;function e(){this._pres=new Map,this._posts=new Map}function t(e,t,n,r,o,i,s){return i.useErrorHandlers?e.execPost(n,r,o,{error:t},(function(e){return"function"==typeof s&&s(e)})):"function"==typeof s&&s(t)}function n(e,t,n,o){let i;try{i=e.apply(t,n)}catch(e){return o(e)}r(i)&&i.then((()=>o()),(e=>o(e)))}function r(e){return"object"==typeof e&&null!==e&&"function"==typeof e.then}function o(e){let t=!1;const n=this;return function(){if(!t)return t=!0,i((()=>e.apply(n,arguments)))}}ac=1,e.skipWrappedFunction=function(){if(!(this instanceof e.skipWrappedFunction))return new e.skipWrappedFunction(...arguments);this.args=[...arguments]},e.overwriteResult=function(){if(!(this instanceof e.overwriteResult))return new e.overwriteResult(...arguments);this.args=[...arguments]},e.prototype.execPre=function(t,s,u,a){3===arguments.length&&(a=u,u=[]);const c=this._pres.get(t)||[],l=c.length,h=c.numAsync||0;let p=0,d=h,f=!1;const m=u;let y=null;if(!l)return i((function(){a(null)}));function g(){if(p>=l)return;const t=c[p];if(t.isAsync){const r=[o(E),o((function(t){if(t){if(f)return;if(!(t instanceof e.skipWrappedFunction))return f=!0,a(t);y=t}if(0==--d&&p>=l)return a(y)}))];n(t.fn,s,r,r[0])}else if(t.fn.length>0){const e=[o(E)],r=arguments.length>=2?arguments:[null].concat(m);for(let t=1;t<r.length;++t)t===r.length-1&&"function"==typeof r[t]||e.push(r[t]);n(t.fn,s,e,e[0])}else{let e=null;try{e=t.fn.call(s)}catch(e){if(null!=e)return a(e)}if(r(e))e.then((()=>E()),(e=>E(e)));else{if(++p>=l)return d>0?void 0:i((function(){a(y)}));g()}}}function E(t){if(t){if(f)return;if(!(t instanceof e.skipWrappedFunction))return f=!0,a(t);y=t}if(++p>=l)return d>0?void 0:a(y);g.apply(s,arguments)}g.apply(null,[null].concat(u))},e.prototype.execPreSync=function(e,t,n){const r=this._pres.get(e)||[],o=r.length;for(let e=0;e<o;++e)r[e].fn.apply(t,n||[])},e.prototype.execPost=function(t,u,a,c,l){arguments.length<5&&(l=c,c=null);const h=this._posts.get(t)||[],p=h.length;let d=0,f=null;if(c&&c.error&&(f=c.error),!p)return i((function(){l.apply(null,[f].concat(a))}));!function t(){const i=h[d].fn;let c=0;const m=a.length,y=[];for(let e=0;e<m;++e)c+=a[e]&&a[e]._kareemIgnore?0:1,a[e]&&a[e]._kareemIgnore||y.push(a[e]);if(f)if(s(h[d],c)){const r=o((function(n){if(n){if(n instanceof e.overwriteResult)return a=n.args,++d>=p?l.call(null,f):t();f=n}if(++d>=p)return l.call(null,f);t()}));n(i,u,[f].concat(y).concat([r]),r)}else{if(++d>=p)return l.call(null,f);t()}else{const m=o((function(n){return n?n instanceof e.overwriteResult?(a=n.args,++d>=p?l.apply(null,[null].concat(a)):t()):(f=n,t()):++d>=p?l.apply(null,[null].concat(a)):void t()}));if(s(h[d],c))return++d>=p?l.apply(null,[null].concat(a)):t();if(i.length===c+1)n(i,u,y.concat([m]),m);else{let n,o;try{o=i.apply(u,y)}catch(e){n=e,f=e}if(r(o))return o.then((t=>{m(t instanceof e.overwriteResult?t:null)}),(e=>m(e)));if(o instanceof e.overwriteResult&&(a=o.args),++d>=p)return l.apply(null,[n].concat(a));t()}}}()},e.prototype.execPostSync=function(t,n,r){const o=this._posts.get(t)||[],i=o.length;for(let t=0;t<i;++t){const i=o[t].fn.apply(n,r||[]);i instanceof e.overwriteResult&&(r=i.args)}return r},e.prototype.createWrapperSync=function(e,t){const n=this;return function(){n.execPreSync(e,this,arguments);const r=t.apply(this,arguments);return n.execPostSync(e,this,[r])[0]}},e.prototype.wrap=function(n,o,i,s,u){const a=s.length>0?s[s.length-1]:null,c=Array.from(s);"function"==typeof a&&c.pop();const l=this,h=(u=u||{}).checkForPromise;this.execPre(n,i,s,(function(s){if(s&&!(s instanceof e.skipWrappedFunction)){const e=u.numCallbackParams||0,r=u.contextParameter?[i]:[];for(let t=r.length;t<e;++t)r.push(null);return t(l,s,n,i,r,u,a)}const p=o.length;let d;if(s instanceof e.skipWrappedFunction)return d=s.args[0],f(null,...s.args);try{d=o.apply(i,c.concat(f))}catch(e){return f(e)}if(h){if(r(d))return d.then((e=>f(null,e)),(e=>f(e)));if(p<c.length+1)return f(null,d)}function f(){const e=Array.from(arguments);if(e.shift(),u.nullResultByDefault&&0===e.length&&e.push(null),arguments[0])return t(l,arguments[0],n,i,e,u,a);l.execPost(n,i,e,(function(){null!==a&&(arguments[0]?a(arguments[0]):a.apply(i,arguments))}))}}))},e.prototype.filter=function(e){const t=this.clone(),n=Array.from(t._pres.keys());for(const r of n){const n=this._pres.get(r).map((e=>Object.assign({},e,{name:r}))).filter(e);0!==n.length?(n.numAsync=n.filter((e=>e.isAsync)).length,t._pres.set(r,n)):t._pres.delete(r)}const r=Array.from(t._posts.keys());for(const n of r){const r=this._posts.get(n).map((e=>Object.assign({},e,{name:n}))).filter(e);0!==r.length?t._posts.set(n,r):t._posts.delete(n)}return t},e.prototype.hasHooks=function(e){return this._pres.has(e)||this._posts.has(e)},e.prototype.createWrapper=function(e,t,n,r){const o=this;return this.hasHooks(e)?function(){const i=n||this;o.wrap(e,t,i,Array.from(arguments),r)}:function(){i((()=>t.apply(this,arguments)))}},e.prototype.pre=function(e,t,n,r,o){let i={};"object"==typeof t&&null!==t?(i=t,t=i.isAsync):"boolean"!=typeof arguments[1]&&(n=t,t=!1);const s=this._pres.get(e)||[];if(this._pres.set(e,s),t&&(s.numAsync=s.numAsync||0,++s.numAsync),"function"!=typeof n)throw new Error('pre() requires a function, got "'+typeof n+'"');return o?s.unshift(Object.assign({},i,{fn:n,isAsync:t})):s.push(Object.assign({},i,{fn:n,isAsync:t})),this},e.prototype.post=function(e,t,n,r){const o=this._posts.get(e)||[];if("function"==typeof t&&(r=!!n,n=t,t={}),"function"!=typeof n)throw new Error('post() requires a function, got "'+typeof n+'"');return r?o.unshift(Object.assign({},t,{fn:n})):o.push(Object.assign({},t,{fn:n})),this._posts.set(e,o),this},e.prototype.clone=function(){const t=new e;for(const e of this._pres.keys()){const n=this._pres.get(e).slice();n.numAsync=this._pres.get(e).numAsync,t._pres.set(e,n)}for(const e of this._posts.keys())t._posts.set(e,this._posts.get(e).slice());return t},e.prototype.merge=function(e,t){const n=(t=1===arguments.length||t)?this.clone():this;for(const t of e._pres.keys()){const r=n._pres.get(t)||[],o=e._pres.get(t).filter((e=>-1===r.map((e=>e.fn)).indexOf(e.fn))),i=r.concat(o);i.numAsync=r.numAsync||0,i.numAsync+=o.filter((e=>e.isAsync)).length,n._pres.set(t,i)}for(const t of e._posts.keys()){const r=n._posts.get(t)||[],o=e._posts.get(t).filter((e=>-1===r.indexOf(e)));n._posts.set(t,r.concat(o))}return n};const i="object"==typeof process&&null!==process&&process.nextTick||function(e){setTimeout(e,0)};function s(e,t){return!!e.errorHandler||e.fn.length===t+2}return uc=e}var hc,pc,dc,fc,mc,yc,gc,Ec,Ac,bc,_c,Oc,Cc,wc,Sc,vc,Dc,Mc,Tc,Bc,Fc,$c,xc,Pc,Nc,Ic,Rc,kc,jc,Lc,Uc,Vc,zc,Wc,qc,Gc,Hc,Kc,Yc={exports:{}},Qc={exports:{}},Jc={exports:{}};function Xc(){if(dc)return pc;dc=1;
/*!
	 * Module dependencies.
	 */
const e=pa(),t=n;class r extends e{constructor(n,r,o,i){let s;const u=e.messages;s=null!=u.DocumentNotFoundError?"function"==typeof u.DocumentNotFoundError?u.DocumentNotFoundError(n,r):u.DocumentNotFoundError:'No document found for query "'+t.inspect(n)+'" on model "'+r+'"',super(s),this.result=i,this.numAffected=o,this.filter=n,this.query=n}}return Object.defineProperty(r.prototype,"name",{value:"DocumentNotFoundError"}),
/*!
	 * exports
	 */
pc=r}function Zc(){if(mc)return fc;mc=1;
/*!
	 * Module dependencies.
	 */
const e=pa(),t=n;class r extends e{constructor(e,t,n,r,o){if(arguments.length>0){const a=i(t);super(u(null,e,t,n,s(o),a,r)),this.init(e,t,n,r,o)}else super(u())}toJSON(){return{stringValue:this.stringValue,valueType:this.valueType,kind:this.kind,value:this.value,path:this.path,reason:this.reason,name:this.name,message:this.message}}
/*!
	   * ignore
	   */init(e,t,n,r,u){this.stringValue=o(t),this.messageFormat=s(u),this.kind=e,this.value=t,this.path=n,this.reason=r,this.valueType=i(t)}copy(e){this.messageFormat=e.messageFormat,this.stringValue=e.stringValue,this.kind=e.kind,this.value=e.value,this.path=e.path,this.reason=e.reason,this.message=e.message,this.valueType=e.valueType}
/*!
	   * ignore
	   */setModel(e){this.message=u(e,this.kind,this.value,this.path,this.messageFormat,this.valueType)}}function o(e){let n=t.inspect(e);return n=n.replace(/^'|'$/g,'"'),n.startsWith('"')||(n='"'+n+'"'),n}function i(e){if(null==e)return""+e;const t=typeof e;return"object"!==t||"function"!=typeof e.constructor?t:e.constructor.name}function s(e){const t=e&&e._castErrorMessage||null;if("string"==typeof t||"function"==typeof t)return t}
/*!
	 * ignore
	 */function u(e,t,n,r,i,s,u){if("string"==typeof i){const s=o(n);let u=i.replace("{KIND}",t).replace("{VALUE}",s).replace("{PATH}",r);return null!=e&&(u=u.replace("{MODEL}",e.modelName)),u}if("function"==typeof i)return i(n,r,e,t);{let i="Cast to "+t+" failed for value "+o(n)+(s?" (type "+s+")":"")+' at path "'+r+'"';return null!=e&&(i+=' for model "'+e.modelName+'"'),null!=u&&"function"==typeof u.constructor&&"AssertionError"!==u.constructor.name&&"Error"!==u.constructor.name&&(i+=' because of "'+u.constructor.name+'"'),i}}
/*!
	 * exports
	 */return Object.defineProperty(r.prototype,"name",{value:"CastError"}),fc=r}function el(){return gc?yc:(gc=1,
/*!
	 * ignore
	 */
yc=function(e){const t=Object.keys(e.errors||{}),n=t.length,r=[];let o;for(let i=0;i<n;++i)o=t[i],e!==e.errors[o]&&r.push(o+": "+e.errors[o].message);return r.join(", ")})}
/*!
 * Module requirements
 */function tl(){if(Ac)return Ec;Ac=1;const e=pa(),t=_a(),r=n,o=el();class i extends e{constructor(e){let n;n="model"===t(e)?e.constructor.modelName+" validation failed":"Validation failed",super(n),this.errors={},this._message=n,e&&(e.$errors=this.errors)}toString(){return this.name+": "+o(this)}inspect(){return Object.assign(new Error(this.message),this)}addError(e,t){if(t instanceof i){const{errors:n}=t;for(const t of Object.keys(n))this.addError(`${e}.${t}`,n[t])}else this.errors[e]=t,this.message=this._message+": "+o(this)}}return r.inspect.custom&&(i.prototype[r.inspect.custom]=i.prototype.inspect),Object.defineProperty(i.prototype,"toJSON",{enumerable:!1,writable:!1,configurable:!0,value:function(){return Object.assign({},this,{name:this.name,message:this.message})}}),Object.defineProperty(i.prototype,"name",{value:"ValidationError"}),
/*!
	 * Module exports
	 */
Ec=i}
/*!
 * Module dependencies.
 */function nl(){if(_c)return bc;_c=1;const e=pa();class t extends e{constructor(t,r){let o=t.message;o||(o=e.messages.general.default);const i=n(o,t,r);super(i),t=Object.assign({},t,{message:i}),this.properties=t,this.kind=t.type,this.path=t.path,this.value=t.value,this.reason=t.reason}toString(){return this.message}toJSON(){return Object.assign({name:this.name,message:this.message},this)}}function n(e,t,n){if("function"==typeof e)return e(t,n);const r=Object.keys(t);for(const n of r)"message"!==n&&(e=e.replace("{"+n.toUpperCase()+"}",t[n]));return e}
/*!
	 * exports
	 */return Object.defineProperty(t.prototype,"name",{value:"ValidatorError"}),Object.defineProperty(t.prototype,"properties",{enumerable:!1,writable:!0,value:null}),t.prototype.formatMessage=n,bc=t}function rl(){if(Cc)return Oc;Cc=1;
/*!
	 * Module dependencies.
	 */
const e=pa();class t extends e{constructor(e,t,n){const r=n.join(", ");super('No matching document found for id "'+e._doc._id+'" version '+t+' modifiedPaths "'+r+'"'),this.version=t,this.modifiedPaths=n}}return Object.defineProperty(t.prototype,"name",{value:"VersionError"}),
/*!
	 * exports
	 */
Oc=t}function ol(){if(Sc)return wc;Sc=1;
/*!
	 * Module dependencies.
	 */
const e=pa();class t extends e{constructor(e){super("Can't save() the same doc multiple times in parallel. Document: "+e._doc._id)}}return Object.defineProperty(t.prototype,"name",{value:"ParallelSaveError"}),
/*!
	 * exports
	 */
wc=t}function il(){if(Dc)return vc;Dc=1;const e=pa();class t extends e{constructor(e){super("Cannot overwrite `"+e+"` model once compiled.")}}return Object.defineProperty(t.prototype,"name",{value:"OverwriteModelError"}),
/*!
	 * exports
	 */
vc=t}function sl(){if(Fc)return Bc;Fc=1;const e=_a();return Bc=function(t){if("TopologyDescription"!==e(t))return!1;const n=Array.from(t.servers.values());return n.length>0&&n.every((e=>"Unknown"===e.type))},Bc}function ul(){if(xc)return $c;xc=1;const e=_a();return $c=function(t){if("TopologyDescription"!==e(t))return!1;if(0===t.servers.size)return!1;for(const e of t.servers.values())if(!1===e.host.endsWith(".mongodb.net")||27017!==e.port)return!1;return!0},$c}function al(){if(Nc)return Pc;Nc=1;const e=_a();return Pc=function(t){if("TopologyDescription"!==e(t))return!1;const n=Array.from(t.servers.values());return n.length>0&&n.every((e=>e.error&&-1!==e.error.message.indexOf("Client network socket disconnected before secure TLS connection was established")))}}
/*!
 * Module dependencies.
 */function cl(){if(Rc)return Ic;Rc=1;const e=pa(),t=sl(),n=ul(),r=al();class o extends e{assimilateError(e){const o=e.reason;n(o)&&t(o)&&-1===e.message.indexOf("bad auth")&&-1===e.message.indexOf("Authentication failed")?this.message="Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/":r(o)?this.message="Mongoose is connecting with SSL enabled, but the server is not accepting SSL connections. Please ensure that the MongoDB server you are connecting to is configured to accept SSL connections. Learn more: https://mongoosejs.com/docs/tutorials/ssl.html":this.message=e.message;for(const t in e)"name"!==t&&(this[t]=e[t]);return this}}return Object.defineProperty(o.prototype,"name",{value:"MongooseServerSelectionError"}),Ic=o}function ll(){if(jc)return kc;jc=1;const e=pa();class t extends e{constructor(e){super("For your own good, using `document.save()` to update an array which was selected using an $elemMatch projection OR populated using skip, limit, query conditions, or exclusion of the _id field when the operation results in a $pop or $set of the entire array is not supported. The following path(s) would have been modified unsafely:\n  "+e.join("\n  ")+"\nUse Model.updateOne() to update these arrays instead.")}}return Object.defineProperty(t.prototype,"name",{value:"DivergentArrayError"}),
/*!
	 * exports
	 */
kc=t}
/*!
 * Module dependencies.
 */function hl(){if(Uc)return Lc;Uc=1;const e=pa();class t extends e{constructor(e,t,n){super(t=t||"Field `"+e+"` is not in schema and strict mode is set to throw."),this.isImmutableError=!!n,this.path=e}}return Object.defineProperty(t.prototype,"name",{value:"StrictModeError"}),Lc=t}
/*!
 * Module dependencies.
 */function pl(){if(zc)return Vc;zc=1;const e=pa();class t extends e{constructor(e,t){super(t=t||"Cannot populate path `"+e+"` because it is not in your schema. Set the `strictPopulate` option to false to override."),this.path=e}}return Object.defineProperty(t.prototype,"name",{value:"StrictPopulateError"}),Vc=t}function dl(){return Wc||(Wc=1,function(e){const t=pa();
/*!
		 * Module exports.
		 */e.exports=t,t.messages=(hc||(hc=1,function(){const e=Jc.exports={};e.DocumentNotFoundError=null,e.general={},e.general.default="Validator failed for path `{PATH}` with value `{VALUE}`",e.general.required="Path `{PATH}` is required.",e.Number={},e.Number.min="Path `{PATH}` ({VALUE}) is less than minimum allowed value ({MIN}).",e.Number.max="Path `{PATH}` ({VALUE}) is more than maximum allowed value ({MAX}).",e.Number.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",e.Date={},e.Date.min="Path `{PATH}` ({VALUE}) is before minimum allowed value ({MIN}).",e.Date.max="Path `{PATH}` ({VALUE}) is after maximum allowed value ({MAX}).",e.String={},e.String.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",e.String.match="Path `{PATH}` is invalid ({VALUE}).",e.String.minlength="Path `{PATH}` (`{VALUE}`) is shorter than the minimum allowed length ({MINLENGTH}).",e.String.maxlength="Path `{PATH}` (`{VALUE}`) is longer than the maximum allowed length ({MAXLENGTH})."}()),Jc.exports),t.Messages=t.messages,t.DocumentNotFoundError=Xc(),t.CastError=Zc(),t.ValidationError=tl(),t.ValidatorError=nl(),t.VersionError=rl(),t.ParallelSaveError=ol(),t.OverwriteModelError=il(),t.MissingSchemaError=function(){if(Tc)return Mc;Tc=1;const e=pa();class t extends e{constructor(e){super("Schema hasn't been registered for model \""+e+'".\nUse mongoose.model(name, schema)')}}return Object.defineProperty(t.prototype,"name",{value:"MissingSchemaError"}),
/*!
	 * exports
	 */
Mc=t}(),t.MongooseServerSelectionError=cl(),t.DivergentArrayError=ll(),t.StrictModeError=hl(),t.StrictPopulateError=pl()}(Qc)),Qc.exports}function fl(){return Gc?qc:(Gc=1,qc=Object.freeze({enumerable:!0,configurable:!0,writable:!0,value:void 0}))}function ml(){if(Kc)return Hc;Kc=1;const e=oc();class t{constructor(t){if(null==t)return this;Object.assign(this,e(t))}}const n=fl();return Object.defineProperty(t.prototype,"type",n),Object.defineProperty(t.prototype,"validate",n),Object.defineProperty(t.prototype,"cast",n),Object.defineProperty(t.prototype,"required",n),Object.defineProperty(t.prototype,"default",n),Object.defineProperty(t.prototype,"ref",n),Object.defineProperty(t.prototype,"refPath",n),Object.defineProperty(t.prototype,"select",n),Object.defineProperty(t.prototype,"index",n),Object.defineProperty(t.prototype,"unique",n),Object.defineProperty(t.prototype,"immutable",n),Object.defineProperty(t.prototype,"sparse",n),Object.defineProperty(t.prototype,"text",n),Object.defineProperty(t.prototype,"transform",n),Hc=t}var yl,gl,El,Al,bl,_l,Ol,Cl,wl,Sl,vl,Dl={exports:{}};function Ml(){return yl||(yl=1,function(e){const t=Zc();e.exports=function(n,r){if(e.exports.convertToTrue.has(n))return!0;if(e.exports.convertToFalse.has(n))return!1;if(null==n)return n;throw new t("boolean",n,r)},e.exports.convertToTrue=new Set([!0,"true",1,"1","yes"]),e.exports.convertToFalse=new Set([!1,"false",0,"0","no"])}(Dl)),Dl.exports}function Tl(){if(El)return gl;El=1;const e=Ml();
/*!
	 * ignore
	 */return gl=function(t){const n=null!=this?this.path:null;return e(t,n)}}function Bl(){return bl?Al:(bl=1,
/*!
	 * ignore
	 */
Al=function(e){if(Array.isArray(e)){if(!e.every((e=>"number"==typeof e||"string"==typeof e)))throw new Error("$type array values must be strings or numbers");return e}if("number"!=typeof e&&"string"!=typeof e)throw new Error("$type parameter must be number, string, or array of numbers and strings");return e})}function Fl(){if(Ol)return _l;Ol=1;const e=hl();
/*!
	 * ignore
	 */return _l=function(t){var n,r;t.$immutable?(t.$immutableSetter=(n=t.path,r=t.options.immutable,function(t,o,i,s){if(null==this||null==this.$__)return t;if(this.isNew)return t;if(s&&s.overwriteImmutable)return t;if(!("function"==typeof r?r.call(this,this):r))return t;const u=null!=this.$__.priorDoc?this.$__.priorDoc.$__getValue(n):this.$__getValue(n);if("throw"===this.$__.strictMode&&t!==u)throw new e(n,"Path `"+n+"` is immutable and strict mode is set to throw.",!0);return u}),t.set(t.$immutableSetter)):t.$immutableSetter&&(t.setters=t.setters.filter((e=>e!==t.$immutableSetter)),delete t.$immutableSetter)},_l}function $l(){return wl?Cl:(wl=1,Cl=function(e){return"function"==typeof e&&e.constructor&&"AsyncFunction"===e.constructor.name})}function xl(){return vl?Sl:(vl=1,Sl=function(e){const t=Object.keys(e);let n=!0;for(let r=0,o=t.length;r<o;++r)if("object"==typeof e[t[r]]&&null!==e[t[r]]){n=!1;break}return n})}var Pl,Nl,Il={};function Rl(){if(Nl)return Pl;Nl=1;var e=1e3,t=60*e,n=60*t,r=24*n,o=7*r,i=365.25*r;function s(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}return Pl=function(u,a){a=a||{};var c=typeof u;if("string"===c&&u.length>0)return function(s){if((s=String(s)).length>100)return;var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!u)return;var a=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*i;case"weeks":case"week":case"w":return a*o;case"days":case"day":case"d":return a*r;case"hours":case"hour":case"hrs":case"hr":case"h":return a*n;case"minutes":case"minute":case"mins":case"min":case"m":return a*t;case"seconds":case"second":case"secs":case"sec":case"s":return a*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(u);if("number"===c&&isFinite(u))return a.long?function(o){var i=Math.abs(o);if(i>=r)return s(o,i,r,"day");if(i>=n)return s(o,i,n,"hour");if(i>=t)return s(o,i,t,"minute");if(i>=e)return s(o,i,e,"second");return o+" ms"}(u):function(o){var i=Math.abs(o);if(i>=r)return Math.round(o/r)+"d";if(i>=n)return Math.round(o/n)+"h";if(i>=t)return Math.round(o/t)+"m";if(i>=e)return Math.round(o/e)+"s";return o+"ms"}(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))},Pl}var kl,jl,Ll,Ul,Vl,zl,Wl={exports:{}},ql={};function Gl(){return jl?kl:(jl=1,kl=function(e){const t=[];let n="",r="DEFAULT";for(let o=0;o<e.length;++o)"IN_SQUARE_BRACKETS"!==r||/\d/.test(e[o])||"]"===e[o]||(r="DEFAULT",n=t[t.length-1]+"["+n,t.splice(t.length-1,1)),"["===e[o]?("IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&(t.push(n),n=""),r="IN_SQUARE_BRACKETS"):"]"===e[o]?"IN_SQUARE_BRACKETS"===r?(r="IMMEDIATELY_AFTER_SQUARE_BRACKETS",t.push(n),n=""):(r="DEFAULT",n+=e[o]):"."===e[o]?("IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&(t.push(n),n=""),r="DEFAULT"):n+=e[o];return"IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&t.push(n),t})}function Hl(){return Ll||(Ll=1,function(e){var t=Gl(),n=["__proto__","constructor","prototype"];
/*!
		 * Recursively set nested arrays
		 */
function r(e,t,n,o,i,s){for(var u,a=0;a<e.length&&a<t.length;++a)u=e[a],Array.isArray(u)&&Array.isArray(t[a])?r(u,t[a],n,o,i,s):u&&(o?o(u,n,s(t[a])):(u[i]&&(u=u[i]),u[n]=s(t[a])))}
/*!
		 * Returns the value passed to it.
		 */function o(e){return e}e.get=function(n,r,i,s){var u;"function"==typeof i&&(i.length<2?(s=i,i=void 0):(u=i,i=void 0)),s||(s=o);var a="string"==typeof n?t(n):n;if(!Array.isArray(a))throw new TypeError("Invalid `path`. Must be either string or array");for(var c,l=r,h=0;h<a.length;++h){if(c=a[h],"string"!=typeof a[h]&&"number"!=typeof a[h])throw new TypeError("Each segment of path to `get()` must be a string or number, got "+typeof a[h]);if(Array.isArray(l)&&!/^\d+$/.test(c)){var p=a.slice(h);return[].concat(l).map((function(t){return t?e.get(p,t,i||u,s):s(void 0)}))}if(u)l=u(l,c);else{var d=i&&l[i]?l[i]:l;l=d instanceof Map?d.get(c):d[c]}if(!l)return s(l)}return s(l)},e.has=function(e,n){var r="string"==typeof e?t(e):e;if(!Array.isArray(r))throw new TypeError("Invalid `path`. Must be either string or array");for(var o=r.length,i=n,s=0;s<o;++s){if("string"!=typeof r[s]&&"number"!=typeof r[s])throw new TypeError("Each segment of path to `has()` must be a string or number, got "+typeof r[s]);if(null==i||"object"!=typeof i||!(r[s]in i))return!1;i=i[r[s]]}return!0},e.unset=function(e,r){var o="string"==typeof e?t(e):e;if(!Array.isArray(o))throw new TypeError("Invalid `path`. Must be either string or array");for(var i=o.length,s=r,u=0;u<i;++u){if(null==s||"object"!=typeof s||!(o[u]in s))return!1;if("string"!=typeof o[u]&&"number"!=typeof o[u])throw new TypeError("Each segment of path to `unset()` must be a string or number, got "+typeof o[u]);if(-1!==n.indexOf(o[u]))return!1;if(u===i-1)return delete s[o[u]],!0;s=s instanceof Map?s.get(o[u]):s[o[u]]}return!0},e.set=function(i,s,u,a,c,l){var h;"function"==typeof a&&(a.length<2?(c=a,a=void 0):(h=a,a=void 0)),c||(c=o);var p="string"==typeof i?t(i):i;if(!Array.isArray(p))throw new TypeError("Invalid `path`. Must be either string or array");if(null!=u){for(var d=0;d<p.length;++d){if("string"!=typeof p[d]&&"number"!=typeof p[d])throw new TypeError("Each segment of path to `set()` must be a string or number, got "+typeof p[d]);if(-1!==n.indexOf(p[d]))return}for(var f,m=l||/\$/.test(i)&&!1!==l,y=u,g=(d=0,p.length-1);d<g;++d)if("$"!=(f=p[d])){if(Array.isArray(y)&&!/^\d+$/.test(f)){var E=p.slice(d);if(!m&&Array.isArray(s))for(var A=0;A<y.length&&A<s.length;++A)e.set(E,s[A],y[A],a||h,c,m);else for(A=0;A<y.length;++A)e.set(E,s,y[A],a||h,c,m);return}if(h)y=h(y,f);else{var b=a&&y[a]?y[a]:y;y=b instanceof Map?b.get(f):b[f]}if(!y)return}else if(d==g-1)break;if(f=p[g],a&&y[a]&&(y=y[a]),Array.isArray(y)&&!/^\d+$/.test(f))if(!m&&Array.isArray(s))r(y,s,f,h,a,c);else for(A=0;A<y.length;++A){var _=y[A];_&&(h?h(_,f,c(s)):(_[a]&&(_=_[a]),_[f]=c(s)))}else h?h(y,f,c(s)):y instanceof Map?y.set(f,c(s)):y[f]=c(s)}},
/*!
		 * Split a string path into components delimited by '.' or
		 * '[\d+]'
		 *
		 * #### Example:
		 *     stringToParts('foo[0].bar.1'); // ['foo', '0', 'bar', '1']
		 */
e.stringToParts=t}(ql)),ql}function Kl(){return Ul?Wl.exports:(Ul=1,Wl.exports=Hl())}function Yl(){if(zl)return Vl;zl=1;const e=oc();return Vl=class{constructor(t){if(this._docs={},this._childDocs=[],null!=t&&(t=e(t),Object.assign(this,t),"object"==typeof t.subPopulate&&(this.populate=t.subPopulate),null!=t.perDocumentLimit&&null!=t.limit))throw new Error("Can not use `limit` and `perDocumentLimit` at the same time. Path: `"+t.path+"`.")}}}var Ql,Jl,Xl,Zl,eh,th={};function nh(){return Ql||(Ql=1,th.isMongooseDocumentArray=function(e){return Array.isArray(e)&&e.isMongooseDocumentArray}),th}function rh(){if(Xl)return Jl;Xl=1;const e=ha(),t=Symbol("mongoose#emitted");return Jl=function(n,r,o,i){if("function"==typeof n)try{return r((function(r){if(null==r)n.apply(this,arguments);else{null!=o&&null!=o.listeners&&o.listeners("error").length>0&&!r[t]&&(r[t]=!0,o.emit("error",r));try{n(r)}catch(r){return e((()=>{throw r}))}}}))}catch(e){return null!=o&&null!=o.listeners&&o.listeners("error").length>0&&!e[t]&&(e[t]=!0,o.emit("error",e)),n(e)}return new(i=i||b.Promise)(((e,n)=>{r((function(r,i){return null!=r?(null!=o&&null!=o.listeners&&o.listeners("error").length>0&&!r[t]&&(r[t]=!0,o.emit("error",r)),n(r)):arguments.length>2?e(Array.prototype.slice.call(arguments,1)):void e(i)}))}))},Jl}function oh(){return eh||(eh=1,Zl=function(e,t,n){const r=Object.keys(t.tree),o={};for(const i of r)n&&(e.paths[i]||e.nested[i]||e.singleNestedPaths[i])||(o[i]=t.tree[i]);e.options._isMerging=!0,e.add(o,null),delete e.options._isMerging,e.callQueue=e.callQueue.concat(t.callQueue),e.method(t.methods),e.static(t.statics);for(const[n,r]of Object.entries(t._userProvidedOptions))n in e._userProvidedOptions||e.set(n,r);for(const n in t.query)e.query[n]=t.query[n];for(const n in t.virtuals)e.virtuals[n]=t.virtuals[n].clone();e._indexes=e._indexes.concat(t._indexes||[]),e.s.hooks.merge(t.s.hooks,!1)}),Zl}var ih,uh,ah,ch,lh={exports:{}},hh={exports:{}},ph={exports:{}};function dh(){return uh||(uh=1,function(e){const t=(ih||(ih=1,function(e){uf();const t=e.exports=function(){};t.ctor=function(){const e=[...arguments],n=function(){t.apply(this,arguments),this.paths={},this.states={}};return(n.prototype=new t).constructor=n,n.prototype.stateNames=e,e.forEach((function(e){n.prototype[e]=function(t){this._changeState(t,e)}})),n},t.prototype._changeState=function(e,t){const n=this.paths[e];if(n===t)return;const r=this.states[n];r&&delete r[e],this.paths[e]=t,this.states[t]=this.states[t]||{},this.states[t][e]=!0},
/*!
		 * ignore
		 */
t.prototype.clear=function(e){if(null==this.states[e])return;const t=Object.keys(this.states[e]);let n,r=t.length;for(;r--;)n=t[r],delete this.states[e][n],delete this.paths[n]},
/*!
		 * ignore
		 */
t.prototype.clearPath=function(e){const t=this.paths[e];t&&(delete this.paths[e],delete this.states[t][e])},t.prototype.getStatePaths=function(e){return null!=this.states[e]?this.states[e]:{}},t.prototype.some=function(){const e=this,t=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(t,(function(t){return null!=e.states[t]&&Object.keys(e.states[t]).length}))},t.prototype._iter=function(e){return function(){let t=[...arguments];const n=t.pop();t.length||(t=this.stateNames);const r=this;return t.reduce((function(e,t){return null==r.states[t]?e:e.concat(Object.keys(r.states[t]))}),[])[e]((function(e,t,r){return n(e,t,r)}))}},t.prototype.forEach=function(){return this.forEach=this._iter("forEach"),this.forEach.apply(this,arguments)},t.prototype.map=function(){return this.map=this._iter("map"),this.map.apply(this,arguments)},t.prototype.clone=function(){const e=new this.constructor;e.paths={...this.paths};for(const t of this.stateNames)t in this.states&&(e.states[t]=null==this.states[t]?this.states[t]:{...this.states[t]});return e}}(ph)),ph.exports),n=t.ctor("require","modify","init","default","ignore");function r(){this.activePaths=new n}e.exports=r,r.prototype.strictMode=!0,r.prototype.fullPath=void 0,r.prototype.selected=void 0,r.prototype.shardval=void 0,r.prototype.saveError=void 0,r.prototype.validationError=void 0,r.prototype.adhocPaths=void 0,r.prototype.removing=void 0,r.prototype.inserting=void 0,r.prototype.saving=void 0,r.prototype.version=void 0,r.prototype._id=void 0,r.prototype.ownerDocument=void 0,r.prototype.populate=void 0,r.prototype.populated=void 0,r.prototype.primitiveAtomics=void 0,r.prototype.wasPopulated=!1,r.prototype.scope=void 0,r.prototype.session=null,r.prototype.pathsToScopes=null,r.prototype.cachedRequired=null}(hh)),hh.exports}
/*!
 * Module dependencies.
 */function fh(){if(ch)return ah;ch=1;const e=B().Binary,t=uf();function n(e,r,i){let s,u,a,c,l=e;return null==e&&(l=0),Array.isArray(r)?(u=r[0],a=r[1]):s=r,c="number"==typeof l||l instanceof Number?Buffer.alloc(l):Buffer.from(l,s,i),t.decorate(c,n.mixin),c.isMongooseBuffer=!0,c[n.pathSymbol]=u,c[o]=a,c._subtype=0,c}const r=Symbol.for("mongoose#Buffer#_path"),o=Symbol.for("mongoose#Buffer#_parent");return n.pathSymbol=r,
/*!
	 * Inherit from Buffer.
	 */
n.mixin={_subtype:void 0,_markModified:function(){const e=this[o];return e&&e.markModified(this[n.pathSymbol]),this},write:function(){const e=Buffer.prototype.write.apply(this,arguments);return e>0&&this._markModified(),e},copy:function(e){const t=Buffer.prototype.copy.apply(this,arguments);return e&&e.isMongooseBuffer&&e._markModified(),t}},
/*!
	 * Compile other Buffer methods marking this buffer as modified.
	 */
t.each(["writeUInt8","writeUInt16","writeUInt32","writeInt8","writeInt16","writeInt32","writeFloat","writeDouble","fill","utf8Write","binaryWrite","asciiWrite","set","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE"],(function(e){Buffer.prototype[e]&&(n.mixin[e]=function(){const t=Buffer.prototype[e].apply(this,arguments);return this._markModified(),t})})),n.mixin.toObject=function(t){const n="number"==typeof t?t:this._subtype||0;return new e(Buffer.from(this),n)},n.mixin.$toObject=n.mixin.toObject,n.mixin.toBSON=function(){return new e(this,this._subtype||0)},n.mixin.equals=function(e){if(!Buffer.isBuffer(e))return!1;if(this.length!==e.length)return!1;for(let t=0;t<this.length;++t)if(this[t]!==e[t])return!1;return!0},n.mixin.subtype=function(e){if("number"!=typeof e)throw new TypeError("Invalid subtype. Expected a number");this._subtype!==e&&this._markModified(),this._subtype=e},
/*!
	 * Module exports.
	 */
n.Binary=e,ah=n}var mh,yh,gh,Eh,Ah,bh,_h,Oh,Ch,wh,Sh,vh,Dh,Mh,Th,Bh,Fh,$h,xh,Ph={};function Nh(){return mh||(mh=1,Ph.schemaMixedSymbol=Symbol.for("mongoose:schema_mixed"),Ph.builtInMiddleware=Symbol.for("mongoose:built-in-middleware")),Ph}
/*!
 * Module dependencies.
 */function Ih(){if(gh)return yh;gh=1;const e=af(),t=Nh(),n=Ha(),r=uf();function o(r,o){if(o&&o.default){const e=o.default;Array.isArray(e)&&0===e.length?o.default=Array:!o.shared&&n(e)&&0===Object.keys(e).length&&(o.default=function(){return{}})}e.call(this,r,o,"Mixed"),this[t.schemaMixedSymbol]=!0}return o.schemaName="Mixed",o.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.get=e.get,o.set=e.set,o.setters=[],o.prototype.cast=function(e){return e instanceof Error?r.errorToPOJO(e):e},o.prototype.castForQuery=function(e,t){return t},
/*!
	 * Module exports.
	 */
yh=o}function Rh(){if(_h)return bh;_h=1;const e=pa();class t extends e{constructor(e,t){super("Tried to set nested object field `"+e+`\` to ${Array.isArray(t)?"array":"primitive value"} \``+t+"`"),this.path=e}}return Object.defineProperty(t.prototype,"name",{value:"ObjectExpectedError"}),bh=t}
/*!
 * Module dependencies.
 */function kh(){if(Ch)return Oh;Ch=1;const e=pa();class t extends e{constructor(e,t,n){super('Parameter "'+t+'" to '+n+'() must be an object, got "'+e.toString()+'" (type '+typeof e+")")}}return Object.defineProperty(t.prototype,"name",{value:"ObjectParameterError"}),Oh=t}function jh(){return Dh?vh:(Dh=1,vh=function(e){const t={},n=Object.keys(e);for(const e of n){if(-1===e.indexOf(".")){t[e]=1;continue}const n=e.split(".");let r=n[0];for(let e=0;e<n.length;++e)t[r]=1,e+1<n.length&&(r=r+"."+n[e+1])}return t})}function Lh(){return Th?Mh:(Th=1,Mh=function(e){return null!=e&&"object"==typeof e&&(null==e.$slice&&null==e.$elemMatch&&null==e.$meta&&null==e.$)})}function Uh(){if(Fh)return Bh;Fh=1;const e=Lh();
/*!
	 * ignore
	 */
function t(e,t,n){e.$__.activePaths.default(t),!n&&e.$isSubdocument&&e.$isSingleNested&&null!=e.$parent()&&e.$parent().$__.activePaths.default(e.$__pathRelativeToParent(t))}return Bh=function(n,r,o,i,s,u,a){const c=Object.keys(n.$__schema.paths),l=c.length,h=a&&a.skipParentChangeTracking;for(let a=0;a<l;++a){let l,p="";const d=c[a];if("_id"===d&&n.$__.skipId)continue;const f=n.$__schema.paths[d],m=f.splitPath(),y=m.length;if("$*"===m[y-1])continue;let g=!1,E=n._doc;for(let a=0;a<y&&null!=E;++a){const c=m[a];if(p+=(p.length?".":"")+c,!0===o){if(p in r)break}else if(!1===o&&r&&!g){const t=f.$isSingleNested||f.$isMongooseDocumentArray;if(p in r&&!e(r[p])||a===y-1&&t&&null!=i&&i[p])g=!0;else if(null!=i&&!i[p])break}if(a===y-1){if(void 0!==E[c])break;if(null!=s)if("function"==typeof f.defaultValue){if(!f.defaultValue.$runBeforeSetters&&s)break;if(f.defaultValue.$runBeforeSetters&&!s)break}else if(!s)continue;if(u&&u[p])break;if(r&&null!==o){if(!0===o){if(d in r)continue;try{l=f.getDefault(n,!1)}catch(e){n.invalidate(d,e);break}void 0!==l&&(E[c]=l,t(n,d,h))}else if(g){try{l=f.getDefault(n,!1)}catch(e){n.invalidate(d,e);break}void 0!==l&&(E[c]=l,t(n,d,h))}}else{try{l=f.getDefault(n,!1)}catch(e){n.invalidate(d,e);break}void 0!==l&&(E[c]=l,t(n,d,h))}}else E=E[c]}}},Bh}function Vh(){if(xh)return $h;function e(t,n,r=new Set){if(r.has(t))throw new Error("Infinite subdocument loop: subdoc with _id "+t._id+" is a parent of itself");const o=t.$parent(),i=t.$__pathRelativeToParent(void 0,!1)+"."+n;o.$__.activePaths.clearPath(i),o.$isSubdocument&&e(o,i,r)}return xh=1,
/*!
	 * ignore
	 */
$h=function(t,n,r){const o=(r=r||{}).skipDocArrays;let i=0;if(!t)return i;for(const r of Object.keys(t.$__.activePaths.getStatePaths("modify"))){if(o){const e=t.$__schema.path(r);if(e&&e.$isMongooseDocumentArray)continue}r.startsWith(n+".")&&(t.$__.activePaths.clearPath(r),++i,t.$isSubdocument&&e(t,r))}return i},$h}var zh,Wh,qh,Gh={};function Hh(){if(zh)return Gh;zh=1;const e=oc(),t=Aa().documentSchemaSymbol,n=Ma().internalToObjectOptions,r=uf();let o;const i=Aa().getSymbol,s=Aa().scopeSymbol,u=r.isPOJO;
/*!
	 * exports
	 */
Gh.compile=l,Gh.defineKey=h;const a=Object.freeze({minimize:!0,virtuals:!1,getters:!1,transform:!1}),c=Object.freeze({noDottedPath:!0});function l(e,t,n,r){o=o||sf();const i=r.typeKey;for(const o of Object.keys(e)){const s=e[o];h({prop:o,subprops:u(s)&&Object.keys(s).length>0&&(!s[i]||"type"===i&&u(s.type)&&s.type.type)?s:null,prototype:t,prefix:n,options:r})}}function h({prop:r,subprops:u,prototype:h,prefix:p,options:d}){o=o||sf();const f=(p?p+".":"")+r,m=(p=p||"")?Object.freeze({}):c;u?Object.defineProperty(h,r,{enumerable:!0,configurable:!0,get:function(){const n=this;if(this.$__.getters||(this.$__.getters={}),!this.$__.getters[f]){const r=Object.create(o.prototype,function(e){const t={};return Object.getOwnPropertyNames(e).forEach((function(n){-1===["isNew","$__","$errors","errors","_doc","$locals","$op","__parentArray","__index","$isDocumentArrayElement"].indexOf(n)||(t[n]=Object.getOwnPropertyDescriptor(e,n),t[n].enumerable=!1)})),t}(this));p||(r.$__[s]=this),r.$__.nestedPath=f,Object.defineProperty(r,"schema",{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(r,"$__schema",{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(r,t,{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(r,"toObject",{enumerable:!1,configurable:!0,writable:!1,value:function(){return e(n.get(f,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toObject&&this.schema.options.toObject.virtuals||null}))}}),Object.defineProperty(r,"$__get",{enumerable:!1,configurable:!0,writable:!1,value:function(){return n.get(f,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toObject&&this.schema.options.toObject.virtuals||null})}}),Object.defineProperty(r,"toJSON",{enumerable:!1,configurable:!0,writable:!1,value:function(){return n.get(f,null,{virtuals:this&&this.schema&&this.schema.options&&this.schema.options.toJSON&&this.schema.options.toJSON.virtuals||null})}}),Object.defineProperty(r,"$__isNested",{enumerable:!1,configurable:!0,writable:!1,value:!0}),Object.defineProperty(r,"$isEmpty",{enumerable:!1,configurable:!0,writable:!1,value:function(){return 0===Object.keys(this.get(f,null,a)||{}).length}}),Object.defineProperty(r,"$__parent",{enumerable:!1,configurable:!0,writable:!1,value:this}),l(u,r,f,d),this.$__.getters[f]=r}return this.$__.getters[f]},set:function(e){null!=e&&e.$__isNested?e=e.$__get():e instanceof o&&!e.$__isNested&&(e=e.$toObject(n));(this.$__[s]||this).$set(f,e)}}):Object.defineProperty(h,r,{enumerable:!0,configurable:!0,get:function(){return this[i].call(this.$__[s]||this,f,null,m)},set:function(e){this.$set.call(this.$__[s]||this,f,e)}})}return Gh}function Kh(){return qh?Wh:(qh=1,Wh=function(e){return null==e?null:Object.keys(e)[0]})}var Yh,Qh,Jh,Xh,Zh,ep,tp,np,rp,op,ip,sp,up,ap,cp,lp,hp,pp,dp,fp,mp,yp,gp,Ep,Ap,bp,_p,Op={};function Cp(){if(Yh)return Op;Yh=1;
/*!
	 * Module dependencies.
	 */
const e=B().Binary,t=Ga(),r=Wa(),o=dl(),i=n;
/*!
	 * ignore
	 */
function s(n){return n&&"object"==typeof n&&!(n instanceof Date)&&!t(n,"ObjectId")&&(!Array.isArray(n)||0!==n.length)&&!(n instanceof Buffer)&&!t(n,"Decimal128")&&!(n instanceof e)}return Op.flatten=
/*!
	 * ignore
	 */
function e(t,n,o,i){let u;u=t&&r(t)&&!Buffer.isBuffer(t)?Object.keys(t.toObject({transform:!1,virtuals:!1})||{}):Object.keys(t||{});const a=u.length,c={};n=n?n+".":"";for(let r=0;r<a;++r){const a=u[r],l=t[a];c[n+a]=l;const h=i&&i.path&&i.path(n+a),p=i&&i.nested&&i.nested[n+a];if(!h||"Mixed"!==h.instance){if(s(l)){if(o&&o.skipArrays&&Array.isArray(l))continue;const t=e(l,n+a,o,i);for(const e in t)c[e]=t[e];Array.isArray(l)&&(c[n+a]=l)}if(p){const e=Object.keys(i.paths);for(const t of e)t.startsWith(n+a+".")&&!c.hasOwnProperty(t)&&(c[t]=void 0)}}}return c}
/*!
	 * ignore
	 */,Op.modifiedPaths=function e(t,n,u,a=null){if(null==t||"object"!=typeof t)return;null==a&&(a={raw:{update:t,path:n},trace:new WeakSet});if(a.trace.has(t))throw new o(`a circular reference in the update value, updateValue:\n${i.inspect(a.raw.update,{showHidden:!1,depth:1})}\nupdatePath: '${a.raw.path}'`);a.trace.add(t);const c=Object.keys(t||{}),l=c.length;u=u||{},n=n?n+".":"";for(let o=0;o<l;++o){const i=c[o];let l=t[i];u[n+i]=!0,!Buffer.isBuffer(l)&&r(l)&&(l=l.toObject({transform:!1,virtuals:!1})),s(l)&&e(l,n+i,u,a)}return a.trace.delete(t),u},Op}function wp(){if(Jh)return Qh;function e(e,t){return null==e?e:e instanceof Map?e.get(t):e[t]}return Jh=1,Qh=function(t,n,r){let o,i=!1;if("string"==typeof n){if(-1===n.indexOf(".")){const o=e(t,n);return null==o?r:o}o=n.split(".")}else if(i=!0,o=n,1===o.length){const n=e(t,o[0]);return null==n?r:n}let s=n,u=t;for(const t of o){if(null==u)return r;if(!i&&null!=u[s])return u[s];u=e(u,t),i||(s=s.substr(t.length+1))}return null==u?r:u}}function Sp(){if(Zh)return Xh;Zh=1;const e=Ga();return Xh=function(t,n){return"string"==typeof t&&"string"==typeof n||"number"==typeof t&&"number"==typeof n?t===n:!(!e(t,"ObjectId")||!e(n,"ObjectId"))&&t.toString()===n.toString()}}function vp(){if(tp)return ep;tp=1;const e=Sp();return ep=function(t,n){if(null==t||null==t.discriminators)return null;for(const r of Object.keys(t.discriminators)){const o=t.discriminators[r];if(null!=o.discriminatorMapping&&e(o.discriminatorMapping.value,n))return o}return null},ep}function Dp(){if(ip)return op;ip=1;const e=wp();return op=function(t,n,r){const o=null!=r?Object.keys(e(t.tree,r,{})):Object.keys(t.tree),i=new Set(Object.keys(n));let s;if(i.size>1){s=new Set;for(const e of o)i.has(e)&&s.add(e);for(const e of i)s.has(e)||s.add(e);s=Array.from(s)}else s=Array.from(i);return s},op}function Mp(){return up||(up=1,sp=function(e,t){if(1===t.length)return;let n,r=t[0];for(let o=0;o<t.length-1;++o){const i=e.path(r);i&&i.schema?(n=i.schema.options.strict,e=i.schema,r=i.$isMongooseDocumentArray&&!isNaN(t[o+1])?"":t[o+1]):r+=r.length?"."+t[o+1]:t[o+1]}return n}),sp}function Tp(){if(cp)return ap;cp=1;const e=uf(),t=new Set(["__index","__parentArray","_doc"]);return ap=function(n,r){if(e.isPOJO(n)&&null!=n.$__&&null!=n._doc){if(r){const e={};for(const r of Object.keys(n))"symbol"!=typeof r&&"$"!==r[0]&&(t.has(r)||(e[r]=n[r]));return{...n._doc,...e}}return n._doc}return n}}function Bp(){return hp?lp:(hp=1,
/*!
	 * ignore
	 */
lp=function(e){return null==e||("object"!=typeof e||!("$meta"in e)&&!("$slice"in e))})}function Fp(){if(dp)return pp;dp=1;const e=Bp(),t=Ka();
/*!
	 * ignore
	 */
return pp=function n(r){if(null==r)return null;const o=Object.keys(r);let i=null;if(1===o.length&&"_id"===o[0])i=!r._id;else for(let s=0;s<o.length;++s){const u=o[s];if("_id"!==u&&e(r[u])&&(i=t(r[u])?n(r[u])??i:!r[u],null!=i))break}return i}}function $p(){if(mp)return fp;mp=1;const e=Bp();return fp=function(t,n){if(null==t)return!1;if("_id"===n)return 0===t._id;const r=Object.keys(t);let o=null;for(const i of r)if(e(t[i])){o=1===t[n]?"inclusive":"exclusive";break}return"inclusive"===o?1!==t[n]:"exclusive"===o&&0===t[n]},fp}function xp(){if(gp)return yp;gp=1;const e=uf();return yp=function(t,n){if(null==t._doc._id||null==n||0===n.length)return;const r=String(t._doc._id);for(const o of n){if(o.isVirtual)continue;const n=o.path.split(".");for(let i=0;i<n.length-1;++i){const s=n.slice(0,i+1).join("."),u=n.slice(i+1).join("."),a=t.get(s);if(null!=a&&e.isMongooseDocumentArray(a)){for(let e=0;e<a.length;++e)a[e]&&a[e].populated(u,null==o._docs[r]?void 0:o._docs[r][e],o);break}}}}}function Pp(){if(Ap)return Ep;Ap=1;const{isPOJO:e}=uf();return Ep=function t(n){const r=Object.keys(n);let o,i,s,u=r.length;for(;u--;)i=r[u],s=n[i],e(s)&&(n[i]=t(s)),void 0!==n[i]?o=!0:delete n[i];return o?n:void 0},Ep}function Np(){if(_p)return bp;_p=1;const e=/\./g;return bp=function(t){if(-1===t.indexOf("."))return[t];const n=t.split(e),r=n.length,o=new Array(r);let i="";for(let e=0;e<r;++e)i+=0!==i.length?"."+n[e]:n[e],o[e]=i;return o}}var Ip,Rp,kp,jp,Lp,Up,Vp,zp,Wp,qp,Gp,Hp,Kp,Yp,Qp,Jp={};function Xp(){return Rp||(Rp=1,Ip=function(e,t,n,r,o){const i=Object.keys(e).reduce(((e,n)=>e||n.startsWith(t+".")),!1),s=t+"."+n.options.discriminatorKey;i||1!==o.length||o[0]!==s||r.splice(r.indexOf(s),1)}),Ip}function Zp(){if(jp)return kp;jp=1;const e=Sp();return kp=function(t,n){if(null==t)return null;for(const r of Object.keys(t)){const o=t[r];if(o.schema&&o.schema.discriminatorMapping&&e(o.schema.discriminatorMapping.value,n))return o}return null},kp}function ed(){return Up?Lp:(Up=1,
/*!
	 * ignore
	 */
Lp=function(e,t){const n=t.split(".");let r,o,i,s="";for(let u=0;u<n.length;++u)if(s+=s.length?".":""+n[u],e[s]){for(o=Object.keys(e),i=o.length,r=0;r<i;++r)0!==o[u].indexOf(s+".")||o[u].indexOf(t);return!0}return!1})}function td(){return Vp||(Vp=1,function(e){
/*!
		 * Module dependencies
		 */
const t=Yl(),n=Xp(),r=wp(),o=Zp(),i=Bp(),s=oc(),u=ed();e.preparePopulationOptionsMQ=function(e,n){const r=e._mongooseOptions.populate,o=Object.keys(r).reduce(((e,t)=>e.concat([r[t]])),[]);var i;null!=n.lean&&o.filter((e=>null==(e&&e.options&&e.options.lean))).forEach((i=n.lean,function(e){e.options||(e.options={}),null!=i&&Array.isArray(i.virtuals)&&((i=Object.assign({},i)).virtuals=i.virtuals.filter((t=>"string"==typeof t&&t.startsWith(e.path+"."))).map((t=>t.slice(e.path.length+1)))),e.options.lean=i}));const s=e&&e.options&&e.options.session||null;null!=s&&o.forEach((e=>{null!=e.options?"session"in e.options||(e.options.session=s):e.options={session:s}}));const u=e._fieldsForExec();for(let n=0;n<o.length;++n)o[n]instanceof t?o[n]=new t({...o[n],_queryProjection:u,_localModel:e.model}):(o[n]._queryProjection=u,o[n]._localModel=e.model);return o},e.createModel=function(t,n,r,i,u){t.hooks.execPreSync("createModel",n);const a=t.schema?t.schema.discriminatorMapping:null,c=a&&a.isRoot?a.key:null,l=n[c];if(c&&l&&t.discriminators){const n=t.discriminators[l]||o(t.discriminators,l);if(n){const t=s(i);return e.applyPaths(t,n.schema),new n(void 0,t,!0)}}const h={skipId:!0,isNew:!1,willInit:!0};return null!=u&&"defaults"in u&&(h.defaults=u.defaults),new t(void 0,r,h)},
/*!
		 * ignore
		 */
e.createModelAndInit=function(t,n,r,o,i,s,u){const a=s?{populated:s}:void 0,c=e.createModel(t,n,r,o,i);try{c.$init(n,a,u)}catch(e){u(e,c)}},
/*!
		 * ignore
		 */
e.applyPaths=function(e,t,o){let s,a;const c=new Set;if(e){a=Object.keys(e);const n=[];for(let t=0;t<a.length;++t){const r=a[t];"-"===a[t][0]&&(delete e[r],"-_id"===r?e._id=0:n.push(r.slice(1)))}a=Object.keys(e);for(let n=0;n<a.length;++n){if("+"===a[n][0])continue;const r=e[a[n]];if(i(r)&&(!("_id"===a[n]&&a.length>1)&&(!(a[n]===t.options.discriminatorKey&&a.length>1&&null!=r)||r))){s=!r;break}}for(const r of n){const n=t.path(r);n&&n.selected&&!1===s?n&&n.selected&&!1===s&&c.add(r):(e[r]=0,s=!0)}}const l=[],h=[],p=[];switch(function t(r,o){if(o||(o=""),-1!==p.indexOf(r))return[];p.push(r);const i=[];return r.eachPath((function(r,u){if(o&&(r=o+"."+r),u.$isSchemaMap||r.endsWith(".$*")){const t=e&&"+"+r in e;return void(u.options&&!1===u.options.select&&!t&&h.push(r))}let a=d(r,u);if(null!=a||Array.isArray(u)||!u.$isMongooseArray||u.$isMongooseDocumentArray||(a=d(r,u.caster)),null!=a&&i.push(a),u.schema){const o=t(u.schema,r);!1===s&&n(e,r,u.schema,l,o)}})),p.pop(),i}(t),s){case!0:for(const t of h)e[t]=0;break;case!1:t&&t.paths._id&&t.paths._id.options&&!1===t.paths._id.options.select&&(e._id=0);for(const t of l)c.has(t)||u(e,t)||(e[t]=e[t]||1);break;case void 0:if(null==e)break;for(const t of Object.keys(e||{}))t.startsWith("+")&&delete e[t];for(const t of h)null==e[t]&&(e[t]=0)}function d(n,i){if(null==e)return;if("boolean"!=typeof i.selected)return;if(!1===i.selected&&e[n])return void(o&&(e[n]=0));if(!s&&i.selected&&n===t.options.discriminatorKey&&null!=e[n]&&!e[n])return void delete e[n];if(!1===s&&i.selected&&null!=e[n]&&!e[n])return void delete e[n];const u="+"+n;if(e&&u in e)return delete e[u],void(!1===s&&a.length>1&&!~a.indexOf(n)&&!o?e[n]=1:null==s&&o&&!1===i.selected&&(e[n]=0));const c=n.split(".");let p="";for(let e=0;e<c.length;++e)if(p+=p.length?"."+c[e]:c[e],-1!==h.indexOf(p))return;if(!s&&i&&i.options&&i.options.$skipDiscriminatorCheck){let t="";for(let n=0;n<c.length;++n){t+=(0===t.length?"":".")+c[n];const o=r(e,t,!1)||r(e,t+".$",!1);if(o&&"object"!=typeof o)return}}return(i.selected?l:h).push(n),n}}}(Jp)),Jp}function nd(){if(Wp)return zp;return Wp=1,zp=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}}function rd(){return Gp||(Gp=1,qp=function(e,t,n){let r=t[0],o=n,i=e;for(let e=0;e<t.length-1;++e){const n=o.path(r);if(n&&n.schema){let s=i.get(r);if(o=n.schema,r=t[e+1],Array.isArray(s)&&!isNaN(r)&&(s=s[r],r=""),null==s)break;i=s}else r+=r.length?"."+t[e+1]:t[e+1]}return i}),qp}function od(){if(Kp)return Hp;Kp=1;const e=sf(),t=ha(),r=Ma().internalToObjectOptions,o=n,i=uf();function s(t,n,r,o,i){if("object"==typeof o&&null!=o&&null==i&&(i=o,o=void 0),null!=r){const e={isNew:r.isNew};"defaults"in r.$__&&(e.defaults=r.$__.defaults),i=Object.assign(e,i)}null!=i&&null!=i.path&&(this.$basePath=i.path),e.call(this,t,n,o,i),delete this.$__.priorDoc}return Hp=s,s.prototype=Object.create(e.prototype),Object.defineProperty(s.prototype,"$isSubdocument",{configurable:!1,writable:!1,value:!0}),Object.defineProperty(s.prototype,"$isSingleNested",{configurable:!1,writable:!1,value:!0}),
/*!
	 * ignore
	 */
s.prototype.toBSON=function(){return this.toObject(r)},s.prototype.save=async function(e){return(e=e||{}).suppressWarning||i.warn("mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app."),new Promise(((e,t)=>{this.$__save((n=>{if(null!=n)return t(n);e(this)}))}))},s.prototype.$__fullPath=function(e){return this.$__.fullPath||this.ownerDocument(),e?this.$__.fullPath+"."+e:this.$__.fullPath},s.prototype.$__pathRelativeToParent=function(e){return null==e?this.$basePath:[this.$basePath,e].join(".")},s.prototype.$__save=function(e){return t((()=>e(null,this)))},
/*!
	 * ignore
	 */
s.prototype.$isValid=function(t){const n=this.$parent(),r=this.$__pathRelativeToParent(t);return null!=n&&null!=r?n.$isValid(r):e.prototype.$isValid.call(this,t)},
/*!
	 * ignore
	 */
s.prototype.markModified=function(t){e.prototype.markModified.call(this,t);const n=this.$parent(),r=this.$__pathRelativeToParent(t);if(null==n||null==r)return;const o=this.$__pathRelativeToParent().replace(/\.$/,"");n.isDirectModified(o)||this.isNew||this.$__parent.markModified(r,this)},
/*!
	 * ignore
	 */
s.prototype.isModified=function(t,n,r){const o=this.$parent();return null!=o?(Array.isArray(t)||"string"==typeof t?t=(t=Array.isArray(t)?t:t.split(" ")).map((e=>this.$__pathRelativeToParent(e))).filter((e=>null!=e)):t||(t=this.$__pathRelativeToParent()),o.$isModified(t,n,r)):e.prototype.isModified.call(this,t,n,r)},s.prototype.$markValid=function(t){e.prototype.$markValid.call(this,t);const n=this.$parent(),r=this.$__pathRelativeToParent(t);null!=n&&null!=r&&n.$markValid(r)},
/*!
	 * ignore
	 */
s.prototype.invalidate=function(t,n,r){e.prototype.invalidate.call(this,t,n,r);const o=this.$parent(),i=this.$__pathRelativeToParent(t);if(null!=o&&null!=i)o.invalidate(i,n,r);else if("cast"===n.kind||"CastError"===n.name||null==i)throw n;return this.ownerDocument().$__.validationError},
/*!
	 * ignore
	 */
s.prototype.$ignore=function(t){e.prototype.$ignore.call(this,t);const n=this.$parent(),r=this.$__pathRelativeToParent(t);null!=n&&null!=r&&n.$ignore(r)},s.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;let e=this;const t=[],n=new Set([e]);for(;"function"==typeof e.$__pathRelativeToParent;){t.unshift(e.$__pathRelativeToParent(void 0,!0));const r=e.$parent();if(null==r)break;if(e=r,n.has(e))throw new Error("Infinite subdocument loop: subdoc with _id "+e._id+" is a parent of itself");n.add(e)}return this.$__.fullPath=t.join("."),this.$__.ownerDocument=e,this.$__.ownerDocument},
/*!
	 * ignore
	 */
s.prototype.$__fullPathWithIndexes=function(){let e=this;const t=[],n=new Set([e]);for(;"function"==typeof e.$__pathRelativeToParent;){t.unshift(e.$__pathRelativeToParent(void 0,!1));const r=e.$parent();if(null==r)break;if(e=r,n.has(e))throw new Error("Infinite subdocument loop: subdoc with _id "+e._id+" is a parent of itself");n.add(e)}return t.join(".")},s.prototype.parent=function(){return this.$__parent},s.prototype.$parent=s.prototype.parent,s.prototype.$__deleteOne=function(e){if(null!=e)return e(null,this)},s.prototype.$__removeFromParent=function(){this.$__parent.set(this.$basePath,null)},s.prototype.deleteOne=function(e,t){if("function"==typeof e&&(t=e,e=null),function(e){const t=e.ownerDocument();function n(){t.$removeListener("save",n),t.$removeListener("deleteOne",n),e.emit("deleteOne",e),e.constructor.emit("deleteOne",e)}t.$on("save",n),t.$on("deleteOne",n)}(this),!e||!e.noop){this.$__removeFromParent();const e=this.ownerDocument();e.$__.removedSubdocs=e.$__.removedSubdocs||[],e.$__.removedSubdocs.push(this)}return this.$__deleteOne(t)},
/*!
	 * ignore
	 */
s.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.nested.populate("path")`, use `doc.populate("nested.path")`')},s.prototype.inspect=function(){return this.toObject()},o.inspect.custom&&(s.prototype[o.inspect.custom]=s.prototype.inspect),Hp}
/*!
 * Module dependencies.
 */function id(){if(Qp)return Yp;Qp=1;const e=t.EventEmitter,n=od(),r=uf(),o=Aa().documentArrayParent;function i(e,t,i,s,u){let a;r.isMongooseDocumentArray(t)?(this.__parentArray=t,this[o]=t.$parent()):(this.__parentArray=void 0,this[o]=void 0),this.$setIndex(u),this.$__parent=this[o],"object"==typeof i&&null!=i?(a={isNew:!0,...i},i=void 0):a={isNew:!0},n.call(this,e,s,this[o],i,a)}
/*!
	 * Inherit from Subdocument
	 */i.prototype=Object.create(n.prototype),i.prototype.constructor=i,Object.defineProperty(i.prototype,"$isSingleNested",{configurable:!1,writable:!1,value:!1}),Object.defineProperty(i.prototype,"$isDocumentArrayElement",{configurable:!1,writable:!1,value:!0});for(const t in e.prototype)i[t]=e.prototype[t];
/*!
	 * ignore
	 */return i.prototype.$setIndex=function(e){if(this.__index=e,null!=this.$__&&null!=this.$__.validationError){const e=Object.keys(this.$__.validationError.errors);for(const t of e)this.invalidate(t,this.$__.validationError.errors[t])}},
/*!
	 * ignore
	 */
i.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.arr[0].populate("path")`, use `doc.populate("arr.0.path")`')},
/*!
	 * ignore
	 */
i.prototype.$__removeFromParent=function(){const e=this._doc._id;if(!e)throw new Error("For your own good, Mongoose does not know how to remove an ArraySubdocument that has no _id");this.__parentArray.pull({_id:e})},i.prototype.$__fullPath=function(e,t){return null==this.__index?null:(this.$__.fullPath||this.ownerDocument(),t?e?this.$__.fullPath+"."+e:this.$__.fullPath:e?this.$__.fullPath+"."+this.__index+"."+e:this.$__.fullPath+"."+this.__index)},i.prototype.$__pathRelativeToParent=function(e,t){return null!=this.__index&&this.__parentArray&&this.__parentArray.$path?t?null==e?this.__parentArray.$path():this.__parentArray.$path()+"."+e:null==e?this.__parentArray.$path()+"."+this.__index:this.__parentArray.$path()+"."+this.__index+"."+e:null},i.prototype.$parent=function(){return this[o]},i.prototype.parentArray=function(){return this.__parentArray},
/*!
	 * Module exports.
	 */
Yp=i}var sd,ud,ad,cd,ld,hd,pd,dd,fd,md,yd,gd,Ed,Ad,bd,_d,Od,Cd,wd,Sd,vd,Dd,Md,Td,Bd,Fd,$d,xd,Pd,Nd,Id,Rd,kd,jd,Ld,Ud,Vd,zd,Wd,qd,Gd,Hd,Kd,Yd,Qd,Jd,Xd,Zd,ef={exports:{}};function tf(){if(ud)return sd;ud=1;const e=sf(),t=id(),n=pa(),r=Vh(),o=oc(),i=Ma().internalToObjectOptions,s=Kl(),u=uf(),a=Ga(),c=Aa().arrayAtomicsSymbol,l=Aa().arrayParentSymbol,h=Aa().arrayPathSymbol,p=Aa().arraySchemaSymbol,d=Aa().populateModelSymbol,f=Symbol("mongoose#Array#sliced"),m=Array.prototype.push,y={$__getAtomics(){const e=[],t=Object.keys(this[c]||{});let n=t.length;const r=Object.assign({},i,{_isNested:!0});if(0===n)return e[0]=["$set",this.toObject(r)],e;for(;n--;){const o=t[n];let i=this[c][o];u.isMongooseObject(i)?i=i.toObject(r):Array.isArray(i)?i=this.toObject.call(i,r):null!=i&&Array.isArray(i.$each)?i.$each=this.toObject.call(i.$each,r):null!=i&&"function"==typeof i.valueOf&&(i=i.valueOf()),"$addToSet"===o&&(i={$each:i}),e.push([o,i])}return e},
/*!
	   * ignore
	   */
$atomics(){return this[c]},
/*!
	   * ignore
	   */
$parent(){return this[l]},
/*!
	   * ignore
	   */
$path(){return this[h]},$shift(){this._registerAtomic("$pop",-1),this._markModified();const e=this.__array;if(!e._shifted)return e._shifted=!0,[].shift.call(e)},$pop(){if(this._registerAtomic("$pop",1),this._markModified(),!this._popped)return this._popped=!0,[].pop.call(this)},
/*!
	   * ignore
	   */
$schema(){return this[p]},_cast(e){let t,r=!1;const o=this[l];if(o&&(r=o.$populated(this[h],!0)),r&&null!=e){if(t=r.options[d],null==t)throw new n("No populated model found for path `"+this[h]+"`. This is likely a bug in Mongoose, please report an issue on github.com/Automattic/mongoose.");(Buffer.isBuffer(e)||a(e,"ObjectId")||!u.isObject(e))&&(e={_id:e});return e.schema&&e.schema.discriminatorMapping&&void 0!==e.schema.discriminatorMapping.key||(e=new t(e)),this[p].caster.applySetters(e,o,!0)}return this[p].caster.applySetters(e,o,!1)},_mapCast(e,t){return this._cast(e,this.length+t)},_markModified(e){const t=this[l];let n;if(t){if(n=this[h],arguments.length&&(n=n+"."+e),null!=n&&n.endsWith(".$"))return this;t.markModified(n,0!==arguments.length?e:t)}return this},_registerAtomic(e,n){if(this[f])return;if("$set"===e)return this[c]={$set:n},r(this[l],this[h]),this._markModified(),this;const o=this[c];if("$pop"===e&&!("$pop"in o)){const e=this;this[l].once("save",(function(){e._popped=e._shifted=null}))}if(o.$set||Object.keys(o).length&&!(e in o))return this[c]={$set:this},this;let i;if("$pullAll"===e||"$addToSet"===e)o[e]||(o[e]=[]),o[e]=o[e].concat(n);else if("$pullDocs"===e){const e=o.$pull||(o.$pull={});n[0]instanceof t?(i=e.$or||(e.$or=[]),Array.prototype.push.apply(i,n.map((e=>e.toObject({transform:(t,n)=>(null==e||null==e.$__||Object.keys(e.$__.activePaths.getStatePaths("default")).forEach((e=>{s.unset(e,n),g(n,e)})),n),virtuals:!1}))))):(i=e._id||(e._id={$in:[]}),i.$in=i.$in.concat(n))}else if("$push"===e)if(o.$push=o.$push||{$each:[]},null!=n&&u.hasUserDefinedProperty(n,"$each"))o.$push=n;else if(1===n.length)o.$push.$each.push(n[0]);else if(n.length<1e4)o.$push.$each.push(...n);else for(const e of n)o.$push.$each.push(e);else o[e]=n;return this},addToSet(){E(this,arguments),A(this,arguments);const e=[].map.call(arguments,this._mapCast,this),n=[];let r="";e[0]instanceof t?r="doc":e[0]instanceof Date?r="date":a(e[0],"ObjectId")&&(r="ObjectId");const o=u.isMongooseArray(e)?e.__array:e,i=u.isMongooseArray(this)?this.__array:this;return o.forEach((function(e){let t;const o=+e;switch(r){case"doc":t=this.some((function(t){return t.equals(e)}));break;case"date":t=this.some((function(e){return+e===o}));break;case"ObjectId":t=this.find((t=>t.toString()===e.toString()));break;default:t=~this.indexOf(e)}t||(this._markModified(),i.push(e),this._registerAtomic("$addToSet",e),[].push.call(n,e))}),this),n},hasAtomics(){return u.isPOJO(this[c])?Object.keys(this[c]).length:0},includes(e,t){return-1!==this.indexOf(e,t)},indexOf(e,t){a(e,"ObjectId")&&(e=e.toString()),t=null==t?0:t;const n=this.length;for(let r=t;r<n;++r)if(e==this[r])return r;return-1},inspect(){return JSON.stringify(this)},nonAtomicPush(){const e=[].map.call(arguments,this._mapCast,this);this._markModified();const t=[].push.apply(this,e);return this._registerAtomic("$set",this),t},pop(){this._markModified();const e=[].pop.call(this);return this._registerAtomic("$set",this),e},pull(){const n=[].map.call(arguments,((e,t)=>this._cast(e,t,{defaults:!1})),this);let o=this[l].get(this[h]);u.isMongooseArray(o)&&(o=o.__array);let i,s=o.length;for(this._markModified();s--;)if(i=o[s],i instanceof e){n.some((function(e){return i.equals(e)}))&&o.splice(s,1)}else~this.indexOf.call(n,i)&&o.splice(s,1);return n[0]instanceof t?this._registerAtomic("$pullDocs",n.map((function(e){const t=e.$__getValue("_id");return void 0===t||e.$isDefault("_id")?e:t}))):this._registerAtomic("$pullAll",n),r(this[l],this[h])>0&&this._registerAtomic("$set",this),this},push(){let e=arguments,t=e;const n=null!=e[0]&&u.hasUserDefinedProperty(e[0],"$each"),r=u.isMongooseArray(this)?this.__array:this;if(n&&(t=e[0],e=e[0].$each),null==this[p])return m.apply(this,e);let o;E(this,e),A(this,e),e=[].map.call(e,this._mapCast,this);const i=this[c];return this._markModified(),n?(t.$each=e,0!==(i.$push&&i.$push.$each&&i.$push.$each.length||0)&&i.$push.$position!=t.$position?(null!=t.$position?([].splice.apply(r,[t.$position,0].concat(e)),o=r.length):o=[].push.apply(r,e),this._registerAtomic("$set",this)):null!=t.$position?([].splice.apply(r,[t.$position,0].concat(e)),o=this.length):o=[].push.apply(r,e)):(t=e,o=m.apply(r,e)),this._registerAtomic("$push",t),o},remove(){return this.pull.apply(this,arguments)},set(e,t,n){const r=this.__array;if(n)return r[e]=t,this;const o=y._cast.call(this,t,e);return y._markModified.call(this,e),r[e]=o,this},shift(){const e=u.isMongooseArray(this)?this.__array:this;this._markModified();const t=[].shift.call(e);return this._registerAtomic("$set",this),t},sort(){const e=u.isMongooseArray(this)?this.__array:this,t=[].sort.apply(e,arguments);return this._registerAtomic("$set",this),t},splice(){let e;const t=u.isMongooseArray(this)?this.__array:this;if(this._markModified(),E(this,Array.prototype.slice.call(arguments,2)),arguments.length){let n;if(null==this[p])n=arguments;else{n=[];for(let e=0;e<arguments.length;++e)n[e]=e<2?arguments[e]:this._cast(arguments[e],arguments[0]+(e-2))}e=[].splice.apply(t,n),this._registerAtomic("$set",this)}return e},
/*!
	   * ignore
	   */
toBSON(){return this.toObject(i)},toObject(t){const n=u.isMongooseArray(this)?this.__array:this;return t&&t.depopulate?((t=o(t))._isNested=!0,[].concat(n).map((function(n){return n instanceof e?n.toObject(t):n}))):[].concat(n)},$toObject(){return this.constructor.prototype.toObject.apply(this,arguments)},unshift(){let e;E(this,arguments),e=null==this[p]?arguments:[].map.call(arguments,this._cast,this);const t=u.isMongooseArray(this)?this.__array:this;return this._markModified(),[].unshift.apply(t,e),this._registerAtomic("$set",this),this.length}};
/*!
	 * Minimize _just_ empty objects along the path chain specified
	 * by `parts`, ignoring all other paths. Useful in cases where
	 * you want to minimize after unsetting a path.
	 *
	 * #### Example:
	 *
	 *     const obj = { foo: { bar: { baz: {} } }, a: {} };
	 *     _minimizePath(obj, 'foo.bar.baz');
	 *     obj; // { a: {} }
	 */
function g(e,t,n){if("string"==typeof t){if(-1===t.indexOf("."))return;t=s.stringToParts(t)}(n=n||0)>=t.length||null!=e&&"object"==typeof e&&(g(e[t[0]],t,n+1),null!=e[t[0]]&&"object"==typeof e[t[0]]&&0===Object.keys(e[t[0]]).length&&delete e[t[0]])}
/*!
	 * ignore
	 */function E(t,n){const r=null==t?null:t[p]&&t[p].caster&&t[p].caster.options&&t[p].caster.options.ref||null;0===t.length&&0!==n.length&&
/*!
	 * ignore
	 */
function(t,n){if(!n)return!1;for(const r of t){if(null==r)return!1;const t=r.constructor;if(!(r instanceof e)||t.modelName!==n&&t.baseModelName!==n)return!1}return!0}(n,r)&&t[l].$populated(t[h],[],{[d]:n[0].constructor})}
/*!
	 * If `docs` isn't all instances of the right model, depopulate `arr`
	 */function A(e,t){const n=null==e?null:e[p]&&e[p].caster&&e[p].caster.options&&e[p].caster.options.ref||null,r=e[l],o=e[h];if(n&&r.populated(o))for(const e of t)if(null!=e&&("object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Buffer||u.isMongooseType(e))){r.depopulate(o);break}}const b=["filter","flat","flatMap","map","slice"];for(const e of b)null!=Array.prototype[e]&&(y[e]=function(){const t=u.isMongooseArray(this)?this.__array:this,n=[].concat(t);return n[e].apply(n,arguments)});return sd=y}
/*!
 * Module dependencies.
 */function nf(){return ad||(ad=1,function(e){const t=sf(),n=tf(),r=Aa().arrayAtomicsSymbol,o=Aa().arrayAtomicsBackupSymbol,i=Aa().arrayParentSymbol,s=Aa().arrayPathSymbol,u=Aa().arraySchemaSymbol,a=Array.prototype.push,c=/^\d+$/;
/*!
		 * Module exports.
		 */
e.exports=function(e,l,h,p){let d;if(Array.isArray(e)){const t=e.length;if(0===t)d=new Array;else if(1===t)d=new Array(1),d[0]=e[0];else if(t<1e4)d=new Array,a.apply(d,e);else{d=new Array;for(let n=0;n<t;++n)a.call(d,e[n])}}else d=[];const f={[r]:{},[o]:void 0,[s]:l,[u]:p,[i]:void 0,isMongooseArray:!0,isMongooseArrayProxy:!0,__array:d};e&&null!=e[r]&&(f[r]=e[r]),null!=h&&h instanceof t&&(f[i]=h,f[u]=p||h.schema.path(l));const m=new Proxy(d,{get:function(e,t){return f.hasOwnProperty(t)?f[t]:n.hasOwnProperty(t)?n[t]:p&&p.virtuals&&p.virtuals.hasOwnProperty(t)?p.virtuals[t].applyGetters(void 0,e):"string"==typeof t&&c.test(t)&&null!=p?.$embeddedSchemaType?p.$embeddedSchemaType.applyGetters(d[t],h):d[t]},set:function(e,t,r){return"string"==typeof t&&c.test(t)?n.set.call(m,t,r,!1):f.hasOwnProperty(t)?f[t]=r:p&&p.virtuals&&p.virtuals.hasOwnProperty(t)?p.virtuals[t].applySetters(r,e):d[t]=r,!0}});return m}}(ef,ef.exports)),ef.exports}function rf(){if(ld)return cd;ld=1;const e=Ga(),t=ba();return cd=function(n){if(null==n)return n;if(e(n,"ObjectId"))return n;if(n._id){if(e(n._id,"ObjectId"))return n._id;if(n._id.toString instanceof Function)return new t(n._id.toString())}return n.toString instanceof Function?new t(n.toString()):new t(n)}}function of(){if(fd)return dd;fd=1;
/*!
	 * Module dependencies.
	 */
const e=tf(),t=function(){if(pd)return hd;pd=1;const e=tf(),t=sf(),n=rf(),r=Zp(),o=Ma().internalToObjectOptions,i=uf(),s=Ga(),u=Aa().arrayParentSymbol,a=Aa().arrayPathSymbol,c=Aa().arraySchemaSymbol,l=Aa().documentArrayParent,h=Array.prototype.toString,p={
/*!
	   * ignore
	   */
toBSON(){return this.toObject(o)},toString(){return h.call(this.__array.map((e=>null!=e&&null!=e.$__?e.toString():e)))},
/*!
	   * ignore
	   */
getArrayParent(){return this[u]},_cast(e,t,n){if(null==this[c])return e;let o=this[c].casterConstructor;if((o.$isMongooseDocumentArray?i.isMongooseDocumentArray(e):e instanceof o)||e&&e.constructor&&e.constructor.baseCasterConstructor===o)return e[l]&&e.__parentArray||(e[l]=this[u],e.__parentArray=this),e.$setIndex(t),e;if(null==e)return null;if((Buffer.isBuffer(e)||s(e,"ObjectId")||!i.isObject(e))&&(e={_id:e}),e&&o.discriminators&&o.schema&&o.schema.options&&o.schema.options.discriminatorKey)if("string"==typeof e[o.schema.options.discriminatorKey]&&o.discriminators[e[o.schema.options.discriminatorKey]])o=o.discriminators[e[o.schema.options.discriminatorKey]];else{const t=r(o.discriminators,e[o.schema.options.discriminatorKey]);t&&(o=t)}if(o.$isMongooseDocumentArray)return o.cast(e,this,void 0,void 0,t);const a=new o(e,this,n,void 0,t);return a.isNew=!0,a},id(e){let r,o,u;try{r=n(e).toString()}catch(e){r=null}for(const n of this)if(n&&(u=n.get("_id"),null!=u))if(u instanceof t){if(o||(o=String(e)),o==u._id)return n}else if(s(e,"ObjectId")||s(u,"ObjectId")){if(r==u)return n}else if(e==u||i.deepEqual(e,u))return n;return null},toObject(e){return[].concat(this.map((function(t){return null==t?null:"function"!=typeof t.toObject?t:t.toObject(e)})))},$toObject(){return this.constructor.prototype.toObject.apply(this,arguments)},push(){const t=e.push.apply(this,arguments);return d(this),t},pull(){const t=e.pull.apply(this,arguments);return d(this),t},shift(){const t=e.shift.apply(this,arguments);return d(this),t},splice(){const t=e.splice.apply(this,arguments);return d(this),t},inspect(){return this.toObject()},create(e){let t=this[c].casterConstructor;if(e&&t.discriminators&&t.schema&&t.schema.options&&t.schema.options.discriminatorKey)if("string"==typeof e[t.schema.options.discriminatorKey]&&t.discriminators[e[t.schema.options.discriminatorKey]])t=t.discriminators[e[t.schema.options.discriminatorKey]];else{const n=r(t.discriminators,e[t.schema.options.discriminatorKey]);n&&(t=n)}return new t(e,this)},
/*!
	   * ignore
	   */
notify(e){const t=this;return function n(r,o){let s=(o=o||t).length;for(;s--;)null!=o[s]&&("save"===e&&(r=t[s]),i.isMongooseArray(o[s])?n(r,o[s]):o[s]&&o[s].emit(e,r))}},set(e,t,n){const r=this.__array;if(n)return r[e]=t,this;const o=p._cast.call(this,t,e);return p._markModified.call(this,e),r[e]=o,this},_markModified(e,t){const n=this[u];let r;if(n){if(r=this[a],arguments.length&&(r=null!=t?r+"."+e.__index+"."+t:r+"."+e),null!=r&&r.endsWith(".$"))return this;n.markModified(r,0!==arguments.length?e:n)}return this}};function d(e){const t=e[u];if(!t||null==t.$__.populated)return;const n=Object.keys(t.$__.populated).filter((t=>t.startsWith(e[a]+".")));for(const r of n){const n=r.slice((e[a]+".").length);Array.isArray(t.$__.populated[r].value)&&(t.$__.populated[r].value=e.map((e=>e.$populated(n))))}}return hd=p}(),n=sf(),r=Aa().arrayAtomicsSymbol,o=Aa().arrayAtomicsBackupSymbol,i=Aa().arrayParentSymbol,s=Aa().arrayPathSymbol,u=Aa().arraySchemaSymbol,a=Array.prototype.push,c=/^\d+$/;
/*!
	 * Module exports.
	 */
return dd=function(l,h,p,d){const f=[],m={[r]:{},[o]:void 0,[s]:h,[u]:void 0,[i]:void 0};if(Array.isArray(l)&&(l[s]===h&&l[i]===p&&(m[r]=Object.assign({},l[r])),l.forEach((e=>{a.call(f,e)}))),m[s]=h,m.__array=f,p&&p instanceof n)for(m[i]=p,m[u]=p.$__schema.path(h);null!=m[u]&&m[u].$isMongooseArray&&!m[u].$isMongooseDocumentArray;)m[u]=m[u].casterConstructor;const y=new Proxy(f,{get:function(n,r){return"isMongooseArray"===r||"isMongooseArrayProxy"===r||"isMongooseDocumentArray"===r||"isMongooseDocumentArrayProxy"===r||(m.hasOwnProperty(r)?m[r]:t.hasOwnProperty(r)?t[r]:d&&d.virtuals&&d.virtuals.hasOwnProperty(r)?d.virtuals[r].applyGetters(void 0,n):e.hasOwnProperty(r)?e[r]:f[r])},set:function(e,n,r){return"string"==typeof n&&c.test(n)?t.set.call(y,n,r,!1):m.hasOwnProperty(n)?m[n]=r:d&&d.virtuals&&d.virtuals.hasOwnProperty(n)?d.virtuals[n].applySetters(r,e):f[n]=r,!0}});return y}}function sf(){return md||(md=1,function(e){
/*!
		 * Module dependencies.
		 */
const r=ll(),o=t.EventEmitter,i=dh(),s=fh(),u=dl(),a=Ih(),c=(Ah||(Ah=1,Eh=class{constructor(e,t,n){this.subdocSnapshot=e,this.activePaths=t,this.version=n}}),Eh),l=Rh(),h=kh(),p=function(){if(Sh)return wh;Sh=1;
/*!
	 * Module dependencies.
	 */
const e=pa();class t extends e{constructor(e){super("Can't validate() the same doc multiple times in parallel. Document: "+e._doc._id)}}return Object.defineProperty(t.prototype,"name",{value:"ParallelValidateError"}),
/*!
	 * exports
	 */
wh=t}(),d=$g(),f=hl(),m=tl(),y=nl(),g=jh(),E=Uh(),A=Vh(),b=oc(),_=Hh().compile,O=Hh().defineKey,C=Kh(),w=Cp().flatten,S=function(){if(rp)return np;rp=1;const e=wp(),t=vp();return np=function n(r,o,i){const s=(i=i||{}).typeOnly,u=Array.isArray(o)?o:-1===o.indexOf(".")?[o]:o.split(".");let a=null,c="adhocOrUndefined";const l=t(r.schema,r.get(r.schema.options.discriminatorKey))||r.schema;for(let t=0;t<u.length;++t){const o=u.slice(0,t+1).join(".");if(a=l.path(o),null!=a){if("Mixed"===a.instance)return s?"real":a;if(c=l.pathType(o),(a.$isSingleNested||a.$isMongooseDocumentArrayElement)&&null!=a.schema.discriminators){const s=a.schema.discriminators,c=r.get(o+"."+e(a,"schema.options.discriminatorKey"));if(null==c||null==s[c])continue;const l=u.slice(t+1).join(".");return n(r.get(o),l,i)}}else c="adhocOrUndefined"}return s?c:a},np}(),v=Dp(),D=Mp(),M=Tp(),T=ha(),B=Ga(),F=Bp(),$=Fp(),x=$p(),P=n.inspect,N=Ma().internalToObjectOptions,I=xp(),R=Pp(),k=Kl(),j=Np(),L=td(),U=uf(),V=nd(),z=U.deepEqual,W=U.isMongooseObject,q=Aa().arrayAtomicsBackupSymbol,G=Aa().arrayAtomicsSymbol,H=Aa().documentArrayParent,K=Aa().documentIsModified,Y=Aa().documentModifiedPaths,Q=Aa().documentSchemaSymbol,J=Aa().getSymbol,X=Aa().modelSymbol,Z=Aa().populateModelSymbol,ee=Aa().scopeSymbol,te=Nh().schemaMixedSymbol,ne=rd(),re=Aa().sessionNewDocuments;let oe,ie,se;const ue=U.specialProperties;function ae(e,t,n,r){if("object"==typeof n&&null!=n&&(n=(r=n).skipId),r=Object.assign({},r),null==this.$__schema){const e=U.isObject(t)&&!t.instanceOfSchema?new d(t):t;this.$__setSchema(e),t=n,n=r,r=arguments[4]||{}}if(this.$__=new i,null!=r.isNew&&!0!==r.isNew&&(this.$isNew=r.isNew),null!=r.priorDoc&&(this.$__.priorDoc=r.priorDoc),n&&(this.$__.skipId=n),null!=e&&"object"!=typeof e)throw new h(e,"obj","Document");let o=!0;void 0!==r.defaults&&(this.$__.defaults=r.defaults,o=r.defaults);const s=this.$__schema;"boolean"==typeof t||"throw"===t?(!0!==t&&(this.$__.strictMode=t),t=void 0):!0!==s.options.strict&&(this.$__.strictMode=s.options.strict);const u=s.requiredPaths(!0);for(const e of u)this.$__.activePaths.require(e);let a=null;U.isPOJO(t)&&Object.keys(t).length>0&&(a=$(t),this.$__.selected=t,this.$__.exclude=a);const c=!1===a&&t?g(t):null;if(null==this._doc&&(this.$__buildDoc(e,t,n,a,c,!1),o&&E(this,t,a,c,!0,null,{skipParentChangeTracking:!0})),e&&(this.$__original_set?this.$__original_set(e,void 0,!0,r):this.$set(e,void 0,!0,r),e instanceof ae&&(this.$isNew=e.$isNew)),r.willInit&&o?r.skipDefaults&&(this.$__.skipDefaults=r.skipDefaults):o&&E(this,t,a,c,!1,r.skipDefaults),!this.$__.strictMode&&e){const e=this;Object.keys(this._doc).forEach((function(t){t in s.tree||t in s.methods||t in s.virtuals||t.startsWith("$")||O({prop:t,subprops:null,prototype:e})}))}!
/*!
		 * Runs queued functions
		 */
function(e){const t=e.$__schema&&e.$__schema.callQueue;if(!t.length)return;for(const n of t)"pre"!==n[0]&&"post"!==n[0]&&"on"!==n[0]&&e[n[0]].apply(e,n[1])}
/*!
		 * ignore
		 */(this)}ae.prototype.$isMongooseDocumentPrototype=!0,Object.defineProperty(ae.prototype,"isNew",{get:function(){return this.$isNew},set:function(e){this.$isNew=e}}),Object.defineProperty(ae.prototype,"errors",{get:function(){return this.$errors},set:function(e){this.$errors=e}}),
/*!
		 * ignore
		 */
ae.prototype.$isNew=!0,
/*!
		 * Document exposes the NodeJS event emitter API, so you can use
		 * `on`, `once`, etc.
		 */
U.each(["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"],(function(e){ae.prototype[e]=function(){if(!this.$__.emitter){if("emit"===e)return;this.$__.emitter=new o,this.$__.emitter.setMaxListeners(0)}return this.$__.emitter[e].apply(this.$__.emitter,arguments)},ae.prototype[`$${e}`]=ae.prototype[e]})),ae.prototype.constructor=ae;for(const e in o.prototype)ae[e]=o.prototype[e];
/*!
		 * ignore
		 */
function ce(e,t,n){if(null==e)return;const r=Object.keys(n.$__schema.paths),o=r.length,i=-1===t.indexOf(".")?[t]:t.split(".");for(let s=0;s<o;++s){let o="";const u=r[s];if(!u.startsWith(t+"."))continue;const a=n.$__schema.paths[u],c=a.splitPath().slice(i.length),l=c.length;if(void 0===a.defaultValue)continue;let h=e;for(let e=0;e<l&&null!=h;++e){const r=c[e];if(e===l-1){if(void 0!==h[r])break;try{const e=a.getDefault(n,!1);void 0!==e&&(h[r]=e)}catch(e){n.invalidate(t+"."+o,e);break}break}o+=(o.length?".":"")+r,h[r]=h[r]||{},h=h[r]}}}function le(e,t,n,r,o){o=o||"",null!=t.$__&&(t=t._doc);const i=Object.keys(t),s=i.length;let u,a,c;const l=e.$__.strictMode,h=e.$__schema;for(let p=0;p<s;++p){if(c=i[p],ue.has(c))continue;if(a=o?o+c:c,u=h.path(a),h.$isRootDiscriminator&&!e.$__isSelected(a))continue;const s=t[c];if(!u&&U.isPOJO(s))n[c]||(n[c]={},l||c in h.tree||c in h.methods||c in h.virtuals||(e[c]=n[c])),le(e,s,n[c],r,a+".");else if(u){if(n.hasOwnProperty(c)&&void 0!==s&&!r.hydratedPopulatedDocs&&delete n[c],null===s)n[c]=u._castNullish(null);else if(void 0!==s){const t=null==s.$__?null:s.$__.wasPopulated;if(!u||t||r.hydratedPopulatedDocs)u&&r.hydratedPopulatedDocs?(n[c]=u.cast(s,e,!0,void 0,{hydratedPopulatedDocs:!0}),n[c]&&n[c].$__&&n[c].$__.wasPopulated?e.$populated(a,n[c].$__.wasPopulated.value,n[c].$__.wasPopulated.options):Array.isArray(n[c])&&n[c].length&&n[c][0]?.$__?.wasPopulated&&e.$populated(a,n[c].map((e=>e?.$__?.wasPopulated?.value)).filter((e=>null!=e)),n[c][0].$__.wasPopulated.options)):n[c]=s;else try{if(r&&r.setters){const t=!1;n[c]=u.applySetters(s,e,t)}else n[c]=u.cast(s,e,!0)}catch(t){e.invalidate(t.path,new y({path:t.path,message:t.message,type:"cast",value:t.value,reason:t}))}}e.$isModified(a)||e.$__.activePaths.init(a)}else n[c]=s,l||o||(e[c]=s)}}
/*!
		 * ignore
		 */
function he(e){if(null==e)return!0;if("object"!=typeof e||Array.isArray(e))return!1;for(const t of Object.keys(e))if(!he(e[t]))return!1;return!0}
/*!
		 * ignore
		 */
function pe(e,t,n,r){const o={};!
/*!
		 * ignore
		 */
function(e){const t=Object.keys(e.$__.activePaths.getStatePaths("require"));let n=0;const r=t.length;for(n=0;n<r;++n){const r=t[n],o=e.$__schema.path(r);if(null!=o&&"function"==typeof o.originalRequiredValue){e.$__.cachedRequired=e.$__.cachedRequired||{};try{e.$__.cachedRequired[r]=o.originalRequiredValue.call(e,e)}catch(t){e.invalidate(r,t)}}}}(e);let i=new Set(Object.keys(e.$__.activePaths.getStatePaths("require")).filter((function(t){return!(!e.$__isSelected(t)&&!e.$isModified(t))&&(null==e.$__.cachedRequired||!(t in e.$__.cachedRequired)||e.$__.cachedRequired[t])})));function s(e){i.add(e)}if(Object.keys(e.$__.activePaths.getStatePaths("init")).forEach(s),Object.keys(e.$__.activePaths.getStatePaths("modify")).forEach(s),Object.keys(e.$__.activePaths.getStatePaths("default")).forEach(s),!r){const t=[];for(const n of Object.keys(e.$__schema.paths)){const r=e.$__schema.path(n);if(r.$isSingleNested){const r=e.$get(n);r&&t.push(r)}else if(r.$isMongooseDocumentArray){const r=e.$get(n);if(r&&r.length)for(const e of r)e&&t.push(e)}}const n=e.modifiedPaths();for(const r of t)if(r.$basePath){const t=r.$__pathRelativeToParent();for(const e of r.modifiedPaths())i.delete(t+"."+e);const s=r.$parent();!e.$isModified(t,null,n)||s.$__.activePaths.getStatePaths("modify").hasOwnProperty(t)||s.$isDefault(t)||(i.add(t),null==e.$__.pathsToScopes&&(e.$__.pathsToScopes={}),e.$__.pathsToScopes[t]=r.$isDocumentArrayElement?r.__parentArray:r.$parent(),o[t]={skipSchemaValidators:!0},r.$isDocumentArrayElement&&null!=r.__index&&(o[t].index=r.__index))}}for(const t of i){const n=e.$__schema.path(t);if(n){if(n.$isMongooseDocumentArray)for(const e of i)(null==e||e.startsWith(n.path+"."))&&i.delete(e);(n.caster||0!==n.validators.length||n.$parentSchemaDocArray)&&(!n.$isMongooseArray||n.$isMongooseDocumentArray||n.$embeddedSchemaType.$isMongooseArray||0!==n.validators.length||0!==n.$embeddedSchemaType.validators.length)||i.delete(t)}}Array.isArray(t)?i=
/*!
		 * ignore
		 */
function(e,t){const n=new Set(t),r=new Map([]);for(const e of t){if(-1===e.indexOf("."))continue;const t=e.split(".");let n=t[0];for(let o=1;o<t.length;++o)r.set(n,e),n=n+"."+t[o]}const o=new Set;for(const t of e)n.has(t)?o.add(t):r.has(t)&&o.add(r.get(t));return o}
/*!
		 * ignore
		 */(i,t):Array.isArray(n)&&(i=function(e,t){return t=new Set(t),e=Array.from(e).filter((e=>!t.has(e))),new Set(e)}(i,n)),function(e,t){for(const n of t){const r=e.$__schema.path(n);if(!r)continue;if(!r.$isMongooseArray||!Array.isArray(r)&&r.$isMongooseDocumentArray&&!(r&&r.schemaOptions&&r.schemaOptions.required))continue;if(r.$isMongooseArray&&!r.$isMongooseDocumentArray&&!r.$embeddedSchemaType.$isMongooseArray&&0===r.$embeddedSchemaType.validators.length)continue;de(e.$__getValue(n),t,n)}}(e,i);const u={skipArrays:!0};for(const t of i)if(e.$__schema.nested[t]){let n=e.$__getValue(t);W(n)&&(n=n.toObject({transform:!1}));const r=w(n,t,u,e.$__schema);Object.keys(r).filter((t=>!e.$__schema.singleNestedPaths.hasOwnProperty(t))).forEach(s)}for(const t of i){const n=e.$__schema.path(t);if(!n)continue;if(n.$parentSchemaDocArray&&"string"==typeof n.$parentSchemaDocArray.path&&i.add(n.$parentSchemaDocArray.path),!n.$isSchemaMap)continue;const r=e.$__getValue(t);if(null!=r)for(const e of r.keys())i.add(t+"."+e)}return i=Array.from(i),[i,o]}function de(e,t,n){if(null!=e){const r=e.length;for(let o=0;o<r;++o)Array.isArray(e[o])?de(e[o],t,n+"."+o):t.add(n+"."+o)}}
/*!
		 * ignore
		 */
/*!
		 * Applies virtuals properties to `json`.
		 */
function fe(e,t,n,r){const o=e.$__schema,i=o.virtuals,s=Object.keys(i);let u=s.length;const a=u;let c,l,h,p=e._doc;const d="boolean"!=typeof(r&&r.aliases)||r.aliases;n=n||{};let f=null;if(Array.isArray(n.virtuals))f=new Set(n.virtuals);else if(n.virtuals&&n.virtuals.pathsToSkip){f=new Set(s);for(let e=0;e<n.virtuals.pathsToSkip.length;e++)f.has(n.virtuals.pathsToSkip[e])&&f.delete(n.virtuals.pathsToSkip[e])}if(!p)return t;for(u=0;u<a;++u){if(c=s[u],null!=f&&!f.has(c))continue;if(!d&&o.aliases.hasOwnProperty(c))continue;if(l=c,null!=n.path){if(!c.startsWith(n.path+"."))continue;l=c.substring(n.path.length+1)}if(-1===l.indexOf(".")&&l===c){if(h=i[c].applyGetters(void 0,e),void 0===h)continue;h=b(h,n),t[l]=h;continue}const r=l.split(".");if(h=b(e.get(c),n),void 0===h)continue;const a=r.length;p=t;for(let e=0;e<a-1;++e)p[r[e]]=p[r[e]]||{},p=p[r[e]];p[r[a-1]]=h}return t}function me(e,t){if(V(t))throw new Error("`transform` function must be synchronous, but the transform on path `"+e+"` returned a promise.")}
/*!
		 * ignore
		 */function ye(e,t,n){const r=e.$populated(t,!0);if(!r&&e.$__.selected){const n=t.split(".")[0];if(e.$__.selected[n+".$"])return n}if(!r||!U.isMongooseArray(n))return;if(r.options.match||r.options.options&&U.object.hasOwnProperty(r.options.options,"limit")||r.options.options&&r.options.options.skip||r.options.select&&(0===r.options.select._id||/\s?-_id\s?/.test(r.options.select))){const e=n[G];if(0===Object.keys(e).length||e.$set||e.$pop)return t}}function ge(e,t,n,r,o,i){if(i||(i="$set"),n[i]||(n[i]={}),n[i][r.path]=o,!1!==e.$__schema.options.versionKey&&!function(e,t){const n=e.$__schema.options.skipVersioning;return!!n&&(t=t.replace(/\.\d+\./,"."),n[t])}(e,r.path)&&3&~e.$__.version&&!e.$__schema.options.optimisticConcurrency){switch(i){case"$set":case"$unset":case"$pop":case"$pull":case"$pullAll":case"$push":case"$addToSet":case"$inc":break;default:return}"$push"===i||"$addToSet"===i||"$pullAll"===i||"$pull"===i?/\.\d+\.|\.\d+$/.test(r.path)?e.$__.version=3:e.$__.version=2:/^\$p/.test(i)||Array.isArray(o)?e.$__.version=3:/\.\d+\.|\.\d+$/.test(r.path)&&(e.$__.version=1)}}function Ee(e,t,n,r,o){if(n.$set&&n.$set[r.path])return;if("function"==typeof o.$__getAtomics)return void o.$__getAtomics().forEach((function(t){const o=t[0],i=t[1];ge(e,0,n,r,i,o)}));const i=o[G],s=Object.keys(i);let u,a,c=s.length;if(0===c)return U.isMongooseObject(o)?o=o.toObject({depopulate:1,_isNested:!0}):o.valueOf&&(o=o.valueOf()),ge(e,0,n,r,o);function l(e){return U.isMongooseObject(e)?e.toObject({depopulate:1,_isNested:!0}):e}for(;c--;)a=s[c],u=i[a],U.isMongooseObject(u)?u=u.toObject({depopulate:!0,transform:!1,_isNested:!0}):Array.isArray(u)?u=u.map(l):u.valueOf&&(u=u.valueOf()),"$addToSet"===a&&(u={$each:u}),ge(e,0,n,r,u,a)}ae.prototype.$__schema,ae.prototype.schema,Object.defineProperty(ae.prototype,"$locals",{configurable:!1,enumerable:!1,get:function(){return null==this.$__.locals&&(this.$__.locals={}),this.$__.locals},set:function(e){this.$__.locals=e}}),ae.prototype.isNew,Object.defineProperty(ae.prototype,"$where",{configurable:!1,enumerable:!1,writable:!0}),ae.prototype.id,ae.prototype.$errors,Object.defineProperty(ae.prototype,"$op",{get:function(){return this.$__.op||null},set:function(e){this.$__.op=e}}),ae.prototype.$__buildDoc=function(e,t,n,r,o){const i={},s=Object.keys(this.$__schema.paths).filter((e=>!e.includes("$*"))),u=s.length;let a=0;for(;a<u;++a){const u=s[a];if("_id"===u){if(n)continue;if(e&&"_id"in e)continue}const c=this.$__schema.paths[u].splitPath(),l=c.length,h=l-1;let p="",d=i,f=!1;for(let e=0;e<l;++e){const n=c[e];if(p.length?p+="."+n:p=n,!0===r){if(p in t)break}else if(!1===r&&t&&!f)if(p in t)f=!0;else if(!o[p])break;e<h&&(d=d[n]||(d[n]={}))}}this._doc=i},
/*!
		 * Converts to POJO when you use the document for querying
		 */
ae.prototype.toBSON=function(){return this.toObject(N)},ae.prototype.init=function(e,t,n){return"function"==typeof t&&(n=t,t=null),this.$__init(e,t),n&&n(null,this),this},ae.prototype.$init=function(){return this.constructor.prototype.init.apply(this,arguments)},ae.prototype.$__init=function(e,t){if(this.$isNew=!1,t=t||{},null!=e._id&&t.populated&&t.populated.length){const n=String(e._id);for(const r of t.populated)if(r.isVirtual?this.$populated(r.path,U.getValue(r.path,e),r):this.$populated(r.path,r._docs[n],r),null!=r._childDocs){for(const e of r._childDocs)null!=e&&null!=e.$__&&(e.$__.parent=this);r._childDocs=[]}}le(this,e,this._doc,t),I(this,t.populated),this.$emit("init",this),this.constructor.emit("init",this);const n=!1===this.$__.exclude&&this.$__.selected?g(this.$__.selected):null;return E(this,this.$__.selected,this.$__.exclude,n,!1,this.$__.skipDefaults),this},ae.prototype.updateOne=function(e,t,n){const r=this.constructor.updateOne({_id:this._doc._id},e,t),o=this;return r.pre((function(e){o.constructor._middleware.execPre("updateOne",o,[o],e)})),r.post((function(e){o.constructor._middleware.execPost("updateOne",o,[o],{},e)})),null!=this.$session()&&("session"in r.options||(r.options.session=this.$session())),null!=n?r.exec(n):r},ae.prototype.replaceOne=function(){const e=[...arguments];return e.unshift({_id:this._doc._id}),this.constructor.replaceOne.apply(this.constructor,e)},ae.prototype.$session=function(e){if(0===arguments.length)return null!=this.$__.session&&this.$__.session.hasEnded?(this.$__.session=null,null):this.$__.session;if(null!=e&&e.hasEnded)throw new u("Cannot set a document's session to a session that has ended. Make sure you haven't called `endSession()` on the session you are passing to `$session()`.");if(null!=e||null!=this.$__.session){if(this.$__.session=e,!this.$isSubdocument){const t=this.$getAllSubdocs();for(const n of t)n.$session(e)}return e}},ae.prototype.$timestamps=function(e){if(0===arguments.length)return null!=this.$__.timestamps?this.$__.timestamps:this.$__schema?this.$__schema.options.timestamps:void 0;return e!==this.$timestamps()&&(this.$__.timestamps=e),this},ae.prototype.overwrite=function(e){const t=Array.from(new Set(Object.keys(this._doc).concat(Object.keys(e))));for(const n of t)"_id"!==n&&(this.$__schema.options.versionKey&&n===this.$__schema.options.versionKey||this.$__schema.options.discriminatorKey&&n===this.$__schema.options.discriminatorKey||this.$set(n,e[n]));return this},ae.prototype.$set=function(e,t,n,r){U.isPOJO(n)&&(r=n,n=void 0);const o=r&&r.merge,i=n&&!0!==n,s=!0===n;let c,h,p,d,m,y=0;const g=r&&"strict"in r;let E=g?r.strict:this.$__.strictMode;if(i&&(c=this.$__.adhocPaths||(this.$__.adhocPaths={}),c[e]=this.$__schema.interpretAsType(e,n,this.$__schema.options)),null==e)[e,t]=[t,e];else if("string"!=typeof e){e instanceof ae&&(e=e.$__isNested?e.toObject():e.$__schema===this.$__schema?fe(e,{...e._doc}):e._doc),null==e&&([e,t]=[t,e]),m=t?t+".":"",h=v(this.$__schema,e);const o=h.length,i=r&&r._skipMinimizeTopLevel||!1;if(0===o&&i)return delete r._skipMinimizeTopLevel,t&&this.$set(t,{}),this;r=Object.assign({},r,{_skipMinimizeTopLevel:!1});for(let t=0;t<o;++t){d=h[t];const o=m?m+d:d;p=this.$__schema.pathType(o);const i=e[d];if(!0!==n||m||null==i||"nested"!==p||null==this._doc[d]||delete this._doc[d],U.isNonBuiltinObject(i)&&"nested"===p)this.$set(o,i,s,Object.assign({},r,{_skipMarkModified:!0})),ce(this.$get(o),o,this);else if(E){if(s&&void 0===i&&void 0!==this.$get(o))continue;if("adhocOrUndefined"===p&&(p=S(this,o,{typeOnly:!0})),"real"===p||"virtual"===p)this.$set(o,i,s,r);else if("nested"===p&&i instanceof ae)this.$set(o,i.toObject({transform:!1}),s,r);else{if("throw"===E)throw"nested"===p?new l(d,i):new f(d);"nested"===p&&null==i&&this.$set(o,i,s,r)}}else this.$set(o,i,s,r)}const u={},a=Object.keys(this.$__schema.tree);for(let e=0,t=a.length;e<t;++e)(d=a[e])&&this._doc.hasOwnProperty(d)&&(u[d]=void 0);return this._doc=Object.assign(u,this._doc),this}let b=this.$__schema.pathType(e),_=null;if("adhocOrUndefined"===b&&(_=-1===e.indexOf(".")?[e]:e.split("."),b=S(this,_,{typeOnly:!0})),"adhocOrUndefined"===b&&!g){null==_&&(_=-1===e.indexOf(".")?[e]:e.split("."));const t=D(this.$__schema,_);void 0!==t&&(E=t)}t=M(t,!0);const O=(()=>null!=this.$__.priorDoc?this.$__.priorDoc.$__getValue(e):s?void 0:this.$__getValue(e))();if("nested"===b&&t){if("object"==typeof t&&null!=t){if(null!=t.$__&&(t=t.toObject(N)),null==t)return this.invalidate(e,new u.CastError("Object",t,e)),this;const n=this.$isModified(e),i=null!=this.$__.savedState&&this.$__.savedState.hasOwnProperty(e);if(null!=this.$__.savedState&&!this.$isNew&&!this.$__.savedState.hasOwnProperty(e)){const t=this.$__getValue(e);this.$__.savedState[e]=t;const n=Object.keys(t||{});for(const r of n)this.$__.savedState[e+"."+r]=t[r]}if(o)return this.$set(t,e,s,r);this.$__setValue(e,null),A(this,e);const a=v(this.$__schema,t,e);this.$__setValue(e,{});for(const n of a)this.$set(e+"."+n,t[n],s,{...r,_skipMarkModified:!0});return null==O||n&&!i||!U.deepEqual(i?this.$__.savedState[e]:O,t)?this.markModified(e):this.unmarkModified(e),this}return this.invalidate(e,new u.CastError("Object",t,e)),this}let C;if(null==_&&(_=-1===e.indexOf(".")?[e]:e.split(".")),"string"==typeof this.$__schema.aliases[_[0]]&&(_[0]=this.$__schema.aliases[_[0]]),"adhocOrUndefined"===b&&E){let n;for(y=0;y<_.length;++y){const r=_.slice(0,y+1).join(".");if(y+1<_.length&&"virtual"===this.$__schema.pathType(r))return k.set(e,t,this),this;if(C=this.$__schema.path(r),null!=C){if(C instanceof a){n=!0;break}if(C.$isSchemaMap&&C.$__schemaType instanceof a&&y<_.length-1){n=!0,C=C.$__schemaType;break}}}if(null==C&&(C=S(this,e)),!n&&!C){if("throw"===E)throw new f(e);return this}}else{if("virtual"===b)return C=this.$__schema.virtualpath(e),C.applySetters(t,this),this;C=this.$__path(e)}let w,T=this._doc,B="";for(y=0;y<_.length-1;++y)T=T[_[y]],B+=(0!==B.length?".":"")+_[y],T||(this.$set(B,{}),this.$__isSelected(B)||this.unmarkModified(B),T=this.$__getValue(B));if(_.length<=1)w=e;else{const t=_.length;for(y=0;y<t;++y){const e=_.slice(0,y+1).join(".");if(null===this.$get(e,null,{getters:!1})){w=e;break}}w||(w=e)}if(!C)return this.$__set(w,e,r,s,_,C,t,O),"nested"===b&&null==t&&A(this,e),this;if((C.$isSingleNested||C.$isMongooseArray)&&
/*!
		 * ignore
		 */
function(e,t){if(!e.$__.validationError)return;const n=Object.keys(e.$__.validationError.errors);for(const r of n)r.startsWith(t+".")&&delete e.$__.validationError.errors[r];0===Object.keys(e.$__.validationError.errors).length&&(e.$__.validationError=null)}
/*!
		 * ignore
		 */(this,e),null!=t&&o&&C.$isSingleNested){t instanceof ae&&(t=t.toObject({virtuals:!1,transform:!1}));const n=Object.keys(t);for(const o of n)this.$set(e+"."+o,t[o],s,r);return this}let F=!0;try{const n=(()=>{if(null==C.options)return!1;if(!(t instanceof ae))return!1;const e=t.constructor,n="function"!=typeof C.options.ref||C.options.ref[X]?C.options.ref:C.options.ref.call(this,this),r=n?.modelName||n;if(null!=r&&(r===e.modelName||r===e.baseModelName))return!0;const o=C.options.refPath;if(null==o)return!1;const i=t.get(o);return i===e.modelName||i===e.baseModelName})();let o,i=!1;if(n&&t instanceof ae&&(!t.$__.wasPopulated||U.deepEqual(t.$__.wasPopulated.value,t._doc._id))){const n=C&&C.$isSingleNested?C.cast(t,this):t._doc._id;this.$populated(e,n,{[Z]:t.constructor}),t.$__.wasPopulated={value:n},i=!0}const s=this.$__schema.options.typeKey;if(C.options&&Array.isArray(C.options[s])&&C.options[s].length&&C.options[s][0]&&C.options[s][0].ref&&
/*!
		 * ignore
		 */
function(e,t){if(!Array.isArray(e))return!1;if(0===e.length)return!1;for(const n of e){if(!(n instanceof ae))return!1;if(null==n.constructor.modelName)return!1;if(n.constructor.modelName!=t&&n.constructor.baseModelName!=t)return!1}return!0}(t,C.options[s][0].ref)){o={[Z]:t[0].constructor},this.$populated(e,t.map((function(e){return e._doc._id})),o);for(const e of t)e.$__.wasPopulated={value:e._doc._id};i=!0}if(!n||!C.$isSingleNested||!t.$__){let n=this;null!=this.$__schema.singleNestedPaths[e]&&_.length>1&&(n=ne(this,_,this.schema)),t=null!=r&&r.overwriteImmutable?C.applySetters(t,n,!1,O,{overwriteImmutable:!0}):C.applySetters(t,n,!1,O)}if(Array.isArray(t)&&!Array.isArray(C)&&C.$isMongooseDocumentArray&&0!==t.length&&null!=t[0]&&null!=t[0].$__&&null!=t[0].$__.populated){const n=Object.keys(t[0].$__.populated);for(const r of n)this.$populated(e+"."+r,t.map((e=>e.$populated(r))),t[0].$__.populated[r].options);i=!0}if(!i&&this.$__.populated){if(Array.isArray(t)&&this.$__.populated[e])for(let e=0;e<t.length;++e)t[e]instanceof ae&&t.set(e,t[e]._doc._id,!0);delete this.$__.populated[e]}null!=t&&C.$isSingleNested&&function(e,t,n){const r=t.schema;if(null==r)return;for(const t of Object.keys(r.paths)){const o=r.paths[t];if(null==o.$immutableSetter)continue;const i=null==n?void 0:n.$__getValue(t);o.$immutableSetter.call(e,i)}}(t,C,O),this.$markValid(e)}catch(n){n instanceof u.StrictModeError&&n.isImmutableError?this.invalidate(e,n):n instanceof u.CastError?(this.invalidate(n.path,n),n.$originalErrorPath&&this.invalidate(e,new u.CastError(C.instance,t,e,n.$originalErrorPath))):this.invalidate(e,new u.CastError(C.instance,t,e,n)),F=!1}if(F){let n=null,o=null;if(!s){const t=this.$isSubdocument?this.ownerDocument():this;n=t.$__.savedState,o=this.$isSubdocument?this.$__.fullPath+"."+e:e,t.$__saveInitialState(o)}this.$__set(w,e,r,s,_,C,t,O);const i=!!this.$__.session?.transaction,u=this.$__.session&&this.$__.session[re]&&this.$__.session[re].has(this)&&this.$__.session[re].get(this).modifiedPaths&&!this.$__.session[re].get(this).modifiedPaths.has(o);null!=n&&n.hasOwnProperty(o)&&(!i||u)&&U.deepEqual(t,n[o])&&this.unmarkModified(e)}return C.$isSingleNested&&(this.isDirectModified(e)||null==t)&&A(this,e),this},ae.prototype.set=ae.prototype.$set,ae.prototype.$__shouldModify=function(e,t,n,r,o,i,s,u){return(!n||!n._skipMarkModified)&&(!!this.$isNew||(t in this.$__.activePaths.getStatePaths("modify")||(void 0===s&&!this.$__isSelected(t)||(void 0!==s||!(t in this.$__.activePaths.getStatePaths("default")))&&(!(this.$populated(t)&&s instanceof ae&&z(s._doc._id,u))&&(!z(s,void 0!==u?u:U.getValue(t,this))||!(r||null==s||!(t in this.$__.activePaths.getStatePaths("default"))||!z(s,i.getDefault(this,r))))))))},ae.prototype.$__set=function(e,t,n,r,o,i,s,u){se=se||id();const a=this.$__shouldModify(e,t,n,r,o,i,s,u);a?(this.$__.primitiveAtomics&&this.$__.primitiveAtomics[t]&&(delete this.$__.primitiveAtomics[t],0===Object.keys(this.$__.primitiveAtomics).length&&delete this.$__.primitiveAtomics),this.markModified(e),ie||(ie=nf()),s&&U.isMongooseArray(s)&&(s._registerAtomic("$set",s),U.isMongooseDocumentArray(s)&&s.forEach((function(e){e&&e.__parentArray&&(e.__parentArray=s)})))):Array.isArray(s)&&Array.isArray(u)&&U.isMongooseArray(s)&&U.isMongooseArray(u)&&(s[G]=u[G],s[q]=u[q],U.isMongooseDocumentArray(s)&&s.forEach((e=>{null!=e&&(e.$isNew=!1)})));let c=this._doc,l=0;const h=o.length;let p="";for(;l<h;l++){const e=l+1===h;if(p+=p?"."+o[l]:o[l],!ue.has(o[l]))if(e)c instanceof Map?c.set(o[l],s):c.$isSingleNested?(o[l]in c||(c[o[l]]=s),c._doc[o[l]]=s,a&&c.markModified(o[l])):c[o[l]]=s;else{const e=c instanceof Map;let t=e?c.get(o[l]):c[o[l]];U.isPOJO(t)||t&&t instanceof se||t&&!Array.isArray(t)&&t.$isSingleNested||t&&Array.isArray(t)?c=t:null==t?(t={},e?c.set(o[l],t):c[o[l]]=t,c=t):c=t}}},ae.prototype.$__getValue=function(e){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError(`Invalid \`path\`. Must be either string or array. Got "${e}" (type ${typeof e})`);return U.getValue(e,this._doc)},ae.prototype.$inc=function(e,t){if(null==t&&(t=1),Array.isArray(e))return e.forEach((e=>this.$inc(e,t))),this;const n=this.$__path(e);if(null==n){if("throw"===this.$__.strictMode)throw new f(e);if(!0===this.$__.strictMode)return this}else if("Number"!==n.instance)return this.invalidate(e,new u.CastError(n.instance,t,e)),this;const r=this.$__getValue(e)||0;let o=!1,i=null,s=t;try{t=n.cast(t),i=n.applySetters(r+t,this),s=i-r,o=!0}catch(n){this.invalidate(e,new u.CastError("number",t,e,n))}return o&&(this.$__.primitiveAtomics=this.$__.primitiveAtomics||{},null==this.$__.primitiveAtomics[e]?this.$__.primitiveAtomics[e]={$inc:s}:this.$__.primitiveAtomics[e].$inc+=s,this.markModified(e),this.$__setValue(e,i)),this},ae.prototype.$__setValue=function(e,t){return U.setValue(e,t,this._doc),this},ae.prototype.get=function(e,t,n){let r;null==n&&(n={}),t&&(r=this.$__schema.interpretAsType(e,t,this.$__schema.options));const o=n.noDottedPath;let i=o?this.$__schema.paths[e]:this.$__path(e);if(null==i&&(i=this.$__schema.virtualpath(e),null!=i))return i.applyGetters(void 0,this);if(o){let t=this._doc[e];return r&&(t=r.cast(t)),null!=i&&!1!==n.getters?i.applyGetters(t,this):t}if(null!=i&&"Mixed"===i.instance){const t=this.$__schema.virtualpath(e);null!=t&&(i=t)}const s=-1!==e.indexOf(".");let u=this._doc;const a=s?e.split("."):[e];"string"==typeof this.$__schema.aliases[a[0]]&&(a[0]=this.$__schema.aliases[a[0]]);for(let e=0,t=a.length;e<t;e++)u&&u._doc&&(u=u._doc),u=null==u?void 0:u instanceof Map?u.get(a[e],{getters:!1}):e===t-1?U.getValue(a[e],u):u[a[e]];if(r&&(u=r.cast(u)),null!=i&&!1!==n.getters)u=i.applyGetters(u,this);else if(this.$__schema.nested[e]&&n.virtuals)return fe(this,b(u)||{},{path:e});return u},
/*!
		 * ignore
		 */
ae.prototype[J]=ae.prototype.get,ae.prototype.$get=ae.prototype.get,ae.prototype.$__path=function(e){const t=this.$__.adhocPaths,n=t&&t.hasOwnProperty(e)?t[e]:null;return n||this.$__schema.path(e)},ae.prototype.markModified=function(e,t){this.$__saveInitialState(e),this.$__.activePaths.modify(e),null==t||this.$isSubdocument||(this.$__.pathsToScopes=this.$__pathsToScopes||{},this.$__.pathsToScopes[e]=t)},
/*!
		 * ignore
		 */
ae.prototype.$__saveInitialState=function(e){const t=this.$__.savedState,n=e;if(null!=t){const e=n.indexOf("."),r=-1===e?n:n.slice(0,e);t.hasOwnProperty(r)||(t[r]=b(this.$__getValue(r)))}},ae.prototype.unmarkModified=function(e){this.$__.activePaths.init(e),null!=this.$__.pathsToScopes&&delete this.$__.pathsToScopes[e]},ae.prototype.$ignore=function(e){this.$__.activePaths.ignore(e)},ae.prototype.directModifiedPaths=function(){return Object.keys(this.$__.activePaths.getStatePaths("modify"))},ae.prototype.$isEmpty=function(e){const t={minimize:!0,virtuals:!1,getters:!1,transform:!1};if(0!==arguments.length){const n=this.$get(e);return null==n||"object"==typeof n&&(U.isPOJO(n)?he(n):0===Object.keys(n.toObject(t)).length)}return 0===Object.keys(this.toObject(t)).length},ae.prototype.modifiedPaths=function(e){e=e||{};const t=Object.keys(this.$__.activePaths.getStatePaths("modify")),n=new Set;let r=0,o=0;const i=t.length;for(r=0;r<i;++r){const i=t[r],s=j(i),u=s.length;for(o=0;o<u;++o)n.add(s[o]);if(!e.includeChildren)continue;let a=0,c=this.$get(i);if("object"==typeof c&&null!==c){c._doc&&(c=c._doc);const e=c.length;if(Array.isArray(c))for(a=0;a<e;++a){const e=i+"."+a;if(!n.has(e)&&(n.add(e),null!=c[a]&&c[a].$__)){const t=c[a].modifiedPaths();let r=0;const o=t.length;for(r=0;r<o;++r)n.add(e+"."+t[r])}}else{const e=Object.keys(c);let t=0;const r=e.length;for(t=0;t<r;++t)n.add(i+"."+e[t])}}}return Array.from(n)},ae.prototype[Y]=ae.prototype.modifiedPaths,ae.prototype.isModified=function(e,t,n){if(e){const r=t&&t.ignoreAtomics,o=this.$__.activePaths.states.modify;if(null==o)return!1;"string"==typeof e&&(e=-1===e.indexOf(" ")?[e]:e.split(" "));for(const t of e)if(null!=o[t])return!0;const i=n||this[Y](),s=e.some((function(e){return!!~i.indexOf(e)}));let u=Object.keys(o);return r&&(u=u.filter((e=>{const t=this.$__getValue(e);return null==t||null==t[G]||void 0!==t[G].$set}))),s||e.some((function(e){return u.some((function(t){return t===e||e.startsWith(t+".")}))}))}return this.$__.activePaths.some("modify")},ae.prototype.$isModified=ae.prototype.isModified,ae.prototype[K]=ae.prototype.isModified,ae.prototype.$isDefault=function(e){if(null==e)return this.$__.activePaths.some("default");if("string"==typeof e&&-1===e.indexOf(" "))return this.$__.activePaths.getStatePaths("default").hasOwnProperty(e);let t=e;return Array.isArray(t)||(t=t.split(" ")),t.some((e=>this.$__.activePaths.getStatePaths("default").hasOwnProperty(e)))},ae.prototype.$isDeleted=function(e){return 0===arguments.length?!!this.$__.isDeleted:(this.$__.isDeleted=!!e,this)},ae.prototype.isDirectModified=function(e){if(null==e)return this.$__.activePaths.some("modify");if("string"==typeof e&&-1===e.indexOf(" ")){const t=this.$__.activePaths.getStatePaths("modify").hasOwnProperty(e);if(t||-1===e.indexOf("."))return t;const n=e.split(".");for(let e=0;e<n.length-1;++e){const t=n.slice(0,e+1).join("."),r=this.$get(t);if(null!=r&&null!=r.$__&&r.isDirectModified(n.slice(e+1).join(".")))return!0}return!1}let t=e;return"string"==typeof t&&(t=t.split(" ")),t.some((e=>this.isDirectModified(e)))},ae.prototype.isInit=function(e){if(null==e)return this.$__.activePaths.some("init");if("string"==typeof e&&-1===e.indexOf(" "))return this.$__.activePaths.getStatePaths("init").hasOwnProperty(e);let t=e;return Array.isArray(t)||(t=t.split(" ")),t.some((e=>this.$__.activePaths.getStatePaths("init").hasOwnProperty(e)))},ae.prototype.isSelected=function(e){if(null==this.$__.selected)return!0;if(!e)return!1;if("_id"===e)return 0!==this.$__.selected._id;if(-1!==e.indexOf(" ")&&(e=e.split(" ")),Array.isArray(e))return e.some((e=>this.$__isSelected(e)));const t=Object.keys(this.$__.selected);let n=null;if(1===t.length&&"_id"===t[0])return 0===this.$__.selected._id;for(const e of t)if("_id"!==e&&F(this.$__.selected[e])){n=!!this.$__.selected[e];break}if(null===n)return!0;if(e in this.$__.selected)return n;const r=e+".";for(const e of t)if("_id"!==e){if(e.startsWith(r))return n||e!==r;if(r.startsWith(e+"."))return n}return!n},ae.prototype.$__isSelected=ae.prototype.isSelected,ae.prototype.isDirectSelected=function(e){if(null==this.$__.selected)return!0;if("_id"===e)return 0!==this.$__.selected._id;if(-1!==e.indexOf(" ")&&(e=e.split(" ")),Array.isArray(e))return e.some((e=>this.isDirectSelected(e)));const t=Object.keys(this.$__.selected);let n=null;if(1===t.length&&"_id"===t[0])return 0===this.$__.selected._id;for(const e of t)if("_id"!==e&&F(this.$__.selected[e])){n=!!this.$__.selected[e];break}return null===n||(this.$__.selected.hasOwnProperty(e)?n:!n)},ae.prototype.validate=async function(e,t){if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new u("Document.prototype.validate() no longer accepts a callback");let n;if(this.$op="validate",1===arguments.length&&("object"!=typeof arguments[0]||Array.isArray(arguments[0])||(t=arguments[0],e=null)),t&&"string"==typeof t.pathsToSkip){const e=-1===t.pathsToSkip.indexOf(" ");t.pathsToSkip=e?[t.pathsToSkip]:t.pathsToSkip.split(" ")}const r=t&&t._skipParallelValidateCheck;if(null!=this.$isSubdocument||(this.$__.validating&&!r?n=new p(this,{parentStack:t&&t.parentStack,conflictStack:this.$__.validating.stack}):r||(this.$__.validating=new p(this,{parentStack:t&&t.parentStack}))),null!=n)throw n;return new Promise(((n,r)=>{this.$__validate(e,t,(e=>{if(this.$op=null,this.$__.validating=null,null!=e)return r(e);n()}))}))},ae.prototype.$validate=ae.prototype.validate,ae.prototype.$__validate=function(e,t,n){this.$__.saveOptions&&this.$__.saveOptions.pathsToSave&&!e?e=[...this.$__.saveOptions.pathsToSave]:"function"==typeof e?(n=e,t=null,e=null):"function"==typeof t&&(n=t,t=null);const r=t&&"object"==typeof t&&"validateModifiedOnly"in t,o=t&&t.pathsToSkip||null;let i;i=r?!!t.validateModifiedOnly:this.$__schema.options.validateModifiedOnly;const s=t&&t.validateAllPaths;if(s){if(o)throw new TypeError("Cannot set both `validateAllPaths` and `pathsToSkip`");if(e)throw new TypeError("Cannot set both `validateAllPaths` and `pathsToValidate`");if(r&&i)throw new TypeError("Cannot set both `validateAllPaths` and `validateModifiedOnly`")}const a=this,c=()=>{let e=this.$__.validationError;if(this.$__.validationError=null,this.$__.validating=null,i&&null!=e){const t=Object.keys(e.errors);for(const n of t)this.$isModified(n)||delete e.errors[n];0===Object.keys(e.errors).length&&(e=void 0)}if(this.$__.cachedRequired={},this.$emit("validate",a),this.constructor.emit("validate",a),e){for(const t in e.errors)!this[H]&&e.errors[t]instanceof u.CastError&&this.invalidate(t,e.errors[t]);return e}};let l,h;if(s){l=new Set(Object.keys(this.$__schema.paths));for(const e of l){const t=this.$__schema.path(e);if(!t||!t.$isMongooseArray)continue;const n=this.$__getValue(e);n&&de(n,l,e)}l=[...l],h={}}else{const n=pe(this,e,o,t&&t._nestedValidate);l=i?n[0].filter((e=>this.$isModified(e))):n[0],h=n[1]}if("string"==typeof e&&(e=e.split(" ")),0===l.length)return T((function(){const e=c();if(e)return a.$__schema.s.hooks.execPost("validate:error",a,[a],{error:e},(function(e){n(e)}));n(null,a)}));const p={};let d=0,f=this.$__.saveOptions?.pathsToSave;if(Array.isArray(f)){f=new Set(f);for(const e of l)f.has(e)&&y(e)}else for(const e of l)y(e);function y(e){null==e||p[e]||(p[e]=!0,d++,T((function(){const t=a.$__schema.path(e);if(!t)return--d||g();if(!a.$isValid(e))return void(--d||g());if(null!=t[te]&&e!==t.path)return--d||g();let n,r=a.$__getValue(e);(n=a.$populated(e))?r=n:null!=r&&null!=r.$__&&r.$__.wasPopulated&&(r=r._doc._id);const o=null!=a.$__.pathsToScopes&&e in a.$__.pathsToScopes?a.$__.pathsToScopes[e]:a,i={...h[e],path:e,validateAllPaths:s,_nestedValidate:!0};t.doValidate(r,(function(n){if(n){if((t.$isSingleNested||t.$isArraySubdocument||t.$isMongooseDocumentArray)&&n instanceof m)return--d||g();a.invalidate(e,n,void 0,!0)}--d||g()}),o,i)})))}function g(){const e=c();if(e)return a.$__schema.s.hooks.execPost("validate:error",a,[a],{error:e},(function(e){n(e)}));n(null,a)}},ae.prototype.validateSync=function(e,t){const n=this;1!==arguments.length||"object"!=typeof arguments[0]||Array.isArray(arguments[0])||(t=arguments[0],e=null);let r;r=t&&"object"==typeof t&&"validateModifiedOnly"in t?!!t.validateModifiedOnly:this.$__schema.options.validateModifiedOnly;let o=t&&t.pathsToSkip;const i=t&&t.validateAllPaths;if(i){if(o)throw new TypeError("Cannot set both `validateAllPaths` and `pathsToSkip`");if(e)throw new TypeError("Cannot set both `validateAllPaths` and `pathsToValidate`")}if("string"==typeof e){const t=-1===e.indexOf(" ");e=t?[e]:e.split(" ")}else"string"==typeof o&&-1!==o.indexOf(" ")&&(o=o.split(" "));let s,a;if(i){s=new Set(Object.keys(this.$__schema.paths));for(const e of s){const t=this.$__schema.path(e);if(!t||!t.$isMongooseArray)continue;const n=this.$__getValue(e);n&&de(n,s,e)}s=[...s],a={}}else{const t=pe(this,e,o);s=r?t[0].filter((e=>this.$isModified(e))):t[0],a=t[1]}const c={};for(let e=0,t=s.length;e<t;++e){const t=s[e];if(c[t])continue;c[t]=!0;const o=n.$__schema.path(t);if(!o)continue;if(!n.$isValid(t))continue;const u=n.$__getValue(t),l=o.doValidateSync(u,n,{skipSchemaValidators:a[t],path:t,validateModifiedOnly:r,validateAllPaths:i});if(l){if((o.$isSingleNested||o.$isArraySubdocument||o.$isMongooseDocumentArray)&&l instanceof m)continue;n.invalidate(t,l,void 0,!0)}}const l=n.$__.validationError;if(n.$__.validationError=void 0,n.$emit("validate",n),n.constructor.emit("validate",n),l)for(const e in l.errors)l.errors[e]instanceof u.CastError&&n.invalidate(e,l.errors[e]);return l},ae.prototype.invalidate=function(e,t,n,r){if(this.$__.validationError||(this.$__.validationError=new m(this)),!this.$__.validationError.errors[e])return t&&"string"!=typeof t||(t=new y({path:e,message:t,type:r||"user defined",value:n})),this.$__.validationError===t||this.$__.validationError.addError(e,t),this.$__.validationError},ae.prototype.$markValid=function(e){this.$__.validationError&&this.$__.validationError.errors[e]&&(delete this.$__.validationError.errors[e],0===Object.keys(this.$__.validationError.errors).length&&(this.$__.validationError=null))},ae.prototype.$isValid=function(e){return null==this.$__.validationError||0===Object.keys(this.$__.validationError.errors).length||null!=e&&(-1!==e.indexOf(" ")&&(e=e.split(" ")),Array.isArray(e)?e.some((e=>null==this.$__.validationError.errors[e])):null==this.$__.validationError.errors[e])},ae.prototype.$__reset=function(){let e=this;const t=this.$isSubdocument?null:this.$getAllSubdocs({useCache:!0});if(t&&t.length>0)for(const e of t)e.$__reset();return this.$__dirty().forEach((function(e){const t=e.value;t&&t[G]&&(t[q]=t[G],t[G]={})})),this.$__.backup={},this.$__.backup.activePaths={modify:Object.assign({},this.$__.activePaths.getStatePaths("modify")),default:Object.assign({},this.$__.activePaths.getStatePaths("default"))},this.$__.backup.validationError=this.$__.validationError,this.$__.backup.errors=this.$errors,this.$__.activePaths.clear("modify"),this.$__.activePaths.clear("default"),this.$__.validationError=void 0,this.$errors=void 0,e=this,this.$__schema.requiredPaths().forEach((function(t){e.$__.activePaths.require(t)})),this},
/*!
		 * ignore
		 */
ae.prototype.$__undoReset=function(){if(null!=this.$__.backup&&null!=this.$__.backup.activePaths){this.$__.activePaths.states.modify=this.$__.backup.activePaths.modify,this.$__.activePaths.states.default=this.$__.backup.activePaths.default,this.$__.validationError=this.$__.backup.validationError,this.$errors=this.$__.backup.errors;for(const e of this.$__dirty()){const t=e.value;t&&t[G]&&t[q]&&(t[G]=t[q])}if(!this.$isSubdocument)for(const e of this.$getAllSubdocs())e.$__undoReset()}},ae.prototype.$__dirty=function(){const e=this;let t=this.$__.activePaths.map("modify",(function(t){return{path:t,value:e.$__getValue(t),schema:e.$__path(t)}}));t=t.concat(this.$__.activePaths.map("default",(function(t){if("_id"!==t&&null!=e.$__getValue(t))return{path:t,value:e.$__getValue(t),schema:e.$__path(t)}})));const n=new Map(t.filter((e=>null!=e)).map((e=>[e.path,e.value]))),r=[];return t.forEach((function(e){if(!e)return;let t=null;const o=j(e.path);for(let e=0;e<o.length-1;e++)if(n.has(o[e])){t=n.get(o[e]);break}null==t?r.push(e):null!=t&&null!=t[G]&&t.hasAtomics()&&(t[G]={},t[G].$set=t)})),r},ae.prototype.$__setSchema=function(e){_(e.tree,this,void 0,e.options);for(const t of Object.keys(e.virtuals))e.virtuals[t]._applyDefaultGetters();null==e.path("schema")&&(this.schema=e),this.$__schema=e,this[Q]=e},ae.prototype.$__getArrayPathsToValidate=function(){return oe||(oe=of()),this.$__.activePaths.map("init","modify",function(e){return this.$__getValue(e)}.bind(this)).filter((function(e){return e&&Array.isArray(e)&&U.isMongooseDocumentArray(e)&&e.length})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return e}))},ae.prototype.$getAllSubdocs=function(e){if(e?.useCache&&this.$__.saveOptions?.__subdocs)return this.$__.saveOptions.__subdocs;oe||(oe=of()),se=se||id();const t=[];return function e(n){const r=[];for(const{model:e}of n.$__schema.childSchemas){const t=n.$__getValue(e.path);if(null!=t){if(t.$__&&r.push(t),Array.isArray(t))for(const e of t)null!=e&&e.$__&&r.push(e);if(t instanceof Map)for(const e of t.values())null!=e&&e.$__&&r.push(e)}}for(const t of r)e(t);t.push(...r)}(this),this.$__.saveOptions&&(this.$__.saveOptions.__subdocs=t),t},ae.prototype.$__handleReject=function(e){this.$listeners("error").length?this.$emit("error",e):this.constructor.listeners&&this.constructor.listeners("error").length&&this.constructor.emit("error",e)},ae.prototype.$toObject=function(e,t){const n=this.$__schema._defaultToObjectOptions(t),r=this.$__hasOnlyPrimitiveValues();let o;(e=U.isPOJO(e)?{...e}:{})._calledWithOptions=e._calledWithOptions||{...e},o=null!=e._calledWithOptions.minimize?e.minimize:null!=n&&null!=n.minimize?n.minimize:this.$__schema.options.minimize,e.minimize=o,r||(e._seen=e._seen||new Map);const i=e._calledWithOptions.depopulate??n?.depopulate??e.depopulate??!1;if(i&&e._isNested&&this.$__.wasPopulated)return b(this.$__.wasPopulated.value||this._doc._id,e);if(i&&(e.depopulate=!0),null!=n)for(const t of Object.keys(n))null==e[t]&&(e[t]=n[t]);e._isNested=!0,e.json=t,e.minimize=o;const s=e._parentOptions;e._parentOptions=this.$isSubdocument?e:null;const u=e._calledWithOptions.schemaFieldsOnly??e.schemaFieldsOnly??n.schemaFieldsOnly??!1;let a;if(r&&!e.flattenObjectIds)a=this.$__toObjectShallow(u);else if(u){a={};for(const t of Object.keys(this.$__schema.paths)){const n=this.$__getValue(t);if(void 0===n)continue;let r=t,o=a;if(-1!==t.indexOf(".")){const e=t.split(".");r=e[e.length-1];for(let t=0;t<e.length-1;++t)o[e[t]]=o[e[t]]??{},o=o[e[t]]}null!==n?o[r]=b(n,e):o[r]=null}}else a=b(this._doc,e)||{};const c=e._calledWithOptions.getters??e.getters??n.getters??!1;c&&(!function(e,t){const n=e.$__schema,r=Object.keys(n.paths);let o,i,s=r.length,u=e._doc;if(!u)return t;for(;s--;){o=r[s];const a=o.split("."),c=a.length,l=c-1;let h,p=t;if(u=e._doc,e.$__isSelected(o))for(let t=0;t<c&&(h=a[t],i=u[h],null==p||"object"==typeof p);++t){if(t===l){if(p[h]=n.paths[o].applyGetters(p[h],e),Array.isArray(p[h])&&n.paths[o].$embeddedSchemaType)for(let t=0;t<p[h].length;++t)p[h][t]=n.paths[o].$embeddedSchemaType.applyGetters(p[h][t],e)}else{if(null==i){h in u&&(p[h]=i);break}p=p[h]||(p[h]={})}u=i}}}(this,a),e.minimize&&(a=R(a)||{}));const l=e._calledWithOptions.virtuals??n.virtuals??s?.virtuals??void 0;(l||c&&!1!==l)&&fe(this,a,e,e),!1===e.versionKey&&this.$__schema.options.versionKey&&delete a[this.$__schema.options.versionKey];const h=e._calledWithOptions.transform??!0;let p;if(!0===h?p=n.transform:"function"==typeof h&&(p=h),h&&function(e,t){const n=e.$__schema,r=Object.keys(n.paths||{});if(!e._doc)return t;for(const o of r){const r=n.paths[o],i=r.options.transform??r.constructor?.defaultOptions?.transform,s=r.$embeddedSchemaType?.options?.transform??r.$embeddedSchemaType?.constructor?.defaultOptions?.transform;if("function"==typeof i){const n=e.$get(o);if(void 0===n)continue;const r=i.call(e,n);me(o,r),U.setValue(o,r,t)}else if("function"==typeof s){const n=e.$get(o);if(void 0===n)continue;const r=[].concat(n);for(let t=0;t<r.length;++t){const n=s.call(e,r[t]);r[t]=n,me(o,n)}t[o]=r}}}(this,a),e.useProjection&&function(e,t){const n=e.$__schema,r=Object.keys(n.paths||{});if(!e._doc)return t;let o=e.$__.selected;void 0===o&&(o={},L.applyPaths(o,n));if(null==o||0===Object.keys(o).length)return t;for(const e of r)null==o[e]||o[e]||delete t[e]}(this,a),"function"==typeof p){const t=p(this,a,e);void 0!==t&&(a=t)}return a},
/*!
		 * Internal shallow clone alternative to `$toObject()`: much faster, no options processing
		 */
ae.prototype.$__toObjectShallow=function(e){const t={};if(null!=this._doc){const n=e?Object.keys(this.$__schema.paths):Object.keys(this._doc);for(const e of n){const n=this._doc[e];n instanceof Date?t[e]=new Date(n):void 0!==n&&(t[e]=n)}}return t},ae.prototype.toObject=function(e){return this.$toObject(e)},ae.prototype.toJSON=function(e){return this.$toObject(e,!0)},
/*!
		 * ignore
		 */
ae.prototype.ownerDocument=function(){return this},ae.prototype.parent=function(){return this.$isSubdocument||this.$__.wasPopulated?this.$__.parent:this},ae.prototype.$parent=ae.prototype.parent,ae.prototype.inspect=function(e){let t;U.isPOJO(e)&&(t=e,t.minimize=!1);const n=arguments.length>0?this.toObject(t):this.toObject();return null==n?"MongooseDocument { "+n+" }":n},P.custom&&(ae.prototype[P.custom]=ae.prototype.inspect),ae.prototype.toString=function(){const e=this.inspect();return"string"==typeof e?e:P(e)},ae.prototype.equals=function(e){if(!e)return!1;const t=this.$__getValue("_id"),n=null!=e.$__?e.$__getValue("_id"):e;return t||n?t&&t.equals?t.equals(n):t===n:z(this,e)},ae.prototype.populate=async function(){const e={},t=[...arguments];if("function"==typeof t[t.length-1])throw new u("Document.prototype.populate() no longer accepts a callback");if(0!==t.length){const n=U.populate.apply(null,t);for(const t of n)e[t.path]=t}const n=U.object.vals(e);let r=this.constructor;if(this.$__isNested){r=this.$__[ee].constructor;const e=this.$__.nestedPath;n.forEach((function(t){t.path=e+"."+t.path}))}if(null!=this.$session()){const e=this.$session();n.forEach((t=>{null!=t.options?"session"in t.options||(t.options.session=e):t.options={session:e}}))}return n.forEach((e=>{e._localModel=r})),r.populate(this,n)},ae.prototype.$getPopulatedDocs=function(){let e=[];null!=this.$__.populated&&(e=e.concat(Object.keys(this.$__.populated)));let t=[];for(const n of e){const e=this.$get(n);Array.isArray(e)?t=t.concat(e):e instanceof ae&&t.push(e)}return t},ae.prototype.populated=function(e,t,n){if(null==t||!0===t){if(!this.$__.populated)return;if("string"!=typeof e)return;const n=e.endsWith(".$*")?e.replace(/\.\$\*$/,""):e,r=this.$__.populated[n];return r?!0===t?r:r.value:void 0}this.$__.populated||(this.$__.populated={}),this.$__.populated[e]={value:t,options:n};const r=e.split(".");for(let e=0;e<r.length-1;++e){const o=r.slice(0,e+1).join("."),i=this.$get(o);if(null!=i&&null!=i.$__&&this.$populated(o)){const o=r.slice(e+1).join(".");i.$populated(o,t,n);break}}return t},ae.prototype.$populated=ae.prototype.populated,ae.prototype.$assertPopulated=function(e,t){if(Array.isArray(e))return e.forEach((e=>this.$assertPopulated(e,t))),this;if(arguments.length>1&&this.$set(t),!this.$populated(e))throw new u(`Expected path "${e}" to be populated`);return this},ae.prototype.depopulate=function(e){let t;"string"==typeof e&&(e=-1===e.indexOf(" ")?[e]:e.split(" "));const n=this.$$populatedVirtuals?Object.keys(this.$$populatedVirtuals):[],r=this.$__&&this.$__.populated||{};if(0===arguments.length){for(const e of n)delete this.$$populatedVirtuals[e],delete this._doc[e],delete r[e];const e=Object.keys(r);for(const n of e)if(t=this.$populated(n),t)if(delete r[n],Array.isArray(t)){const e=U.getValue(n,this._doc);if(e.isMongooseArray){const t=e.__array;for(let e=0;e<t.length;++e){const n=t[e];null!=n&&(t[e]=n instanceof ae?n._doc._id:n._id)}}else U.setValue(n,t,this._doc)}else U.setValue(n,t,this._doc);return this}for(const o of e)if(t=this.$populated(o),delete r[o],-1!==n.indexOf(o))delete this.$$populatedVirtuals[o],delete this._doc[o];else if(t)if(Array.isArray(t)){const e=U.getValue(o,this._doc);if(e.isMongooseArray){const t=e.__array;for(let e=0;e<t.length;++e){const n=t[e];null!=n&&(t[e]=n instanceof ae?n._doc._id:n._id)}}else U.setValue(o,t,this._doc)}else U.setValue(o,t,this._doc);return this},ae.prototype.$__fullPath=function(e){return e||""},ae.prototype.getChanges=function(){const e=this.$__delta();return e?e[1]:{}},ae.prototype.$__delta=function(){const e=this.$__dirty(),t=this.$__schema.options.optimisticConcurrency;if(t)if(Array.isArray(t)){const n=new Set(t);this.modifiedPaths().find((e=>n.has(e)))&&(this.$__.version=e.length?3:1)}else this.$__.version=e.length?3:1;if(!e.length&&3!==this.$__.version)return;const n={},o={},i=e.length,u=[];let a=0;for(n._id=this._doc._id,null!=(n&&n._id&&n._id.$__||null)&&(n._id=n._id.toObject({transform:!1,depopulate:!0}));a<i;++a){const t=e[a];let r=t.value;const i=ye(this,t.path,r);if(i){u.push(i);continue}if(!this.$populated(t.path,!0)&&this.$__.selected){const e=t.path.split("."),r=e[0];if(this.$__.selected[r]&&this.$__.selected[r].$elemMatch){if(!(e.length>1&&0==e[1]&&void 0===n[r])){u.push(t.path);continue}n[r]=this.$__.selected[r],e[1]="$",t.path=e.join(".")}}if(this.$isDefault(t.path)&&this.$__.selected){if(-1===t.path.indexOf(".")&&x(this.$__.selected,t.path))continue;if(j(t.path).find((e=>x(this.$__.isSelected,e))))continue}if(!u.length)if(void 0===r)ge(this,n,o,t,1,"$unset");else if(null===r)ge(this,n,o,t,null);else if(U.isMongooseArray(r)&&r.$path()&&r[G])Ee(this,n,o,t,r);else if(r[s.pathSymbol]&&Buffer.isBuffer(r))r=r.toObject(),ge(this,n,o,t,r);else if(this.$__.primitiveAtomics&&null!=this.$__.primitiveAtomics[t.path]){const e=this.$__.primitiveAtomics[t.path],r=C(e);ge(this,n,o,t,e[r],r)}else r=b(r,{depopulate:!0,transform:!1,virtuals:!1,getters:!1,omitUndefined:!0,_isNested:!0}),ge(this,n,o,t,r)}return u.length?new r(u):(this.$__.version&&this.$__version(n,o),0===Object.keys(o).length?[n,null]:[n,o])},ae.prototype.$clone=function(){const e=new(0,this.constructor);if(e.$isNew=this.$isNew,this._doc&&(e._doc=b(this._doc,{retainDocuments:!0})),this.$__){const t=new(0,this.$__.constructor);for(const e of Object.getOwnPropertyNames(this.$__))"activePaths"!==e&&(t[e]=b(this.$__[e]));Object.assign(t.activePaths,b({...this.$__.activePaths})),e.$__=t}return e},ae.prototype.$createModifiedPathsSnapshot=function(){const e=new WeakMap;if(!this.$isSubdocument){const t=this.$getAllSubdocs();for(const n of t)e.set(n,n.$__.activePaths.clone())}return new c(e,this.$__.activePaths.clone(),this.$__.version)},ae.prototype.$restoreModifiedPathsSnapshot=function(e){if(this.$__.activePaths=e.activePaths.clone(),this.$__.version=e.version,!this.$isSubdocument){const t=this.$getAllSubdocs();for(const n of t)e.subdocSnapshot.has(n)&&(n.$__.activePaths=e.subdocSnapshot.get(n))}return this},ae.prototype.$clearModifiedPaths=function(){if(this.$__.activePaths.clear("modify"),this.$__.activePaths.clear("init"),this.$__.version=0,!this.$isSubdocument){const e=this.$getAllSubdocs();for(const t of e)t.$clearModifiedPaths()}return this},
/*!
		 * Check if the given document only has primitive values
		 */
ae.prototype.$__hasOnlyPrimitiveValues=function(){return!this.$__.populated&&!this.$__.wasPopulated&&(null==this._doc||Object.values(this._doc).every((e=>null==e||"object"!=typeof e||U.isNativeObject(e)&&!Array.isArray(e)||B(e,"ObjectId")||B(e,"Decimal128"))))},
/*!
		 * Module exports.
		 */
ae.VERSION_WHERE=1,ae.VERSION_INC=2,ae.VERSION_ALL=3,ae.ValidationError=m,e.exports=ae}(lh)),lh.exports}function uf(){return yd||(yd=1,function(e){
/*!
		 * Module dependencies.
		 */
const t=B().UUID,n=Rl(),r=Kl(),o=ba(),i=Yl(),s=oc(),u=ha(),a=Ha(),c=za(),l=nh(),h=Ga(),p=Ka(),d=qa(),f=Wa(),m=rh(),y=oh(),g=Ba(),{trustedSymbol:E}=rc();let A;e.specialProperties=g,e.isMongooseArray=c.isMongooseArray,e.isMongooseDocumentArray=l.isMongooseDocumentArray,e.registerMongooseArray=c.registerMongooseArray,e.registerMongooseDocumentArray=l.registerMongooseDocumentArray;const b=/\s/,_=/\s+/;e.toCollectionName=function(e,t){if("system.profile"===e)return e;if("system.indexes"===e)return e;if("function"==typeof t){if("string"!=typeof e)throw new TypeError("Collection name must be a string");if(0===e.length)throw new TypeError("Collection name cannot be empty");return t(e)}return e},e.deepEqual=function t(n,r){if(n===r)return!0;if("object"!=typeof n||"object"!=typeof r)return n===r;if(n instanceof Date&&r instanceof Date)return n.getTime()===r.getTime();if(h(n,"ObjectId")&&h(r,"ObjectId")||h(n,"Decimal128")&&h(r,"Decimal128"))return n.toString()===r.toString();if(n instanceof RegExp&&r instanceof RegExp)return n.source===r.source&&n.ignoreCase===r.ignoreCase&&n.multiline===r.multiline&&n.global===r.global&&n.dotAll===r.dotAll&&n.unicode===r.unicode&&n.sticky===r.sticky&&n.hasIndices===r.hasIndices;if(null==n||null==r)return!1;if(n.prototype!==r.prototype)return!1;if(n instanceof Map||r instanceof Map)return n instanceof Map&&r instanceof Map&&(t(Array.from(n.keys()),Array.from(r.keys()))&&t(Array.from(n.values()),Array.from(r.values())));if(n instanceof Number&&r instanceof Number)return n.valueOf()===r.valueOf();if(Buffer.isBuffer(n))return e.buffer.areEqual(n,r);if(Array.isArray(n)||Array.isArray(r)){if(!Array.isArray(n)||!Array.isArray(r))return!1;const e=n.length;if(e!==r.length)return!1;for(let o=0;o<e;++o)if(!t(n[o],r[o]))return!1;return!0}null!=n.$__?n=n._doc:f(n)&&(n=n.toObject()),null!=r.$__?r=r._doc:f(r)&&(r=r.toObject());const o=Object.keys(n),i=Object.keys(r),s=o.length;if(s!==i.length)return!1;for(let e=s-1;e>=0;e--)if(o[e]!==i[e])return!1;for(const e of o)if(!t(n[e],r[e]))return!1;return!0},e.last=function(e){if(e.length>0)return e[e.length-1]},
/*!
		 * ignore
		 */
e.promiseOrCallback=m,
/*!
		 * ignore
		 */
e.cloneArrays=function(t){return Array.isArray(t)?t.map((t=>e.cloneArrays(t))):t},
/*!
		 * ignore
		 */
e.omit=function(e,t){if(null==t)return Object.assign({},e);Array.isArray(t)||(t=[t]);const n=Object.assign({},e);for(const e of t)delete n[e];return n},e.merge=function t(n,r,i,s){i=i||{};const u=Object.keys(r);let a=0;const c=u.length;let l;r[E]&&(n[E]=r[E]),s=s||"";const d=i.omitNested||{};for(;a<c;)if(l=u[a++],!(i.omit&&i.omit[l]||d[s]||g.has(l)))if(null==n[l])p(r[l])?n[l]={...r[l]}:Array.isArray(r[l])?n[l]=[...r[l]]:n[l]=r[l];else if(e.isObject(r[l])){if(e.isObject(n[l])||(n[l]={}),null!=r[l]){if(i.isDiscriminatorSchemaMerge&&r[l].$isSingleNested&&n[l].$isMongooseDocumentArray||r[l].$isMongooseDocumentArray&&n[l].$isSingleNested)continue;if(r[l].instanceOfSchema){n[l].instanceOfSchema?y(n[l],r[l].clone(),i.isDiscriminatorSchemaMerge):n[l]=r[l].clone();continue}if(h(r[l],"ObjectId")){n[l]=new o(r[l]);continue}}t(n[l],r[l],i,s?s+"."+l:l)}else i.overwrite&&(n[l]=r[l]);return n},e.toObject=function t(n){let r;if(A||(A=sf()),null==n)return n;if(n instanceof A)return n.toObject();if(Array.isArray(n)){r=[];for(const e of n)r.push(t(e));return r}if(e.isPOJO(n)){r={},n[E]&&(r[E]=n[E]);for(const e of Object.keys(n))g.has(e)||(r[e]=t(n[e]));return r}return n},e.isObject=a,e.isPOJO=Ka(),e.isNonBuiltinObject=function(n){return!("object"!=typeof n||e.isNativeObject(n)||e.isMongooseType(n)||n instanceof t||null==n)},e.isNativeObject=function(e){return Array.isArray(e)||e instanceof Date||e instanceof Boolean||e instanceof Number||e instanceof String},e.isEmptyObject=function(e){return null!=e&&"object"==typeof e&&0===Object.keys(e).length},e.hasKey=function(t,n){const r=Object.keys(t);for(const o of r){if(o===n)return!0;if(e.isPOJO(t[o])&&e.hasKey(t[o],n))return!0}return!1},e.tick=function(e){if("function"==typeof e)return function(){try{e.apply(this,arguments)}catch(e){u((function(){throw e}))}}},e.isMongooseType=function(e){return h(e,"ObjectId")||h(e,"Decimal128")||e instanceof Buffer},e.isMongooseObject=f,e.expires=function(e){e&&"Object"===e.constructor.name&&"expires"in e&&(e.expireAfterSeconds="string"!=typeof e.expires?e.expires:Math.round(n(e.expires)/1e3),delete e.expires)},e.populate=function(t,n,r,o,u,a,c,l){let h=null;if(1===arguments.length){if(t instanceof i)return t._docs={},t._childDocs=[],[t];if(Array.isArray(t)){const n=function(e){const t=[];return e.forEach((function(e){if(b.test(e.path)){e.path.split(_).forEach((function(n){const r=Object.assign({},e);r.path=n,t.push(r)}))}else t.push(e)})),t}(t);return n.map((t=>e.populate(t)[0]))}h=e.isObject(t)?Object.assign({},t):{path:t}}else h="object"==typeof r?{path:t,select:n,match:r,options:o}:{path:t,select:n,model:r,match:o,options:u,populate:a,justOne:c,count:l};if(!("string"==typeof h.path||Array.isArray(h.path)&&h.path.every((e=>"string"==typeof e))))throw new TypeError("utils.populate: invalid path. Expected string or array of strings. Got typeof `"+typeof t+"`");return function(t){if(Array.isArray(t.populate)){const n=[];t.populate.forEach((function(t){if(b.test(t.path)){const r=Object.assign({},t);r.path.split(_).forEach((function(t){r.path=t,n.push(e.populate(r)[0])}))}else n.push(e.populate(t)[0])})),t.populate=e.populate(n)}else null!=t.populate&&"object"==typeof t.populate&&(t.populate=e.populate(t.populate));const n=[],r=b.test(t.path)?t.path.split(_):Array.isArray(t.path)?t.path:[t.path];null!=t.options&&(t.options=s(t.options));for(const e of r)n.push(new i(Object.assign({},t,{path:e})));return n}(h)},e.getValue=function(e,t,n){return r.get(e,t,C,n)};
/*!
		 * ignore
		 */
const O=Object.freeze({getters:!1});function C(e,t){if("$*"===t&&e instanceof Map)return e;let n=e?._doc||e;return null!=n&&n.isMongooseArrayProxy&&(n=n.__array),n instanceof Map?n.get(t,O):n[t]}e.setValue=function(e,t,n,o,i){r.set(e,t,n,"_doc",o,i)},e.object={},e.object.vals=function(e){const t=Object.keys(e);let n=t.length;const r=[];for(;n--;)r.push(e[t[n]]);return r};const w=Object.prototype.hasOwnProperty;e.object.hasOwnProperty=function(e,t){return w.call(e,t)},e.isNullOrUndefined=function(e){return null==e},
/*!
		 * ignore
		 */
e.array={},e.array.flatten=function e(t,n,r){return r||(r=[]),t.forEach((function(t){Array.isArray(t)?e(t,n,r):n&&!n(t)||r.push(t)})),r};
/*!
		 * ignore
		 */
const S=Object.prototype.hasOwnProperty;e.hasUserDefinedProperty=function(t,n){if(null==t)return!1;if(Array.isArray(n)){for(const r of n)if(e.hasUserDefinedProperty(t,r))return!0;return!1}if(S.call(t,n))return!0;if("object"==typeof t&&n in t){const e=t[n];return e!==Object.prototype[n]&&e!==Array.prototype[n]}return!1};
/*!
		 * ignore
		 */
const v=Math.pow(2,32)-1;e.isArrayIndex=function(e){return"number"==typeof e?e>=0&&e<=v:"string"==typeof e&&(!!/^\d+$/.test(e)&&((e=+e)>=0&&e<=v))},e.array.unique=function(e){const t=new Set,n=new Set,r=[];for(const o of e)if("number"==typeof o||"string"==typeof o||null==o){if(t.has(o))continue;r.push(o),t.add(o)}else if(h(o,"ObjectId")){if(n.has(o.toString()))continue;r.push(o),n.add(o.toString())}else r.push(o);return r},e.buffer={},e.buffer.areEqual=function(e,t){if(!Buffer.isBuffer(e))return!1;if(!Buffer.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0},e.getFunctionName=d,e.decorate=function(e,t){for(const n in t)g.has(n)||(e[n]=t[n])},e.mergeClone=function(t,n){f(n)&&(n=n.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1}));const r=Object.keys(n),o=r.length;let i,u=0;for(;u<o;)if(i=r[u++],!g.has(i))if(void 0===t[i])t[i]=s(n[i],{transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1});else{let r=n[i];if(null==r||!r.valueOf||r instanceof Date||(r=r.valueOf()),e.isObject(r)){let n=r;f(r)&&!r.isMongooseBuffer&&(n=n.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1})),r.isMongooseBuffer&&(n=Buffer.from(n)),e.mergeClone(t[i],n)}else t[i]=s(r,{flattenDecimals:!1})}},e.each=function(e,t){for(const n of e)t(n)},e.renameObjKey=function(e,t,n){return Object.keys(e).reduce(((r,o)=>(o===t?r[n]=e[t]:r[o]=e[o],r)),{})},
/*!
		 * ignore
		 */
e.getOption=function(e){const t=Array.prototype.slice.call(arguments,1);for(const n of t)if(null!=n&&null!=n[e])return n[e];return null},
/*!
		 * ignore
		 */
e.noop=function(){},e.errorToPOJO=function(e){if(!(e instanceof Error))throw new Error("`error` must be `instanceof Error`.");const t={};for(const n of Object.getOwnPropertyNames(e))t[n]=e[n];return t},
/*!
		 * ignore
		 */
e.warn=function(e){return process.emitWarning(e,{code:"MONGOOSE"})},e.injectTimestampsOption=function(e,t){null!=t&&(e.timestamps=t)}}(Il)),Il}function af(){return gd||(gd=1,function(e,t){
/*!
		 * Module dependencies.
		 */
const n=dl(),r=ml(),o=Tl(),i=Bl(),s=oc(),u=Fl(),a=$l(),c=xl(),l=ha(),h=Aa().schemaTypeSymbol,p=uf(),d=Aa().validatorErrorSymbol,f=Aa().documentIsModified,m=Aa().populateModelSymbol,y=n.CastError,g=n.ValidatorError,E={_skipMarkModified:!0};function A(e,t,n){this[h]=!0,this.path=e,this.instance=n,this.validators=[],this.getters=this.constructor.hasOwnProperty("getters")?this.constructor.getters.slice():[],this.setters=this.constructor.hasOwnProperty("setters")?this.constructor.setters.slice():[],this.splitPath(),t=t||{};const o=this.constructor.defaultOptions||{},i=Object.keys(o);for(const e of i)"validate"===e?this.validate(o.validate):o.hasOwnProperty(e)&&!Object.prototype.hasOwnProperty.call(t,e)&&(t[e]=o[e]);null==t.select&&delete t.select;const s=this.OptionsConstructor||r;this.options=new s(t),this._index=null,p.hasUserDefinedProperty(this.options,"immutable")&&(this.$immutable=this.options.immutable,u(this));const a=Object.keys(this.options);for(const e of a)if("cast"!==e){if(p.hasUserDefinedProperty(this.options,e)&&"function"==typeof this[e]){if("index"===e&&this._index){if(!1===t.index){const e=this._index;if("object"==typeof e&&null!=e){if(e.unique)throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true');if(e.sparse)throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}this._index=!1}continue}const n=t[e];if("default"===e){this.default(n);continue}const r=Array.isArray(n)?n:[n];this[e].apply(this,r)}}else Array.isArray(this.options[e])?this.castFunction.apply(this,this.options[e]):this.castFunction(this.options[e]);Object.defineProperty(this,"$$context",{enumerable:!1,configurable:!1,writable:!0,value:null})}function b(e,t){if(void 0!==e&&!e){const e=new(t.ErrorConstructor||g)(t);return e[d]=!0,e}}
/*!
		 * ignore
		 */
function _(e,t){return this.castForQuery(null,e,t)}
/*!
		 * ignore
		 */function O(e,t){const n=this;return Array.isArray(e)?e.map((function(e){return Array.isArray(e)&&0===e.length?e:n.castForQuery(null,e,t)})):[this.castForQuery(null,e,t)]}
/*!
		 * ignore
		 */A.prototype.OptionsConstructor=r,A.prototype.path,A.prototype.validators,A.prototype.isRequired,A.prototype.splitPath=function(){return null!=this._presplitPath?this._presplitPath:null!=this.path?(this._presplitPath=-1===this.path.indexOf(".")?[this.path]:this.path.split("."),this._presplitPath):void 0},A.cast=function(e){return 0===arguments.length||(!1===e&&(e=e=>e),this._cast=e),this._cast},A.prototype.castFunction=function(e,t){return 0===arguments.length?this._castFunction:(!1===e&&(e=this.constructor._defaultCaster||(e=>e)),"string"==typeof e?(this._castErrorMessage=e,this._castFunction):(null!=e&&(this._castFunction=e),null!=t&&(this._castErrorMessage=t),this._castFunction))},A.prototype.cast=function(){throw new Error("Base SchemaType class does not implement a `cast()` function")},A.set=function(e,t){this.hasOwnProperty("defaultOptions")||(this.defaultOptions=Object.assign({},this.defaultOptions)),this.defaultOptions[e]=t},A.get=function(e){this.getters=this.hasOwnProperty("getters")?this.getters:[],this.getters.push(e)},A.prototype.default=function(e){if(1===arguments.length){if(void 0===e)return void(this.defaultValue=void 0);if(null!=e&&e.instanceOfSchema)throw new n("Cannot set default value of path `"+this.path+"` to a mongoose Schema instance.");return this.defaultValue=e,this.defaultValue}return arguments.length>1&&(this.defaultValue=[...arguments]),this.defaultValue},A.prototype.index=function(e){return this._index=e,p.expires(this._index),this},A.prototype.unique=function(e,t){if(!1===this._index){if(!e)return;throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true')}return this.options.hasOwnProperty("index")||!1!==e?(null==this._index||!0===this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.unique=!!e,"string"==typeof t&&(this._duplicateKeyErrorMessage=t),this):this},A.prototype.text=function(e){if(!1===this._index){if(!e)return this;throw new Error('Path "'+this.path+'" may not have `index` set to false and `text` set to true')}return this.options.hasOwnProperty("index")||!1!==e?(null===this._index||void 0===this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.text=e,this):this},A.prototype.sparse=function(e){if(!1===this._index){if(!e)return this;throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}return this.options.hasOwnProperty("index")||!1!==e?(null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.sparse=e,this):this},A.prototype.immutable=function(e){return this.$immutable=e,u(this),this},A.prototype.transform=function(e){return this.options.transform=e,this},A.prototype.set=function(e){if("function"!=typeof e)throw new TypeError("A setter must be a function.");return this.setters.push(e),this},A.prototype.get=function(e){if("function"!=typeof e)throw new TypeError("A getter must be a function.");return this.getters.push(e),this},A.prototype.validateAll=function(e){for(let t=0;t<e.length;t++)this.validate(e[t]);return this},A.prototype.validate=function(e,t,r){if("function"==typeof e||e&&"RegExp"===p.getFunctionName(e.constructor)){let o;return"function"==typeof t?(o={validator:e,message:t},o.type=r||"user defined"):t instanceof Object&&!r?(o=c(t)?Object.assign({},t):s(t),o.message||(o.message=o.msg),o.validator=e,o.type=o.type||"user defined"):(null==t&&(t=n.messages.general.default),r||(r="user defined"),o={message:t,type:r,validator:e}),this.validators.push(o),this}let o,i,u;for(o=0,i=arguments.length;o<i;o++){if(u=arguments[o],!p.isPOJO(u)){throw new Error("Invalid validator. Received ("+typeof u+") "+u+". See https://mongoosejs.com/docs/api/schematype.html#SchemaType.prototype.validate()")}this.validate(u.validator,u)}return this},A.prototype.required=function(e,t){let r={};if(arguments.length>0&&null==e)return this.validators=this.validators.filter((function(e){return e.validator!==this.requiredValidator}),this),this.isRequired=!1,delete this.originalRequiredValue,this;if("object"==typeof e&&(r=e,t=r.message||t,e=e.isRequired),!1===e)return this.validators=this.validators.filter((function(e){return e.validator!==this.requiredValidator}),this),this.isRequired=!1,delete this.originalRequiredValue,this;const o=this;this.isRequired=!0,this.requiredValidator=function(t){const n=this&&this.$__&&this.$__.cachedRequired;if(null!=n&&!this.$__isSelected(o.path)&&!this[f](o.path))return!0;if(null!=n&&o.path in n){const e=!n[o.path]||o.checkRequired(t,this);return delete n[o.path],e}return"function"==typeof e&&!e.apply(this)||o.checkRequired(t,this)},this.originalRequiredValue=e,"string"==typeof e&&(t=e,e=void 0);const i=t||n.messages.general.required;return this.validators.unshift(Object.assign({},r,{validator:this.requiredValidator,message:i,type:"required"})),this},A.prototype.ref=function(e){return this.options.ref=e,this},A.prototype.getDefault=function(e,t,n){let r;if(r="function"==typeof this.defaultValue?this.defaultValue===Date.now||this.defaultValue===Array||"objectid"===this.defaultValue.name.toLowerCase()?this.defaultValue.call(e):this.defaultValue.call(e,e):this.defaultValue,null!=r){if("object"!=typeof r||this.options&&this.options.shared||(r=s(r)),n&&n.skipCast)return this._applySetters(r,e);const o=this.applySetters(r,e,t,void 0,E);return o&&!Array.isArray(o)&&o.$isSingleNested&&(o.$__parent=e),o}return r},A.prototype._applySetters=function(e,t,n,r,o){let i=e;if(n)return i;const s=this.setters;for(let e=s.length-1;e>=0;e--)i=s[e].call(t,i,r,this,o);return i},
/*!
		 * ignore
		 */
A.prototype._castNullish=function(e){return e},A.prototype.applySetters=function(e,t,n,r,o){let i=this._applySetters(e,t,n,r,o);return null==i?this._castNullish(i):(i=this.cast(i,t,n,r,o),i)},A.prototype.applyGetters=function(e,t){let n=e;const r=this.getters,o=r.length;if(0===o)return n;for(let e=0;e<o;++e)n=r[e].call(t,n,this);return n},A.prototype.select=function(e){return this.selected=!!e,this},A.prototype.doValidate=function(e,t,n,r){let o=!1;const i=this.path;if("function"!=typeof t)throw new TypeError("Must pass callback function to doValidate(), got "+typeof t);const u=this.validators.filter((e=>"object"==typeof e&&null!==e));let a=u.length;if(!a)return t(null);for(let t=0,a=u.length;t<a&&!o;++t){const o=u[t],a=o.validator;let l;const p=c(o)?Object.assign({},o):s(o);if(p.path=r&&r.path?r.path:i,p.fullPath=this.$fullPath,p.value=e,a instanceof RegExp)h(a.test(e),p,n);else if("function"==typeof a)if(void 0!==e||a===this.requiredValidator){try{l=p.propsParameter?a.call(n,e,p):a.call(n,e)}catch(e){l=!1,p.reason=e,e.message&&(p.message=e.message)}null!=l&&"function"==typeof l.then?l.then((function(e){h(e,p,n)}),(function(e){p.reason=e,p.message=e.message,l=!1,h(l,p,n)})):h(l,p,n)}else h(!0,p,n)}function h(e,n,r){if(!o)if(void 0===e||e)--a<=0&&l((function(){t(null)}));else{const e=n.ErrorConstructor||g;o=new e(n,r),o[d]=!0,l((function(){t(o)}))}}},A.prototype.doValidateSync=function(e,t,n){const r=this.path;if(!this.validators.length)return null;let o=this.validators;if(void 0===e){if(0===this.validators.length||"required"!==this.validators[0].type)return null;o=[this.validators[0]]}let i=null,u=0;const l=o.length;for(u=0;u<l;++u){const l=o[u];if(null===l||"object"!=typeof l)continue;const h=l.validator,p=c(l)?Object.assign({},l):s(l);p.path=n&&n.path?n.path:r,p.fullPath=this.$fullPath,p.value=e;let d=!1;if(!a(h))if(h instanceof RegExp)i=b(h.test(e),p);else if("function"==typeof h){try{d=p.propsParameter?h.call(t,e,p):h.call(t,e)}catch(e){d=!1,p.reason=e}if((null==d||"function"!=typeof d.then)&&(i=b(d,p),i))break}}return i},A._isRef=function(e,t,n,r){let o=r&&e.options&&(e.options.ref||e.options.refPath);if(!o&&n&&null!=n.$__){const t=n.$__fullPath(e.path,!0),r=n.ownerDocument();o=null!=t&&r.$populated(t)||n.$populated(e.path)}return!!o&&(null==t||(!(Buffer.isBuffer(t)||"Binary"===t._bsontype||!p.isObject(t))||r))},
/*!
		 * ignore
		 */
A.prototype._castRef=function(e,t,n,r){if(null==e)return e;if(null!=e.$__)return e.$__.wasPopulated=e.$__.wasPopulated||{value:e._doc._id},e;if(Buffer.isBuffer(e)||!p.isObject(e)){if(n)return e;throw new y(this.instance,e,this.path,null,this)}const o=t.$__fullPath(this.path,!0),i=t.ownerDocument().$populated(o,!0);let s=e;if(!(t.$__.populated&&t.$__.populated[o]&&t.$__.populated[o].options&&t.$__.populated[o].options.options&&t.$__.populated[o].options.options.lean)){const n=i?i.options[m]:t.constructor.db.model(this.options.ref);s=n.hydrate(e,null,r),s.$__.wasPopulated={value:s._doc._id,options:{[m]:n}}}return s},A.prototype.$conditionalHandlers={$all:function(e,t){const n=this;return Array.isArray(e)?e.map((function(e){return n.castForQuery(null,e,t)})):[this.castForQuery(null,e,t)]},$eq:_,$in:O,$ne:_,$nin:O,$exists:o,$type:i},A.prototype.castForQuery=function(e,t,n){let r;if(null!=e){if(r=this.$conditionalHandlers[e],!r)throw new Error("Can't use "+e);return r.call(this,t,n)}try{return this.applySetters(t,n)}catch(e){throw e instanceof y&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}},A.checkRequired=function(e){return 0!==arguments.length&&(this._checkRequired=e),this._checkRequired},A.prototype.checkRequired=function(e){return null!=e},A.prototype.clone=function(){const e=Object.assign({},this.options),t=new this.constructor(this.path,e,this.instance);return t.validators=this.validators.slice(),void 0!==this.requiredValidator&&(t.requiredValidator=this.requiredValidator),void 0!==this.defaultValue&&(t.defaultValue=this.defaultValue),void 0!==this.$immutable&&void 0===this.options.immutable&&(t.$immutable=this.$immutable,u(t)),void 0!==this._index&&(t._index=this._index),void 0!==this.selected&&(t.selected=this.selected),void 0!==this.isRequired&&(t.isRequired=this.isRequired),void 0!==this.originalRequiredValue&&(t.originalRequiredValue=this.originalRequiredValue),t.getters=this.getters.slice(),t.setters=this.setters.slice(),t},A.prototype.getEmbeddedSchemaType=function(){return this.$embeddedSchemaType},
/*!
		 * If _duplicateKeyErrorMessage is a string, replace unique index errors "E11000 duplicate key error" with this string.
		 *
		 * @api private
		 */
A.prototype._duplicateKeyErrorMessage=null,A.prototype.toJSONSchema=function(){throw new Error("Converting unsupported SchemaType to JSON Schema: "+this.instance)},
/*!
		 * Module exports.
		 */
e.exports=t=A,t.CastError=y,t.ValidatorError=g}(Yc,Yc.exports)),Yc.exports}function cf(){if(Ad)return Ed;Ad=1;const e=fl();class t{constructor(e){Object.assign(this,e),null!=e&&null!=e.options&&(this.options=Object.assign({},e.options))}}return Object.defineProperty(t.prototype,"ref",e),Object.defineProperty(t.prototype,"refPath",e),Object.defineProperty(t.prototype,"localField",e),Object.defineProperty(t.prototype,"foreignField",e),Object.defineProperty(t.prototype,"justOne",e),Object.defineProperty(t.prototype,"count",e),Object.defineProperty(t.prototype,"match",e),Object.defineProperty(t.prototype,"options",e),Object.defineProperty(t.prototype,"skip",e),Object.defineProperty(t.prototype,"limit",e),Object.defineProperty(t.prototype,"perDocumentLimit",e),Ed=t}function lf(){return _d||(_d=1,bd=function(e,t,n){if(null==e)return e;if(null!=e._doc&&(e=e._doc),arguments.length>=3){if("object"!=typeof e)return;if(void 0===n)return;return e instanceof Map?e.set(t,n):e[t]=n,n}return"$*"===t?e instanceof Map?Array.from(e.values()):Object.keys(e).map((t=>e[t])):e instanceof Map?e.get(t):e[t]}),bd}function hf(){if(Cd)return Od;Cd=1;const e=pa(),t=$p(),r=lf(),o=Kl(),i=n,s=uf(),u=/(\.\d+$|\.\d+\.)/g;return Od=function(n,a,c,l,h){if(null==n)return[];if("string"==typeof n&&null!=h&&t(h,n))throw new e("refPath `"+n+"` must not be excluded in projection, got "+i.inspect(h));if(u.test(c)){const e=c.split(u);if(""===e[e.length-1])throw new Error("Can't populate individual element in an array");let t="",i=n;for(let n=0;n<e.length;n+=2){const r=e[n];if(!i.startsWith(r+".")){if(n===e.length-1){t+=i,i="";break}throw new Error("Could not normalize ref path, chunk "+r+" not in populated path")}t+=i.substring(0,r.length)+e[n+1],i=i.substring(r.length+1)}const l=o.get(t,a,r);let h=Array.isArray(l)?l:[l];return h=s.array.flatten(h),h}const p=o.get(n,a,r);let d;return d=null!=l&&l.virtuals.hasOwnProperty(n)?[l.virtuals[n].applyGetters(void 0,a)]:Array.isArray(p)?p:[p],d}}function pf(){if(Sd)return wd;Sd=1;const e=hf(),t=uf(),n=Aa().modelSymbol;function r(e,t){this.path=t,this.getters=[],this.setters=[],this.options=Object.assign({},e)}return r.prototype._applyDefaultGetters=function(){if(this.getters.length>0||this.setters.length>0)return;const e="$"+this.path;this.getters.push((function(){return this.$locals[e]})),this.setters.push((function(t){this.$locals[e]=t}))},
/*!
	 * ignore
	 */
r.prototype.clone=function(){const e=new r(this.options,this.path);return e.getters=[].concat(this.getters),e.setters=[].concat(this.setters),e},r.prototype.get=function(e){return this.getters.push(e),this},r.prototype.set=function(e){return this.setters.push(e),this},r.prototype.applyGetters=function(e,n){t.hasUserDefinedProperty(this.options,["ref","refPath"])&&n.$$populatedVirtuals&&n.$$populatedVirtuals.hasOwnProperty(this.path)&&(e=n.$$populatedVirtuals[this.path]);let r=e;for(const e of this.getters)r=e.call(n,r,this,n);return r},r.prototype.applySetters=function(e,t){let n=e;for(const e of this.setters)n=e.call(t,n,this,t);return n},r.prototype._getModelNamesForPopulate=function(t){if(this.options.refPath)return e(this.options.refPath,t,this.path);let r=null;return r="function"!=typeof this.options.ref||this.options.ref[n]?this.options.ref:this.options.ref.call(t,t),null==r||Array.isArray(r)?r:[r]},
/*!
	 * exports
	 */
wd=r}function df(){return Dd||(Dd=1,vd=function(e){const t={_id:{auto:!0}};t._id[e.options.typeKey]="ObjectId",e.add(t)}),vd}function ff(){return Td||(Td=1,Md=function(e,t){const n=e.discriminatorMapping&&e.discriminatorMapping.value;if(n&&!("sparse"in t)){const r=e.options.discriminatorKey;t.partialFilterExpression=t.partialFilterExpression||{},t.partialFilterExpression[r]=n}return t}),Md}function mf(){if(Fd)return Bd;Fd=1;const e=wp(),t=Ha(),n=ff();return Bd=function(r){let o=[];const i=new WeakMap,s=r.constructor.indexTypes,u=new Map;return function r(a,c,l){if(i.has(a))return;i.set(a,!0),c=c||"";const h=Object.keys(a.paths);for(const n of h){const i=a.paths[n];if(null!=l&&l.paths[n])continue;if(null!=i._duplicateKeyErrorMessage&&(a._duplicateKeyErrorMessagesByPath=a._duplicateKeyErrorMessagesByPath||{},a._duplicateKeyErrorMessagesByPath[n]=i._duplicateKeyErrorMessage),i.$isMongooseDocumentArray||i.$isSingleNested){if(!0!==e(i,"options.excludeIndexes")&&!0!==e(i,"schemaOptions.excludeIndexes")&&!0!==e(i,"schema.options.excludeIndexes")&&r(i.schema,c+n+"."),null!=i.schema.discriminators){const e=i.schema.discriminators,t=Object.keys(e);for(const o of t)r(e[o],c+n+".",i.schema)}if(i.$isMongooseDocumentArray)continue}const h=i._index||i.caster&&i.caster._index;if(!1!==h&&null!=h){const e={},r=t(h),i=r?h:{},l="string"==typeof h?h:!!r&&h.type;if(l&&-1!==s.indexOf(l))e[c+n]=l;else if(i.text)e[c+n]="text",delete i.text;else{let t=!1;t="descending"===h||"desc"===h||"ascending"!==h&&"asc"!==h&&-1===Number(h),e[c+n]=t?-1:1}delete i.type,"background"in i||(i.background=!0),null!=a.options.autoIndex&&(i._autoIndex=a.options.autoIndex);const p=i&&i.name;"string"==typeof p&&u.has(p)?Object.assign(u.get(p),e):(o.push([e,i]),u.set(p,e))}}i.delete(a),c?function(e,t){const n=e._indexes,r=n.length;for(let e=0;e<r;++e){const r=n[e][0],i=n[e][1],s=Object.keys(r),u=s.length,a={};for(let e=0;e<u;++e){const n=s[e];a[t+n]=r[n]}const c=Object.assign({},i);if(null!=i&&null!=i.partialFilterExpression){c.partialFilterExpression={};const e=i.partialFilterExpression;for(const n of Object.keys(e))c.partialFilterExpression[t+n]=e[n]}o.push([a,c])}}(a,c):(a._indexes.forEach((function(e){const t=e[1];"background"in t||(t.background=!0),n(a,t)})),o=o.concat(a._indexes))}(r),o},Bd}function yf(){return xd?$d:(xd=1,$d=function(e){switch(e){case"p":e="primary";break;case"pp":e="primaryPreferred";break;case"s":e="secondary";break;case"sp":e="secondaryPreferred";break;case"n":e="nearest"}return e})}function gf(){return Rd?Id:(Rd=1,Id=function(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++){const i=n[o];if(i!==r[o]||e[i]!==t[i])return!1}return!0})}function Ef(){return jd||(jd=1,kd=function(e,t,n,r){return r.justOne||r.count?(e[t]=Array.isArray(n)?n[0]:n,"object"!=typeof e[t]&&(e[t]=r.count?n:null)):(e[t]=Array.isArray(n)?n:null==n?[]:[n],e[t]=e[t].filter((function(e){return e&&"object"==typeof e}))),e[t]}),kd}function Af(){return Ud?Ld:(Ud=1,Ld=function(e){return e.replace(/\.\$(\[[^\]]*\])?(?=\.)/g,".0").replace(/\.\$(\[[^\]]*\])?$/g,".0")})}function bf(){if(zd)return Vd;return zd=1,Vd=
/*!
	 * ignore
	 */
function(e,t){if(null==e)return null;if("boolean"==typeof e)return t;if("boolean"==typeof e[t])return e[t]?t:null;if(!(t in e))return t;return e[t]}}function _f(){if(qd)return Wd;qd=1;const e=Af(),t=bf();
/*!
	 * ignore
	 */
function n(e,o,i){if(null==o)return;if(Object.keys(o).some((e=>"$"===e[0]))){if(o.$push&&u(o.$push),o.$addToSet&&u(o.$addToSet),null!=o.$set){const t=Object.keys(o.$set);for(const n of t)r(i,n,o.$set,e)}if(null!=o.$setOnInsert){const t=Object.keys(o.$setOnInsert);for(const n of t)r(i,n,o.$setOnInsert,e)}}const s=Object.keys(o).filter((e=>"$"!==e[0]));for(const t of s)r(i,t,o,e);function u(r){for(const o of Object.keys(r)){const s=i.path(o.replace(/\.\$\./i,".").replace(/.\$$/,""));if(r[o]&&s&&s.$isMongooseDocumentArray&&s.schema.options.timestamps){const i=s.schema.options.timestamps,u=t(i,"createdAt"),a=t(i,"updatedAt");r[o].$each?r[o].$each.forEach((function(t){null!=a&&(t[a]=e),null!=u&&(t[u]=e),n(e,t,s.schema)})):(null!=a&&(r[o][a]=e),null!=u&&(r[o][u]=e),n(e,r[o],s.schema))}}}}function r(r,o,i,s){const u=e(o),a=r.path(u);if(!a)return;const c=[],l=u.split(".");for(let e=l.length-1;e>0;--e){const t=r.path(l.slice(0,e).join("."));null!=t&&(t.$isMongooseDocumentArray||t.$isSingleNested)&&c.push({parentPath:o.split(".").slice(0,e).join("."),parentSchemaType:t})}if(Array.isArray(i[o])&&a.$isMongooseDocumentArray)!function(e,r,o){const i=r.schema.options.timestamps,s=e.length;if(!i){for(let t=0;t<s;++t)n(o,e[t],r.schema);return}const u=t(i,"createdAt"),a=t(i,"updatedAt");for(let t=0;t<s;++t)null!=a&&(e[t][a]=o),null!=u&&(e[t][u]=o),n(o,e[t],r.schema)}(i[o],a,s);else if(i[o]&&a.$isSingleNested)!function(e,r,o){const i=r.schema.options.timestamps;if(!i)return void n(o,e,r.schema);const s=t(i,"createdAt"),u=t(i,"updatedAt");null!=u&&(e[u]=o),null!=s&&(e[s]=o),n(o,e,r.schema)}(i[o],a,s);else if(c.length>0)for(const e of c){const n=e.parentPath,r=e.parentSchemaType,u=r.schema.options.timestamps,a=t(u,"updatedAt");if(u&&null!=a)if(r.$isSingleNested)i[n+"."+a]=s;else if(r.$isMongooseDocumentArray){let e=o.substring(n.length+1);if(/^\d+$/.test(e)){i[n+"."+e][a]=s;continue}const t=e.indexOf(".");e=-1!==t?e.substring(0,t):e,i[n+"."+e+"."+a]=s}}else if(null!=a.schema&&a.schema!=r&&i[o]){const e=a.schema.options.timestamps,n=t(e,"createdAt"),r=t(e,"updatedAt");if(!e)return;null!=r&&(i[o][r]=s),null!=n&&(i[o][n]=s)}}return Wd=n}function Of(){if(Hd)return Gd;Hd=1;
/*!
	 * ignore
	 */
const e=wp();return Gd=
/*!
	 * ignore
	 */
function(t,n,r,o,i,s){const u=o;let a=u;const c=e(i,"timestamps",!0);if(!c||null==u)return o;const l=null!=c&&!1===c.createdAt,h=null!=c&&!1===c.updatedAt;if(s)return o&&o.$set&&(o=o.$set,u.$set={},a=u.$set),h||!r||o[r]||(a[r]=t),l||!n||o[n]||(a[n]=t),u;if(o=o||{},Array.isArray(u))return null==r||u.push({$set:{[r]:t}}),u;if(u.$set=u.$set||{},!h&&r&&(!o.$currentDate||!o.$currentDate[r])){let e=!1;if(-1!==r.indexOf(".")){const n=r.split(".");for(let r=1;r<n.length;++r){const i=n.slice(-r).join("."),s=n.slice(0,-r).join(".");if(null!=o[s]){o[s][i]=t,e=!0;break}if(o.$set&&o.$set[s]){o.$set[s][i]=t,e=!0;break}}}e||(u.$set[r]=t),u.hasOwnProperty(r)&&delete u[r]}if(!l&&n){o[n]&&delete o[n],o.$set&&o.$set[n]&&delete o.$set[n];let e=!1;if(-1!==n.indexOf(".")){const r=n.split(".");for(let n=1;n<r.length;++n){const i=r.slice(-n).join("."),s=r.slice(0,-n).join(".");if(null!=o[s]){o[s][i]=t,e=!0;break}if(o.$set&&o.$set[s]){o.$set[s][i]=t,e=!0;break}}}e||(u.$setOnInsert=u.$setOnInsert||{},u.$setOnInsert[n]=t)}0===Object.keys(u.$set).length&&delete u.$set;return u},Gd}function Cf(){return Yd?Kd:(Yd=1,Kd=function(e,t,n,r,o){const i=null!=t&&!1===t.updatedAt,s=null!=t&&!1===t.createdAt,u=null!=n?n():e.ownerDocument().constructor.base.now();if(!s&&(e.isNew||e.$isSubdocument)&&r&&!e.$__getValue(r)&&e.$__isSelected(r)&&e.$set(r,u,void 0,{overwriteImmutable:!0}),!i&&o&&(e.isNew||e.$isModified())){let t=u;e.isNew&&null!=r&&(t=e.$__getValue(r)),e.$set(o,t)}})}function wf(){if(Jd)return Qd;Jd=1;const e=_f(),t=Of(),n=wp(),r=bf(),o=Cf(),i=Nh(),s=new Set(["replaceOne","findOneAndReplace"]);return Qd=function(u,a){const c=u.childSchemas.find((function(e){return!!e.schema.options.timestamps}));if(!a&&!c)return;const l=r(a,"createdAt"),h=r(a,"updatedAt"),p=null!=a&&a.hasOwnProperty("currentTime")?a.currentTime:null,d={};if(u.$timestamps={createdAt:l,updatedAt:h},l&&!u.paths[l]){const e=null!=u.base?u.base.get("timestamps.createdAt.immutable"):null,t=null==e||e;d[l]={[u.options.typeKey||"type"]:Date,immutable:t}}h&&!u.paths[h]&&(d[h]=Date),u.add(d),u.pre("save",(function(e){const t=n(this,"$__.saveOptions.timestamps");if(!1===t)return e();o(this,t,p,l,h),e()})),u.methods.initializeTimestamps=function(){const e=null!=p?p():this.constructor.base.now();if(l&&!this.get(l)&&this.$set(l,e),h&&!this.get(h)&&this.$set(h,e),this.$isSubdocument)return this;const t=this.$getAllSubdocs();for(const e of t)e.initializeTimestamps&&e.initializeTimestamps();return this},m[i.builtInMiddleware]=!0;const f={query:!0,model:!1};function m(n){const r=null!=p?p():this.model.base.now();s.has(this.op)&&null==this.getUpdate()&&this.setUpdate({}),t(r,l,h,this.getUpdate(),this._mongooseOptions,s.has(this.op)),e(r,this.getUpdate(),this.model.schema),n()}u.pre("findOneAndReplace",f,m),u.pre("findOneAndUpdate",f,m),u.pre("replaceOne",f,m),u.pre("update",f,m),u.pre("updateOne",f,m),u.pre("updateMany",f,m)},Qd}ef.exports;var Sf,vf,Df,Mf={};function Tf(){if(Sf)return Mf;Sf=1;
/*!
	 * ignore
	 */
const e=Object.freeze(["countDocuments","distinct","estimatedDocumentCount","find","findOne","findOneAndReplace","findOneAndUpdate","replaceOne","updateMany","updateOne","deleteMany","deleteOne","findOneAndDelete"]);Mf.queryOperations=e;
/*!
	 * ignore
	 */
const t=e.concat(["validate"]);Mf.queryMiddlewareFunctions=t;Mf.aggregateMiddlewareFunctions=["aggregate"];Mf.modelMiddlewareFunctions=["bulkWrite","createCollection","insertMany"];return Mf.documentMiddlewareFunctions=["validate","save","remove","updateOne","deleteOne","init"],Mf}function Bf(){if(Df)return vf;Df=1;const e=Nh(),t=rh();
/*!
	 * ignore
	 */
vf=r,
/*!
	 * ignore
	 */
r.middlewareFunctions=["deleteOne","save","validate","remove","updateOne","init"];
/*!
	 * ignore
	 */
const n=new Set(r.middlewareFunctions.flatMap((e=>[e,`$__${e}`])));function r(o,i,s){const u={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0,contextParameter:!0},a=(s=s||{}).decorateDoc?o:o.prototype;o.$appliedHooks=!0;for(const e of Object.keys(i.paths)){const t=i.paths[e];let n=null;if(t.$isSingleNested)n=t.caster;else{if(!t.$isMongooseDocumentArray)continue;n=t.Constructor}if(!n.$appliedHooks&&(r(n,t.schema,{...s,isChildSchema:!0}),null!=n.discriminators)){const e=Object.keys(n.discriminators);for(const t of e)r(n.discriminators[t],n.discriminators[t].schema,s)}}const c=i.s.hooks.filter((e=>"updateOne"===e.name||"deleteOne"===e.name?!!e.document:"remove"===e.name||"init"===e.name?null==e.document||!!e.document:null==e.query&&null==e.document||!1!==e.document)).filter((t=>!i.methods[t.name]||!t.fn[e.builtInMiddleware]));o._middleware=c,a.$__originalValidate=a.$__originalValidate||a.$__validate;const l=s&&s.isChildSchema?["save","validate","deleteOne"]:["save","validate"];for(const e of l){const t="validate"===e?"$__originalValidate":`$__${e}`,n=c.createWrapper(e,a[t],null,u);a[`$__${e}`]=n}a.$__init=c.createWrapperSync("init",a.$__init,null,u);const h=Object.keys(i.methods),p=Object.assign({},u,{checkForPromise:!0});for(const e of h){if(n.has(e))continue;if(!c.hasHooks(e))continue;const r=a[e];a[e]=function(){const n=Array.prototype.slice.call(arguments),r=n.slice(-1).pop(),i="function"==typeof r?n.slice(0,n.length-1):n;return t(r,(t=>this[`$__${e}`].apply(this,i.concat([t]))),o.events)},a[`$__${e}`]=c.createWrapper(e,r,null,p)}}return vf}var Ff,$f,xf,Pf,Nf,If,Rf,kf={};function jf(){if(Pf)return xf;Pf=1;const e=Ih(),t=pa(),r=oc(),o=uf().deepEqual,i=_a(),s=Tp(),u=n,a=Ba(),c=Ga(),l=Vh(),h=Aa().populateModelSymbol;
/*!
	 * ignore
	 */
class p extends Map{constructor(t,n,r,o){"Object"===i(t)&&(t=Object.keys(t).reduce(((e,n)=>e.concat([[n,t[n]]])),[])),super(t),this.$__parent=null!=r&&null!=r.$__?r:null,this.$__path=n,this.$__schemaType=null==o?new e(n):o,this.$__runDeferred()}$init(e,t){d(e),super.set(e,t),null!=t&&t.$isSingleNested&&(t.$basePath=this.$__path+"."+e)}$__set(e,t){super.set(e,t)}get(e,t){return c(e,"ObjectId")&&(e=e.toString()),!1===(t=t||{}).getters?super.get(e):this.$__schemaType.applyGetters(super.get(e),this.$__parent)}set(e,n){if(c(e,"ObjectId")&&(e=e.toString()),d(e),n=s(n),null==this.$__schemaType)return this.$__deferred=this.$__deferred||[],void this.$__deferred.push({key:e,value:n});let r;const i=this.$__parent,u=null!=i&&i.$__&&i.$__.populated?i.$populated(p.call(this),!0)||i.$populated(this.$__path,!0):null,a=this.get(e);if(null!=u){if(this.$__schemaType.$isSingleNested)throw new t(`Cannot manually populate single nested subdoc underneath Map at path "${this.$__path}". Try using an array instead of a Map.`);Array.isArray(n)&&this.$__schemaType.$isMongooseArray?n=n.map((e=>(null==e.$__&&(e=new u.options[h](e)),e.$__.wasPopulated={value:e._doc._id},e))):null!=n&&(null==n.$__&&(n=new u.options[h](n)),n.$__.wasPopulated={value:n._doc._id})}else try{const t=this.$__schemaType.$isMongooseDocumentArray||this.$__schemaType.$isSingleNested?{path:p.call(this)}:null;n=this.$__schemaType.applySetters(n,this.$__parent,!1,this.get(e),t)}catch(e){if(null!=this.$__parent&&null!=this.$__parent.$__)return void this.$__parent.invalidate(p.call(this),e);throw e}if(super.set(e,n),null!=i&&null!=i.$__&&!o(n,a)){const e=p.call(this);i.markModified(e),(this.$__schemaType.$isMongooseDocumentArray||this.$__schemaType.$isSingleNested)&&l(i,e)}function p(){return r||(r=this.$__path+"."+e,r)}}clear(){super.clear();const e=this.$__parent;null!=e&&e.markModified(this.$__path)}delete(e){return c(e,"ObjectId")&&(e=e.toString()),this.set(e,void 0),super.delete(e)}toBSON(){return new Map(this)}toObject(e){if(e&&e.flattenMaps){const t={},n=this.keys();for(const o of n)t[o]=r(this.get(o),e);return t}return new Map(this)}$toObject(){return this.constructor.prototype.toObject.apply(this,arguments)}toJSON(e){if("boolean"!=typeof(e&&e.flattenMaps)||e.flattenMaps){const t={},n=this.keys();for(const o of n)t[o]=r(this.get(o),e);return t}return new Map(this)}inspect(){return new Map(this)}$__runDeferred(){if(this.$__deferred){for(const e of this.$__deferred)this.set(e.key,e.value);this.$__deferred=null}}}function d(e){const t=typeof e;if("string"!==t)throw new TypeError(`Mongoose maps only support string keys, got ${t}`);if(e.startsWith("$"))throw new Error(`Mongoose maps do not support keys that start with "$", got "${e}"`);if(e.includes("."))throw new Error(`Mongoose maps do not support keys that contain ".", got "${e}"`);if(a.has(e))throw new Error(`Mongoose maps do not support reserved key name "${e}"`)}return u.inspect.custom&&Object.defineProperty(p.prototype,u.inspect.custom,{enumerable:!1,writable:!1,configurable:!1,value:p.prototype.inspect}),Object.defineProperty(p.prototype,"$__set",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(p.prototype,"$__parent",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(p.prototype,"$__path",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(p.prototype,"$__schemaType",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(p.prototype,"$isMongooseMap",{enumerable:!1,writable:!1,configurable:!1,value:!0}),Object.defineProperty(p.prototype,"$__deferredCalls",{enumerable:!1,writable:!1,configurable:!1,value:!0}),xf=p}function Lf(){return Rf||(Rf=1,kf.Array=nf(),kf.Buffer=fh(),kf.Document=kf.Embedded=id(),kf.DocumentArray=of(),kf.Double=$f?Ff:($f=1,Ff=B().Double),kf.Decimal128=Ta(),kf.ObjectId=ba(),kf.Map=jf(),kf.Subdocument=od(),kf.UUID=If?Nf:(If=1,Nf=B().UUID)),kf}var Uf,Vf,zf,Wf,qf,Gf,Hf,Kf,Yf,Qf,Jf,Xf,Zf,em,tm,nm,rm,om,im={};function sm(){if(Gf)return qf;Gf=1;const e=g;return qf=function(t){return null==t?t:""===t?null:("string"!=typeof t&&"boolean"!=typeof t||(t=Number(t)),e.ok(!isNaN(t)),t instanceof Number?t.valueOf():"number"==typeof t?t:Array.isArray(t)||"function"!=typeof t.valueOf?t.toString&&!Array.isArray(t)&&t.toString()==Number(t)?Number(t):void e.ok(!1):Number(t.valueOf()))}}function um(){return Kf?Hf:(Kf=1,Hf=function(e){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))for(let t=e.length-1;t>=0;--t)void 0===e[t]&&e.splice(t,1);for(const t of Object.keys(e))void 0===e[t]&&delete e[t];return e})}function am(){if(Qf)return Yf;Qf=1;const e=Zc(),t=hl(),n=sm(),r=um(),o=new Set(["$and","$or"]),i=new Set(["$cmp","$eq","$lt","$lte","$gt","$gte"]),s=new Set(["$multiply","$divide","$log","$mod","$trunc","$avg","$max","$min","$stdDevPop","$stdDevSamp","$sum"]),u=new Set(["$abs","$exp","$ceil","$floor","$ln","$log10","$sqrt","$sin","$cos","$tan","$asin","$acos","$atan","$atan2","$asinh","$acosh","$atanh","$sinh","$cosh","$tanh","$degreesToRadians","$radiansToDegrees"]),a=new Set(["$arrayElemAt","$first","$last"]),c=new Set(["$year","$month","$week","$dayOfMonth","$dayOfYear","$hour","$minute","$second","$isoDayOfWeek","$isoWeekYear","$isoWeek","$millisecond"]),l=new Set(["$not"]);function h(n,a,c){if(m(n)||null===n)return n;null!=n.$cond?Array.isArray(n.$cond)?n.$cond=n.$cond.map((e=>h(e,a,c))):(n.$cond.if=h(n.$cond.if,a,c),n.$cond.then=h(n.$cond.then,a,c),n.$cond.else=h(n.$cond.else,a,c)):null!=n.$ifNull?n.$ifNull.map((e=>h(e,a,c))):null!=n.$switch&&(Array.isArray(n.$switch.branches)&&(n.$switch.branches=n.$switch.branches.map((e=>h(e,a,c)))),"default"in n.$switch&&(n.$switch.default=h(n.$switch.default,a,c)));const y=Object.keys(n);for(const e of y)o.has(e)?n[e]=n[e].map((e=>h(e,a,c))):i.has(e)?n[e]=f(n[e],a,c):s.has(e)?n[e]=d(n[e]):u.has(e)?n[e]=p(n[e]):l.has(e)&&(n[e]=h(n[e],a,c));if(n.$in&&(n.$in=function(e,n,r){const o=e[1];if(!m(o))return e;const i=e[0],s=n.path(o.slice(1));if(null===s){if(!1===r)return e;if("throw"===r)throw new t("$in");return}if(!s.$isMongooseArray)throw new Error("Path must be an array for $in");return[s.$isMongooseDocumentArray?s.$embeddedSchemaType.cast(i):s.caster.cast(i),o]}(n.$in,a,c)),n.$size&&(n.$size=p(n.$size)),n.$round){const t=n.$round;if(!Array.isArray(t)||t.length<1||t.length>2)throw new e("Array",t,"$round");n.$round=t.map((e=>p(e)))}return r(n),n}function p(t){if(!y(t))return t;try{return n(t)}catch(n){throw new e("Number",t)}}function d(t){if(!Array.isArray(t)){if(!y(t))return t;try{return n(t)}catch(n){throw new e("Number",t)}}return t.map((t=>{if(!y(t))return t;try{return n(t)}catch(n){throw new e("Number",t)}}))}function f(r,o,i){if(!Array.isArray(r)||2!==r.length)throw new Error("Comparison operator must be an array of length 2");r[0]=h(r[0],o,i);const s=r[0];if(y(r[1])){let u=null,l=null,h=null;if(m(s))u=s.slice(1),l=o.path(u);else if("object"==typeof s&&null!=s)for(const e of Object.keys(s))c.has(e)&&m(s[e])?(u=s[e].slice(1)+"."+e,h=n):a.has(e)&&m(s[e])&&(u=s[e].slice(1)+"."+e,l=o.path(s[e].slice(1)),null!=l&&(l.$isMongooseDocumentArray?l=l.$embeddedSchemaType:l.$isMongooseArray&&(l=l.caster)));const p="object"==typeof r[1]&&null!=r[1]&&null!=r[1].$literal;if(null!=l)r[1]=p?{$literal:l.cast(r[1].$literal)}:l.cast(r[1]);else if(null!=h)if(p)try{r[1]={$literal:h(r[1].$literal)}}catch(t){throw new e(h.name.replace(/^cast/,""),r[1],u+".$literal")}else try{r[1]=h(r[1])}catch(t){throw new e(h.name.replace(/^cast/,""),r[1],u)}else{if(null!=u&&!0===i)return;if(null!=u&&"throw"===i)throw new t(u)}}else r[1]=h(r[1]);return r}function m(e){return"string"==typeof e&&"$"===e[0]}function y(e){return("string"!=typeof e||"$"!==e[0])&&("object"!=typeof e||null===e||!Object.keys(e).find((e=>"$"===e[0]))||null!=e.$literal)}return Yf=function(e,t,n){if("object"!=typeof e||null===e)throw new Error("`$expr` must be an object");return h(e,t,n)},Yf}function cm(){if(Xf)return Jf;Xf=1;const e=Zc();return Jf=function(t,n){if(null==t)return t;if(t._id&&"string"==typeof t._id)return t._id;if(t.toString&&t.toString!==Object.prototype.toString&&!Array.isArray(t))return t.toString();throw new e("string",t,n)}}function lm(){if(nm)return tm;nm=1;const e=new Set(["$ref","$id","$db"]);return tm=function(t){return"$"===t[0]&&!e.has(t)}}function hm(){if(om)return rm;om=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),t=hl(),r=Fg(),o=am(),i=cm(),s=function(){if(em)return Zf;em=1;const e=Zc(),t=Ml(),n=cm();return Zf=function(r,o){if(null==r||"object"!=typeof r)throw new e("$text",r,o);return null!=r.$search&&(r.$search=n(r.$search,o+".$search")),null!=r.$language&&(r.$language=n(r.$language,o+".$language")),null!=r.$caseSensitive&&(r.$caseSensitive=t(r.$caseSensitive,o+".$castSensitive")),null!=r.$diacriticSensitive&&(r.$diacriticSensitive=t(r.$diacriticSensitive,o+".$diacriticSensitive")),r}}(),u=wp(),a=vp(),c=lm(),l=n,h=Ha(),p=Wa(),d=uf(),f=["Polygon","MultiPolygon"];function m(e,t,n){if(Array.isArray(e))e.forEach((function(r,o){if(Array.isArray(r)||h(r))return m(r,t,n);e[o]=t.castForQuery(null,r,n)}));else{const r=Object.keys(e);let o=r.length;for(;o--;){const i=r[o],s=e[i];Array.isArray(s)||h(s)?(m(s,t,n),e[i]=s):e[i]=t.castForQuery({val:s,context:n})}}}function y(e,t,n,r){if("strictQuery"in e)return e.strictQuery;if("strictQuery"in t)return t.strictQuery;const o=r&&r.mongooseCollection&&r.mongooseCollection.conn&&r.mongooseCollection.conn.base&&r.mongooseCollection.conn.base.options;return o&&"strictQuery"in o?o.strictQuery:n.strictQuery}return rm=function n(g,E,A,b){if(Array.isArray(E))throw new Error("Query filter must be an object, got an array ",l.inspect(E));if(null==E)return E;null!=g&&null!=g.discriminators&&null!=E[g.options.discriminatorKey]&&(g=a(g,E[g.options.discriminatorKey])||g);const _=Object.keys(E);let O,C,w,S,v,D,M,T=_.length;for(A=A||{};T--;)if(v=_[T],M=E[v],"$or"===v||"$nor"===v||"$and"===v){if(!Array.isArray(M))throw new e("Array",M,v);for(let t=M.length-1;t>=0;t--){if(null==M[t]||"object"!=typeof M[t])throw new e("Object",M[t],v+"."+t);const r=Object.keys(M[t]).length,o=M[t][g.options.discriminatorKey];if(null==o)M[t]=n(g,M[t],A,b);else{const e=a(b.schema,o);M[t]=n(e||g,M[t],A,b)}0===Object.keys(M[t]).length&&0!==r&&M.splice(t,1)}0===M.length&&delete E[v]}else{if("$where"===v){if(D=typeof M,"string"!==D&&"function"!==D)throw new Error("Must have a string or function for $where");"function"===D&&(E[v]=M.toString());continue}if("$expr"===v){M=o(M,g);continue}if("$elemMatch"===v)M=n(g,M,A,b);else if("$text"===v)M=s(M,v);else if("$comment"!==v||g.paths.hasOwnProperty("$comment")){if(!g)continue;if(w=g.path(v),!w){const e=v.split(".");let t=e.length;for(;t--;){const n=e.slice(0,t).join("."),r=e.slice(t).join("."),o=g.path(n),i=o&&o.schema&&o.schema.options&&o.schema.options.discriminatorKey;if(null!=o&&null!=(o.schema&&o.schema.discriminators)&&null!=i&&r!==i){const e=u(E,n+"."+i),t=o.schema.discriminators;"string"==typeof e&&null!=t[e]?w=t[e].path(r):null!=e&&1===Object.keys(e).length&&Array.isArray(e.$in)&&1===e.$in.length&&"string"==typeof e.$in[0]&&null!=t[e.$in[0]]&&(w=t[e.$in[0]].path(r))}}}if(w){if(null==M)continue;if(d.isPOJO(M))if(C=Object.keys(M).some(c),C){const e=Object.keys(M);let t,r=e.length;for(;r--;)if(t=e[r],S=M[t],"$elemMatch"===t)S&&null!=w&&null!=w.schema?n(w.schema,S,A,b):S&&null!=w&&w.$isMongooseArray&&(d.isPOJO(S)&&null!=S.$not?n(g,S,A,b):M[t]=w.castForQuery(t,S,b));else if("$not"===t){if(S&&w){if(O=Object.keys(S),O.length&&c(O[0]))for(const e in S)S[e]=w.castForQuery(e,S[e],b);else M[t]=w.castForQuery(t,S,b);continue}}else M[t]=w.castForQuery(t,S,b)}else E[v]=w.castForQuery(null,M,b);else if(Array.isArray(M)&&-1===["Buffer","Array"].indexOf(w.instance)&&!A.sanitizeFilter){const e=[],t=M;for(const n of t)e.push(w.castForQuery(null,n,b));E[v]={$in:e}}else E[v]=w.castForQuery(null,M,b)}else{const e=v.split(".");let o,i,s,u=e.length;for(;u--&&(o=e.slice(0,u).join("."),w=g.path(o),!w););if(w){if(w.caster&&w.caster.schema){s={},i=e.slice(u).join("."),s[i]=M;const t=n(w.caster.schema,s,A,b)[i];void 0===t?delete E[v]:E[v]=t}else E[v]=M;continue}if(h(M)){let e="";if(M.$near?e="$near":M.$nearSphere?e="$nearSphere":M.$within?e="$within":M.$geoIntersects?e="$geoIntersects":M.$geoWithin&&(e="$geoWithin"),e){const t=new r.Number("__QueryCasting__");let n=M[e];if(null!=M.$maxDistance&&(M.$maxDistance=t.castForQuery(null,M.$maxDistance,b)),null!=M.$minDistance&&(M.$minDistance=t.castForQuery(null,M.$minDistance,b)),"$within"===e){const e=n.$center||n.$centerSphere||n.$box||n.$polygon;if(!e)throw new Error("Bad $within parameter: "+JSON.stringify(M));n=e}else if("$near"===e&&"string"==typeof n.type&&Array.isArray(n.coordinates))n=n.coordinates;else if(("$near"===e||"$nearSphere"===e||"$geoIntersects"===e)&&n.$geometry&&"string"==typeof n.$geometry.type&&Array.isArray(n.$geometry.coordinates))null!=n.$maxDistance&&(n.$maxDistance=t.castForQuery(null,n.$maxDistance,b)),null!=n.$minDistance&&(n.$minDistance=t.castForQuery(null,n.$minDistance,b)),p(n.$geometry)&&(n.$geometry=n.$geometry.toObject({transform:!1,virtuals:!1})),n=n.$geometry.coordinates;else if("$geoWithin"===e)if(n.$geometry){p(n.$geometry)&&(n.$geometry=n.$geometry.toObject({virtuals:!1}));const e=n.$geometry.type;if(-1===f.indexOf(e))throw new Error('Invalid geoJSON type for $geoWithin "'+e+'", must be "Polygon" or "MultiPolygon"');n=n.$geometry.coordinates}else n=n.$box||n.$polygon||n.$center||n.$centerSphere,p(n)&&(n=n.toObject({virtuals:!1}));m(n,t,b);continue}}if(g.nested[v])continue;const a="strict"in A?A.strict:g.options.strict,c=y(A,g._userProvidedOptions,g.options,b);if(A.upsert&&a){if("throw"===a)throw new t(v);throw new t(v,'Path "'+v+'" is not in schema, strict mode is `true`, and upsert is `true`.')}if("throw"===c)throw new t(v,'Path "'+v+"\" is not in schema and strictQuery is 'throw'.");c&&delete E[v]}}else M=i(M,v),E[v]=M}return E},rm}var pm,dm,fm,mm,ym,gm,Em,Am,bm,_m={};function Om(){return mm||(mm=1,fm=function(e,t,n,r){return n?r?{bsonType:t}:{bsonType:[t,"null"]}:r?{type:e}:{type:[e,"null"]}}),fm}
/*!
 * Module requirements.
 */function Cm(){if(gm)return ym;gm=1;const e=Zc();
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function t(t,n){const r=Number(n);if(isNaN(r))throw new e("number",n,t);return r}return ym=function(e){const n=this;return Array.isArray(e)?e.map((function(e){return t(n.path,e)})):Buffer.isBuffer(e)?e:t(n.path,e)}}function wm(){if(Am)return Em;Am=1;
/*!
	 * Module requirements.
	 */
const e=dl(),t=function(){if(dm)return pm;dm=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"min",n),Object.defineProperty(t.prototype,"max",n),Object.defineProperty(t.prototype,"enum",n),Object.defineProperty(t.prototype,"populate",n),
/*!
	 * ignore
	 */
pm=t}(),n=af(),r=sm(),o=Om(),i=Cm(),s=uf(),u=n.CastError;function a(e,t){n.call(this,e,t,"Number")}
/*!
	 * ignore
	 */
function c(e){return this.cast(e)}return a.get=n.get,a.set=n.set,a.setters=[],
/*!
	 * ignore
	 */
a._cast=r,a.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
a._defaultCaster=e=>{if("number"!=typeof e)throw new Error;return e},a.schemaName="Number",a.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.OptionsConstructor=t,
/*!
	 * ignore
	 */
a._checkRequired=e=>"number"==typeof e||e instanceof Number,a.checkRequired=n.checkRequired,a.prototype.checkRequired=function(e,t){if("object"==typeof e&&n._isRef(this,e,t,!0))return null!=e;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():a.checkRequired())(e)},a.prototype.min=function(t,n){if(this.minValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.minValidator}),this)),null!=t){let r=n||e.messages.Number.min;r=r.replace(/{MIN}/,t),this.validators.push({validator:this.minValidator=function(e){return null==e||e>=t},message:r,type:"min",min:t})}return this},a.prototype.max=function(t,n){if(this.maxValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.maxValidator}),this)),null!=t){let r=n||e.messages.Number.max;r=r.replace(/{MAX}/,t),this.validators.push({validator:this.maxValidator=function(e){return null==e||e<=t},message:r,type:"max",max:t})}return this},a.prototype.enum=function(t,n){if(this.enumValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.enumValidator}),this)),!Array.isArray(t)){s.isPOJO(t)&&null!=t.values?(n=t.message,t=t.values):"number"==typeof t&&(t=Array.prototype.slice.call(arguments),n=null),s.isPOJO(t)&&(t=Object.values(t)),n=n||e.messages.Number.enum}return n=null==n?e.messages.Number.enum:n,this.enumValidator=e=>null==e||-1!==t.indexOf(e),this.validators.push({validator:this.enumValidator,message:n,type:"enum",enumValues:t}),this},a.prototype.cast=function(e,t,r,o,i){if("number"!=typeof e&&n._isRef(this,e,t,r)&&(null==e||s.isNonBuiltinObject(e)))return this._castRef(e,t,r,i);const c=e&&void 0!==e._id?e._id:e;let l;l="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():a.cast();try{return l(c)}catch(e){throw new u("Number",c,this.path,e,this)}},a.prototype.$conditionalHandlers={...n.prototype.$conditionalHandlers,$bitsAllClear:i,$bitsAnyClear:i,$bitsAllSet:i,$bitsAnySet:i,$gt:c,$gte:c,$lt:c,$lte:c,$mod:function(e){const t=this;return Array.isArray(e)?e.map((function(e){return t.cast(e)})):[this.cast(e)]}},a.prototype.castForQuery=function(e,t,n){let r;if(null!=e){if(r=this.$conditionalHandlers[e],!r)throw new u("number",t,this.path,null,this);return r.call(this,t,n)}try{t=this.applySetters(t,n)}catch(e){throw e instanceof u&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}return t},a.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required||"_id"===this.path;return o("number","number",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Em=a}function Sm(){if(bm)return _m;bm=1;
/*!
	 * Module requirements.
	 */
const e=wm();
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function t(t){return e.cast()(t)}return _m.castToNumber=t,_m.castArraysOfNumbers=function e(n,r){n.forEach((function(o,i){Array.isArray(o)?e(o,r):n[i]=t.call(r,o)}))},_m}var vm,Dm,Mm,Tm,Bm,Fm,$m,xm,Pm,Nm,Im,Rm,km,jm,Lm,Um,Vm,zm,Wm,qm,Gm,Hm,Km,Ym,Qm,Jm={};
/*!
 * Module requirements.
 */function Xm(){if(vm)return Jm;vm=1;const e=Sm().castArraysOfNumbers,t=Sm().castToNumber;function n(t,n){switch(t.$geometry.type){case"Polygon":case"LineString":case"Point":e(t.$geometry.coordinates,n)}return r(n,t),t}function r(e,n){n.$maxDistance&&(n.$maxDistance=t.call(e,n.$maxDistance)),n.$minDistance&&(n.$minDistance=t.call(e,n.$minDistance))}
/*!
	 * ignore
	 */
return Jm.cast$geoIntersects=function(e){if(!e.$geometry)return;return n(e,this),e},Jm.cast$near=function(t){const o=Zm();if(Array.isArray(t))return e(t,this),t;if(r(this,t),t&&t.$geometry)return n(t,this);if(!Array.isArray(t))throw new TypeError("$near must be either an array or an object with a $geometry property");return o.prototype.castForQuery.call(this,null,t)},Jm.cast$within=function(e){if(r(this,e),e.$box||e.$polygon){const n=e.$box?"$box":"$polygon";e[n].forEach((e=>{if(!Array.isArray(e)){throw new TypeError("Invalid $within $box argument. Expected an array, received "+e)}e.forEach(((n,r)=>{e[r]=t.call(this,n)}))}))}else if(e.$center||e.$centerSphere){const n=e.$center?"$center":"$centerSphere";e[n].forEach(((r,o)=>{Array.isArray(r)?r.forEach(((e,n)=>{r[n]=t.call(this,e)})):e[n][o]=t.call(this,r)}))}else e.$geometry&&n(e,this);return e},Jm}function Zm(){if(Mm)return Dm;Mm=1;
/*!
	 * Module dependencies.
	 */
const e=Tl(),t=Bl(),r=pa(),o=function(){if(Vf)return Uf;Vf=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"enum",n),Object.defineProperty(t.prototype,"of",n),Object.defineProperty(t.prototype,"castNonArrays",n),
/*!
	 * ignore
	 */
Uf=t}(),i=af(),s=i.CastError,u=Ih(),a=cf(),c=pf(),l=(Wf||(Wf=1,zf=function e(t){if(!Array.isArray(t))return{min:0,max:0,containsNonArrayItem:!0};if(0===t.length)return{min:1,max:1,containsNonArrayItem:!1};if(1===t.length&&!Array.isArray(t[0]))return{min:1,max:1,containsNonArrayItem:!1};const n=e(t[0]);for(let r=1;r<t.length;++r){const o=e(t[r]);o.min<n.min&&(n.min=o.min),o.max>n.max&&(n.max=o.max),n.containsNonArrayItem=n.containsNonArrayItem||o.containsNonArrayItem}return n.min=n.min+1,n.max=n.max+1,n}),zf),h=hm(),p=oc(),d=_a(),f=lm(),m=n,y=uf(),g=Sm().castToNumber,E=Om(),A=Xm(),b=Zp();let _,O;const C=Symbol("mongoose#isNestedArray"),w=Object.freeze({});function S(e,t,n,r){O||(O=Lf().Embedded);let o,s,a="type";if(r&&r.typeKey&&(a=r.typeKey),this.schemaOptions=r,t){let r={};y.isPOJO(t)&&(t[a]?(r=p(t),delete r[a],t=t[a]):t=u),null!=n&&null!=n.ref&&null==r.ref&&(r.ref=n.ref),t===Object&&(t=u);const o="string"==typeof t?t:y.getFunctionName(t),i=Fg(),s=i.hasOwnProperty(o)?i[o]:t;if(this.casterConstructor=s,this.casterConstructor instanceof S&&(this.casterConstructor[C]=!0),"function"!=typeof s||s.$isArraySubdocument||s.$isSchemaMap)this.caster=s,this.caster instanceof O||(this.caster.path=e);else{const t=this.caster instanceof O?null:e;this.caster=new s(t,r)}this.$embeddedSchemaType=this.caster}if(this.$isMongooseArray=!0,i.call(this,e,n,"Array"),null!=this.defaultValue&&(o=this.defaultValue,s="function"==typeof o),!("defaultValue"in this)||null!=this.defaultValue){const e=function(){return s?o.call(this):null!=o?[].concat(o):[]};e.$runBeforeSetters=!s,this.default(e)}}S.schemaName="Array",S.options={castNonArrays:!0},
/*!
	 * ignore
	 */
S.defaultOptions={},S.set=i.set,S.setters=[],S.get=i.get,
/*!
	 * Inherits from SchemaType.
	 */
S.prototype=Object.create(i.prototype),S.prototype.constructor=S,S.prototype.OptionsConstructor=o,
/*!
	 * ignore
	 */
S._checkRequired=i.prototype.checkRequired,S.checkRequired=i.checkRequired,
/*!
	 * Virtuals defined on this array itself.
	 */
S.prototype.virtuals=null,S.prototype.checkRequired=function(e,t){if("object"==typeof e&&i._isRef(this,e,t,!0))return!!e;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():S.checkRequired())(e)},S.prototype.enum=function(){let e=this;for(;;){const t=e&&e.caster&&e.caster.instance;if("Array"!==t){if("String"!==t&&"Number"!==t)throw new Error("`enum` can only be set on an array of strings or numbers , not "+t);break}e=e.caster}let t=arguments;return!Array.isArray(arguments)&&y.isObject(arguments)&&(t=y.object.vals(t)),e.caster.enum.apply(e.caster,t),this},S.prototype.applyGetters=function(e,t){if(null!=t&&null!=t.$__&&t.$populated(this.path))return e;return i.prototype.applyGetters.call(this,e,t)},S.prototype._applySetters=function(e,t,n,r){if(this.casterConstructor.$isMongooseArray&&S.options.castNonArrays&&!this[C]){let t=0,n=this;for(;null!=n&&n.$isMongooseArray&&!n.$isMongooseDocumentArray;)++t,n=n.casterConstructor;if(null!=e&&0!==e.length){const n=l(e);if(n.min===n.max&&n.max<t&&n.containsNonArrayItem)for(let r=n.max;r<t;++r)e=[e]}}return i.prototype._applySetters.call(this,e,t,n,r)},S.prototype.cast=function(e,t,n,r,o){let i,a;if(_||(_=Lf().Array),Array.isArray(e)){if(!e.length&&t){const e=t.schema.indexedPaths(),n=this.path;for(i=0,a=e.length;i<a;++i){const t=e[i][0][n];if("2dsphere"===t||"2d"===t)return}const r=this.path.endsWith(".coordinates")?this.path.substring(0,this.path.lastIndexOf(".")):null;if(null!=r)for(i=0,a=e.length;i<a;++i){if("2dsphere"===e[i][0][r])return}}o=o||w;let r=y.isMongooseArray(e)?e.__array:e,c=o.path||this.path;if(null!=o.arrayPathIndex&&(c+="."+o.arrayPathIndex),r=(e=_(r,c,t,this)).__array,n&&null!=t&&null!=t.$__&&t.$populated(this.path))return e;const l=this.caster,h=l.$isMongooseArray;if(l&&this.casterConstructor!==u)try{const e=r.length;for(i=0;i<e;i++){const e={};h&&(null!=o.arrayPath||null!=l._arrayParentPath)&&(e.arrayPathIndex=i),o.hydratedPopulatedDocs&&(e.hydratedPopulatedDocs=o.hydratedPopulatedDocs),r[i]=l.applySetters(r[i],t,n,void 0,e)}}catch(t){throw new s("["+t.kind+"]",m.inspect(e),this.path+"."+i,t,this)}return e}const c=null!=this.options.castNonArrays?this.options.castNonArrays:S.options.castNonArrays;if(n||c)return t&&n&&t.markModified(this.path),this.cast([e],t,n);throw new s("Array",m.inspect(e),this.path,null,this)},
/*!
	 * ignore
	 */
S.prototype._castForPopulate=function(e,t){if(_||(_=Lf().Array),Array.isArray(e)){let n;const r=e.__array?e.__array:e,o=r.length,i=this.caster;if(i&&this.casterConstructor!==u)try{for(n=0;n<o;n++){const e={};i.$isMongooseArray&&null!=i._arrayParentPath&&(e.arrayPathIndex=n),r[n]=i.cast(r[n],t,!1,void 0,e)}}catch(t){throw new s("["+t.kind+"]",m.inspect(e),this.path+"."+n,t,this)}return e}throw new s("Array",m.inspect(e),this.path,null,this)},S.prototype.$toObject=S.prototype.toObject,
/*!
	 * ignore
	 */
S.prototype.discriminator=function(...e){let t=this;for(;t.$isMongooseArray&&!t.$isMongooseDocumentArray;)if(t=t.casterConstructor,null==t||"function"==typeof t)throw new r("You can only add an embedded discriminator on a document array, "+this.path+" is a plain array");return t.discriminator(...e)},
/*!
	 * ignore
	 */
S.prototype.clone=function(){const e=Object.assign({},this.options),t=new this.constructor(this.path,this.caster,e,this.schemaOptions);return t.validators=this.validators.slice(),void 0!==this.requiredValidator&&(t.requiredValidator=this.requiredValidator),t},S.prototype._castForQuery=function(e,t){let n=this.casterConstructor;if(e&&n.discriminators&&n.schema&&n.schema.options&&n.schema.options.discriminatorKey)if("string"==typeof e[n.schema.options.discriminatorKey]&&n.discriminators[e[n.schema.options.discriminatorKey]])n=n.discriminators[e[n.schema.options.discriminatorKey]];else{const t=b(n.discriminators,e[n.schema.options.discriminatorKey]);t&&(n=t)}const r=this.casterConstructor.prototype,o=r&&r.castForQuery,i=r&&r.cast,s=n.castForQuery,u=this.caster;return Array.isArray(e)?(this.setters.reverse().forEach((t=>{e=t.call(this,e,this)})),e=e.map((function(e){return y.isObject(e)&&e.$elemMatch?e:o?e=o.call(u,null,e,t):i?e=i.call(u,e):s?e=s.call(u,null,e,t):null!=e?e=new n(e):e}))):o?e=o.call(u,null,e,t):i?e=i.call(u,e):s?e=s.call(u,null,e,t):null!=e&&(e=new n(e)),e},S.prototype.castForQuery=function(e,t,n){let r;if(null!=e){if(r=this.$conditionalHandlers[e],!r)throw new Error("Can't use "+e+" with Array.");return r.call(this,t,n)}return this._castForQuery(t,n)},S.prototype.virtual=function(e,t){if(e instanceof c||"VirtualType"===d(e))return this.virtual(e.path,e.options);if(t=new a(t),y.hasUserDefinedProperty(t,["ref","refPath"]))throw new r("Cannot set populate virtual as a property of an array");const n=new c(t,e);return null===this.virtuals&&(this.virtuals={}),this.virtuals[e]=n,n};const v=S.prototype.$conditionalHandlers={};function D(e){return function(t,n){if(!Array.isArray(t))throw new TypeError("conditional "+e+" requires an array");const r=[];for(const e of t)r.push(h(this.casterConstructor.schema??n.schema,e,null,this&&this.$$context));return r}}return v.$all=function(e,t){return Array.isArray(e)||(e=[e]),e=e.map((e=>{if(!y.isObject(e))return e;if(null!=e.$elemMatch)return{$elemMatch:h(this.casterConstructor.schema,e.$elemMatch,null,this&&this.$$context)};const t={};return t[this.path]=e,h(this.casterConstructor.schema,t,null,this&&this.$$context)[this.path]}),this),this.castForQuery(null,e,t)},v.$options=String,v.$elemMatch=function(e,t){const n=Object.keys(e),r=n.length;for(let o=0;o<r;++o){const r=n[o],i=e[r];f(r)&&null!=i&&(e[r]=this.castForQuery(r,i,t))}return e},v.$geoIntersects=A.cast$geoIntersects,v.$or=D("$or"),v.$and=D("$and"),v.$nor=D("$nor"),v.$near=v.$nearSphere=A.cast$near,v.$within=v.$geoWithin=A.cast$within,v.$size=v.$minDistance=v.$maxDistance=g,v.$exists=e,v.$type=t,v.$eq=v.$gt=v.$gte=v.$lt=v.$lte=v.$not=v.$regex=v.$ne=S.prototype._castForQuery,v.$nin=i.prototype.$conditionalHandlers.$nin,v.$in=i.prototype.$conditionalHandlers.$in,S.prototype.toJSONSchema=function(e){const t=this.getEmbeddedSchemaType(),n=this.options.required&&"function"!=typeof this.options.required;return{...E("array","array",e?.useBsonType,n),items:t.toJSONSchema(e)}},
/*!
	 * Module exports.
	 */
Dm=S}function ey(){if($m)return Fm;$m=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),t=af(),n=function(){if(Bm)return Tm;Bm=1;const{Long:e}=B(),t=9223372036854775807n,n=-9223372036854775808n,r=`Mongoose only supports BigInts between ${n} and ${t} because MongoDB does not support arbitrary precision integers`;return Tm=function(o){if(null==o)return o;if(""===o)return null;if("bigint"==typeof o){if(o>t||o<n)throw new Error(r);return o}if(o instanceof e)return o.toBigInt();if("string"==typeof o||"number"==typeof o){if((o=BigInt(o))>t||o<n)throw new Error(r);return o}throw new Error(`Cannot convert value to BigInt: "${o}"`)}}(),r=Om();function o(e,n){t.call(this,e,n,"BigInt")}
/*!
	 * ignore
	 */
function i(e,t){return this.castForQuery(null,e,t)}return o.schemaName="BigInt",o.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
o.prototype=Object.create(t.prototype),o.prototype.constructor=o,
/*!
	 * ignore
	 */
o._cast=n,o.set=t.set,o.setters=[],o.get=t.get,o.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
o._checkRequired=e=>null!=e,o.checkRequired=t.checkRequired,o.prototype.checkRequired=function(e){return this.constructor._checkRequired(e)},o.prototype.cast=function(t){let n;n="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():o.cast();try{return n(t)}catch(n){throw new e("BigInt",t,this.path,n,this)}},
/*!
	 * ignore
	 */
o.$conditionalHandlers={...t.prototype.$conditionalHandlers,$gt:i,$gte:i,$lt:i,$lte:i},o.prototype.castForQuery=function(t,n,r){let i;if(null!=t)return i=o.$conditionalHandlers[t],i?i.call(this,n):this.applySetters(n,r);try{return this.applySetters(n,r)}catch(t){throw t instanceof e&&t.path===this.path&&null!=this.$fullPath&&(t.path=this.$fullPath),t}},o.prototype._castNullish=function(e){if(void 0===e)return e;"function"==typeof this.constructor.cast?this.constructor.cast():o.cast();return e},o.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("string","long",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Fm=o}function ty(){if(km)return Rm;km=1;const e=fh(),t=function(){if(Im)return Nm;Im=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"subtype",n),
/*!
	 * ignore
	 */
Nm=t}
/*!
 * Module dependencies.
 */(),n=af(),r=Om(),o=Cm(),i=uf(),s=e.Binary,u=n.CastError;function a(e,t){n.call(this,e,t,"Buffer")}
/*!
	 * ignore
	 */
function c(e,t){return this.castForQuery(null,e,t)}return a.schemaName="Buffer",a.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.OptionsConstructor=t,
/*!
	 * ignore
	 */
a._checkRequired=e=>!(!e||!e.length),a.set=n.set,a.setters=[],a.get=n.get,a.checkRequired=n.checkRequired,a.prototype.checkRequired=function(e,t){return n._isRef(this,e,t,!0)?!!e:this.constructor._checkRequired(e)},a.prototype.cast=function(t,r,o,a,c){let l;if(n._isRef(this,t,r,o)){if(t&&t.isMongooseBuffer)return t;if(Buffer.isBuffer(t))return t&&t.isMongooseBuffer||(t=new e(t,[this.path,r]),null!=this.options.subtype&&(t._subtype=this.options.subtype)),t;if(t instanceof s){if(l=new e(t.value(!0),[this.path,r]),"number"!=typeof t.sub_type)throw new u("Buffer",t,this.path,null,this);return l._subtype=t.sub_type,l}if(null==t||i.isNonBuiltinObject(t))return this._castRef(t,r,o,c)}if(t&&t._id&&(t=t._id),t&&t.isMongooseBuffer)return t;if(Buffer.isBuffer(t))return t&&t.isMongooseBuffer||(t=new e(t,[this.path,r]),null!=this.options.subtype&&(t._subtype=this.options.subtype)),t;if(t instanceof s){if(l=new e(t.value(!0),[this.path,r]),"number"!=typeof t.sub_type)throw new u("Buffer",t,this.path,null,this);return l._subtype=t.sub_type,l}if(null===t)return t;const h=typeof t;if("string"===h||"number"===h||Array.isArray(t)||"object"===h&&"Buffer"===t.type&&Array.isArray(t.data))return"number"===h&&(t=[t]),l=new e(t,[this.path,r]),null!=this.options.subtype&&(l._subtype=this.options.subtype),l;if(i.isPOJO(t)&&(t.$binary instanceof s||"string"==typeof t.$binary)){const e=this.cast(Buffer.from(t.$binary,"base64"));if(null!=t.$type)return e._subtype=t.$type,e}throw new u("Buffer",t,this.path,null,this)},a.prototype.subtype=function(e){return this.options.subtype=e,this},a.prototype.$conditionalHandlers={...n.prototype.$conditionalHandlers,$bitsAllClear:o,$bitsAnyClear:o,$bitsAllSet:o,$bitsAnySet:o,$gt:c,$gte:c,$lt:c,$lte:c},a.prototype.castForQuery=function(e,t,n){let r,o;if(null!=e){if(r=this.$conditionalHandlers[e],!r)throw new Error("Can't use "+e+" with Buffer.");return r.call(this,t)}try{o=this.applySetters(t,n)}catch(e){throw e instanceof u&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}return o?o.toObject({transform:!1,virtuals:!1}):o},a.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("string","binData",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Rm=a}function ny(){if(Wm)return zm;Wm=1;const e=dl(),t=function(){if(Lm)return jm;Lm=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"min",n),Object.defineProperty(t.prototype,"max",n),Object.defineProperty(t.prototype,"expires",n),
/*!
	 * ignore
	 */
jm=t}(),n=af(),r=function(){if(Vm)return Um;Vm=1;const e=g;return Um=function(t){if(null==t||""===t)return null;if(t instanceof Date)return e.ok(!isNaN(t.valueOf())),t;let n;if(e.ok("boolean"!=typeof t),n=t instanceof Number||"number"==typeof t?new Date(t):"string"==typeof t&&!isNaN(Number(t))&&(Number(t)>=275761||Number(t)<-271820)?new Date(Number(t)):"function"==typeof t.valueOf?new Date(t.valueOf()):new Date(t),!isNaN(n.valueOf()))return n;e.ok(!1)},Um}
/*!
 * Module requirements.
 */(),o=Om(),i=_a(),s=uf(),u=n.CastError;function a(e,t){n.call(this,e,t,"Date")}function c(e){return this.cast(e)}return a.schemaName="Date",a.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.OptionsConstructor=t,
/*!
	 * ignore
	 */
a._cast=r,a.set=n.set,a.setters=[],a.get=n.get,a.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
a._defaultCaster=e=>{if(null!=e&&!(e instanceof Date))throw new Error;return e},a.prototype.expires=function(e){return"Object"!==i(this._index)&&(this._index={}),this._index.expires=e,s.expires(this._index),this},
/*!
	 * ignore
	 */
a._checkRequired=e=>e instanceof Date,a.checkRequired=n.checkRequired,a.prototype.checkRequired=function(e,t){if("object"==typeof e&&n._isRef(this,e,t,!0))return null!=e;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():a.checkRequired())(e)},a.prototype.min=function(t,n){if(this.minValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.minValidator}),this)),t){let r=n||e.messages.Date.min;"string"==typeof r&&(r=r.replace(/{MIN}/,t===Date.now?"Date.now()":t.toString()));const o=this;this.validators.push({validator:this.minValidator=function(e){let n=t;"function"==typeof t&&t!==Date.now&&(n=n.call(this));const r=n===Date.now?n():o.cast(n);return null===e||e.valueOf()>=r.valueOf()},message:r,type:"min",min:t})}return this},a.prototype.max=function(t,n){if(this.maxValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.maxValidator}),this)),t){let r=n||e.messages.Date.max;"string"==typeof r&&(r=r.replace(/{MAX}/,t===Date.now?"Date.now()":t.toString()));const o=this;this.validators.push({validator:this.maxValidator=function(e){let n=t;"function"==typeof n&&n!==Date.now&&(n=n.call(this));const r=n===Date.now?n():o.cast(n);return null===e||e.valueOf()<=r.valueOf()},message:r,type:"max",max:t})}return this},a.prototype.cast=function(e){let t;t="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():a.cast();try{return t(e)}catch(t){throw new u("date",e,this.path,t,this)}},a.prototype.$conditionalHandlers={...n.prototype.$conditionalHandlers,$gt:c,$gte:c,$lt:c,$lte:c},a.prototype.castForQuery=function(e,t,n){if(null==e)try{return this.applySetters(t,n)}catch(e){throw e instanceof u&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}const r=this.$conditionalHandlers[e];if(!r)throw new Error("Can't use "+e+" with Date.");return r.call(this,t)},a.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return o("string","date",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
zm=a}function ry(){if(Km)return Hm;Km=1;const e=af(),t=e.CastError,n=function(){if(Gm)return qm;Gm=1;const e=Ta(),t=g;return qm=function(n){return null==n?n:"object"==typeof n&&"string"==typeof n.$numberDecimal?e.fromString(n.$numberDecimal):n instanceof e?n:"string"==typeof n?e.fromString(n):"function"==typeof Buffer&&Buffer.isBuffer(n)||"function"==typeof Uint8Array&&n instanceof Uint8Array?new e(n):"number"==typeof n?e.fromString(String(n)):"function"==typeof n.valueOf&&"string"==typeof n.valueOf()?e.fromString(n.valueOf()):void t.ok(!1)}}
/*!
 * Module dependencies.
 */(),r=Om(),o=Ga();function i(t,n){e.call(this,t,n,"Decimal128")}
/*!
	 * ignore
	 */
function s(e){return this.cast(e)}return i.schemaName="Decimal128",i.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
i.prototype=Object.create(e.prototype),i.prototype.constructor=i,
/*!
	 * ignore
	 */
i._cast=n,i.set=e.set,i.setters=[],i.get=e.get,i.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
i._defaultCaster=e=>{if(null!=e&&!o(e,"Decimal128"))throw new Error;return e},
/*!
	 * ignore
	 */
i._checkRequired=e=>o(e,"Decimal128"),i.checkRequired=e.checkRequired,i.prototype.checkRequired=function(t,n){if(e._isRef(this,t,n,!0))return!!t;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():i.checkRequired())(t)},i.prototype.cast=function(n,r,s,u,a){if(e._isRef(this,n,r,s))return o(n,"Decimal128")?n:this._castRef(n,r,s,a);let c;c="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():i.cast();try{return c(n)}catch(e){throw new t("Decimal128",n,this.path,e,this)}},i.prototype.$conditionalHandlers={...e.prototype.$conditionalHandlers,$gt:s,$gte:s,$lt:s,$lte:s},i.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("string","decimal",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Hm=i}var oy,iy,sy,uy,ay={};function cy(){return iy?oy:(iy=1,oy=function(e,t,n){if(0===e.length)return n();let r=e.length,o=null;for(const i of e)t(i,(function(e){if(null==o)return null!=e?(o=e,n(o)):--r<=0?n():void 0}))})}var ly,hy,py,dy,fy,my,yy,gy,Ey,Ay,by,_y,Oy,Cy,wy,Sy,vy,Dy,My,Ty,By,Fy,$y,xy,Py,Ny,Iy,Ry,ky,jy,Ly,Uy,Vy,zy,Wy,qy,Gy,Hy,Ky={exports:{}};function Yy(){if(py)return hy;py=1;const e=Aa().arrayAtomicsSymbol,t=Aa().sessionNewDocuments,n=uf();function r(e,t){return e=e||{},null!=t.$pullAll&&(e.$pullAll=(e.$pullAll||[]).concat(t.$pullAll)),null!=t.$push&&(e.$push=e.$push||{},e.$push.$each=(e.$push.$each||[]).concat(t.$push.$each)),null!=t.$addToSet&&(e.$addToSet=(e.$addToSet||[]).concat(t.$addToSet)),null!=t.$set&&(e.$set=Array.isArray(t.$set)?[...t.$set]:Object.assign({},t.$set)),e}return hy=function(o){o.pre("save",(function(){const o=this.$session();if(null!=o&&null!=o.transaction&&null!=o[t]&&!o[t].has(this)){const i={};this.isNew&&(i.isNew=!0),this.$__schema.options.versionKey&&(i.versionKey=this.get(this.$__schema.options.versionKey)),i.modifiedPaths=new Set(Object.keys(this.$__.activePaths.getStatePaths("modify"))),i.atomics=function(t,o){const i=new Map;o=o||new Map;const s=Object.keys(t.$__.activePaths.init).concat(Object.keys(t.$__.activePaths.modify));for(const u of s){const s=t.$__getValue(u);if(null!=s&&Array.isArray(s)&&n.isMongooseDocumentArray(s)&&s.length&&null!=s[e]&&0!==Object.keys(s[e]).length){const t=o.get(u)||{};i.set(u,r(t,s[e]))}}const u=t.$__dirty();for(const t of u){const n=t.path,s=t.value;if(null!=s&&null!=s[e]&&0!==Object.keys(s[e]).length){const t=o.get(n)||{};i.set(n,r(t,s[e]))}}return i}(this),o[t].set(this,i)}}))},hy}function Qy(){return my||(my=1,ay.saveSubdocs=function(){if(uy)return sy;uy=1;const e=cy();
/*!
	 * ignore
	 */return sy=function(t){const n=!0;t.s.hooks.pre("save",!1,(function(t){if(this.$isSubdocument)return void t();const n=this,r=this.$getAllSubdocs({useCache:!0});r.length?e(r,(function(e,t){e.$__schema.s.hooks.execPre("save",e,(function(e){t(e)}))}),(function(e){if(n.$__.saveOptions&&(n.$__.saveOptions.__subdocs=null),e)return n.$__schema.s.hooks.execPost("save:error",n,[n],{error:e},(function(e){t(e)}));t()})):t()}),null,n),t.s.hooks.post("save",(async function(){const e=this.$__.removedSubdocs;if(!e||!e.length)return;const t=[];for(const n of e)t.push(new Promise(((e,t)=>{n.$__schema.s.hooks.execPost("deleteOne",n,[n],(function(n){if(n)return t(n);e()}))})));this.$__.removedSubdocs=null,await Promise.all(t)})),t.s.hooks.post("save",(async function(){if(this.$isSubdocument)return;const e=this,t=this.$getAllSubdocs({useCache:!0});if(!t.length)return;const n=[];for(const e of t)n.push(new Promise(((t,n)=>{e.$__schema.s.hooks.execPost("save",e,[e],(function(e){if(e)return n(e);t()}))})));try{await Promise.all(n)}catch(t){await new Promise(((n,r)=>{this.$__schema.s.hooks.execPost("save:error",e,[e],{error:t},(function(e){if(e)return r(e);n()}))}))}}),null,n)},sy}(),ay.sharding=function(){if(ly)return Ky.exports;ly=1;const e=Aa().objectIdSymbol,t=uf();
/*!
	 * ignore
	 */
function n(){let e,t;if(this.$__.shardval){e=Object.keys(this.$__.shardval),t=e.length,this.$where=this.$where||{};for(let n=0;n<t;++n)this.$where[e[n]]=this.$__.shardval[e[n]]}}
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function r(){const n=this.$__schema.options.shardKey||this.$__schema.options.shardkey;if(!t.isPOJO(n))return;const r=this.$__.shardval={},o=Object.keys(n),i=o.length;let s;for(let n=0;n<i;++n)s=this.$__getValue(o[n]),null==s?r[o[n]]=s:t.isMongooseObject(s)?r[o[n]]=s.toObject({depopulate:!0,_isNested:!0}):s instanceof Date||s[e]?r[o[n]]=s:"function"==typeof s.valueOf?r[o[n]]=s.valueOf():r[o[n]]=s}
/*!
	 * ignore
	 */
return Ky.exports=function(e){e.post("init",(function(){return r.call(this),this})),e.pre("save",(function(e){n.call(this),e()})),e.pre("remove",(function(e){n.call(this),e()})),e.post("save",(function(){r.call(this)}))},Ky.exports.storeShard=r,Ky.exports}(),ay.trackTransaction=Yy(),ay.validateBeforeSave=(fy||(fy=1,
/*!
	 * ignore
	 */
dy=function(e){e.pre("save",!1,(function(e,t){const n=this;if(this.$isSubdocument)return e();let r;if(r=t&&"object"==typeof t&&"validateBeforeSave"in t?!!t.validateBeforeSave:this.$__schema.options.validateBeforeSave,r){const r=t&&"object"==typeof t&&"validateModifiedOnly"in t?{validateModifiedOnly:t.validateModifiedOnly}:null;this.$validate(r).then((()=>{this.$op="save",e()}),(t=>{n.$__schema.s.hooks.execPost("save:error",n,[n],{error:t},(function(t){n.$op="save",e(t)}))}))}else e()}),null,!0)}),dy)),ay}function Jy(){if(gy)return yy;gy=1;const e=Qy();return yy=function(t){for(const n of Object.values(e))n(t,{deduplicate:!0});t.plugins=Object.values(e).map((e=>({fn:e,opts:{deduplicate:!0}}))).concat(t.plugins)},yy}function Xy(){if(Ay)return Ey;Ay=1;const e=oh(),t=Ba(),n=Ga(),r=ba(),o=Ha();return Ey=function i(s,u,a,c){const l=Object.keys(u);let h=0;const p=l.length;let d;if(a=a||"",!(c=c||new WeakSet).has(u)){for(c.add(u);h<p;)if(d=l[h++],(a||"discriminators"!==d&&"base"!==d&&"_applyDiscriminators"!==d&&"_userProvidedOptions"!==d&&"options"!==d&&"tree"!==d)&&!("tree"===a&&null!=u&&u.instanceOfSchema||t.has(d)))if(null==s[d])s[d]=u[d];else if(o(u[d])){if(o(s[d])||(s[d]={}),null!=u[d]){if(u[d].$isSingleNested&&s[d].$isMongooseDocumentArray||u[d].$isMongooseDocumentArray&&s[d].$isSingleNested||u[d].$isMongooseDocumentArrayElement&&s[d].$isMongooseDocumentArrayElement)continue;if(u[d].instanceOfSchema){s[d].instanceOfSchema?e(s[d],u[d].clone(),!0):s[d]=u[d].clone();continue}if(n(u[d],"ObjectId")){s[d]=new r(u[d]);continue}}i(s[d],u[d],a?a+"."+d:d,c)}null!=u&&u.instanceOfSchema&&(s.tree=Object.assign({},u.tree,s.tree))}}}function Zy(){if(_y)return by;_y=1;const e=Ih(),t=Jy(),n=oc(),r=Hh().defineKey,o=wp(),i=uf(),s=Xy(),u={toJSON:!0,toObject:!0,_id:!0,id:!0,virtuals:!0,methods:!0};
/*!
	 * ignore
	 */
return by=function(a,c,l,h,p,d,f){if(!l||!l.instanceOfSchema)throw new Error("You must pass a valid discriminator Schema");if(d=null==d||d,a.schema.discriminatorMapping&&!a.schema.discriminatorMapping.isRoot)throw new Error('Discriminator "'+c+'" can only be a discriminator of the root model');if(p){const e=o(a.base,"options.applyPluginsToDiscriminators",!1)||!d;a.base._applyPlugins(l,{skipTopLevel:!e})}else d||t(l);const m=a.schema.options.discriminatorKey,y=a.schema.path(m);if(null!=y)i.hasUserDefinedProperty(y.options,"select")||(y.options.select=!0),y.options.$skipDiscriminatorCheck=!0;else{const e={};e[m]={default:void 0,select:!0,$skipDiscriminatorCheck:!0},e[m][a.schema.options.typeKey]=String,a.schema.add(e),r({prop:m,prototype:a.prototype,options:a.schema.options})}if(l.path(m)&&!0!==l.path(m).options.$skipDiscriminatorCheck)throw new Error('Discriminator "'+c+'" cannot have field with name "'+m+'"');let g=c;if(("string"==typeof h&&h.length||null!=h)&&(g=h),function(t,r){t._baseSchema=r,r.paths._id&&r.paths._id.options&&!r.paths._id.options.auto&&t.remove("_id");const o=Object.keys(r.paths),c=[];for(const n of o){if(t.nested[n]){c.push(n);continue}if(-1===n.indexOf("."))continue;const r=n.split(".").slice(0,-1);let o="";for(const i of r)o+=(o.length?".":"")+i,(t.paths[o]instanceof e||t.singleNestedPaths[o]instanceof e)&&c.push(n)}t.obj={...t.obj},s(t,r),t._gatherChildSchemas();for(const e of c)delete t.paths[e];t.childSchemas.forEach((e=>{e.model.prototype.$__setSchema(e.schema)}));const l={};l[m]={default:g,select:!0,set:function(e){if(e===g||Array.isArray(g)&&i.deepEqual(e,g))return g;throw new Error("Can't set discriminator key \""+m+'"')},$skipDiscriminatorCheck:!0},l[m][t.options.typeKey]=y?y.options[t.options.typeKey]:String,t.add(l),t.discriminatorMapping={key:m,value:g,isRoot:!1},r.options.collection&&(t.options.collection=r.options.collection);const h=t.options.toJSON,f=t.options.toObject,E=t.options._id,A=t.options.id,b=Object.keys(t.options);t.options.discriminatorKey=r.options.discriminatorKey;const _=t._userProvidedOptions;for(const e of b)if(!u[e]&&e in _&&!i.deepEqual(t.options[e],r.options[e]))throw new Error("Can't customize discriminator option "+e+" (can only modify "+Object.keys(u).join(", ")+")");t.options=n(r.options);for(const e of Object.keys(_))t.options[e]=_[e];h&&(t.options.toJSON=h),f&&(t.options.toObject=f),void 0!==E&&(t.options._id=E),t.options.id=A,d&&(t.s.hooks=a.schema.s.hooks.merge(t.s.hooks)),p&&(t.plugins=Array.prototype.slice.call(r.plugins)),t.callQueue=r.callQueue.concat(t.callQueue),delete t._requiredpaths}(l,a.schema),a.discriminators||(a.discriminators={}),a.schema.discriminatorMapping||(a.schema.discriminatorMapping={key:m,value:null,isRoot:!0}),a.schema.discriminators||(a.schema.discriminators={}),a.schema.discriminators[c]=l,a.discriminators[c]&&!l.options.overwriteModels&&!f)throw new Error('Discriminator with name "'+c+'" already exists');return l},by}function eg(){if(Cy)return Oy;Cy=1;const e=Zp();return Oy=function(t,n,r){const o=t.schema.options.discriminatorKey;let i=null!=n&&n[o];if(null==i&&(i=r),t.discriminators&&null!=i)if(t.discriminators[i])t=t.discriminators[i];else{const n=e(t.discriminators,i);n&&(t=n)}return t}}function tg(){if(Sy)return wy;Sy=1;const e=df();return wy=function(t,n){return null==n||null==n._id||(t=t.clone(),n._id?t.paths._id||(e(t),t.options._id=!0):(t.remove("_id"),t.options._id=!1)),t},wy}function ng(){if(Dy)return vy;Dy=1;const e=pa();class t extends e{constructor(e,t){super(`Cannot create use schema for property "${e}" because the schema has the ${t} option enabled.`)}}return Object.defineProperty(t.prototype,"name",{value:"InvalidSchemaOptionError"}),
/*!
	 * exports
	 */
vy=t}function rg(){if(Ty)return My;Ty=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),n=t.EventEmitter,r=Rh(),o=function(){if(Qm)return Ym;Qm=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"_id",n),Ym=t}(),i=af(),s=Uh(),u=Tl(),a=Sm().castToNumber,c=Om(),l=Zy(),h=Xm(),p=eg(),d=tg(),f=Ma().internalToObjectOptions,m=Fp(),y=uf(),g=ng();let E;function A(e,t,n){if(e.options.timeseries)throw new g(t,"timeseries");const r=A.defaultOptions&&A.defaultOptions._id;null!=r&&((n=n||{})._id=r),e=d(e,n),this.caster=b(e,null,n),this.caster.path=t,this.caster.prototype.$basePath=t,this.schema=e,this.$isSingleNested=!0,this.base=e.base,i.call(this,t,n,"Embedded")}
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function b(e,t,r){E||(E=od());const o=function(e,t,n){this.$__parent=n,E.apply(this,arguments),null!=n&&this.$session(n.$session())};e._preCompile();const i=null!=t?t.prototype:E.prototype;(o.prototype=Object.create(i)).$__setSchema(e),o.prototype.constructor=o,o.$__required=r?.required,o.base=e.base,o.schema=e,o.$isSingleNested=!0,o.events=new n,o.prototype.toBSON=function(){return this.toObject(f)};for(const t in e.methods)o.prototype[t]=e.methods[t];for(const t in e.statics)o[t]=e.statics[t];for(const e in n.prototype)o[e]=n.prototype[e];return o}return My=A,A.prototype=Object.create(i.prototype),A.prototype.constructor=A,A.prototype.OptionsConstructor=o,A.prototype.$conditionalHandlers.$geoWithin=function(e,t){return{$geometry:this.castForQuery(null,e.$geometry,t)}},
/*!
	 * ignore
	 */
A.prototype.$conditionalHandlers.$near=A.prototype.$conditionalHandlers.$nearSphere=h.cast$near,A.prototype.$conditionalHandlers.$within=A.prototype.$conditionalHandlers.$geoWithin=h.cast$within,A.prototype.$conditionalHandlers.$geoIntersects=h.cast$geoIntersects,A.prototype.$conditionalHandlers.$minDistance=a,A.prototype.$conditionalHandlers.$maxDistance=a,A.prototype.$conditionalHandlers.$exists=u,A.prototype.cast=function(e,t,n,o,i){if(e&&e.$isSingleNested&&e.parent===t)return e;if(null!=e&&("object"!=typeof e||Array.isArray(e)))throw new r(this.path,e);const u=this.schema.path(this.schema.options.discriminatorKey),a=null==u?null:u.getDefault(t),c=p(this.caster,e,a);let l;const h=t&&t.$__&&t.$__.selected,d=this.path,f=null==h?null:Object.keys(h).reduce(((e,t)=>(t.startsWith(d+".")&&((e=e||{})[t.substring(d.length+1)]=h[t]),e)),null);if(!n)return i=Object.assign({},i,{priorDoc:o}),0===Object.keys(e).length?new c({},f,t,void 0,i):new c(e,f,t,void 0,i);{l=new c(void 0,f,t,!1,{defaults:!1}),delete l.$__.defaults,l.$init(e);const n=m(f);s(l,f,n)}return l},A.prototype.castForQuery=function(t,n,r,o){let i;if(null!=t){if(i=this.$conditionalHandlers[t],!i)throw new Error("Can't use "+t);return i.call(this,n)}if(null==n)return n;const s=p(this.caster,n);if(n instanceof s)return n;this.options.runSetters&&(n=this._applySetters(n,r));const u=null!=o&&null!=o.strict?o.strict:void 0;try{n=new s(n,u)}catch(t){if(!(t instanceof e))throw new e("Embedded",n,this.path,t,this);throw t}return n},A.prototype.doValidate=function(e,t,n,r){const o=p(this.caster,e);if(!e||e instanceof o||(e=new o(e,null,null!=n&&null!=n.$__?n:null)),r&&r.skipSchemaValidators)return e?e.validate().then((()=>t(null)),(e=>t(e))):t(null);i.prototype.doValidate.call(this,e,(function(n){return n?t(n):e?void e.validate().then((()=>t(null)),(e=>t(e))):t(null)}),n,r)},A.prototype.doValidateSync=function(e,t,n){if(!n||!n.skipSchemaValidators){const n=i.prototype.doValidateSync.call(this,e,t);if(n)return n}if(e)return e.validateSync()},A.prototype.discriminator=function(e,t,n){n=n||{};const r=y.isPOJO(n)?n.value:n,o="boolean"!=typeof n.clone||n.clone;return t.instanceOfSchema&&o&&(t=t.clone()),t=l(this.caster,e,t,r,null,null,n.overwriteExisting),this.caster.discriminators[e]=b(t,this.caster),this.caster.discriminators[e]},
/*!
	 * ignore
	 */
A.defaultOptions={},A.set=i.set,A.setters=[],A.get=i.get,
/*!
	 * ignore
	 */
A.prototype.toJSON=function(){return{path:this.path,options:this.options}},
/*!
	 * ignore
	 */
A.prototype.clone=function(){const e=new this.constructor(this.schema,this.path,{...this.options,_skipApplyDiscriminators:!0});return e.validators=this.validators.slice(),void 0!==this.requiredValidator&&(e.requiredValidator=this.requiredValidator),e.caster.discriminators=Object.assign({},this.caster.discriminators),e._appliedDiscriminators=this._appliedDiscriminators,e},A.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return{...this.schema.toJSONSchema(e),...c("object","object",e?.useBsonType,t)}},My}
/*!
 * Module dependencies.
 */function og(){if(Ny)return Py;Ny=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),n=function(){if(Fy)return By;Fy=1;const e=pa(),t=af(),n=rg(),r=eg();function o(n,r){if(this.$parentSchemaType=r&&r.$parentSchemaType,!this.$parentSchemaType)throw new e("Cannot create DocumentArrayElement schematype without a parent");delete r.$parentSchemaType,t.call(this,n,r,"DocumentArrayElement"),this.$isMongooseDocumentArrayElement=!0}return o.schemaName="DocumentArrayElement",o.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype.cast=function(...e){return this.$parentSchemaType.cast(...e)[0]},o.prototype.doValidate=function(e,t,o,i){const s=r(this.caster,e);return!e||e instanceof s||(e=new s(e,o,null,null,i&&null!=i.index?i.index:null)),n.prototype.doValidate.call(this,e,t,o,i)},o.prototype.clone=function(){this.options.$parentSchemaType=this.$parentSchemaType;const e=t.prototype.clone.apply(this,arguments);return delete this.options.$parentSchemaType,e.caster=this.caster,e.schema=this.schema,e},
/*!
	 * Module exports.
	 */
By=o}(),r=t.EventEmitter,o=Zm(),i=function(){if(xy)return $y;xy=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"excludeIndexes",n),Object.defineProperty(t.prototype,"_id",n),
/*!
	 * ignore
	 */
$y=t}(),s=af(),u=hm(),a=Om(),c=Zy(),l=tg(),h=Tp(),p=lm(),d=uf(),f=eg(),m=ng(),y=Aa().arrayAtomicsSymbol,g=Aa().arrayPathSymbol,E=Aa().documentArrayParent;let A,b;function _(e,t,r,i){if(t.options&&t.options.timeseries)throw new m(e,"timeseries");const s=_.defaultOptions&&_.defaultOptions._id;null!=s&&((i=i||{})._id=s),null!=i&&null!=i._id?t=l(t,i):null!=r&&null!=r._id&&(t=l(t,r));const u=O(t,r);u.prototype.$basePath=e,o.call(this,e,u,r),this.schema=t,this.schemaOptions=i||{},this.$isMongooseDocumentArray=!0,this.Constructor=u,u.base=t.base;const a=this.defaultValue;"defaultValue"in this&&null==a||this.default((function(){let e=a.call(this);return null==e||Array.isArray(e)||(e=[e]),e}));this.$embeddedSchemaType=new n(e+".$",{required:this&&this.schemaOptions&&this.schemaOptions.required||!1,$parentSchemaType:this}),this.$embeddedSchemaType.caster=this.Constructor,this.$embeddedSchemaType.schema=this.schema}
/*!
	 * ignore
	 */
function O(e,t,n){function o(){b.apply(this,arguments),null!=this.__parentArray&&null!=this.__parentArray.getArrayParent()&&this.$session(this.__parentArray.getArrayParent().$session())}b||(b=id()),e._preCompile();const i=null!=n?n.prototype:b.prototype;o.prototype=Object.create(i),o.prototype.$__setSchema(e),o.schema=e,o.prototype.constructor=o,o.$isArraySubdocument=!0,o.events=new r,o.base=e.base;for(const t in e.methods)o.prototype[t]=e.methods[t];for(const t in e.statics)o[t]=e.statics[t];for(const e in r.prototype)o[e]=r.prototype[e];return o.options=t,o}_.schemaName="DocumentArray",_.options={castNonArrays:!0},
/*!
	 * Inherits from SchemaArray.
	 */
_.prototype=Object.create(o.prototype),_.prototype.constructor=_,_.prototype.OptionsConstructor=i,_.prototype.$conditionalHandlers={...o.prototype.$conditionalHandlers},_.prototype.discriminator=function(e,t,n){"function"==typeof e&&(e=d.getFunctionName(e)),n=n||{};const r=d.isPOJO(n)?n.value:n,o="boolean"!=typeof n.clone||n.clone;t.instanceOfSchema&&o&&(t=t.clone());const i=O(t=c(this.casterConstructor,e,t,r,null,null,n?.overwriteExisting),null,this.casterConstructor);i.baseCasterConstructor=this.casterConstructor;try{Object.defineProperty(i,"name",{value:e})}catch(e){}return this.casterConstructor.discriminators[e]=i,this.casterConstructor.discriminators[e]},_.prototype.doValidate=function(e,t,n,r){A||(A=of());const o=this;try{s.prototype.doValidate.call(this,e,(function(i){if(i)return t(i);let s,u=e&&e.length;if(!u)return t();if(r&&r.updateValidator)return t();d.isMongooseDocumentArray(e)||(e=new A(e,o.path,n));function a(e){null!=e&&(s=e),--u||t(s)}for(let n=0,i=u;n<i;++n){let i=e[n];if(null!=i){if(!(i instanceof b)){const t=f(o.casterConstructor,e[n]);i=e[n]=new t(i,e,void 0,void 0,n)}null==r||!r.validateModifiedOnly||i.$isModified()?i.$__validate(null,r,a):--u||t(s)}else--u||t(s)}}),n)}catch(e){return t(e)}},_.prototype.doValidateSync=function(e,t,n){const r=s.prototype.doValidateSync.call(this,e,t);if(null!=r)return r;const o=e&&e.length;let i=null;if(o){for(let t=0,r=o;t<r;++t){let r=e[t];if(!r)continue;if(!(r instanceof b)){const n=f(this.casterConstructor,e[t]);r=e[t]=new n(r,e,void 0,void 0,t)}if(null!=n&&n.validateModifiedOnly&&!r.$isModified())continue;const o=r.validateSync(n);o&&null==i&&(i=o)}return i}},
/*!
	 * ignore
	 */
_.prototype.getDefault=function(e,t,n){let r="function"==typeof this.defaultValue?this.defaultValue.call(e):this.defaultValue;if(null==r)return r;if(n&&n.skipCast)return r;A||(A=of()),Array.isArray(r)||(r=[r]),r=new A(r,this.path,e);for(let e=0;e<r.length;++e){const t=new(f(this.casterConstructor,r[e]))({},r,void 0,void 0,e);t.$init(r[e]),t.isNew=!0,Object.assign(t.$__.activePaths.default,t.$__.activePaths.init),t.$__.activePaths.init={},r[e]=t}return r};const C=Object.freeze({transform:!1,virtuals:!1}),w=Object.freeze({skipId:!1,willInit:!0});function S(e,t,n){if(!n||!t)return;const r=e.path+".",o=Object.keys(t);let i=o.length;const s={};let u,a,c;for(;i--;)if(a=o[i],a.startsWith(r)){if(c=a.substring(r.length),"$"===c)continue;c.startsWith("$.")&&(c=c.substring(2)),u||(u=!0),s[c]=t[a]}return u&&s||void 0}
/*!
	 * ignore
	 */return _.prototype.cast=function(t,n,r,o,i){if(A||(A=of()),null!=t&&null!=t[g]&&t===o)return t;let s,u;const a=(i=i||{}).path||this.path;if(!Array.isArray(t)){if(!r&&!_.options.castNonArrays)throw new e("DocumentArray",t,this.path,null,this);return n&&r&&n.markModified(a),this.cast([t],n,r,o,i)}i.skipDocumentArrayCast&&!d.isMongooseDocumentArray(t)||(t=new A(t,a,n,this)),null!=o&&(t[y]=o[y]||{}),null!=i.arrayPathIndex&&(t[g]=a+"."+i.arrayPathIndex);const c=d.isMongooseDocumentArray(t)?t.__array:t,l=c.length;for(let i=0;i<l;++i){if(!c[i])continue;const a=f(this.casterConstructor,c[i]),l=h(c[i],!0);if(c[i]!==l&&(c[i]=l),c[i]instanceof b){if(c[i][E]!==n)if(r){const e=new a(null,t,w,s,i);c[i]=e.$init(c[i])}else{const e=new a(c[i],t,void 0,void 0,i);c[i]=e}null==c[i].__index&&c[i].$setIndex(i)}else if(null!=c[i])if(r)n?s||(s=S(this,n.$__.selected,r)):s=!0,u=new a(null,t,w,s,i),c[i]=u.$init(c[i]);else if(o&&"function"==typeof o.id&&(u=o.id(c[i]._id)),o&&u&&d.deepEqual(u.toObject(C),c[i]))u.set(c[i]),c[i]=u;else try{u=new a(c[i],t,void 0,void 0,i),c[i]=u}catch(n){throw new e("embedded",c[i],t[g],n,this)}}return t},
/*!
	 * ignore
	 */
_.prototype.clone=function(){const e=Object.assign({},this.options),t=new this.constructor(this.path,this.schema,e,this.schemaOptions);return t.validators=this.validators.slice(),void 0!==this.requiredValidator&&(t.requiredValidator=this.requiredValidator),t.Constructor.discriminators=Object.assign({},this.Constructor.discriminators),t._appliedDiscriminators=this._appliedDiscriminators,t},
/*!
	 * ignore
	 */
_.prototype.applyGetters=function(e,t){return s.prototype.applyGetters.call(this,e,t)},_.defaultOptions={},_.set=s.set,_.setters=[],_.get=s.get,
/*!
	 * Handle casting $elemMatch operators
	 */
_.prototype.$conditionalHandlers.$elemMatch=function(e,t){const n=Object.keys(e),r=n.length;for(let o=0;o<r;++o){const r=n[o],i=e[r];p(r)&&null!=i&&(e[r]=this.castForQuery(r,i,t))}const o=this&&this.casterConstructor&&this.casterConstructor.schema&&this.casterConstructor.schema.options&&this.casterConstructor.schema.options.discriminatorKey,i=this&&this.casterConstructor&&this.casterConstructor.schema&&this.casterConstructor.schema.discriminators||{};if(null!=o&&null!=e[o]&&null!=i[e[o]])return u(i[e[o]],e,null,this&&this.$$context);const s=this.casterConstructor.schema??t.schema;return u(s,e,null,this&&this.$$context)},_.prototype.toJSONSchema=function(e){const t=a("object","object",e?.useBsonType,!1),n=this.options.required&&"function"!=typeof this.options.required;return{...a("array","array",e?.useBsonType,n),items:{...t,...this.schema.toJSONSchema(e)}}},
/*!
	 * Module exports.
	 */
Py=_}function ig(){if(jy)return ky;jy=1;
/*!
	 * ignore
	 */
const e=jf(),t=function(){if(Ry)return Iy;Ry=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"of",n),Iy=t}(),n=af(),r=Om();
/*!
	 * ignore
	 */
class o extends n{constructor(e,t){super(e,t,"Map"),this.$isSchemaMap=!0}set(e,t){return n.set(e,t)}cast(t,n,r){if(t instanceof e)return t;const o=this.path;if(r){const r=new e({},o,n,this.$__schemaType);if(t instanceof b.Map)for(const e of t.keys()){let i=t.get(e);i=null==i?r.$__schemaType._castNullish(i):r.$__schemaType.cast(i,n,!0,null,{path:o+"."+e}),r.$init(e,i)}else for(const e of Object.keys(t)){let i=t[e];i=null==i?r.$__schemaType._castNullish(i):r.$__schemaType.cast(i,n,!0,null,{path:o+"."+e}),r.$init(e,i)}return r}return new e(t,o,n,this.$__schemaType)}clone(){const e=super.clone();return null!=this.$__schemaType&&(e.$__schemaType=this.$__schemaType.clone()),e}getEmbeddedSchemaType(){return this.$__schemaType}toJSONSchema(e){const t=e?.useBsonType,n=this.getEmbeddedSchemaType(),o=this.options.required&&"function"!=typeof this.options.required,i=r("object","object",t,o);return i.additionalProperties=n.toJSONSchema(e),i}}return o.schemaName="Map",o.prototype.OptionsConstructor=t,o.defaultOptions={},ky=o}function sg(){if(zy)return Vy;zy=1;const e=function(){if(Uy)return Ly;Uy=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"auto",n),Object.defineProperty(t.prototype,"populate",n),
/*!
	 * ignore
	 */
Ly=t}
/*!
 * Module dependencies.
 */(),t=af(),n=rf(),r=Om(),o=_a(),i=ba(),s=Ga(),u=uf(),a=t.CastError;let c;function l(e,n){const r="string"==typeof e&&24===e.length&&/^[a-f0-9]+$/i.test(e),o=n&&n.suppressWarning;!r&&void 0!==e||o||u.warn("mongoose: To create a new ObjectId please try `Mongoose.Types.ObjectId` instead of using `Mongoose.Schema.ObjectId`. Set the `suppressWarning` option if you're trying to create a hex char path in your schema."),t.call(this,e,n,"ObjectId")}
/*!
	 * ignore
	 */
function h(e){return this.cast(e)}
/*!
	 * ignore
	 */
function p(){return new i}function d(e){if(c||(c=sf()),this instanceof c&&void 0===e){return new i}return e}return l.schemaName="ObjectId",l.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
l.prototype=Object.create(t.prototype),l.prototype.constructor=l,l.prototype.OptionsConstructor=e,l.get=t.get,l.set=t.set,l.setters=[],l.prototype.auto=function(e){return e&&(this.default(p),this.set(d)),this},
/*!
	 * ignore
	 */
l._checkRequired=e=>s(e,"ObjectId")
/*!
	 * ignore
	 */,l._cast=n,l.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
l._defaultCaster=e=>{if(!s(e,"ObjectId"))throw new Error(e+" is not an instance of ObjectId");return e},l.checkRequired=t.checkRequired,l.prototype.checkRequired=function(e,n){if(t._isRef(this,e,n,!0))return!!e;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():l.checkRequired())(e)},l.prototype.cast=function(e,n,r,c,h){if(!s(e,"ObjectId")&&t._isRef(this,e,n,r)){if("objectid"===(o(e)||"").toLowerCase())return new i(e.toHexString());if(null==e||u.isNonBuiltinObject(e))return this._castRef(e,n,r,h)}let p;p="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():l.cast();try{return p(e)}catch(t){throw new a("ObjectId",e,this.path,t,this)}},l.prototype.$conditionalHandlers={...t.prototype.$conditionalHandlers,$gt:h,$gte:h,$lt:h,$lte:h},p.$runBeforeSetters=!0,l.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required||"_id"===this.path;return r("string","objectId",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Vy=l}function ug(){if(Hy)return Gy;Hy=1;
/*!
	 * Module dependencies.
	 */
const e=af(),t=dl(),n=function(){if(qy)return Wy;qy=1;const e=ml();class t extends e{}const n=fl();return Object.defineProperty(t.prototype,"enum",n),Object.defineProperty(t.prototype,"match",n),Object.defineProperty(t.prototype,"lowercase",n),Object.defineProperty(t.prototype,"trim",n),Object.defineProperty(t.prototype,"uppercase",n),Object.defineProperty(t.prototype,"minLength",n),Object.defineProperty(t.prototype,"minlength",n),Object.defineProperty(t.prototype,"maxLength",n),Object.defineProperty(t.prototype,"maxlength",n),Object.defineProperty(t.prototype,"populate",n),
/*!
	 * ignore
	 */
Wy=t}(),r=cm(),o=Om(),i=uf(),s=Ga(),u=e.CastError;function a(t,n){this.enumValues=[],this.regExp=null,e.call(this,t,n,"String")}
/*!
	 * ignore
	 */
function c(e,t){return this.castForQuery(null,e,t)}
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function l(e){return null==e?this._castNullish(e):this.cast(e,this)}a.schemaName="String",a.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
a.prototype=Object.create(e.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,"OptionsConstructor",{configurable:!1,enumerable:!1,writable:!1,value:n}),
/*!
	 * ignore
	 */
a._cast=r,a.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
a._defaultCaster=e=>{if(null!=e&&"string"!=typeof e)throw new Error;return e},a.get=e.get,a.set=e.set,a.setters=[],
/*!
	 * ignore
	 */
a._checkRequired=e=>(e instanceof String||"string"==typeof e)&&e.length,a.checkRequired=e.checkRequired,a.prototype.enum=function(){if(this.enumValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.enumValidator}),this),this.enumValidator=!1),void 0===arguments[0]||!1===arguments[0])return this;let e,n;i.isObject(arguments[0])?Array.isArray(arguments[0].values)?(e=arguments[0].values,n=arguments[0].message):(e=i.object.vals(arguments[0]),n=t.messages.String.enum):(e=arguments,n=t.messages.String.enum);for(const t of e)void 0!==t&&this.enumValues.push(this.cast(t));const r=this.enumValues;return this.enumValidator=function(e){return null==e||~r.indexOf(e)},this.validators.push({validator:this.enumValidator,message:n,type:"enum",enumValues:r}),this},a.prototype.lowercase=function(e){return arguments.length>0&&!e?this:this.set((e=>("string"!=typeof e&&(e=this.cast(e)),e?e.toLowerCase():e)))},a.prototype.uppercase=function(e){return arguments.length>0&&!e?this:this.set((e=>("string"!=typeof e&&(e=this.cast(e)),e?e.toUpperCase():e)))},a.prototype.trim=function(e){return arguments.length>0&&!e?this:this.set((e=>("string"!=typeof e&&(e=this.cast(e)),e?e.trim():e)))},a.prototype.minlength=function(e,n){if(this.minlengthValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.minlengthValidator}),this)),null!=e){let r=n||t.messages.String.minlength;r=r.replace(/{MINLENGTH}/,e),this.validators.push({validator:this.minlengthValidator=function(t){return null===t||t.length>=e},message:r,type:"minlength",minlength:e})}return this},a.prototype.minLength=a.prototype.minlength,a.prototype.maxlength=function(e,n){if(this.maxlengthValidator&&(this.validators=this.validators.filter((function(e){return e.validator!==this.maxlengthValidator}),this)),null!=e){let r=n||t.messages.String.maxlength;r=r.replace(/{MAXLENGTH}/,e),this.validators.push({validator:this.maxlengthValidator=function(t){return null===t||t.length<=e},message:r,type:"maxlength",maxlength:e})}return this},a.prototype.maxLength=a.prototype.maxlength,a.prototype.match=function(e,n){const r=n||t.messages.String.match;return this.validators.push({validator:function(t){if(!e)return!1;e.lastIndex=0;return null==t||""===t||e.test(t)},message:r,type:"regexp",regexp:e}),this},a.prototype.checkRequired=function(t,n){if("object"==typeof t&&e._isRef(this,t,n,!0))return null!=t;return("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():a.checkRequired())(t)},a.prototype.cast=function(t,n,r,o,i){if("string"!=typeof t&&e._isRef(this,t,n,r))return this._castRef(t,n,r,i);let s;s="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():a.cast();try{return s(t)}catch(e){throw new u("string",t,this.path,null,this)}};const h={...e.prototype.$conditionalHandlers,$all:function(e,t){const n=this;return Array.isArray(e)?e.map((function(e){return n.castForQuery(null,e,t)})):[this.castForQuery(null,e,t)]},$gt:c,$gte:c,$lt:c,$lte:c,$options:l,$regex:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)?e:l.call(this,e)},$not:c};return Object.defineProperty(a.prototype,"$conditionalHandlers",{configurable:!1,enumerable:!1,writable:!1,value:Object.freeze(h)}),a.prototype.castForQuery=function(e,t,n){let r;if(null!=e){if(r=this.$conditionalHandlers[e],!r)throw new Error("Can't use "+e+" with String.");return r.call(this,t,n)}if("[object RegExp]"===Object.prototype.toString.call(t)||s(t,"BSONRegExp"))return t;try{return this.applySetters(t,n)}catch(e){throw e instanceof u&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}},a.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return o("string","string",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
Gy=a}var ag,cg,lg,hg,pg,dg,fg,mg,yg,gg,Eg,Ag,bg,_g,Og,Cg,wg,Sg,vg,Dg={exports:{}};function Mg(){if(ag)return Dg.exports;ag=1;const e=fh(),t=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i,n=e.Binary;function r(t){"string"!=typeof t&&(t="");const n=function(e){return null!=e&&Buffer.from(e,"hex")}(t.replace(/[{}-]/g,"")),r=new e(n);return r._subtype=4,r}return Dg.exports=function(o){if(null==o)return o;function i(t){const n=new e(t);return n._subtype=4,n}if("string"==typeof o){if(t.test(o))return r(o);throw new Error(`"${o}" is not a valid UUID string`)}if(Buffer.isBuffer(o))return i(o);if(o instanceof n)return i(o.value(!0));if(o.toString&&o.toString!==Object.prototype.toString&&t.test(o.toString()))return r(o.toString());throw new Error(`"${o}" cannot be casted to a UUID`)},Dg.exports.UUID_FORMAT=t,Dg.exports}
/*!
 * Module dependencies.
 */function Tg(){if(fg)return dg;fg=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),t=af(),n=function(){if(pg)return hg;pg=1;const e=g,t=B(),n=Ga();return hg=function(r){if(null==r||""===r)return null;let o;if(n(r,"Long"))o=r.toNumber();else if("string"==typeof r)try{return o=t.Double.fromString(r),o}catch{e.ok(!1)}else if("object"==typeof r){const n=r.valueOf()??r.toString();if("string"==typeof n)try{return o=t.Double.fromString(r),o}catch{e.ok(!1)}else o=Number(n)}else o=Number(r);return new t.Double(o)}}(),r=Om();function o(e,n){t.call(this,e,n,"Double")}
/*!
	 * ignore
	 */
function i(e){return this.cast(e)}return o.schemaName="Double",o.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
o.prototype=Object.create(t.prototype),o.prototype.constructor=o,
/*!
	 * ignore
	 */
o._cast=n,o.set=t.set,o.setters=[],o.get=t.get,
/*!
	 * ignore
	 */
o._defaultCaster=e=>{if(null!=e&&"Double"!==e._bsontype)throw new Error;return e},o.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
o._checkRequired=e=>null!=e,o.checkRequired=t.checkRequired,o.prototype.checkRequired=function(e){return this.constructor._checkRequired(e)},o.prototype.cast=function(t){let n;n="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():o.cast();try{return n(t)}catch(n){throw new e("Double",t,this.path,n,this)}},o.prototype.$conditionalHandlers={...t.prototype.$conditionalHandlers,$gt:i,$gte:i,$lt:i,$lte:i},o.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("number","double",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
dg=o}function Bg(){if(Eg)return gg;Eg=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),t=af(),n=function(){if(yg)return mg;yg=1;const e=Ga(),t=g;return mg=function(n){if(null==n)return n;if(""===n)return null;const r=e(n,"Long")?n.toNumber():Number(n);if(r===(0|r)&&r>=-2147483648&&r<=2147483647)return r;t.ok(!1)}}(),r=Om(),o=Cm();function i(e,n){t.call(this,e,n,"Int32")}
/*!
	 * ignore
	 */
function s(e,t){return this.castForQuery(null,e,t)}return i.schemaName="Int32",i.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
i.prototype=Object.create(t.prototype),i.prototype.constructor=i,
/*!
	 * ignore
	 */
i._cast=n,i.set=t.set,i.setters=[],i.get=t.get,
/*!
	 * ignore
	 */
i._defaultCaster=e=>{if(null!=e&&("number"!=typeof e||e!==(0|e)||e<-2147483648||e>2147483647))throw new Error;return e},i.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
i._checkRequired=e=>null!=e,i.checkRequired=t.checkRequired,i.prototype.checkRequired=function(e){return this.constructor._checkRequired(e)},i.prototype.cast=function(t){let n;n="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():i.cast();try{return n(t)}catch(n){throw new e("Int32",t,this.path,n,this)}},
/*!
	 * ignore
	 */
i.$conditionalHandlers={...t.prototype.$conditionalHandlers,$gt:s,$gte:s,$lt:s,$lte:s,$bitsAllClear:o,$bitsAnyClear:o,$bitsAllSet:o,$bitsAnySet:o},i.prototype.castForQuery=function(t,n,r){let o;if(null!=t)return o=i.$conditionalHandlers[t],o?o.call(this,n):this.applySetters(n,r);try{return this.applySetters(n,r)}catch(t){throw t instanceof e&&t.path===this.path&&null!=this.$fullPath&&(t.path=this.$fullPath),t}},i.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("number","int",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
gg=i}function Fg(){return Ag||(Ag=1,(e=im).Array=Zm(),e.BigInt=ey(),e.Boolean=function(){if(Pm)return xm;Pm=1;
/*!
	 * Module dependencies.
	 */
const e=Zc(),t=af(),n=Ml(),r=Om();function o(e,n){t.call(this,e,n,"Boolean")}return o.schemaName="Boolean",o.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
o.prototype=Object.create(t.prototype),o.prototype.constructor=o,
/*!
	 * ignore
	 */
o._cast=n,o.set=t.set,o.setters=[],o.get=t.get,o.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
o._defaultCaster=e=>{if(null!=e&&"boolean"!=typeof e)throw new Error;return e},
/*!
	 * ignore
	 */
o._checkRequired=e=>!0===e||!1===e,o.checkRequired=t.checkRequired,o.prototype.checkRequired=function(e){return this.constructor._checkRequired(e)},Object.defineProperty(o,"convertToTrue",{get:()=>n.convertToTrue,set:e=>{n.convertToTrue=e}}),Object.defineProperty(o,"convertToFalse",{get:()=>n.convertToFalse,set:e=>{n.convertToFalse=e}}),o.prototype.cast=function(t){let n;n="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():o.cast();try{return n(t)}catch(n){throw new e("Boolean",t,this.path,n,this)}},o.$conditionalHandlers={...t.prototype.$conditionalHandlers},o.prototype.castForQuery=function(t,n,r){let i;if(null!=t)return i=o.$conditionalHandlers[t],i?i.call(this,n):this.applySetters(n,r);try{return this.applySetters(n,r)}catch(t){throw t instanceof e&&t.path===this.path&&null!=this.$fullPath&&(t.path=this.$fullPath),t}},o.prototype._castNullish=function(e){if(void 0===e)return e;const t="function"==typeof this.constructor.cast?this.constructor.cast():o.cast();return null==t?e:!(t.convertToFalse instanceof Set&&t.convertToFalse.has(e))&&(!!(t.convertToTrue instanceof Set&&t.convertToTrue.has(e))||e)},o.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return r("boolean","bool",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
xm=o}(),e.Buffer=ty(),e.Date=ny(),e.Decimal128=e.Decimal=ry(),e.DocumentArray=og(),e.Map=ig(),e.Mixed=Ih(),e.Number=wm(),e.ObjectId=sg(),e.String=ug(),e.Subdocument=rg(),e.UUID=function(){if(lg)return cg;lg=1;const e=fh(),t=af(),n=t.CastError,r=Mg(),o=Om(),i=uf(),s=Cm(),u=r.UUID_FORMAT,a=e.Binary;function c(e){let t;return"string"!=typeof e&&null!=e?(t=e.toString("hex"),t.substring(0,8)+"-"+t.substring(8,12)+"-"+t.substring(12,16)+"-"+t.substring(16,20)+"-"+t.substring(20,32)):e}function l(e,n){t.call(this,e,n,"UUID"),this.getters.push((function(e){return null!=e&&null!=e.$__?e:Buffer.isBuffer(e)?c(e):e instanceof a?c(e.buffer):i.isPOJO(e)&&"Buffer"===e.type&&Array.isArray(e.data)?c(Buffer.from(e.data)):e}))}
/*!
	 * ignore
	 */
function h(e){return this.cast(e)}
/*!
	 * ignore
	 */function p(e){return e.map((e=>this.cast(e)))}return l.schemaName="UUID",l.defaultOptions={},
/*!
	 * Inherits from SchemaType.
	 */
l.prototype=Object.create(t.prototype),l.prototype.constructor=l,
/*!
	 * ignore
	 */
l._cast=r,l.get=t.get,l.set=t.set,l.setters=[],l.cast=function(e){return 0===arguments.length||(!1===e&&(e=this._defaultCaster),this._cast=e),this._cast},
/*!
	 * ignore
	 */
l._checkRequired=e=>null!=e,l.checkRequired=t.checkRequired,l.prototype.checkRequired=function(e){return Buffer.isBuffer(e)&&(e=c(e)),null!=e&&u.test(e)},l.prototype.cast=function(e,r,o,s,u){if(i.isNonBuiltinObject(e)&&t._isRef(this,e,r,o))return this._castRef(e,r,o,u);let a;a="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():l.cast();try{return a(e)}catch(t){throw new n(l.schemaName,e,this.path,t,this)}},l.prototype.$conditionalHandlers={...t.prototype.$conditionalHandlers,$bitsAllClear:s,$bitsAnyClear:s,$bitsAllSet:s,$bitsAnySet:s,$all:p,$gt:h,$gte:h,$in:p,$lt:h,$lte:h,$ne:h,$nin:p},l.prototype.castForQuery=function(e,t,r){let o;if(null!=e){if(o=this.$conditionalHandlers[e],!o)throw new Error("Can't use "+e+" with UUID.");return o.call(this,t,r)}try{return this.applySetters(t,r)}catch(e){throw e instanceof n&&e.path===this.path&&null!=this.$fullPath&&(e.path=this.$fullPath),e}},l.prototype.toJSONSchema=function(e){const t=this.options.required&&"function"!=typeof this.options.required;return o("string","binData",e?.useBsonType,t)},
/*!
	 * Module exports.
	 */
cg=l}(),e.Double=Tg(),e.Int32=Bg(),e.Oid=e.ObjectId,e.Object=e.Mixed,e.Bool=e.Boolean,e.ObjectID=e.ObjectId),im;var e}function $g(){return bg||(bg=1,function(e,r){
/*!
		 * Module dependencies.
		 */
const o=t.EventEmitter,i=lc(),s=pa(),u=af(),a=ml(),c=cf(),l=pf(),h=df(),p=oc(),d=wp(),f=_a(),m=mf(),y=yf(),g=function(){if(Nd)return Pd;function e(){return null!=this._id?this._id.toString():null}return Nd=1,
/*!
	 * ignore
	 */
Pd=function(t){return!t.paths.id&&t.paths._id&&t.options.id?(t.aliases&&t.aliases.id||t.virtual("id").get(e),t):t},Pd}(),E=gf(),A=oh(),b=Kl(),_=Ef(),O=wf(),C=uf(),w=function(){if(Zd)return Xd;Zd=1;const e=pa(),t=n;return Xd=function(n,r){if("string"!=typeof n&&"function"!=typeof n)throw new e('Invalid ref at path "'+r+'". Got '+t.inspect(n,{depth:0}))}}(),S=/\.\d+(\.|$)/;let v;const D=Tf().queryMiddlewareFunctions,M=Bf().middlewareFunctions,T=D.concat(M).reduce(((e,t)=>e.add(t)),new Set),B=C.isPOJO;let F=0;const $=/^\d+$/;function x(e,t){if(!(this instanceof x))return new x(e,t);if(this.obj=e,this.paths={},this.aliases={},this.subpaths={},this.virtuals={},this.singleNestedPaths={},this.nested={},this.inherits={},this.callQueue=[],this._indexes=[],this._searchIndexes=[],this.methods=t&&t.methods||{},this.methodOptions={},this.statics=t&&t.statics||{},this.tree={},this.query=t&&t.query||{},this.childSchemas=[],this.plugins=[],this.$id=++F,this.mapPaths=[],this.s={hooks:new i},this.options=this.defaultOptions(t),Array.isArray(e))for(const t of e)this.add(t);else e&&this.add(e);if(t&&t.virtuals){const e=t.virtuals,n=Object.keys(e);for(const t of n){const n=e[t].options?e[t].options:void 0,r=this.virtual(t,n);e[t].get&&r.get(e[t].get),e[t].set&&r.set(e[t].set)}}const n=e&&e._id&&C.isObject(e._id);!this.paths._id&&this.options._id&&!n&&h(this),this.setupTimestamp(this.options.timestamps)}function P(e,t){for(const n of Object.keys(t)){let r=null;if(null!=t[n])r=t[n];else{const t=d(e.paths[n],"options");if(null==t)continue;r=t.alias}if(!r)continue;const o=e.paths[n].path;if(Array.isArray(r))for(const t of r){if("string"!=typeof t)throw new Error("Invalid value for alias option on "+o+", got "+t);e.aliases[t]=o,e.virtual(t).get(function(e){return function(){return"function"==typeof this.get?this.get(e):this[e]}}(o)).set(function(e){return function(t){return this.$set(e,t)}}(o))}else{if("string"!=typeof r)throw new Error("Invalid value for alias option on "+o+", got "+r);e.aliases[r]=o,e.virtual(r).get(function(e){return function(){return"function"==typeof this.get?this.get(e):this[e]}}(o)).set(function(e){return function(t){return this.$set(e,t)}}(o))}}}
/*!
		 * Inherit from EventEmitter.
		 */x.prototype=Object.create(o.prototype),x.prototype.constructor=x,x.prototype.instanceOfSchema=!0,
/*!
		 * ignore
		 */
Object.defineProperty(x.prototype,"$schemaType",{configurable:!1,enumerable:!1,writable:!0}),Object.defineProperty(x.prototype,"childSchemas",{configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(x.prototype,"virtuals",{configurable:!1,enumerable:!0,writable:!0}),x.prototype.obj,x.prototype.paths,x.prototype.tree,x.prototype.clone=function(){const e=this._clone();return e.on("init",(e=>this.emit("init",e))),e},
/*!
		 * ignore
		 */
x.prototype._clone=function(e){const t=new(e=e||(null==this.base?x:this.base.Schema))({},this._userProvidedOptions);t.base=this.base,t.obj=this.obj,t.options=p(this.options),t.callQueue=this.callQueue.map((function(e){return e})),t.methods=p(this.methods),t.methodOptions=p(this.methodOptions),t.statics=p(this.statics),t.query=p(this.query),t.plugins=Array.prototype.slice.call(this.plugins),t._indexes=p(this._indexes),t._searchIndexes=p(this._searchIndexes),t.s.hooks=this.s.hooks.clone(),t.tree=p(this.tree),t.paths=Object.fromEntries(Object.entries(this.paths).map((([e,t])=>[e,t.clone()]))),t.nested=p(this.nested),t.subpaths=p(this.subpaths);for(const e of Object.values(t.paths))if(e.$isSingleNested){const n=e.path;for(const r of Object.keys(e.schema.paths))t.singleNestedPaths[n+"."+r]=e.schema.paths[r];for(const r of Object.keys(e.schema.singleNestedPaths))t.singleNestedPaths[n+"."+r]=e.schema.singleNestedPaths[r];for(const r of Object.keys(e.schema.subpaths))t.singleNestedPaths[n+"."+r]=e.schema.subpaths[r];for(const r of Object.keys(e.schema.nested))t.singleNestedPaths[n+"."+r]="nested"}return t._gatherChildSchemas(),t.virtuals=p(this.virtuals),t.$globalPluginsApplied=this.$globalPluginsApplied,t.$isRootDiscriminator=this.$isRootDiscriminator,t.$implicitlyCreated=this.$implicitlyCreated,t.$id=++F,t.$originalSchemaId=this.$id,t.mapPaths=[].concat(this.mapPaths),null!=this.discriminatorMapping&&(t.discriminatorMapping=Object.assign({},this.discriminatorMapping)),null!=this.discriminators&&(t.discriminators=Object.assign({},this.discriminators)),null!=this._applyDiscriminators&&(t._applyDiscriminators=new Map(this._applyDiscriminators)),t.aliases=Object.assign({},this.aliases),t},x.prototype.pick=function(e,t){const n=new x({},t||this.options);if(!Array.isArray(e))throw new s('Schema#pick() only accepts an array argument, got "'+typeof e+'"');for(const t of e)if(this.nested[t])n.add({[t]:d(this.tree,t)});else{const e=this.path(t);if(null==e)throw new s("Path `"+t+"` is not in the schema");n.add({[t]:e})}return n},x.prototype.omit=function(e,t){const n=new x(this,t||this.options);if(!Array.isArray(e))throw new s('Schema#omit() only accepts an array argument, got "'+typeof e+'"');n.remove(e);for(const t in n.singleNestedPaths)e.includes(t)&&delete n.singleNestedPaths[t];return n},x.prototype.defaultOptions=function(e){this._userProvidedOptions=null==e?{}:p(e);const t=this.base&&this.base.options||{};if((e={strict:!("strict"in t)||t.strict,strictQuery:"strictQuery"in t&&t.strictQuery,bufferCommands:!0,capped:!1,versionKey:"__v",optimisticConcurrency:!1,minimize:!0,autoIndex:null,discriminatorKey:"__t",shardKey:null,read:null,validateBeforeSave:!0,validateModifiedOnly:!1,_id:!0,id:!("id"in t)||t.id,typeKey:"type",...e}).versionKey&&"string"!=typeof e.versionKey)throw new s("`versionKey` must be falsy or string, got `"+typeof e.versionKey+"`");if("string"==typeof e.read?e.read=y(e.read):Array.isArray(e.read)&&"string"==typeof e.read[0]&&(e.read={mode:y(e.read[0]),tags:e.read[1]}),e.optimisticConcurrency&&!e.versionKey)throw new s("Must set `versionKey` if using `optimisticConcurrency`");return e},x.prototype.discriminator=function(e,t,n){return this._applyDiscriminators=this._applyDiscriminators||new Map,this._applyDiscriminators.set(e,{schema:t,options:n}),this},
/*!
		 * Get this schema's default toObject/toJSON options, including Mongoose global
		 * options.
		 */
x.prototype._defaultToObjectOptions=function(e){const t=e?"toJSON":"toObject";if(this._defaultToObjectOptionsMap&&this._defaultToObjectOptionsMap[t])return this._defaultToObjectOptionsMap[t];const n=this.base&&this.base.options&&this.base.options[t]||{},r=this.options[t]||{},o=Object.assign({},n,r);return this._defaultToObjectOptionsMap=this._defaultToObjectOptionsMap||{},this._defaultToObjectOptionsMap[t]=o,o},x.prototype.add=function(e,t){if(e instanceof x||null!=e&&e.instanceOfSchema)return A(this,e),this;if(!1===e._id&&null==t&&(this.options._id=!1),"__proto__."===(t=t||"")||"constructor."===t||"prototype."===t)return this;const n=Object.keys(e),r=this.options.typeKey;for(const o of n){if(C.specialProperties.has(o))continue;const n=t+o,i=e[o];if(null==i)throw new TypeError("Invalid value for schema path `"+n+'`, got value "'+i+'"');if("_id"===o&&!1===i)continue;let s=!1;if("string"==typeof i){s=null!=(null!=this.base?this.base.Schema.Types:x.Types)[i.charAt(0).toUpperCase()+i.substring(1)]}if("_id"!==o&&("object"!=typeof i&&"function"!=typeof i&&!s||null==i))throw new TypeError(`Invalid schema configuration: \`${i}\` is not a valid type at path \`${o}\`. See https://bit.ly/mongoose-schematypes for a list of valid schema types.`);if(i instanceof l||"VirtualType"===(i.constructor&&i.constructor.name||null))this.virtual(i);else{if(Array.isArray(i)&&1===i.length&&null==i[0])throw new TypeError("Invalid value for schema Array path `"+n+'`, got value "'+i[0]+'"');if(B(i)||i instanceof a)if(Object.keys(i).length<1)t&&(this.nested[t.substring(0,t.length-1)]=!0),this.path(n,i);else if(!i[r]||"type"===r&&B(i.type)&&i.type.type)this.nested[n]=!0,this.add(i,n+".");else{const e=i[r];if(B(e)&&Object.keys(e).length>0){t&&(this.nested[t.substring(0,t.length-1)]=!0);const n={};this._userProvidedOptions.typeKey&&(n.typeKey=this._userProvidedOptions.typeKey),null!=this._userProvidedOptions.strict&&(n.strict=this._userProvidedOptions.strict),null!=this._userProvidedOptions.toObject&&(n.toObject=C.omit(this._userProvidedOptions.toObject,["transform"])),null!=this._userProvidedOptions.toJSON&&(n.toJSON=C.omit(this._userProvidedOptions.toJSON,["transform"]));const s=new x(e,n);s.$implicitlyCreated=!0;const u=Object.assign({},i,{[r]:s});this.path(t+o,u)}else if(t&&(this.nested[t.substring(0,t.length-1)]=!0),this.path(t+o,i),null!=i&&!i.instanceOfSchema&&C.isPOJO(i.discriminators)){const e=this.path(t+o);for(const t in i.discriminators)e.discriminator(t,i.discriminators[t])}}else if(t&&(this.nested[t.substring(0,t.length-1)]=!0),this.path(t+o,i),null!=i[0]&&!i[0].instanceOfSchema&&C.isPOJO(i[0].discriminators)){const e=this.path(t+o);for(const t in i[0].discriminators)e.discriminator(t,i[0].discriminators[t])}}}return P(this,Object.fromEntries(Object.entries(e).map((([e])=>[t+e,null])))),this},x.prototype.alias=function(e,t){return P(this,{[e]:t}),this},x.prototype.removeIndex=function(e){if(arguments.length>1)throw new Error("removeIndex() takes only 1 argument");if("object"!=typeof e&&"string"!=typeof e)throw new Error("removeIndex() may only take either an object or a string as an argument");if("object"==typeof e)for(let t=this._indexes.length-1;t>=0;--t)E(this._indexes[t][0],e)&&this._indexes.splice(t,1);else for(let t=this._indexes.length-1;t>=0;--t)null!=this._indexes[t][1]&&this._indexes[t][1].name===e&&this._indexes.splice(t,1);return this},x.prototype.clearIndexes=function(){return this._indexes.length=0,this},x.prototype.searchIndex=function(e){return this._searchIndexes.push(e),this},x.reserved=Object.create(null),x.prototype.reserved=x.reserved;const N=x.reserved;
/*!
		 * ignore
		 */
function I(e){return/\.\d+/.test(e)?e.replace(/\.\d+\./g,".$.").replace(/\.\d+$/,".$"):e}
/*!
		 * ignore
		 */function R(e,t){if(0===e.mapPaths.length)return null;for(const n of e.mapPaths){const r=n.path;if(new RegExp("^"+r.replace(/\.\$\*/g,"\\.[^.]+")+"$").test(t))return e.paths[r]}return null}function k(e,t,n){const r=t.split(/\.(\d+)\.|\.(\d+)$/).filter(Boolean);if(r.length<2)return e.paths.hasOwnProperty(r[0])?e.paths[r[0]]:"adhocOrUndefined";let o=e.path(r[0]),i=!1;if(!o)return"adhocOrUndefined";const s=r.length-1;for(let e=1;e<r.length;++e){i=!1;const t=r[e];if(e===s&&o&&!/\D/.test(t)){o=o.$isMongooseDocumentArray?o.$embeddedSchemaType:o instanceof v.Array?o.caster:void 0;break}if(!/\D/.test(t)){o instanceof v.Array&&e!==s&&(o=o.caster);continue}if(!o||!o.schema){o=void 0;break}i="nested"===o.schema.pathType(t),o=o.schema.path(t)}return e.subpaths[n]=o,o?"real":i?"nested":"adhocOrUndefined"}
/*!
		 * ignore
		 */
/*!
		 * Recursively set options on implicitly created schemas
		 */
function j(e,t){for(const{schema:n}of e.childSchemas)n.$implicitlyCreated&&(Object.assign(n.options,t),j(n,t))}N.prototype=N.emit=N.listeners=N.removeListener=N.collection=N.errors=N.get=N.init=N.isModified=N.isNew=N.populated=N.remove=N.save=N.toObject=N.validate=1,N.collection=1,x.prototype.path=function(e,t){if(void 0===t){if(null!=this.paths[e])return this.paths[e];const t=I(e);let n=
/*!
		 * ignore
		 */
function(e,t,n){if(e.paths.hasOwnProperty(t))return e.paths[t];if(e.subpaths.hasOwnProperty(n)){const t=e.subpaths[n];if("nested"===t)return;return t}if(e.singleNestedPaths.hasOwnProperty(n)&&"object"==typeof e.singleNestedPaths[n]){const t=e.singleNestedPaths[n];if("nested"===t)return;return t}return null}(this,e,t);if(null!=n)return n;const r=R(this,e);return null!=r?r:(n=this.hasMixedParent(t),null!=n?n:S.test(e)?function(e,t,n){return k(e,t,n),e.subpaths[n]}(this,e,t):void 0)}const n=e.split(".")[0];if(N[n]&&!this.options.suppressReservedKeysWarning){const e=`\`${n}\` is a reserved schema pathname and may break some functionality. You are allowed to use it, but use at your own risk. To disable this warning pass \`suppressReservedKeysWarning\` as a schema option.`;C.warn(e)}"object"==typeof t&&C.hasUserDefinedProperty(t,"ref")&&w(t.ref,e);const r=e.split(/\./),o=r.pop();let i=this.tree,s="";for(const t of r){if(C.specialProperties.has(t))throw new Error("Cannot set special property `"+t+"` on a schema");if(s=s+=(s.length>0?".":"")+t,i[t]||(this.nested[s]=!0,i[t]={}),"object"!=typeof i[t]){const n="Cannot set nested path `"+e+"`. Parent path `"+s+"` already set to type "+i[t].name+".";throw new Error(n)}i=i[t]}i[o]=p(t),this.paths[e]=this.interpretAsType(e,t,this.options);const a=this.paths[e];if(this.childSchemas=this.childSchemas.filter((t=>t.path!==e)),a.$isSchemaMap){const t=e+".$*";this.paths[t]=a.$__schemaType,this.mapPaths.push(this.paths[t]),a.$__schemaType.$isSingleNested&&this.childSchemas.push({schema:a.$__schemaType.schema,model:a.$__schemaType.caster,path:e})}if(a.$isSingleNested){for(const t of Object.keys(a.schema.paths))this.singleNestedPaths[e+"."+t]=a.schema.paths[t];for(const t of Object.keys(a.schema.singleNestedPaths))this.singleNestedPaths[e+"."+t]=a.schema.singleNestedPaths[t];for(const t of Object.keys(a.schema.subpaths))this.singleNestedPaths[e+"."+t]=a.schema.subpaths[t];for(const t of Object.keys(a.schema.nested))this.singleNestedPaths[e+"."+t]="nested";Object.defineProperty(a.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),a.caster.base=this.base,this.childSchemas.push({schema:a.schema,model:a.caster,path:e})}else a.$isMongooseDocumentArray&&(Object.defineProperty(a.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),a.casterConstructor.base=this.base,this.childSchemas.push({schema:a.schema,model:a.casterConstructor,path:e}));if(a.$isMongooseArray&&a.caster instanceof u){let t=e,n=a;const r=[];for(;n.$isMongooseArray;)t+=".$",n.$isMongooseDocumentArray?(n.$embeddedSchemaType._arrayPath=t,n.$embeddedSchemaType._arrayParentPath=e,n=n.$embeddedSchemaType):(n.caster._arrayPath=t,n.caster._arrayParentPath=e,n=n.caster),this.subpaths[t]=n;for(const e of r)this.subpaths[e.path]=e}if(a.$isMongooseDocumentArray){for(const t of Object.keys(a.schema.paths)){const n=a.schema.paths[t];this.subpaths[e+"."+t]=n,"object"==typeof n&&null!=n&&null==n.$parentSchemaDocArray&&(n.$parentSchemaDocArray=a)}for(const t of Object.keys(a.schema.subpaths)){const n=a.schema.subpaths[t];this.subpaths[e+"."+t]=n,"object"==typeof n&&null!=n&&null==n.$parentSchemaDocArray&&(n.$parentSchemaDocArray=a)}for(const t of Object.keys(a.schema.singleNestedPaths)){const n=a.schema.singleNestedPaths[t];this.subpaths[e+"."+t]=n,"object"==typeof n&&null!=n&&null==n.$parentSchemaDocArray&&(n.$parentSchemaDocArray=a)}}return this},
/*!
		 * ignore
		 */
x.prototype._gatherChildSchemas=function(){const e=[];for(const t of Object.keys(this.paths)){if("string"!=typeof t)continue;const n=this.paths[t];n.$isMongooseDocumentArray||n.$isSingleNested?e.push({schema:n.schema,model:n.caster,path:t}):n.$isSchemaMap&&n.$__schemaType.$isSingleNested&&e.push({schema:n.$__schemaType.schema,model:n.$__schemaType.caster,path:t})}return this.childSchemas=e,e},Object.defineProperty(x.prototype,"base",{configurable:!0,enumerable:!1,writable:!0,value:null}),x.prototype.interpretAsType=function(e,t,n){if(t instanceof u){if(t.path===e)return t;const n=t.clone();return n.path=e,n}const r=null!=this.base?this.base.Schema.Types:x.Types,o=null!=this.base?this.base.Types:Lf();if(!(C.isPOJO(t)||t instanceof a)){if("Object"!==C.getFunctionName(t.constructor)){const e=t;(t={})[n.typeKey]=e}}let i,c=t[n.typeKey]&&(t[n.typeKey]instanceof Function||"type"!==n.typeKey||!t.type.type)?t[n.typeKey]:{};if(C.isPOJO(c)||"mixed"===c)return new r.Mixed(e,t);if(Array.isArray(c)||c===Array||"array"===c||c===r.Array){let o=c===Array||"array"===c?t.cast||t.of:c[0];if(o&&o.instanceOfSchema){if(!(o instanceof x)){if(!this.options._isMerging)throw new TypeError("Schema for array path `"+e+"` is from a different copy of the Mongoose module. Please make sure you're using the same version of Mongoose everywhere with `npm list mongoose`. If you are still getting this error, please add `new Schema()` around the path: "+`${e}: new Schema(...)`);o=new x(o)}return new r.DocumentArray(e,o,t)}if(o&&o[n.typeKey]&&o[n.typeKey].instanceOfSchema){if(!(o[n.typeKey]instanceof x)){if(!this.options._isMerging)throw new TypeError("Schema for array path `"+e+"` is from a different copy of the Mongoose module. Please make sure you're using the same version of Mongoose everywhere with `npm list mongoose`. If you are still getting this error, please add `new Schema()` around the path: "+`${e}: new Schema(...)`);o[n.typeKey]=new x(o[n.typeKey])}return new r.DocumentArray(e,o[n.typeKey],t,o)}if(void 0!==o&&(Array.isArray(o)||o.type===Array||"Array"==o.type))return o&&"Array"==o.type&&(o.type=Array),new r.Array(e,this.interpretAsType(e,o,n),t);const s=null==o||!o[n.typeKey]||"type"===n.typeKey&&o.type.type?o:o[n.typeKey];if("string"==typeof o)o=r[o.charAt(0).toUpperCase()+o.substring(1)];else if(C.isPOJO(s)){if(Object.keys(s).length){const o={minimize:n.minimize};n.typeKey&&(o.typeKey=n.typeKey),n.hasOwnProperty("strict")&&(o.strict=n.strict),n.hasOwnProperty("strictQuery")&&(o.strictQuery=n.strictQuery),n.hasOwnProperty("toObject")&&(o.toObject=C.omit(n.toObject,["transform"])),n.hasOwnProperty("toJSON")&&(o.toJSON=C.omit(n.toJSON,["transform"])),this._userProvidedOptions.hasOwnProperty("_id")?o._id=this._userProvidedOptions._id:null!=x.Types.DocumentArray.defaultOptions._id&&(o._id=x.Types.DocumentArray.defaultOptions._id);const i=new x(s,o);return i.$implicitlyCreated=!0,new r.DocumentArray(e,i,t)}return new r.Array(e,r.Mixed,t)}if(o){if(c=!o[n.typeKey]||"type"===n.typeKey&&o.type.type?o:o[n.typeKey],Array.isArray(c))return new r.Array(e,this.interpretAsType(e,c,n),t);if(i="string"==typeof c?c:c.schemaName||C.getFunctionName(c),"ClockDate"===i&&(i="Date"),void 0===i)throw new TypeError(`Invalid schema configuration: Could not determine the embedded type for array \`${e}\`. See https://mongoosejs.com/docs/guide.html#definition for more info on supported schema syntaxes.`);if(!r.hasOwnProperty(i))throw new TypeError(`Invalid schema configuration: \`${i}\` is not a valid type within the array \`${e}\`.See https://bit.ly/mongoose-schematypes for a list of valid schema types.`)}return new r.Array(e,o||r.Mixed,t,n)}if(c&&c.instanceOfSchema)return new r.Subdocument(c,e,t);if(i=Buffer.isBuffer(c)?"Buffer":"function"==typeof c||"object"==typeof c?c.schemaName||C.getFunctionName(c):c===o.ObjectId?"ObjectId":c===o.Decimal128?"Decimal128":null==c?""+c:c.toString(),i&&(i=i.charAt(0).toUpperCase()+i.substring(1)),"ObjectID"===i&&(i="ObjectId"),"ClockDate"===i&&(i="Date"),void 0===i)throw new TypeError(`Invalid schema configuration: \`${e}\` schematype definition is invalid. See https://mongoosejs.com/docs/guide.html#definition for more info on supported schema syntaxes.`);if(null==r[i])throw new TypeError(`Invalid schema configuration: \`${i}\` is not a valid type at path \`${e}\`. See https://bit.ly/mongoose-schematypes for a list of valid schema types.`);const l=new r[i](e,t);return l.$isSchemaMap&&
/*!
		 * ignore
		 */
function(e,t,n,r,o){const i=n+".$*";let u={type:{}};if(C.hasUserDefinedProperty(r,"of")){if(u=C.isPOJO(r.of)&&Object.keys(r.of).length>0&&!C.hasUserDefinedProperty(r.of,e.options.typeKey)?{[e.options.typeKey]:new x(r.of)}:C.isPOJO(r.of)?Object.assign({},r.of):{[e.options.typeKey]:r.of},u[e.options.typeKey]&&u[e.options.typeKey].instanceOfSchema){u[e.options.typeKey].eachPath(((e,t)=>{if(!0===t.options.select||!1===t.options.select)throw new s('Cannot use schema-level projections (`select: true` or `select: false`) within maps at path "'+n+"."+e+'"')}))}C.hasUserDefinedProperty(r,"ref")&&(u.ref=r.ref)}t.$__schemaType=e.interpretAsType(i,u,o)}(this,l,e,t,n),l},x.prototype.eachPath=function(e){const t=Object.keys(this.paths),n=t.length;for(let r=0;r<n;++r)e(t[r],this.paths[t[r]]);return this},x.prototype.requiredPaths=function(e){if(this._requiredpaths&&!e)return this._requiredpaths;const t=Object.keys(this.paths);let n=t.length;const r=[];for(;n--;){const e=t[n];this.paths[e].isRequired&&r.push(e)}return this._requiredpaths=r,this._requiredpaths},x.prototype.indexedPaths=function(){return this._indexedpaths||(this._indexedpaths=this.indexes()),this._indexedpaths},x.prototype.pathType=function(e){if(this.paths.hasOwnProperty(e))return"real";if(this.virtuals.hasOwnProperty(e))return"virtual";if(this.nested.hasOwnProperty(e))return"nested";const t=I(e);if(this.subpaths.hasOwnProperty(t)||this.subpaths.hasOwnProperty(e))return"real";const n=this.singleNestedPaths.hasOwnProperty(t)||this.singleNestedPaths.hasOwnProperty(e);if(n)return"nested"===n?"nested":"real";return null!=R(this,e)?"real":/\.\d+\.|\.\d+$/.test(e)?k(this,e,t):"adhocOrUndefined"},x.prototype.hasMixedParent=function(e){const t=e.split(/\./g);e="";for(let n=0;n<t.length;++n)if(e=n>0?e+"."+t[n]:t[n],this.paths.hasOwnProperty(e)&&this.paths[e]instanceof v.Mixed)return this.paths[e];return null},x.prototype.setupTimestamp=function(e){return O(this,e)},x.prototype.queue=function(e,t){return this.callQueue.push([e,t]),this},x.prototype.pre=function(e){if(e instanceof RegExp){const t=Array.prototype.slice.call(arguments,1);for(const n of T)e.test(n)&&this.pre.apply(this,[n].concat(t));return this}if(Array.isArray(e)){const t=Array.prototype.slice.call(arguments,1);for(const n of e)this.pre.apply(this,[n].concat(t));return this}return this.s.hooks.pre.apply(this.s.hooks,arguments),this},x.prototype.post=function(e){if(e instanceof RegExp){const t=Array.prototype.slice.call(arguments,1);for(const n of T)e.test(n)&&this.post.apply(this,[n].concat(t));return this}if(Array.isArray(e)){const t=Array.prototype.slice.call(arguments,1);for(const n of e)this.post.apply(this,[n].concat(t));return this}return this.s.hooks.post.apply(this.s.hooks,arguments),this},x.prototype.plugin=function(e,t){if("function"!=typeof e)throw new Error('First param to `schema.plugin()` must be a function, got "'+typeof e+'"');if(t&&t.deduplicate)for(const t of this.plugins)if(t.fn===e)return this;return this.plugins.push({fn:e,opts:t}),e(this,t),this},x.prototype.method=function(e,t,n){if("string"!=typeof e)for(const t in e)this.methods[t]=e[t],this.methodOptions[t]=p(n);else this.methods[e]=t,this.methodOptions[e]=p(n);return this},x.prototype.static=function(e,t){if("string"!=typeof e)for(const t in e)this.statics[t]=e[t];else this.statics[e]=t;return this},x.prototype.index=function(e,t){e||(e={}),t||(t={}),t.expires&&C.expires(t);for(const t in e)this.aliases[t]&&(e=C.renameObjKey(e,t,this.aliases[t]));for(const t of Object.keys(e))"ascending"===e[t]||"asc"===e[t]?e[t]=1:"descending"!==e[t]&&"desc"!==e[t]||(e[t]=-1);for(const n of this.indexes())null==t.name&&null==n[1].name&&E(n[0],e)&&C.warn(`Duplicate schema index on ${JSON.stringify(e)} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.`);return this._indexes.push([e,t]),this},x.prototype.set=function(e,t,n){if(1===arguments.length)return this.options[e];switch(e){case"read":"string"==typeof t?this.options[e]={mode:y(t),tags:n}:Array.isArray(t)&&"string"==typeof t[0]?this.options[e]={mode:y(t[0]),tags:t[1]}:this.options[e]=t,this._userProvidedOptions[e]=this.options[e];break;case"timestamps":this.setupTimestamp(t),this.options[e]=t,this._userProvidedOptions[e]=this.options[e];break;case"_id":this.options[e]=t,this._userProvidedOptions[e]=this.options[e],t&&!this.paths._id?h(this):!t&&null!=this.paths._id&&this.paths._id.auto&&this.remove("_id");break;default:this.options[e]=t,this._userProvidedOptions[e]=this.options[e]}return"strict"===e&&j(this,{strict:t}),"strictQuery"===e&&j(this,{strictQuery:t}),"toObject"===e&&(delete(t={...t}).transform,j(this,{toObject:t})),"toJSON"===e&&(delete(t={...t}).transform,j(this,{toJSON:t})),this},x.prototype.get=function(e){return this.options[e]};const L="2d 2dsphere hashed text".split(" ");
/*!
		 * ignore
		 */
function U(e,t){const n=t.split("."),r=n.pop();let o=e.tree;for(const e of n)o=o[e];delete o[r]}
/*!
		 * ignore
		 */
function V(e){return e.startsWith("$[")&&e.endsWith("]")}Object.defineProperty(x,"indexTypes",{get:function(){return L},set:function(){throw new Error("Cannot overwrite Schema.indexTypes")}}),x.prototype.indexes=function(){return m(this)},x.prototype.virtual=function(e,t){if(e instanceof l||"VirtualType"===f(e))return this.virtual(e.path,e.options);if(t=new c(t),C.hasUserDefinedProperty(t,["ref","refPath"])){if(null==t.localField)throw new Error("Reference virtuals require `localField` option");if(null==t.foreignField)throw new Error("Reference virtuals require `foreignField` option");const n=this.virtual(e);n.options=t,this.pre("init",(function(r,o){if(b.has(e,r)){const i=b.get(e,r);if(this.$$populatedVirtuals||(this.$$populatedVirtuals={}),t.justOne||t.count?this.$$populatedVirtuals[e]=Array.isArray(i)?i[0]:i:this.$$populatedVirtuals[e]=Array.isArray(i)?i:null==i?[]:[i],o?.hydratedPopulatedDocs&&!t.count){const r=n._getModelNamesForPopulate(this),o=this.$$populatedVirtuals[e];if(Array.isArray(o)||o.$__||1!==r?.length){if(Array.isArray(o)&&1===r?.length){const n=this.db.model(r[0]);for(let e=0;e<o.length;++e)o[e].$__||(o[e]=n.hydrate(o[e],null,{hydratedPopulatedDocs:!0}));const i=t.foreignField;this.$populated(e,o.map((e=>null==e?e:e.get("function"==typeof i?i.call(e,e):i))),{populateModelSymbol:n})}}else{const t=this.db.model(r[0]);this.$$populatedVirtuals[e]=t.hydrate(o)}}b.unset(e,r)}})),n.set((function(n){return this.$$populatedVirtuals||(this.$$populatedVirtuals={}),_(this.$$populatedVirtuals,e,n,t)})),"function"==typeof t.get&&n.get(t.get);const r=e.split(".");let o=r[0];for(let e=0;e<r.length-1;++e)if(null!=this.paths[o]){if(this.paths[o].$isMongooseDocumentArray||this.paths[o].$isSingleNested){const n=r.slice(e+1).join(".");this.paths[o].schema.virtual(n,t);break}o+="."+r[e+1]}return n}const n=this.virtuals,r=e.split(".");if("real"===this.pathType(e))throw new Error('Virtual path "'+e+'" conflicts with a real path in the schema');if(n[e]=r.reduce((function(n,o,i){return n[o]||(n[o]=i===r.length-1?new l(t,e):{}),n[o]}),this.tree),t&&t.applyToArray&&r.length>1){const e=this.path(r.slice(0,-1).join("."));if(e&&e.$isMongooseArray)return e.virtual(r[r.length-1],t);throw new s(`Path "${e}" is not an array`)}return n[e]},x.prototype.virtualpath=function(e){return this.virtuals.hasOwnProperty(e)?this.virtuals[e]:null},x.prototype.remove=function(e){return"string"==typeof e&&(e=[e]),Array.isArray(e)&&e.forEach((function(e){if(null!=this.path(e)||this.nested[e]){if(this.nested[e]){const t=Object.keys(this.paths).concat(Object.keys(this.nested));for(const n of t)n.startsWith(e+".")&&(delete this.paths[n],delete this.nested[n],U(this,n));return delete this.nested[e],void U(this,e)}delete this.paths[e],U(this,e)}}),this),this},x.prototype.removeVirtual=function(e){if("string"==typeof e&&(e=[e]),Array.isArray(e)){for(const t of e)if(null==this.virtuals[t])throw new s(`Attempting to remove virtual "${t}" that does not exist.`);for(const t of e)delete this.paths[t],delete this.virtuals[t],-1!==t.indexOf(".")?b.unset(t,this.tree):delete this.tree[t]}return this},x.prototype.loadClass=function(e,t){return e===Object.prototype||e===Function.prototype||e.prototype.hasOwnProperty("$isMongooseModelPrototype")||e.prototype.hasOwnProperty("$isMongooseDocumentPrototype")||(this.loadClass(Object.getPrototypeOf(e),t),t||Object.getOwnPropertyNames(e).forEach((function(t){if(t.match(/^(length|name|prototype|constructor|__proto__)$/))return;const n=Object.getOwnPropertyDescriptor(e,t);n.hasOwnProperty("value")&&this.static(t,n.value)}),this),Object.getOwnPropertyNames(e.prototype).forEach((function(n){if(n.match(/^(constructor)$/))return;const r=Object.getOwnPropertyDescriptor(e.prototype,n);t||"function"==typeof r.value&&this.method(n,r.value),"function"==typeof r.get&&(this.virtuals[n]&&(this.virtuals[n].getters=[]),this.virtual(n).get(r.get)),"function"==typeof r.set&&(this.virtuals[n]&&(this.virtuals[n].setters=[]),this.virtual(n).set(r.set))}),this)),this},
/*!
		 * ignore
		 */
x.prototype._getSchema=function(e){const t=this.path(e),n=[];if(t)return t.$fullPath=e,t;const r=e.split(".");for(let e=0;e<r.length;++e)("$"===r[e]||V(r[e]))&&(r[e]="0"),$.test(r[e])&&(r[e]="$");return function e(t,r){let o,i,s=t.length+1;for(;s--;)if(i=t.slice(0,s).join("."),o=r.path(i),o){if(n.push(i),o.caster){if(o.caster instanceof v.Mixed)return o.caster.$fullPath=n.join("."),o.caster;if(s!==t.length){if(s+1===t.length&&o.$embeddedSchemaType&&("$"===t[s]||V(t[s])))return o.$embeddedSchemaType;if(o.schema){let n;return"$"===t[s]||V(t[s])?s+1===t.length?o.$embeddedSchemaType:(n=e(t.slice(s+1),o.schema),n&&(n.$parentSchemaDocArray=n.$parentSchemaDocArray||(o.schema.$isSingleNested?null:o)),n):(n=e(t.slice(s),o.schema),n&&(n.$parentSchemaDocArray=n.$parentSchemaDocArray||(o.schema.$isSingleNested?null:o)),n)}}}else if(o.$isSchemaMap){if(s>=t.length)return o;if(s+1>=t.length)return o.$__schemaType;if(o.$__schemaType instanceof v.Mixed)return o.$__schemaType;if(null!=o.$__schemaType.schema){return e(t.slice(s+1),o.$__schemaType.schema)}}return o.$fullPath=n.join("."),o}}(r,this)},
/*!
		 * ignore
		 */
x.prototype._getPathType=function(e){if(this.path(e))return"real";return function e(t,n){let r,o,i=t.length+1;for(;i--;){if(o=t.slice(0,i).join("."),r=n.path(o),r)return r.caster?r.caster instanceof v.Mixed?{schema:r,pathType:"mixed"}:i!==t.length&&r.schema?"$"===t[i]||V(t[i])?i===t.length-1?{schema:r,pathType:"nested"}:e(t.slice(i+1),r.schema):e(t.slice(i),r.schema):{schema:r,pathType:r.$isSingleNested?"nested":"array"}:{schema:r,pathType:"real"};if(i===t.length&&n.nested[o])return{schema:n,pathType:"nested"}}return{schema:r||n,pathType:"undefined"}}(e.split("."),this)},x.prototype._transformDuplicateKeyError=function(e){if(!this._duplicateKeyErrorMessagesByPath)return e;if(11e3!==e.code&&11001!==e.code)return e;if(null!=e.keyPattern){const t=e.keyPattern,n=Object.keys(t);if(1!==n.length)return e;const r=n[0];return this._duplicateKeyErrorMessagesByPath.hasOwnProperty(r)?new s(this._duplicateKeyErrorMessagesByPath[r],{cause:e}):e}return e},x.prototype._preCompile=function(){this.plugin(g,{deduplicate:!0})},x.prototype.toJSONSchema=function(e){const t=e?.useBsonType??!1,n=t?{required:[],properties:{}}:{type:"object",required:[],properties:{}};for(const r of Object.keys(this.paths)){const o=this.paths[r];if(-1!==o._presplitPath.indexOf("$*"))continue;let i=n;if(o._presplitPath.length>1)for(let e=0;e<o._presplitPath.length-1;++e){const n=o._presplitPath[e];null==i.properties[n]&&(i.properties[n]=t?{bsonType:["object","null"],properties:{}}:{type:["object","null"],properties:{}}),i=i.properties[n]}const s=o._presplitPath[o._presplitPath.length-1];let u=!1;"_id"===r?(i.required||(i.required=[]),i.required.push("_id"),u=!0):o.options.required&&"function"!=typeof o.options.required&&(i.required||(i.required=[]),i.required.push(s),u=!0),i.properties[s]=o.toJSONSchema(e),o.options.enum&&(i.properties[s].enum=u?o.options.enum:[...o.options.enum,null])}return 0===n.required.length&&delete n.required,n},
/*!
		 * Module exports.
		 */
e.exports=r=x,x.Types=v=Fg(),
/*!
		 * ignore
		 */
r.ObjectId=v.ObjectId}(cc,cc.exports)),cc.exports}
/*!
 * Module dependencies.
 */function xg(){if(Og)return _g;Og=1;const e=dl();class t extends e{constructor(e,t,n,r){let o=e.map((e=>e.message)).join(", ");o.length>200&&(o=o.slice(0,200)+"..."),super(`${r} failed with ${e.length} Mongoose validation errors: ${o}`),this.validationErrors=e,this.results=t,this.rawResult=n,this.operation=r}}return Object.defineProperty(t.prototype,"name",{value:"MongooseBulkWriteError"}),
/*!
	 * exports
	 */
_g=t}function Pg(){return vg||(vg=1,Sg=function e(t,n,r,o){if(t[o])return;if(t[o]=!0,!r||!r.skipTopLevel){let e=null;for(const r of n){const n=null==r[1]?null:r[1].tags;Array.isArray(n)?(e=e||new Set(t.options.pluginTags||[]),n.find((t=>e.has(t)))&&t.plugin(r[0],r[1])):t.plugin(r[0],r[1])}}if(delete(r=Object.assign({},r)).skipTopLevel,!1!==r.applyPluginsToChildSchemas)for(const i of Object.keys(t.paths)){const s=t.paths[i];null!=s.schema&&(e(s.schema,n,r,o),s.caster.prototype.$__setSchema(s.schema))}const i=t.discriminators;if(null==i)return;const s=r.applyPluginsToDiscriminators,u=Object.keys(i);for(const t of u){e(i[t],n,{skipTopLevel:!s},o)}}),Sg}var Ng,Ig,Rg,kg,jg,Lg={};function Ug(){if(Ng)return Lg;Ng=1;
/*!
	 * ignore
	 */
let e=null;return Lg.get=function(){return e},Lg.set=function(t){e=t},Lg}function Vg(){if(Rg)return Ig;return Rg=1,Ig=function(){return{ok:1,nInserted:0,nUpserted:0,nMatched:0,nModified:0,nRemoved:0,upserted:[],writeErrors:[],insertedIds:[],writeConcernErrors:[]}}}var zg,Wg,qg,Gg,Hg,Kg,Yg,Qg,Jg,Xg,Zg,eE,tE,nE,rE,oE,iE,sE,uE,aE,cE,lE,hE,pE={exports:{}};function dE(){if(Wg)return zg;Wg=1;const e=Cp().modifiedPaths;return zg=function(t){const n=Object.keys(t),r={},o={};for(const i of n)i.startsWith("$")?e(t[i],"",r):o[i]=t[i];return e(o,"",r),r},zg}function fE(){if(Gg)return qg;Gg=1;const e=dE();return qg=function(t){if(null==t)return{};const n=e(t);return Object.keys(n).reduce(((e,t)=>{const n=t.match(/\$\[[^\]]+\]/g);if(null==n)return e;for(const r of n){const n=t.indexOf(r);if(n!==t.lastIndexOf(r))throw new Error(`Path '${t}' contains the same array filter multiple times`);e[r.substring(2,r.length-1)]=t.substring(0,n-1).replace(/\$\[[^\]]+\]/g,"0")}return e}),{})},qg}function mE(){if(Kg)return Hg;Kg=1;const e=Af(),t=wp(),n=Zp(),r=fE();return Hg=function(o,i,s,u,a){const c=u.split(".");let l=null,h="adhocOrUndefined";s=s||{},i=i||{};const p=null!=a&&Array.isArray(a.arrayFilters)?a.arrayFilters:[],d=r(i);for(let r=0;r<c.length;++r){const u=c.slice(0,r+1).join("."),a=e(u);if(l=o.path(a),null!=l&&(h=o.pathType(a),(l.$isSingleNested||l.$isMongooseDocumentArrayElement)&&null!=l.schema.discriminators)){const e=t(l,"schema.options.discriminatorKey"),o=a+"."+e,f=o.replace(/\.\d+\./,".");let m=null;o in s&&(m=s[o]),f in s&&(m=s[f]);const y=a.replace(/\.\d+$/,"");l.$isMongooseDocumentArrayElement&&null!=t(s[y],"$elemMatch."+e)&&(m=s[y].$elemMatch[e]);const g=u+"."+e;g in i&&(m=i[g]),o in i&&(m=i[o]);for(const t of Object.keys(d)){const n=d[t]+"."+e,r=t+"."+e;if(n===f){const e=p.find((e=>e.hasOwnProperty(r)));null!=e&&(m=e[r])}}if(null==m)continue;const E=n(l.caster.discriminators,m),A=E&&E.schema;if(null==A)continue;const b=c.slice(r+1).join(".");if(l=A.path(b),null!=l){h=A._getPathType(b);break}}}return{type:h,schematype:l}},Hg}function yE(){if(Qg)return Yg;Qg=1;const e=hl();return Yg=function(t,n,r,o,i,s,u){if(null==t||!t.options||!t.options.immutable)return!1;let a=t.options.immutable;if("function"==typeof a&&(a=a.call(u,u)),!a)return!1;if(s&&s.overwriteImmutable)return!1;if(!1===n)return!1;if("throw"===n)throw new e(null,`Field ${i} is immutable and strict = 'throw'`);return delete r[o],!0},Yg}function gE(){if(Xg)return Jg;Xg=1;const e=wp();function t(t,n,r,o,i){const s=t.path(r);if(null==s)return;let u=e(s,"options.immutable",null);null!=u&&("function"==typeof u&&(u=u.call(i,i)),u&&(o.$setOnInsert=o.$setOnInsert||{},o.$setOnInsert[r]=n[r],delete n[r]))}return Jg=function(e,n,r){if(null==n)return;const o=Object.keys(n);for(const i of o){const o=i.startsWith("$");if("$set"===i){const o=Object.keys(n[i]);for(const s of o)t(e,n[i],s,n,r)}else o||t(e,n,i,n,r)}},Jg}function EE(){if(eE)return Zg;eE=1;const e=Ba();return Zg=function(t,n,r){if(-1===n.indexOf(".")){if(e.has(n))return;return void(t[n]=r)}const o=n.split("."),i=o.pop();let s=t;for(const t of o)e.has(t)||(null==s[t]&&(s[t]={}),s=s[t]);e.has(i)||(s[i]=r)}}function AE(){if(nE)return tE;nE=1;const e=Zc(),t=pa(),n=ug(),r=hl(),o=tl(),i=sm(),s=hm(),u=_a(),a=Zp(),c=mE(),l=yE(),h=gE(),p=Nh().schemaMixedSymbol,d=EE(),f=uf(),{internalToObjectOptions:m}=Ma(),y=new Set(["$currentDate","$inc","$min","$max","$mul","$rename","$set","$setOnInsert","$unset","$addToSet","$pop","$pull","$push","$pullAll","$bit"]);
/*!
	 * ignore
	 */
function g(e,n){if("$unset"===e){if("string"!=typeof n&&(!Array.isArray(n)||n.find((e=>"string"!=typeof e))))throw new t("Invalid $unset in pipeline, must be  a string or an array of strings");return n}if("$project"===e){if(null==n||"object"!=typeof n)throw new t("Invalid $project in pipeline, must be an object");return n}if("$addFields"===e||"$set"===e){if(null==n||"object"!=typeof n)throw new t("Invalid "+e+" in pipeline, must be an object");return n}if("$replaceRoot"===e||"$replaceWith"===e){if(null==n||"object"!=typeof n)throw new t("Invalid "+e+" in pipeline, must be an object");return n}throw new t('Invalid update pipeline operator: "'+e+'"')}function E(t,o,a,h,m,y,g){const b=h.strict,_=g?g+".":"",C=Object.keys(o);let S,v,D,M=C.length,T=!1,B=null;const F=null!=b?b:t.options.strict;for(;M--;){if(v=C[M],D=o[v],"$pull"===a){if(S=t._getSchema(_+v),null==S){const e=c(t,o,y,_+v,h);null!=e.schematype&&(S=e.schematype)}if(null!=S&&null!=S.schema){o[v]=s(S.schema,o[v],h,m),T=!0;continue}}const $=_?_+v:v;if(null!=t.discriminatorMapping&&$===t.options.discriminatorKey&&t.discriminatorMapping.value!==o[v]&&!h.overwriteDiscriminatorKey){if("throw"===F){B=A(new Error("Can't modify discriminator key \""+$+'" on discriminator model'),m,$,B);continue}if(F){delete o[v];continue}}if("Object"===u(D)){if(S=t._getSchema(_+v),null==S){const e=c(t,o,y,_+v,h);null!=e.schematype&&(S=e.schematype)}if("$setOnInsert"!==a&&l(S,b,o,v,_+v,h,m))continue;if(S&&S.caster&&a in O)if("$each"in D){T=!0;try{o[v]={$each:w(S,D.$each,a,v,m,_+v)}}catch(e){B=A(e,m,v,B)}null!=D.$slice&&(o[v].$slice=0|D.$slice),D.$sort&&(o[v].$sort=D.$sort),null!=D.$position&&(o[v].$position=i(D.$position))}else{if(null!=S&&S.$isSingleNested){const e=null==b?S.schema.options.strict:b;try{o[v]=S.castForQuery(null,D,m,{strict:e})}catch(e){B=A(e,m,v,B)}}else try{o[v]=w(S,D,a,v,m,_+v)}catch(e){B=A(e,m,v,B)}if(void 0===o[v]){delete o[v];continue}T=!0}else if("$currentDate"===a||a in O&&S){try{o[v]=w(S,D,a,v,m,_+v)}catch(e){B=A(e,m,v,B)}if(void 0===o[v]){delete o[v];continue}T=!0}else if("$rename"===a){const e=new n(`${_}${v}.$rename`);try{o[v]=w(e,D,a,v,m,_+v)}catch(e){B=A(e,m,v,B)}if(void 0===o[v]){delete o[v];continue}T=!0}else{const e=_+v,n=t._getPathType(e);let i=b;if(n&&n.schema&&null==i&&(i=n.schema.options.strict),"undefined"===n.pathType){if("throw"===i)throw new r(e);if(i){delete o[v];continue}}T|=E(t,D,a,h,m,y,_+v)||f.isObject(D)&&0===Object.keys(D).length}}else{const i="$each"===v||"$or"===v||"$and"===v||"$in"===v?g:_+v;if(S=t._getSchema(i),"$setOnInsert"!==a&&l(S,b,o,v,_+v,h,m))continue;let s=t._getPathType(i);if(null==S){const e=c(t,o,y,i,h);null!=e.schematype&&(S=e.schematype,s=e.type)}let u=b;s&&s.schema&&null==b&&(u=s.schema.options.strict);if(u&&!S&&!/real|nested/.test(s.pathType)){if("throw"===u&&null==t.virtuals[i])throw new r(_+v);delete o[v]}else{if("$rename"===a){if(null==o[v])throw new e("String",o[v],`${_}${v}.$rename`);const t=new n(`${_}${v}.$rename`);o[v]=t.castForQuery(null,o[v],m);continue}try{0===_.length||-1===v.indexOf(".")?o[v]=w(S,D,a,v,m,_+v):!1===u&&null==S||(d(o,v,w(S,D,a,v,m,_+v)),delete o[v])}catch(e){B=A(e,m,v,B)}if(!Array.isArray(o[v])||"$addToSet"!==a&&"$push"!==a||"$each"===v||S&&S.caster&&!S.caster.$isMongooseArray&&!S.caster[p]&&(o[v]={$each:o[v]}),void 0===o[v]){delete o[v];continue}T=!0}}}if(null!=B)throw B;return T}
/*!
	 * ignore
	 */function A(e,t,n,r){if("object"!=typeof t||!t.options.multipleCastError)throw e;return(r=r||new o).addError(n,e),r}tE=function(e,t,n,r,o){if(null==t)return;if(n=n||{},Array.isArray(t)){const e=t.length;for(let n=0;n<e;++n){const e=Object.keys(t[n]);for(const r of e)t[n][r]=g(r,t[n][r])}return t}if(null!=e&&null!=o&&f.hasUserDefinedProperty(o,e.options.discriminatorKey)&&"object"!=typeof o[e.options.discriminatorKey]&&null!=e.discriminators){const t=o[e.options.discriminatorKey],n=a(r.model.discriminators,t);e=e.discriminators[t]||n&&n.schema||e}else if(null!=e&&n.overwriteDiscriminatorKey&&f.hasUserDefinedProperty(t,e.options.discriminatorKey)&&null!=e.discriminators){const n=t[e.options.discriminatorKey],o=a(r.model.discriminators,n);e=e.discriminators[n]||o&&o.schema||e}else if(null!=e&&n.overwriteDiscriminatorKey&&null!=t.$set&&f.hasUserDefinedProperty(t.$set,e.options.discriminatorKey)&&null!=e.discriminators){const n=t.$set[e.options.discriminatorKey],o=a(r.model.discriminators,n);e=e.discriminators[n]||o&&o.schema||e}n.upsert&&h(e,t,r);const i=Object.keys(t);let s=i.length;const u={};let c,l=!1;for(o=o||{};s--;){const e=i[s];y.has(e)?"$set"===e&&u.$set||(u[e]=t[e]):(u.$set||(t.$set?u.$set=t.$set:u.$set={}),u.$set[e]=t[e],i.splice(s,1),~i.indexOf("$set")||i.push("$set"))}for(s=i.length;s--;){const t=i[s];if(c=u[t],l=l||t.startsWith("$"),null!=c&&c.$__&&(c=c.toObject(m),u[t]=c),!c||"object"!=typeof c||Buffer.isBuffer(c)||!y.has(t)){throw new Error("Invalid atomic update value for "+t+". Expected an object, received "+typeof c)}E(e,c,t,n,r,o),t.startsWith("$")&&f.isEmptyObject(c)&&delete u[t]}return 0===Object.keys(u).length&&n.upsert&&Object.keys(o).length>0?{$setOnInsert:{...o}}:u};const b={$pop:1,$inc:1},_={$unset:1},O={$push:1,$addToSet:1,$set:1,$setOnInsert:1},C={$set:1,$setOnInsert:1};function w(t,n,r,o,s,u){if(!t){if(r in b)try{return i(n)}catch(t){throw new e("number",n,u)}return n}if(t.caster&&r in O&&(f.isObject(n)||Array.isArray(n))&&!C[r]){let e=0,r=t;for(;r.$isMongooseArray;)++e,r=r.caster;let o=0,i=n;for(;Array.isArray(i);)++o,i=i[0];const u=e-o;for(;o<e;)n=[n],++o;let a=t.applySetters(Array.isArray(n)?n:[n],s);for(let e=0;e<u;++e)a=a[0];return a}if(r in _)return n;if(r in b){if(null==n)throw new e("number",n,t.path);if("$inc"===r)return t.castForQuery(null,n,s);try{return i(n)}catch(r){throw new e("number",n,t.path)}}if("$currentDate"===r)return"object"==typeof n?{$type:n.$type}:Boolean(n);if(y.has(o))return t.castForQuery(o,n,s);if(C[r]){const e=null!=n&&t.$isMongooseArray&&null!=t.$fullPath&&!t.$fullPath.match(/\d+$/),r=null!=t[p];return e||r?t.applySetters(n,s):t.castForQuery(null,n,s)}return t.castForQuery(null,n,s)}return tE}function bE(){if(oE)return rE;oE=1;const e=dE();return rE=function(t,n,r){if(!r||!n||!n.upsert)return;e(t)[r]||(n.overwrite?t[r]=0:(t.$setOnInsert||(t.$setOnInsert={}),t.$setOnInsert[r]=0))},rE}function _E(){if(sE)return iE;sE=1;const e=Cp().modifiedPaths,t=wp();return iE=function(n,r,o,i){const s=null!=(i=i||{}).setDefaultsOnInsert?i.setDefaultsOnInsert:r.base.options.setDefaultsOnInsert;if(!i.upsert||!1===s)return o;const u=Object.keys(o||{}),a=u.length,c={};let l=!1;for(let t=0;t<a;++t)u[t].startsWith("$")&&(e(o[u[t]],"",c),l=!0);l||e(o,"",c);const h=Object.keys(n),p=h.length;for(let e=0;e<p;++e){const t=h[e],r=n[t];if(r&&"object"==typeof r){const e=Object.keys(r),t=e.length;let n=!1;for(let r=0;r<t;++r)if(e[r].startsWith("$")){n=!0;break}if(n)continue}c[t]=!0}return i&&i.overwrite&&!l||r.eachPath((function(e,n){if("_id"===n.path&&n.options.auto)return;const r=n.getDefault(null,!0);(function(e,t){if(e[t])return!0;const n=t.split(".");let r=n[0];for(let t=1;t<n.length;++t){if(e[r])return!0;r+="."+n[t]}const o=Object.keys(e);if(o.length){const e=t+".";for(const n of o)if(n.slice(0,t.length+1)===e)return!0}return!1})(c,e)||void 0!==r&&(n.splitPath().includes("$*")||((o=o||{}).$setOnInsert=o.$setOnInsert||{},null==t(o,e)&&(o.$setOnInsert[e]=r)))})),o},iE}function OE(){return uE||(uE=1,function(e){const t=pa(),r=Zp(),o=_f(),i=Of(),s=hm(),u=AE(),a=oc(),c=bE(),{inspect:l}=n,h=_E();function p(e,t){null!=e&&e.discriminatorMapping&&!e.discriminatorMapping.isRoot&&(t[e.discriminatorMapping.key]=e.discriminatorMapping.value)}function d(e,t){const n=e.schema.options.discriminatorKey;return null!=t&&t.hasOwnProperty(n)&&(e=r(e.discriminators,t[n])||e),e}function f(e,t){const n=e.timestamps,r=t.timestamps;return null!=n?n:null==r||r}e.exports=function(n,r,o){const i=n.base.now();return r.insertOne?t=>e.exports.castInsertOne(n,r.insertOne,o).then((()=>t(null)),(e=>t(e))):r.updateOne?t=>{try{e.exports.castUpdateOne(n,r.updateOne,o,i),t(null)}catch(e){t(e)}}:r.updateMany?t=>{try{e.exports.castUpdateMany(n,r.updateMany,o,i),t(null)}catch(e){t(e)}}:r.replaceOne?t=>{e.exports.castReplaceOne(n,r.replaceOne,o).then((()=>t(null)),(e=>t(e)))}:r.deleteOne?t=>{try{e.exports.castDeleteOne(n,r.deleteOne),t(null)}catch(e){t(e)}}:r.deleteMany?t=>{try{e.exports.castDeleteMany(n,r.deleteMany),t(null)}catch(e){t(e)}}:e=>{e(new t(`Invalid op passed to \`bulkWrite()\`: ${l(r)}`),null)}},e.exports.castInsertOne=async function(e,t,n){const r=d(e,t.document),o=new r(t.document);r.schema.options.timestamps&&f(t,n)&&o.initializeTimestamps(),null!=n.session&&o.$session(n.session);const i=r?.schema?.options?.versionKey;return i&&null==o[i]&&(o[i]=0),t.document=o,n.skipValidation||t.skipValidation||await t.document.$validate(),t},e.exports.castUpdateOne=function(e,t,n,r){if(!t.filter)throw new Error("Must provide a filter object.");if(!t.update)throw new Error("Must provide an update object.");const l=d(e,t.filter),m=l.schema,y=null!=n.strict?n.strict:l.schema.options.strict,g=a(t.update);p(m,t.filter);const E=f(t,n);if(null!=l.schema.$timestamps&&E){const e=l.schema.$timestamps.createdAt,t=l.schema.$timestamps.updatedAt;i(r,e,t,g,{})}E&&o(r,g,l.schema);const A=e.base.options.setDefaultsOnInsert;return!1!==(null==t.setDefaultsOnInsert?A:t.setDefaultsOnInsert)&&h(t.filter,l.schema,g,{setDefaultsOnInsert:!0,upsert:t.upsert}),c(g,t,l.schema.options.versionKey),t.filter=s(l.schema,t.filter,{strict:y,upsert:t.upsert}),t.update=u(l.schema,g,{strict:y,upsert:t.upsert,arrayFilters:t.arrayFilters,overwriteDiscriminatorKey:t.overwriteDiscriminatorKey},l,t.filter),t},e.exports.castUpdateMany=function(e,t,n,r){if(!t.filter)throw new Error("Must provide a filter object.");if(!t.update)throw new Error("Must provide an update object.");const a=d(e,t.filter),l=a.schema,m=null!=n.strict?n.strict:a.schema.options.strict,y=e.base.options.setDefaultsOnInsert;!1!==(null==t.setDefaultsOnInsert?y:t.setDefaultsOnInsert)&&h(t.filter,a.schema,t.update,{setDefaultsOnInsert:!0,upsert:t.upsert});const g=f(t,n);if(null!=a.schema.$timestamps&&g){const e=a.schema.$timestamps.createdAt,n=a.schema.$timestamps.updatedAt;i(r,e,n,t.update,{})}g&&o(r,t.update,a.schema),p(l,t.filter),c(t.update,t,a.schema.options.versionKey),t.filter=s(a.schema,t.filter,{strict:m,upsert:t.upsert}),t.update=u(a.schema,t.update,{strict:m,upsert:t.upsert,arrayFilters:t.arrayFilters,overwriteDiscriminatorKey:t.overwriteDiscriminatorKey},a,t.filter)},e.exports.castReplaceOne=async function(e,t,n){const r=d(e,t.filter),o=r.schema,i=null!=n.strict?n.strict:r.schema.options.strict;p(o,t.filter),t.filter=s(r.schema,t.filter,{strict:i,upsert:t.upsert});const u=new r(t.replacement,i,!0);r.schema.options.timestamps&&f(t,n)&&u.initializeTimestamps(),null!=n.session&&u.$session(n.session);const a=r?.schema?.options?.versionKey;a&&null==u[a]&&(u[a]=0),t.replacement=u,n.skipValidation||t.skipValidation||await t.replacement.$validate(),t.replacement=t.replacement.toBSON()},e.exports.castDeleteOne=function(e,t){const n=d(e,t.filter);p(n.schema,t.filter),t.filter=s(n.schema,t.filter)},e.exports.castDeleteMany=function(e,t){const n=d(e,t.filter);p(n.schema,t.filter),t.filter=s(n.schema,t.filter)},e.exports.cast={insertOne:e.exports.castInsertOne,updateOne:e.exports.castUpdateOne,updateMany:e.exports.castUpdateMany,replaceOne:e.exports.castReplaceOne,deleteOne:e.exports.castDeleteOne,deleteMany:e.exports.castDeleteMany}}(pE)),pE.exports}function CE(){return cE?aE:(cE=1,aE=function(e,t,n){return e.mongoose=e.mongoose||{},e.mongoose.validationErrors=t,e.mongoose.results=n,e})}function wE(){if(hE)return lE;hE=1;
/*!
	 * Module dependencies.
	 */
const e=sc(),n=t.EventEmitter,r=$g(),o=la(),i=xg(),s=dl(),u=cl(),a=function(){if(wg)return Cg;wg=1;
/*!
	 * Module dependencies.
	 */
const e=pa();class t extends e{constructor(e,t){super(e),this.errors=t}}return Object.defineProperty(t.prototype,"name",{value:"SyncIndexesError"}),Cg=t}(),c=Pg(),l=oc(),h=Ug(),p=wp(),d=Vg(),f=ha(),m=uf(),y=function(){if(jg)return kg;jg=1;const e=pa();class t extends e{constructor(e,t){super(e),this.errors=t}}return Object.defineProperty(t.prototype,"name",{value:"CreateCollectionsError"}),kg=t}(),g=OE(),{modelSymbol:E}=Aa(),A=nd(),b=CE(),_=Aa().arrayAtomicsSymbol,O=Aa().sessionNewDocuments,C=["MONGODB-X509"];function w(e){this.base=e,this.collections={},this.models={},this.config={},this.replica=!1,this.options=null,this.otherDbs=[],this.relatedDbs={},this.states=o,this._readyState=o.disconnected,this._closeCalled=!1,this._hasOpened=!1,this.plugins=[],void 0!==e&&e.connections.length?this.id=e.nextConnectionId:this.id=0,this._queue=[]}
/*!
	 * Inherit from EventEmitter
	 */
/*!
	 * ignore
	 */
function S(e,t,n){if("function"==typeof t&&null==n)throw new s("Connection.prototype.openUri() no longer accepts a callback");if("function"==typeof n)throw new s("Connection.prototype.openUri() no longer accepts a callback")}
/*!
	 * ignore
	 */function v(e){if("MongoServerSelectionError"===e?.name){const t=e;(e=new u).assimilateError(t)}return e}return Object.setPrototypeOf(w.prototype,n.prototype),Object.defineProperty(w.prototype,"readyState",{get:function(){return this._readyState===o.connected&&null!=this._lastHeartbeatAt&&"LoadBalanced"!==this.client?.topology?.s?.description?.type&&"number"==typeof this.client?.topology?.s?.description?.heartbeatFrequencyMS&&Date.now()-this._lastHeartbeatAt>=2*this.client.topology.s.description.heartbeatFrequencyMS?o.disconnected:this._readyState},set:function(e){if(!(e in o))throw new Error("Invalid connection state: "+e);if(this._readyState!==e){this._readyState=e;for(const t of this.otherDbs)t.readyState=e;o.connected===e&&(this._hasOpened=!0),this.emit(o[e])}}}),w.prototype.get=function(e){return this.config.hasOwnProperty(e)?this.config[e]:p(this.options,e)},w.prototype.set=function(e,t){return this.config.hasOwnProperty(e)?(this.config[e]=t,t):(this.options=this.options||{},this.options[e]=t,t)},w.prototype.collections,w.prototype.name,w.prototype.models,w.prototype.id,Object.defineProperty(w.prototype,"plugins",{configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(w.prototype,"host",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(w.prototype,"port",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(w.prototype,"user",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(w.prototype,"pass",{configurable:!0,enumerable:!0,writable:!0}),w.prototype.db,w.prototype.client,w.prototype.config,w.prototype.createCollection=async function(e,t){if("function"==typeof t||arguments.length>=3&&"function"==typeof arguments[2])throw new s("Connection.prototype.createCollection() no longer accepts a callback");return await this._waitForConnect(),this.db.createCollection(e,t)},w.prototype.bulkWrite=async function(e,t){await this._waitForConnect();const n=null==(t=t||{}).ordered||t.ordered,r=this.base.transactionAsyncLocalStorage?.getStore();t&&t.hasOwnProperty("session")||null==r?.session||(t={...t,session:r.session});const o=this.base.now();let u=null;if(n){const n=[];for(const r of e){if("string"!=typeof r.model&&!r.model?.[E])throw new s("Must specify model in Connection.prototype.bulkWrite() operations");const e=r.model[E]?r.model:this.model(r.model);if(null==r.name)throw new s("Must specify operation name in Connection.prototype.bulkWrite()");if(!g.cast.hasOwnProperty(r.name))throw new s(`Unrecognized bulkWrite() operation name ${r.name}`);await g.cast[r.name](e,r,t,o),n.push({...r,namespace:e.namespace()})}u=await this.client.bulkWrite(n,t)}else{const n=[],r=[];let a=[];const c=[],l=[];for(let i=0;i<e.length;++i){const u=e[i];if("string"!=typeof u.model&&!u.model?.[E]){const e=new s("Must specify model in Connection.prototype.bulkWrite() operations");a.push({index:i,error:e}),l[i]=e;continue}let h;try{h=u.model[E]?u.model:this.model(u.model)}catch(e){a.push({index:i,error:e});continue}if(null==u.name){const e=new s("Must specify operation name in Connection.prototype.bulkWrite()");a.push({index:i,error:e}),l[i]=e;continue}if(!g.cast.hasOwnProperty(u.name)){const e=new s(`Unrecognized bulkWrite() operation name ${u.name}`);a.push({index:i,error:e}),l[i]=e;continue}let p=null;try{p=g.cast[u.name](h,u,t,o)}catch(e){a.push({index:i,error:e}),l[i]=e;continue}A(p)?c.push(p.then((()=>{n.push({...u,namespace:h.namespace()}),r.push(i)}),(e=>{a.push({index:i,error:e}),l[i]=e}))):(n.push({...u,namespace:h.namespace()}),r.push(i))}if(c.length>0&&await Promise.all(c),a=a.sort(((e,t)=>e.index-t.index)).map((e=>e.error)),0===n.length){if(t.throwOnValidationError&&a.length)throw new i(a,l,e,"bulkWrite");const e=new(0,this.base.driver.get().BulkWriteResult)(d(),!1);return b(e,a,l)}let h;[u,h]=await this.client.bulkWrite(n,t).then((e=>[e,null])).catch((e=>[null,e]));for(let e=0;e<r.length;++e)l[r[e]]=null;if(h&&a.length>0&&(b(h,a,l),h.mongoose=h.mongoose||{},h.mongoose.validationErrors=a),a.length>0){if(t.throwOnValidationError)throw new i(a,l,u,"bulkWrite");b(u,a,l)}}return u},w.prototype.createCollections=async function(e={}){const t={},n={},{continueOnError:r}=e;delete e.continueOnError;for(const e of Object.values(this.models))try{t[e.modelName]=await e.createCollection({})}catch(o){if(!r){n[e.modelName]=o;break}t[e.modelName]=o}if(!r&&Object.keys(n).length){const e=Object.entries(n).map((([e,t])=>`${e}: ${t.message}`)).join(", ");throw new y(e,n)}return t},w.prototype.withSession=async function(e){if(0===arguments.length)throw new Error("Please provide an executor function");return await this.client.withSession(e)},w.prototype.startSession=async function(e){if(arguments.length>=2&&"function"==typeof arguments[1])throw new s("Connection.prototype.startSession() no longer accepts a callback");await this._waitForConnect();return this.client.startSession(e)},w.prototype.transaction=function(e,t){return this.startSession().then((n=>(n[O]=new Map,n.withTransaction((()=>
/*!
	 * Reset document state in between transaction retries re: gh-13698
	 */
async function(e,t,n){try{return null==n.transactionAsyncLocalStorage?await e(t):await new Promise((r=>{n.transactionAsyncLocalStorage.run({session:t},(()=>r(e(t))))}))}catch(e){
/*!
	 * If transaction was aborted, we need to reset newly inserted documents' `isNew`.
	 */
throw function(e){for(const t of e[O].keys()){const n=e[O].get(t);n.hasOwnProperty("isNew")&&(t.$isNew=n.isNew),n.hasOwnProperty("versionKey")&&t.set(t.schema.options.versionKey,n.versionKey),n.modifiedPaths.length>0&&null==t.$__.activePaths.states.modify&&(t.$__.activePaths.states.modify={});for(const e of n.modifiedPaths){const n=t.$__.activePaths.paths[e];null!=n&&delete t.$__.activePaths[n][e],t.$__.activePaths.paths[e]="modify",t.$__.activePaths.states.modify[e]=!0}for(const e of n.atomics.keys()){const r=t.$__getValue(e);null!=r&&(r[_]=n.atomics.get(e))}}}(t),e}}(e,n,this.base)),t).then((e=>(delete n[O],e))).catch((e=>{throw delete n[O],e})).finally((()=>{n.endSession().catch((()=>{}))})))))},w.prototype.dropCollection=async function(e){if(arguments.length>=2&&"function"==typeof arguments[1])throw new s("Connection.prototype.dropCollection() no longer accepts a callback");return await this._waitForConnect(),this.db.dropCollection(e)},w.prototype._waitForConnect=async function(e){if((this.readyState===o.connecting||this.readyState===o.disconnected)&&this._shouldBufferCommands()){const t=this._getBufferTimeoutMS();let n=null,r=!1;const o={},i=new Promise((e=>{o.fn=e,this._queue.push(o)}));if(e?await i:await Promise.race([i,new Promise((e=>{n=setTimeout((()=>{r=!0,e()}),t)}))]),r){const e=this._queue.indexOf(o);-1!==e&&this._queue.splice(e,1);throw new s("Connection operation buffering timed out after "+t+"ms")}null!=n&&clearTimeout(n)}},
/*!
	 * Get the default buffer timeout for this connection
	 */
w.prototype._getBufferTimeoutMS=function(){return null!=this.config.bufferTimeoutMS?this.config.bufferTimeoutMS:null!=this.base&&null!=this.base.get("bufferTimeoutMS")?this.base.get("bufferTimeoutMS"):1e4},w.prototype.listCollections=async function(){await this._waitForConnect();const e=this.db.listCollections();return await e.toArray()},w.prototype.listDatabases=async function(){throw new s("listDatabases() not implemented by driver")},w.prototype.dropDatabase=async function(){if(arguments.length>=1&&"function"==typeof arguments[0])throw new s("Connection.prototype.dropDatabase() no longer accepts a callback");await this._waitForConnect();for(const e of Object.values(this.models))delete e.$init;return this.db.dropDatabase()},
/*!
	 * ignore
	 */
w.prototype._shouldBufferCommands=function(){return null!=this.config.bufferCommands?this.config.bufferCommands:null==this.base.get("bufferCommands")||this.base.get("bufferCommands")},w.prototype.error=function(e,t){return t?(t(e),null):(this.listeners("error").length>0&&this.emit("error",e),Promise.reject(e))},w.prototype.onOpen=function(){this.readyState=o.connected;for(const e of this._queue)e.fn.apply(e.ctx,e.args);this._queue=[];for(const e in this.collections)m.object.hasOwnProperty(this.collections,e)&&this.collections[e].onOpen();this.emit("open")},w.prototype.openUri=async function(e,t){if((this.readyState===o.connecting||this.readyState===o.connected)&&this._connectionString===e)return this;this._closeCalled=!1;let n=!1;t&&"_fireAndForget"in t&&(n=t._fireAndForget,delete t._fireAndForget);try{S.apply(arguments)}catch(e){if(n)throw e;throw this.$initialConnection=Promise.reject(e),e}this.$initialConnection=this.createClient(e,t).then((()=>this)).catch((e=>{throw this.readyState=o.disconnected,this.listeners("error").length>0&&f((()=>this.emit("error",e))),e}));for(const e of Object.values(this.models))e.init().catch((function(){}));if(n)return this;try{await this.$initialConnection}catch(e){throw v(e)}return this},w.prototype.on=function(e,t){return"error"===e&&this.$initialConnection&&this.$initialConnection.catch((()=>{})),n.prototype.on.call(this,e,t)},w.prototype.once=function(e,t){return"error"===e&&this.$initialConnection&&this.$initialConnection.catch((()=>{})),n.prototype.once.call(this,e,t)},w.prototype.destroy=async function(e){if("function"==typeof e||2===arguments.length&&"function"==typeof arguments[1])throw new s("Connection.prototype.destroy() no longer accepts a callback");return this.$wasForceClosed=null!=e&&"object"==typeof e?!!e.force:!!e,this._close(e,!0)},w.prototype.close=async function(e){if("function"==typeof e||2===arguments.length&&"function"==typeof arguments[1])throw new s("Connection.prototype.close() no longer accepts a callback");this.$wasForceClosed=null!=e&&"object"==typeof e?!!e.force:!!e,null!=this._lastHeartbeatAt&&(this._lastHeartbeatAt=null);for(const e of Object.values(this.models))delete e.$init;return this._close(e,!1)},w.prototype._close=async function(e,t){const n=this,r=this._closeCalled;this._closeCalled=!0,this._destroyCalled=t,null!=this.client&&(this.client._closeCalled=!0,this.client._destroyCalled=t);const i=this;switch(this.readyState){case o.disconnected:t&&-1!==this.base.connections.indexOf(i)&&this.base.connections.splice(this.base.connections.indexOf(i),1),r||(await this.doClose(e),this.onClose(e));break;case o.connected:this.readyState=o.disconnecting,await this.doClose(e),t&&-1!==n.base.connections.indexOf(i)&&this.base.connections.splice(this.base.connections.indexOf(i),1),this.onClose(e);break;case o.connecting:return new Promise(((n,r)=>{const o=()=>{this.removeListener("open",o),this.removeListener("error",o),t?this.destroy(e).then(n,r):this.close(e).then(n,r)};this.once("open",o),this.once("error",o)}));case o.disconnecting:return new Promise((e=>{this.once("close",(()=>{t&&-1!==this.base.connections.indexOf(i)&&this.base.connections.splice(this.base.connections.indexOf(i),1),e()}))}))}return this},w.prototype.doClose=function(){throw new Error("Connection#doClose unimplemented by driver")},w.prototype.onClose=function(e){this.readyState=o.disconnected;for(const t in this.collections)m.object.hasOwnProperty(this.collections,t)&&this.collections[t].onClose(e);this.emit("close",e);for(const t of this.otherDbs)this._destroyCalled?t.destroy({force:e,skipCloseClient:!0}):t.close({force:e,skipCloseClient:!0})},w.prototype.collection=function(e,t){const n={autoIndex:null!=this.config.autoIndex?this.config.autoIndex:this.base.options.autoIndex,autoCreate:null!=this.config.autoCreate?this.config.autoCreate:this.base.options.autoCreate,autoSearchIndex:null!=this.config.autoSearchIndex?this.config.autoSearchIndex:this.base.options.autoSearchIndex};(t=Object.assign({},n,t?l(t):{})).$wasForceClosed=this.$wasForceClosed;const r=this.base&&this.base.__driver&&this.base.__driver.Collection||h.get().Collection;return e in this.collections||(this.collections[e]=new r(e,this,t)),this.collections[e]},w.prototype.plugin=function(e,t){return this.plugins.push([e,t]),this},w.prototype.model=function(e,t,n,o){if(!(this instanceof w))throw new s("`connection.model()` should not be run with `new`. If you are doing `new db.model(foo)(bar)`, use `db.model(foo)(bar)` instead");let i;if("function"==typeof e&&(i=e,e=i.name),"string"==typeof t&&(n=t,t=!1),m.isObject(t)&&(t.instanceOfSchema?t instanceof this.base.Schema||(t=t._clone(this.base.Schema)):t=new r(t)),t&&!t.instanceOfSchema)throw new Error("The 2nd parameter to `mongoose.model()` should be a schema or a POJO");const u={cache:!1,overwriteModels:this.base.options.overwriteModels},a=Object.assign(u,o,{connection:this});if(this.models[e]&&!n&&!0!==a.overwriteModels){if(t&&t.instanceOfSchema&&t!==this.models[e].schema)throw new s.OverwriteModelError(e);return this.models[e]}let l;if(t&&t.instanceOfSchema)return c(t,this.plugins,null,"$connectionPluginsApplied"),l=this.base._model(i||e,t,n,a),this.models[e]||(this.models[e]=l),l.init().catch((function(){})),l;if(this.models[e]&&n){l=this.models[e],t=l.prototype.schema;return l.__subclass(this,t,n)}if(1===arguments.length){if(l=this.models[e],!l)throw new s.MissingSchemaError(e);return l}if(!l)throw new s.MissingSchemaError(e);return this!==l.prototype.db||n&&n!==l.collection.name?(this.models[e]=l.__subclass(this,t,n),this.models[e]):(this.models[e]||(this.models[e]=l),l)},w.prototype.deleteModel=function(e){if("string"==typeof e){const t=this.model(e);if(null==t)return this;const n=t.collection.name;delete this.models[e],delete this.collections[n],this.emit("deleteModel",t)}else{if(!(e instanceof RegExp))throw new Error('First parameter to `deleteModel()` must be a string or regexp, got "'+e+'"');{const t=e,n=this.modelNames();for(const e of n)t.test(e)&&this.deleteModel(e)}}return this},w.prototype.watch=function(t,n){return new e((e=>{f((()=>{if(this.readyState===o.connecting)this.once("open",(function(){const r=this.db.watch(t,n);e(null,r)}));else{const r=this.db.watch(t,n);e(null,r)}}))}),t,n)},w.prototype.asPromise=async function(){try{return await this.$initialConnection,this}catch(e){throw v(e)}},w.prototype.modelNames=function(){return Object.keys(this.models)},w.prototype.shouldAuthenticate=function(){return null!=this.user&&(null!=this.pass||this.authMechanismDoesNotRequirePassword())},w.prototype.authMechanismDoesNotRequirePassword=function(){return!this.options||!this.options.auth||C.indexOf(this.options.auth.authMechanism)>=0},w.prototype.optionsProvideAuthenticationData=function(e){return e&&e.user&&(e.pass||this.authMechanismDoesNotRequirePassword())},w.prototype.getClient=function(){return this.client},w.prototype.setClient=function(){throw new s("Connection#setClient not implemented by driver")},
/*!
	 * Called internally by `openUri()` to create a MongoClient instance.
	 */
w.prototype.createClient=function(){throw new s("Connection#createClient not implemented by driver")},w.prototype.syncIndexes=async function(e={}){const t={},n={},{continueOnError:r}=e;delete e.continueOnError;for(const o of Object.values(this.models))try{t[o.modelName]=await o.syncIndexes(e)}catch(e){if(!r){n[o.modelName]=e;break}t[o.modelName]=e}if(!r&&Object.keys(n).length){const e=Object.entries(n).map((([e,t])=>`${e}: ${t.message}`)).join(", ");throw new a(e,n)}return t},
/*!
	 * Module exports.
	 */
w.STATES=o,lE=w}var SE,vE,DE={name:"mongoose",description:"Mongoose MongoDB ODM",version:"8.13.2",author:"Guillermo Rauch <guillermo@learnboost.com>",keywords:["mongodb","document","model","schema","database","odm","data","datastore","query","nosql","orm","db"],type:"commonjs",license:"MIT",dependencies:{bson:"^6.10.3",kareem:"2.6.3",mongodb:"~6.15.0",mpath:"0.9.0",mquery:"5.0.0",ms:"2.1.3",sift:"17.1.3"},devDependencies:{"@babel/core":"7.26.10","@babel/preset-env":"7.26.9","@typescript-eslint/eslint-plugin":"^8.19.1","@typescript-eslint/parser":"^8.19.1",acquit:"1.3.0","acquit-ignore":"0.2.1","acquit-require":"0.1.1",ajv:"8.17.1","assert-browserify":"2.0.0","babel-loader":"8.2.5","broken-link-checker":"^0.7.8",buffer:"^5.6.0",cheerio:"1.0.0","crypto-browserify":"3.12.1",dox:"1.0.0",eslint:"8.57.1","eslint-plugin-markdown":"^5.1.0","eslint-plugin-mocha-no-only":"1.2.0",express:"^4.19.2","fs-extra":"~11.3.0","highlight.js":"11.11.1","lodash.isequal":"4.5.0","lodash.isequalwith":"4.4.0","markdownlint-cli2":"^0.17.1",marked:"15.0.7",mkdirp:"^3.0.1",mocha:"11.1.0",moment:"2.30.1","mongodb-memory-server":"10.1.4",ncp:"^2.0.0",nyc:"15.1.0",pug:"3.0.3",q:"1.5.1",sinon:"20.0.0","stream-browserify":"3.0.0",tsd:"0.31.2",typescript:"5.7.3",uuid:"11.1.0",webpack:"5.98.0"},directories:{lib:"./lib/mongoose"},scripts:{"docs:clean":"npm run docs:clean:stable","docs:clean:stable":"rimraf index.html && rimraf -rf ./docs/*.html  && rimraf -rf ./docs/api && rimraf -rf ./docs/tutorials/*.html && rimraf -rf ./docs/typescript/*.html && rimraf -rf ./docs/*.html && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp","docs:clean:5x":"rimraf index.html && rimraf -rf ./docs/5.x && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp","docs:clean:6x":"rimraf index.html && rimraf -rf ./docs/6.x && rimraf -rf ./docs/source/_docs && rimraf -rf ./tmp","docs:copy:tmp":"mkdirp ./tmp/docs/css && mkdirp ./tmp/docs/js && mkdirp ./tmp/docs/images && mkdirp ./tmp/docs/tutorials && mkdirp ./tmp/docs/typescript && mkdirp ./tmp/docs/api && ncp ./docs/css ./tmp/docs/css --filter=.css$ && ncp ./docs/js ./tmp/docs/js --filter=.js$ && ncp ./docs/images ./tmp/docs/images && ncp ./docs/tutorials ./tmp/docs/tutorials && ncp ./docs/typescript ./tmp/docs/typescript && ncp ./docs/api ./tmp/docs/api && cp index.html ./tmp && cp docs/*.html ./tmp/docs/","docs:copy:tmp:5x":"rimraf ./docs/5.x && ncp ./tmp ./docs/5.x","docs:copy:tmp:6x":"rimraf ./docs/6.x && ncp ./tmp ./docs/6.x","docs:generate":"node ./scripts/website.js","docs:generate:sponsorData":"node ./scripts/loadSponsorData.js","docs:test":"npm run docs:generate","docs:view":"node ./scripts/static.js","docs:prepare:publish:stable":"git checkout gh-pages && git merge master && npm run docs:generate","docs:prepare:publish:5x":"git checkout 5.x && git merge 5.x && npm run docs:clean:stable && npm run docs:generate && npm run docs:copy:tmp && git checkout gh-pages && npm run docs:copy:tmp:5x","docs:prepare:publish:6x":"git checkout 6.x && git merge 6.x && npm run docs:clean:stable && env DOCS_DEPLOY=true npm run docs:generate && mv ./docs/6.x ./tmp && git checkout gh-pages && npm run docs:copy:tmp:6x","docs:prepare:publish:7x":"env DOCS_DEPLOY=true npm run docs:generate && git checkout gh-pages && rimraf ./docs/7.x && mv ./tmp ./docs/7.x","docs:check-links":"blc http://127.0.0.1:8089 -ro",lint:"eslint .","lint-js":"eslint . --ext .js --ext .cjs","lint-ts":"eslint . --ext .ts","lint-md":'markdownlint-cli2 "**/*.md" "#node_modules" "#benchmarks"',"build-browser":"(rm ./dist/* || true) && node ./scripts/build-browser.js",prepublishOnly:"npm run build-browser",release:"git pull && git push origin master --tags && npm publish","release-5x":"git pull origin 5.x && git push origin 5.x && git push origin 5.x --tags && npm publish --tag 5x","release-6x":"git pull origin 6.x && git push origin 6.x && git push origin 6.x --tags && npm publish --tag 6x",mongo:"node ./tools/repl.js","publish-7x":"npm publish --tag 7x",test:"mocha --exit ./test/*.test.js","test-deno":"deno run --allow-env --allow-read --allow-net --allow-run --allow-sys --allow-write ./test/deno.js","test-rs":"START_REPLICA_SET=1 mocha --timeout 30000 --exit ./test/*.test.js","test-tsd":"node ./test/types/check-types-filename && tsd","setup-test-encryption":"bash scripts/configure-cluster-with-encryption.sh","test-encryption":"mocha --exit ./test/encryption/*.test.js",tdd:"mocha ./test/*.test.js --inspect --watch --recursive --watch-files ./**/*.{js,ts}","test-coverage":"nyc --reporter=html --reporter=text npm test","ts-benchmark":"cd ./benchmarks/typescript/simple && npm install && npm run benchmark | node ../../../scripts/tsc-diagnostics-check"},main:"./index.js",types:"./types/index.d.ts",engines:{node:">=16.20.1"},bugs:{url:"https://github.com/Automattic/mongoose/issues/new"},repository:{type:"git",url:"git://github.com/Automattic/mongoose.git"},homepage:"https://mongoosejs.com",browser:"./dist/browser.umd.js",config:{mongodbMemoryServer:{disablePostinstall:!0}},funding:{type:"opencollective",url:"https://opencollective.com/mongoose"},tsd:{directory:"test/types",compilerOptions:{esModuleInterop:!1,strict:!0,allowSyntheticDefaultImports:!0,strictPropertyInitialization:!1,noImplicitAny:!1,strictNullChecks:!0,module:"commonjs",target:"ES2017"}}};function ME(){if(vE)return SE;vE=1;const e=oc(),t=dl();return SE=function(n,r){const o=r||{},i=o.readPreference?o.readPreference:function(e){const t=/(?:&|\?)readPreference=(\w+)(?:&|$)/.exec(e);return t?t[1]:null}(n),s=e(o);return i&&"primary"!==i&&"primaryPreferred"!==i?function(e,n){if(!function(e){const t=e.config&&e.config.autoIndex,{autoCreate:n,autoIndex:r}=e;return!!(t||n||r)}(n)||"secondary"!==(r=e)&&"secondaryPreferred"!==r)return function(e){return e.config={autoIndex:!1},e.autoCreate=!1,e.autoIndex=!1,e}(n);!function(){throw new t('MongoDB prohibits index creation on connections that read from non-primary replicas.  Connections that set "readPreference" to "secondary" or "secondaryPreferred" may not opt-in to the following connection options: autoCreate, autoIndex')}();var r}(i,s):s},SE}var TE,BE,FE,$E,xE={};function PE(){return TE||(TE=1,xE.setTimeout=setTimeout),xE}
/*!
 * Module dependencies.
 */function NE(){return $E||($E=1,v.BulkWriteResult=function(){if(Gu)return qu;Gu=1;const e=ta().BulkWriteResult;return qu=e}(),v.Collection=ic(),v.Connection=function(){if(FE)return BE;FE=1;const e=wE(),t=dl(),n=la(),r=Mu(),o=DE,i=ME(),s=PE().setTimeout,u=uf();function a(){e.apply(this,arguments),this._listening=!1,this._lastHeartbeatAt=null}
/*!
	 * ignore
	 */
function c(e,t,r,o){const i=null!=o?t.db(o):t.db();e.db=i,e.client=t,e.host=t&&t.s&&t.s.options&&t.s.options.hosts&&t.s.options.hosts[0]&&t.s.options.hosts[0].host||void 0,e.port=t&&t.s&&t.s.options&&t.s.options.hosts&&t.s.options.hosts[0]&&t.s.options.hosts[0].port||void 0,e.name=null!=o?o:i.databaseName,e._closeCalled=t._closeCalled;const s=()=>{e.readyState!==n.connected&&(e.readyState=n.connected,e.emit("reconnect"),e.emit("reconnected"),e.onOpen())},a=t&&t.topology&&t.topology.description&&t.topology.description.type||"";"Single"===a?t.on("serverDescriptionChanged",(t=>{"Unknown"===t.newDescription.type?e.readyState=n.disconnected:s()})):a.startsWith("ReplicaSet")&&t.on("topologyDescriptionChanged",(t=>{const r=t.newDescription;e.readyState===n.connected&&"ReplicaSetWithPrimary"!==r.type?e.readyState=n.disconnected:e.readyState===n.disconnected&&"ReplicaSetWithPrimary"===r.type&&s()})),e._lastHeartbeatAt=null,t.on("serverHeartbeatSucceeded",(()=>{e._lastHeartbeatAt=Date.now()})),r.monitorCommands&&(t.on("commandStarted",(t=>e.emit("commandStarted",t))),t.on("commandFailed",(t=>e.emit("commandFailed",t))),t.on("commandSucceeded",(t=>e.emit("commandSucceeded",t)))),e.onOpen();for(const t in e.collections)u.object.hasOwnProperty(e.collections,t)&&e.collections[t].onOpen()}
/*!
	 * Module exports.
	 */return a.STATES=n,
/*!
	 * Inherits from Connection.
	 */
Object.setPrototypeOf(a.prototype,e.prototype),a.prototype.useDb=function(e,t){if((t=t||{}).useCache&&this.relatedDbs[e])return this.relatedDbs[e];const r=new this.constructor;r.name=e,r.base=this.base,r.collections={},r.models={},r.replica=this.replica,r.config=Object.assign({},this.config,r.config),r.name=this.name,r.options=this.options,r._readyState=this._readyState,r._closeCalled=this._closeCalled,r._hasOpened=this._hasOpened,r._listening=!1,r._parent=this,r.host=this.host,r.port=this.port,r.user=this.user,r.pass=this.pass;const o=this;function i(){r.client=o.client;const n={};t.hasOwnProperty("noListener")&&(n.noListener=t.noListener),r.db=o.client.db(e,n),r._lastHeartbeatAt=o._lastHeartbeatAt,r.onOpen()}return r.client=o.client,this.db&&this._readyState===n.connected?i():this._queue.push({fn:i}),r.name=e,!0!==t.noListener&&this.otherDbs.push(r),r.otherDbs.push(this),t&&t.useCache&&(this.relatedDbs[r.name]=r,r.relatedDbs=this.relatedDbs),r},a.prototype.aggregate=function(e,t){return new this.base.Aggregate(null,this).append(e).option(t??{})},a.prototype.removeDb=function(e){const r=this.otherDbs.filter((t=>t.name===e));if(!r.length)throw new t(`No connections to database "${e}" found`);for(const e of r)e._closeCalled=!0,e._destroyCalled=!0,e._readyState=n.disconnected,e.$wasForceClosed=!0;delete this.relatedDbs[e],this.otherDbs=this.otherDbs.filter((t=>t.name!==e))},a.prototype.doClose=async function(e){if(null==this.client)return this;let t=!1;return null!=e&&"object"==typeof e&&(t=e.skipCloseClient,e=e.force),t||(await this.client.close(e),await new Promise((e=>s(e,1)))),this},a.prototype.listDatabases=async function(){return await this._waitForConnect(),await this.db.admin().listDatabases()},
/*!
	 * ignore
	 */
a.prototype.createClient=async function(e,s){if("string"!=typeof e)throw new t(`The \`uri\` parameter to \`openUri()\` must be a string, got "${typeof e}". Make sure the first parameter to \`mongoose.connect()\` or \`mongoose.createConnection()\` is a string.`);if(this._destroyCalled)throw new t("Connection has been closed and destroyed, and cannot be used for re-opening the connection. Please create a new connection with `mongoose.createConnection()` or `mongoose.connect()`.");if((this.readyState===n.connecting||this.readyState===n.connected)&&this._connectionString!==e)throw new t("Can't call `openUri()` on an active connection with different connection strings. Make sure you aren't calling `mongoose.connect()` multiple times. See: https://mongoosejs.com/docs/connections.html#multiple_connections");if(s=i(e,s)){const e=s.config&&null!=s.config.autoIndex?s.config.autoIndex:s.autoIndex;null!=e&&(this.config.autoIndex=!1!==e,delete s.config,delete s.autoIndex),"autoCreate"in s&&(this.config.autoCreate=!!s.autoCreate,delete s.autoCreate),"sanitizeFilter"in s&&(this.config.sanitizeFilter=s.sanitizeFilter,delete s.sanitizeFilter),"autoSearchIndex"in s&&(this.config.autoSearchIndex=s.autoSearchIndex,delete s.autoSearchIndex),"bufferTimeoutMS"in s&&(this.config.bufferTimeoutMS=s.bufferTimeoutMS,delete s.bufferTimeoutMS),(s.user||s.pass)&&(s.auth=s.auth||{},s.auth.username=s.user,s.auth.password=s.pass,this.user=s.user,this.pass=s.pass),delete s.user,delete s.pass,null!=s.bufferCommands&&(this.config.bufferCommands=s.bufferCommands,delete s.bufferCommands)}else s={};this._connectionOptions=s;const a=s.dbName;let l;null!=a&&(this.$dbName=a),delete s.dbName,u.hasUserDefinedProperty(s,"driverInfo")||(s.driverInfo={name:"Mongoose",version:o.version}),this.readyState=n.connecting,this._connectionString=e;try{l=new r.MongoClient(e,s)}catch(e){throw this.readyState=n.disconnected,e}this.client=l,l.setMaxListeners(0),await l.connect(),c(this,l,s,a);for(const e of this.otherDbs)c(e,l,{},e.name);return this},
/*!
	 * ignore
	 */
a.prototype.setClient=function(e){if(!(e instanceof r.MongoClient))throw new t("Must call `setClient()` with an instance of MongoClient");if(this.readyState!==n.disconnected)throw new t("Cannot call `setClient()` on a connection that is already connected.");if(null==e.topology)throw new t("Cannot call `setClient()` with a MongoClient that you have not called `connect()` on yet.");this._connectionString=e.s.url,c(this,e,{},e.s.options.dbName);for(const e of Object.values(this.models))e.init().catch((function(){}));return this},BE=a}
/*!
 * Module exports.
 */()),v}var IE,RE,kE,jE,LE,UE,VE,zE,WE,qE,GE,HE,KE,YE,QE,JE,XE,ZE,eA,tA,nA,rA,oA,iA,sA={exports:{}};function uA(){if(UE)return LE;UE=1;
/*!
	 * Module dependencies.
	 */
const e=function(){if(jE)return kE;jE=1;const e=pa();class t extends e{constructor(e){let t=e.map((e=>e.message)).join(", ");t.length>50&&(t=t.slice(0,50)+"..."),super(`eachAsync() finished with ${e.length} errors: ${t}`),this.errors=e}}return Object.defineProperty(t.prototype,"name",{value:"EachAsyncMultiError"}),
/*!
	 * exports
	 */
kE=t}(),t=ha();function n(t){return 0===t.length?null:new e(t)}return LE=async function(e,r,o){const i=o.parallel||1,s=o.batchSize,u=o.signal,a=o.continueOnError,c=[],l=function(){const e=[];let t=null,n=0;return function(o){if(null===t&&0===e.length)return t=n++,o(r);e.push(o)};function r(){if(0!==e.length){t=n++;e.shift()(r)}else t=null}}();let h=!1;return new Promise(((r,o)=>{if(null!=u){if(u.aborted)return r(null);u.addEventListener("abort",(()=>(h=!0,r(null))),{once:!0})}if(null!=s){if("number"!=typeof s)throw new TypeError("batchSize must be a number");if(!Number.isInteger(s))throw new TypeError("batchSize must be an integer");if(s<1)throw new TypeError("batchSize must be at least 1")}!function(r){let o=0,u=0,d=null;for(let e=0;e<i;++e)l(f());function f(){let i=[],f=!1;return m;function m(y){return f||h||d?y():void e((function(e,g){if(null!=d)return y();if(null!=e)if("MongoCursorExhaustedError"===e.name)g=null;else{if(!a)return d=e,r(e),y();c.push(e)}if(null==g){if(f=!0,o<=0){const e=a?n(c):d;r(e)}else s&&i.length&&p(i,u++,E);return y()}if(++o,t((()=>y())),s&&i.push(g),s&&i.length!==s)return void t((()=>l(m)));function E(e){if(s?(o-=i.length,i=[]):--o,null!=e){if(!a)return d=e,r(e);c.push(e)}if((f||h)&&o<=0){const e=a?n(c):d;return r(e)}t((()=>l(m)))}p(s?i:g,u++,E)}))}}}(((e,t)=>{if(null!=e)return o(e);r(t)}))}));function p(e,t,n){let o;try{o=r(e,t)}catch(e){return n(e)}o&&"function"==typeof o.then?o.then((function(){n(null)}),(function(e){n(e||new Error("`eachAsync()` promise rejected without error"))})):n(null)}},LE}
/*!
 * Module dependencies.
 */function aA(){if(qE)return WE;qE=1;const e=uf();function t(t,n,r,o){e.hasUserDefinedProperty(t,o)||(e.hasUserDefinedProperty(n,o)?t[o]=n[o]:e.hasUserDefinedProperty(r,o)&&(t[o]=r[o]))}return WE={applyGlobalMaxTimeMS:function(e,n,r){t(e,n,r,"maxTimeMS")},applyGlobalDiskUse:function(e,n,r){t(e,n,r,"allowDiskUse")}},WE}function cA(){return HE||(HE=1,GE=function(e,t){if(void 0!==t.readConcern)return;if(t&&t.session&&t.session.transaction)return;const n=e.options?.readConcern?.level;null!=n&&(t.readConcern={level:n})}),GE}function lA(){return YE||(YE=1,KE=function(e,t){if(null!=t.writeConcern)return;if(t&&t.session&&t.session.transaction)return;const n=e.options.writeConcern??{};0!=Object.keys(n).length?(t.writeConcern={},"w"in t||null==n.w||(t.writeConcern.w=n.w),"j"in t||null==n.j||(t.writeConcern.j=n.j),"wtimeout"in t||null==n.wtimeout||(t.writeConcern.wtimeout=n.wtimeout)):("w"in t||null==n.w||(t.w=n.w),"j"in t||null==n.j||(t.j=n.j),"wtimeout"in t||null==n.wtimeout||(t.wtimeout=n.wtimeout))}),KE}function hA(){if(JE)return QE;JE=1;const e=lm();return QE=function(t,n,r){if(!Object.keys(r).some(e))return n.castForQuery(null,r,t);const o=Object.keys(r);let i=o.length;for(;i--;){const s=o[i],u=r[s];if("$not"===s){if(u&&n&&!n.caster){const o=Object.keys(u);if(o.length&&e(o[0]))for(const e of Object.keys(u))u[e]=n.castForQuery(e,u[e],t);else r[s]=n.castForQuery(s,u,t);continue}}else r[s]=n.castForQuery(s,u,t)}return r}}function pA(){if(ZE)return XE;ZE=1;const e=/^\d+$/;return XE=function(t,n){let r=t.path(n);if(null!=r)return r;const o=n.split(".");let i="",s=!1;for(const n of o)s&&e.test(n)||(i=0===i.length?n:i+"."+n,r=t.path(i),null!=r&&r.schema&&(t=r.schema,i="",!s&&r.$isMongooseDocumentArray&&(s=!0)));return r},XE}function dA(){if(tA)return eA;tA=1;const e=hA(),t=Af(),n=pA(),r=fE();function o(r,i,s,u,a){if(Array.isArray(r))for(const c of r){if(null==c)throw new Error(`Got null array filter in ${r}`);const l=Object.keys(c).filter((e=>null!=c[e]));if(0===l.length)continue;const h=l[0];if("$and"===h||"$or"===h){for(const e of l)o(c[e],i,s,u,a);continue}const p=h.indexOf("."),d=-1===p?h:h.substring(0,p);if(null==u[d])continue;const f=t(u[d]),m=n(i,f);let y=null!=m?m.schema:null;null!=y&&null!=y.discriminators&&c[d+"."+y.options.discriminatorKey]&&(y=y.discriminators[c[d+"."+y.options.discriminatorKey]]||y);for(const r of l){if(null===u[r])continue;if(0===Object.keys(u).length)continue;const o=r.indexOf(".");let i,l=-1===o?null:r.substring(o);if(null==l||null==y?i=m:(l=t(l),i=n(y,l)),null==i){if(!s)return;throw new Error(`Could not find path "${null==l?f+".0":f+".0"+l}" in schema`)}"object"==typeof c[r]?c[r]=e(a,i,c[r]):c[r]=i.castForQuery(null,c[r])}}}return eA=function(e){const t=e.options.arrayFilters,n=e.getUpdate(),i=e.schema,s=r(n);let u=i.options.strict;null!=e._mongooseOptions.strict&&(u=e._mongooseOptions.strict),e.model&&null!=e.model.base.options.strictQuery&&(u=e.model.base.options.strictQuery),null!=i._userProvidedOptions.strictQuery&&(u=i._userProvidedOptions.strictQuery),null!=e._mongooseOptions.strictQuery&&(u=e._mongooseOptions.strictQuery),o(t,i,u,s,e)},eA}function fA(){if(rA)return nA;rA=1;const e=Bp(),t=Ka();
/*!
	 * ignore
	 */
return nA=function n(r){if(null==r)return!1;const o=Object.keys(r),i=o.length;if(0===i)return!1;for(let s=0;s<i;++s){const i=o[s];if(!i.startsWith("+")&&(e(r[i])&&r[i]))return t(r[i])?n(r[i]):!!r[i]}return!1}}function mA(){return iA?oA:(iA=1,oA=function(e,t){return e===t||t.startsWith(e+".")})}var yA,gA={exports:{}},EA={};function AA(){return yA||(yA=1,function(e){
/*!
		 * Module dependencies.
		 */
const t=["__proto__","constructor","prototype"],n=e.clone=function t(n,r){if(null==n)return n;if(Array.isArray(n))return e.cloneArray(n,r);if(n.constructor){if(/ObjectI[dD]$/.test(n.constructor.name))return"function"==typeof n.clone?n.clone():new n.constructor(n.id);if("ReadPreference"===n.constructor.name)return new n.constructor(n.mode,t(n.tags,r));if("Binary"==n._bsontype&&n.buffer&&n.value)return"function"==typeof n.clone?n.clone():new n.constructor(n.value(!0),n.sub_type);if("Date"===n.constructor.name||"Function"===n.constructor.name)return new n.constructor(+n);if("RegExp"===n.constructor.name)return new RegExp(n);if("Buffer"===n.constructor.name)return Buffer.from(n)}return o(n)?e.cloneObject(n,r):n.valueOf?n.valueOf():void 0};
/*!
		 * ignore
		 */
e.cloneObject=function(e,r){const o=r&&r.minimize,i={},s=Object.keys(e),u=s.length;let a,c=!1,l="",h=0;for(h=0;h<u;++h)l=s[h],-1===t.indexOf(l)&&(a=n(e[l],r),o&&void 0===a||(c||(c=!0),i[l]=a));return o?c&&i:i},e.cloneArray=function(e,t){const r=[],o=e.length;let i=0;for(;i<o;i++)r.push(n(e[i],t));return r},e.merge=function n(r,o){const i=Object.keys(o);for(const s of i)-1===t.indexOf(s)&&(void 0===r[s]?r[s]=o[s]:e.isObject(o[s])?n(r[s],o[s]):r[s]=o[s])},e.mergeClone=function r(o,i){const s=Object.keys(i);for(const u of s)-1===t.indexOf(u)&&(void 0===o[u]?o[u]=n(i[u]):e.isObject(i[u])?r(o[u],i[u]):o[u]=n(i[u]))},e.readPref=function(e){switch(e){case"p":e="primary";break;case"pp":e="primaryPreferred";break;case"s":e="secondary";break;case"sp":e="secondaryPreferred";break;case"n":e="nearest"}return e},e.readConcern=function(e){if("string"==typeof e){switch(e){case"l":e="local";break;case"a":e="available";break;case"m":e="majority";break;case"lz":e="linearizable";break;case"s":e="snapshot"}e={level:e}}return e};const r=Object.prototype.toString;e.toString=function(e){return r.call(e)};const o=e.isObject=function(t){return"[object Object]"==e.toString(t)};e.keys=Object.keys,e.create="function"==typeof Object.create?Object.create:function(e){if(arguments.length>1)throw new Error("Adding properties is not supported");function t(){}return t.prototype=e,new t},e.inherits=function(t,n){t.prototype=e.create(n.prototype),t.prototype.constructor=t},e.isArgumentsObject=function(e){return"[object Arguments]"===Object.prototype.toString.call(e)}}(EA)),EA}var bA,_A,OA,CA={exports:{}},wA={exports:{}};function SA(){if(_A)return bA;return _A=1,bA=function(e){function t(e){let r,o,i,s=null;function u(...e){if(!u.enabled)return;const n=u,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return u.namespace=e,u.useColors=t.useColors(),u.color=t.selectColor(e),u.extend=n,u.destroy=t.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(u),u}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e,t){let n=0,r=0,o=-1,i=0;for(;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(o=r,i=n,r++):(n++,r++);else{if(-1===o)return!1;r=o+1,i++,n=i}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names,...t.skips.map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").trim().replace(" ",",").split(",").filter(Boolean);for(const e of n)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const n of t.skips)if(r(e,n))return!1;for(const n of t.names)if(r(e,n))return!0;return!1},t.humanize=Rl(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},bA}var vA,DA,MA,TA,BA,FA,$A={exports:{}};function xA(){return DA?vA:(DA=1,vA=(e,t=process.argv)=>{const n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),o=t.indexOf("--");return-1!==r&&(-1===o||r<o)})}function PA(){return BA||(BA=1,function(e,t){const r=E,o=n;t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(o.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:o}=this;if(o){const t=this.color,o="[3"+(t<8?t:"8;5;"+t),i=`  ${o};1m${r} [0m`;n[0]=i+n[0].split("\n").join("\n"+i),n.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=o.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=function(){if(TA)return MA;TA=1;const e=c,t=E,n=xA(),{env:r}=process;let o;function i(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function s(t,i){if(0===o)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(t&&!i&&void 0===o)return 0;const s=o||0;if("dumb"===r.TERM)return s;if("win32"===process.platform){const t=e.release().split(".");return Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in r)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in r))||"codeship"===r.CI_NAME?1:s;if("TEAMCITY_VERSION"in r)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(r.TEAMCITY_VERSION)?1:0;if("truecolor"===r.COLORTERM)return 3;if("TERM_PROGRAM"in r){const e=parseInt((r.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(r.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(r.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(r.TERM)||"COLORTERM"in r?1:s}return n("no-color")||n("no-colors")||n("color=false")||n("color=never")?o=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=1),"FORCE_COLOR"in r&&(o="true"===r.FORCE_COLOR?1:"false"===r.FORCE_COLOR?0:0===r.FORCE_COLOR.length?1:Math.min(parseInt(r.FORCE_COLOR,10),3)),MA={supportsColor:function(e){return i(s(e,e&&e.isTTY))},stdout:i(s(!0,t.isatty(1))),stderr:i(s(!0,t.isatty(2)))}}();e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=SA()(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)}}($A,$A.exports)),$A.exports}function NA(){return FA||(FA=1,"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?CA.exports=(OA||(OA=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=SA()(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(wA,wA.exports)),wA.exports):CA.exports=PA()),CA.exports}var IA,RA={};var kA,jA={exports:{}};function LA(){return kA||(kA=1,(e=jA.exports).isNode="undefined"!=typeof process&&"object"==typeof b&&"function"==typeof Buffer&&process.argv,e.isMongo=!e.isNode&&"function"==typeof printjson&&"function"==typeof ObjectId&&"function"==typeof rs&&"function"==typeof sh,e.isBrowser=!e.isNode&&!e.isMongo&&"undefined"!=typeof window,e.type=e.isNode?"node":e.isMongo?"mongo":e.isBrowser?"browser":"unknown"),jA.exports;var e}var UA,VA,zA,WA,qA,GA,HA,KA,YA,QA,JA,XA,ZA,eb,tb,nb,rb,ob,ib,sb,ub,ab={exports:{}},cb={exports:{}};function lb(){return UA||(UA=1,function(e){const t=["find","findOne","updateMany","updateOne","replaceOne","count","distinct","findOneAndDelete","findOneAndUpdate","aggregate","findCursor","deleteOne","deleteMany"];function n(){}for(let e=0,o=t.length;e<o;++e){const o=t[e];n.prototype[o]=r(o)}function r(e){return function(){throw new Error("collection."+e+" not implemented")}}e.exports=n,n.methods=t}(cb)),cb.exports}function hb(){if(WA)return zA;WA=1;const e=LA();if("unknown"==e.type)throw new Error("Unknown environment");return zA=e.isNode?(VA||(VA=1,function(e){const t=lb();e.exports=class extends t{constructor(e){super(),this.collection=e,this.collectionName=e.collectionName}async find(e,t){return this.collection.find(e,t).toArray()}async findOne(e,t){return this.collection.findOne(e,t)}async count(e,t){return this.collection.count(e,t)}async distinct(e,t,n){return this.collection.distinct(e,t,n)}async updateMany(e,t,n){return this.collection.updateMany(e,t,n)}async updateOne(e,t,n){return this.collection.updateOne(e,t,n)}async replaceOne(e,t,n){return this.collection.replaceOne(e,t,n)}async deleteOne(e,t){return this.collection.deleteOne(e,t)}async deleteMany(e,t){return this.collection.deleteMany(e,t)}async findOneAndDelete(e,t){return this.collection.findOneAndDelete(e,t)}async findOneAndUpdate(e,t,n){return this.collection.findOneAndUpdate(e,t,n)}findCursor(e,t){return this.collection.find(e,t)}}}(ab)),ab.exports):(e.isMongo,lb()),zA}function pb(){return qA||(qA=1,function(e){const t=g,r=n,o=AA(),i=NA()("mquery");function s(e,t){if(!(this instanceof s))return new s(e,t);const n=this.constructor.prototype;this.op=n.op||void 0,this.options=Object.assign({},n.options),this._conditions=n._conditions?o.clone(n._conditions):{},this._fields=n._fields?o.clone(n._fields):void 0,this._updateDoc=n._updateDoc?o.clone(n._updateDoc):void 0,this._path=n._path||void 0,this._distinctDoc=n._distinctDoc||void 0,this._collection=n._collection||void 0,this._traceFunction=n._traceFunction||void 0,t&&this.setOptions(t),e&&this.find(e)}let u="$geoWithin";Object.defineProperty(s,"use$geoWithin",{get:function(){return"$geoWithin"==u},set:function(e){u=!0===e?"$geoWithin":"$within"}}),s.prototype.toConstructor=function(){function e(t,n){if(!(this instanceof e))return new e(t,n);s.call(this,t,n)}o.inherits(e,s);const t=e.prototype;return t.options={},t.setOptions(this.options),t.op=this.op,t._conditions=o.clone(this._conditions),t._fields=o.clone(this._fields),t._updateDoc=o.clone(this._updateDoc),t._path=this._path,t._distinctDoc=this._distinctDoc,t._collection=this._collection,t._traceFunction=this._traceFunction,e},s.prototype.setOptions=function(e){if(!e||!o.isObject(e))return this;const t=o.keys(e);let n;for(let r=0;r<t.length;++r)if(n=t[r],"function"==typeof this[n]){const t=Array.isArray(e[n])?e[n]:[e[n]];this[n].apply(this,t)}else this.options[n]=e[n];return this},s.prototype.collection=function(e){return this._collection=new s.Collection(e),this},s.prototype.collation=function(e){return this.options.collation=e,this},s.prototype.$where=function(e){return this._conditions.$where=e,this},s.prototype.where=function(){if(!arguments.length)return this;this.op||(this.op="find");const e=typeof arguments[0];if("string"==e)return this._path=arguments[0],2===arguments.length&&(this._conditions[this._path]=arguments[1]),this;if("object"==e&&!Array.isArray(arguments[0]))return this.merge(arguments[0]);throw new TypeError("path must be a string or object")},s.prototype.equals=function(e){this._ensurePath("equals");const t=this._path;return this._conditions[t]=e,this},s.prototype.eq=function(e){this._ensurePath("eq");const t=this._path;return this._conditions[t]=e,this},s.prototype.or=function(e){const t=this._conditions.$or||(this._conditions.$or=[]);return Array.isArray(e)||(e=[e]),t.push.apply(t,e),this},s.prototype.nor=function(e){const t=this._conditions.$nor||(this._conditions.$nor=[]);return Array.isArray(e)||(e=[e]),t.push.apply(t,e),this},s.prototype.and=function(e){const t=this._conditions.$and||(this._conditions.$and=[]);return Array.isArray(e)||(e=[e]),t.push.apply(t,e),this},
/*!
		 * gt, gte, lt, lte, ne, in, nin, all, regex, size, maxDistance
		 *
		 *     Thing.where('type').nin(array)
		 */
"gt gte lt lte ne in nin all regex size maxDistance minDistance".split(" ").forEach((function(e){s.prototype[e]=function(){let t,n;1===arguments.length?(this._ensurePath(e),n=arguments[0],t=this._path):(n=arguments[1],t=arguments[0]);return(null===this._conditions[t]||"object"==typeof this._conditions[t]?this._conditions[t]:this._conditions[t]={})["$"+e]=n,this}})),s.prototype.mod=function(){let e,t;1===arguments.length?(this._ensurePath("mod"),e=arguments[0],t=this._path):2!==arguments.length||Array.isArray(arguments[1])?3===arguments.length?(e=[arguments[1],arguments[2]],t=arguments[0]):(e=arguments[1],t=arguments[0]):(this._ensurePath("mod"),e=[arguments[0],arguments[1]],t=this._path);return(this._conditions[t]||(this._conditions[t]={})).$mod=e,this},s.prototype.exists=function(){let e,t;0===arguments.length?(this._ensurePath("exists"),e=this._path,t=!0):1===arguments.length?"boolean"==typeof arguments[0]?(this._ensurePath("exists"),e=this._path,t=arguments[0]):(e=arguments[0],t=!0):2===arguments.length&&(e=arguments[0],t=arguments[1]);return(this._conditions[e]||(this._conditions[e]={})).$exists=t,this},s.prototype.elemMatch=function(){if(null==arguments[0])throw new TypeError("Invalid argument");let e,t,n;if("function"==typeof arguments[0])this._ensurePath("elemMatch"),t=this._path,e=arguments[0];else if(o.isObject(arguments[0]))this._ensurePath("elemMatch"),t=this._path,n=arguments[0];else if("function"==typeof arguments[1])t=arguments[0],e=arguments[1];else{if(!arguments[1]||!o.isObject(arguments[1]))throw new TypeError("Invalid argument");t=arguments[0],n=arguments[1]}e&&(n=new s,e(n),n=n._conditions);return(this._conditions[t]||(this._conditions[t]={})).$elemMatch=n,this},s.prototype.within=function(){if(this._ensurePath("within"),this._geoComparison=u,0===arguments.length)return this;if(2===arguments.length)return this.box.apply(this,arguments);if(2<arguments.length)return this.polygon.apply(this,arguments);const e=arguments[0];if(!e)throw new TypeError("Invalid argument");if(e.center)return this.circle(e);if(e.box)return this.box.apply(this,e.box);if(e.polygon)return this.polygon.apply(this,e.polygon);if(e.type&&e.coordinates)return this.geometry(e);throw new TypeError("Invalid argument")},s.prototype.box=function(){let e,t;if(3===arguments.length)e=arguments[0],t=[arguments[1],arguments[2]];else{if(2!==arguments.length)throw new TypeError("Invalid argument");this._ensurePath("box"),e=this._path,t=[arguments[0],arguments[1]]}return(this._conditions[e]||(this._conditions[e]={}))[this._geoComparison||u]={$box:t},this},s.prototype.polygon=function(){let e,t;"string"==typeof arguments[0]?(e=Array.from(arguments),t=e.shift()):(this._ensurePath("polygon"),t=this._path,e=Array.from(arguments));return(this._conditions[t]||(this._conditions[t]={}))[this._geoComparison||u]={$polygon:e},this},s.prototype.circle=function(){let e,t;if(1===arguments.length)this._ensurePath("circle"),e=this._path,t=arguments[0];else{if(2!==arguments.length)throw new TypeError("Invalid argument");e=arguments[0],t=arguments[1]}if(!("radius"in t)||!t.center)throw new Error("center and radius are required");const n=this._conditions[e]||(this._conditions[e]={}),r=t.spherical?"$centerSphere":"$center",o=this._geoComparison||u;return n[o]={},n[o][r]=[t.center,t.radius],"unique"in t&&(n[o].$uniqueDocs=!!t.unique),this},s.prototype.near=function(){let e,t;if(this._geoComparison="$near",0===arguments.length)return this;if(1===arguments.length)this._ensurePath("near"),e=this._path,t=arguments[0];else{if(2!==arguments.length)throw new TypeError("Invalid argument");e=arguments[0],t=arguments[1]}if(!t.center)throw new Error("center is required");const n=this._conditions[e]||(this._conditions[e]={}),o=t.spherical?"$nearSphere":"$near";if(Array.isArray(t.center)){n[o]=t.center;const e="maxDistance"in t?t.maxDistance:null;null!=e&&(n.$maxDistance=e),null!=t.minDistance&&(n.$minDistance=t.minDistance)}else{if("Point"!=t.center.type||!Array.isArray(t.center.coordinates))throw new Error(r.format("Invalid GeoJSON specified for %s",o));n[o]={$geometry:t.center},"maxDistance"in t&&(n[o].$maxDistance=t.maxDistance),"minDistance"in t&&(n[o].$minDistance=t.minDistance)}return this},s.prototype.intersects=function(){if(this._ensurePath("intersects"),this._geoComparison="$geoIntersects",0===arguments.length)return this;const e=arguments[0];if(null!=e&&e.type&&e.coordinates)return this.geometry(e);throw new TypeError("Invalid argument")},s.prototype.geometry=function(){if("$within"!=this._geoComparison&&"$geoWithin"!=this._geoComparison&&"$near"!=this._geoComparison&&"$geoIntersects"!=this._geoComparison)throw new Error("geometry() must come after `within()`, `intersects()`, or `near()");let e,t;if(1!==arguments.length)throw new TypeError("Invalid argument");if(this._ensurePath("geometry"),t=this._path,e=arguments[0],!e.type||!Array.isArray(e.coordinates))throw new TypeError("Invalid argument");return(this._conditions[t]||(this._conditions[t]={}))[this._geoComparison]={$geometry:e},this},s.prototype.select=function(){let e=arguments[0];if(!e)return this;if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");this._validate("select");const t=this._fields||(this._fields={}),n=typeof e;let r,i;if(("string"==n||o.isArgumentsObject(e))&&"number"==typeof e.length||Array.isArray(e)){for("string"==n&&(e=e.split(/\s+/)),r=0,i=e.length;r<i;++r){let n=e[r];if(!n)continue;const o="-"==n[0]?0:1;0===o&&(n=n.substring(1)),t[n]=o}return this}if(o.isObject(e)){const n=o.keys(e);for(r=0;r<n.length;++r)t[n[r]]=e[n[r]];return this}throw new TypeError("Invalid select() argument. Must be string or object.")},s.prototype.slice=function(){if(0===arguments.length)return this;let e,t;if(this._validate("slice"),1===arguments.length){const n=arguments[0];if("object"==typeof n&&!Array.isArray(n)){const e=Object.keys(n),t=e.length;for(let r=0;r<t;++r)this.slice(e[r],n[e[r]]);return this}this._ensurePath("slice"),e=this._path,t=arguments[0]}else 2===arguments.length?"number"==typeof arguments[0]?(this._ensurePath("slice"),e=this._path,t=[arguments[0],arguments[1]]):(e=arguments[0],t=arguments[1]):3===arguments.length&&(e=arguments[0],t=[arguments[1],arguments[2]]);return(this._fields||(this._fields={}))[e]={$slice:t},this},s.prototype.sort=function(e){if(!e)return this;let t,n,r;this._validate("sort");const i=typeof e;if(Array.isArray(e)){for(n=e.length,t=0;t<e.length;++t){if(!Array.isArray(e[t]))throw new Error("Invalid sort() argument, must be array of arrays");l(this.options,e[t][0],e[t][1])}return this}if(1===arguments.length&&"string"==i){for(n=(e=e.split(/\s+/)).length,t=0;t<n;++t){if(r=e[t],!r)continue;const n="-"==r[0]?-1:1;-1===n&&(r=r.substring(1)),c(this.options,r,n)}return this}if(o.isObject(e)){const n=o.keys(e);for(t=0;t<n.length;++t)r=n[t],c(this.options,r,e[r]);return this}if("undefined"!=typeof Map&&e instanceof Map)return function(e,t){if(e.sort=e.sort||new Map,!(e.sort instanceof Map))throw new TypeError("Can't mix sort syntaxes. Use either array or object or map consistently");t.forEach((function(t,n){let r=String(t||1).toLowerCase();if(r=a[r],!r)throw new TypeError("Invalid sort value: < "+n+": "+t+" >");e.sort.set(n,r)}))}
/*!
		 * limit, skip, batchSize, comment
		 *
		 * Sets these associated options.
		 *
		 *     query.comment('feed query');
		 */(this.options,e),this;throw new TypeError("Invalid sort() argument. Must be a string, object, or array.")};
/*!
		 * @ignore
		 */
const a={1:1,"-1":-1,asc:1,ascending:1,desc:-1,descending:-1};function c(e,t,n){if(Array.isArray(e.sort))throw new TypeError("Can't mix sort syntaxes. Use either array or object:\n- `.sort([['field', 1], ['test', -1]])`\n- `.sort({ field: 1, test: -1 })`");let r;if(n&&n.$meta)return r=e.sort||(e.sort={}),void(r[t]={$meta:n.$meta});r=e.sort||(e.sort={});let o=String(n||1).toLowerCase();if(o=a[o],!o)throw new TypeError("Invalid sort value: { "+t+": "+n+" }");r[t]=o}function l(e,t,n){if(e.sort=e.sort||[],!Array.isArray(e.sort))throw new TypeError("Can't mix sort syntaxes. Use either array or object:\n- `.sort([['field', 1], ['test', -1]])`\n- `.sort({ field: 1, test: -1 })`");let r=String(n||1).toLowerCase();if(r=a[r],!r)throw new TypeError("Invalid sort value: [ "+t+", "+n+" ]");e.sort.push([t,r])}
/*!
		 * Internal helper for updateMany, updateOne
		 */
function h(e,t,n,r,i){return e.op=t,s.canMerge(n)&&e.merge(n),r&&e._mergeUpdate(r),o.isObject(i)&&e.setOptions(i),e}async function p(e,t){const n=e._optionsForExec(),r=e._conditions,o=e._updateForExec();return i("update",e._collection.collectionName,r,o,n),e._collection[t](r,o,n)}["limit","skip","batchSize","comment"].forEach((function(e){s.prototype[e]=function(t){return this._validate(e),this.options[e]=t,this}})),s.prototype.maxTime=s.prototype.maxTimeMS=function(e){return this._validate("maxTime"),this.options.maxTimeMS=e,this},s.prototype.hint=function(){if(0===arguments.length)return this;this._validate("hint");const e=arguments[0];if(o.isObject(e)){const t=this.options.hint||(this.options.hint={});for(const n in e)t[n]=e[n];return this}if("string"==typeof e)return this.options.hint=e,this;throw new TypeError("Invalid hint. "+e)},s.prototype.j=function(e){return this.options.j=e,this},s.prototype.slaveOk=function(e){return this.options.slaveOk=!arguments.length||!!e,this},s.prototype.read=s.prototype.setReadPreference=function(e){return arguments.length>1&&!s.prototype.read.deprecationWarningIssued&&(console.error("Deprecation warning: 'tags' argument is not supported anymore in Query.read() method. Please use mongodb.ReadPreference object instead."),s.prototype.read.deprecationWarningIssued=!0),this.options.readPreference=o.readPref(e),this},s.prototype.readConcern=s.prototype.r=function(e){return this.options.readConcern=o.readConcern(e),this},s.prototype.tailable=function(){return this._validate("tailable"),this.options.tailable=!arguments.length||!!arguments[0],this},s.prototype.writeConcern=s.prototype.w=function(e){return"object"==typeof e?(void 0!==e.j&&(this.options.j=e.j),void 0!==e.w&&(this.options.w=e.w),void 0!==e.wtimeout&&(this.options.wtimeout=e.wtimeout)):this.options.w="m"===e?"majority":e,this},s.prototype.wtimeout=s.prototype.wTimeout=function(e){return this.options.wtimeout=e,this},s.prototype.merge=function(e){if(!e)return this;if(!s.canMerge(e))throw new TypeError("Invalid argument. Expected instanceof mquery or plain object");return e instanceof s?(e._conditions&&o.merge(this._conditions,e._conditions),e._fields&&(this._fields||(this._fields={}),o.merge(this._fields,e._fields)),e.options&&(this.options||(this.options={}),o.merge(this.options,e.options)),e._updateDoc&&(this._updateDoc||(this._updateDoc={}),o.mergeClone(this._updateDoc,e._updateDoc)),e._distinctDoc&&(this._distinctDoc=e._distinctDoc),this):(o.merge(this._conditions,e),this)},s.prototype.find=function(e){return this.op="find",s.canMerge(e)&&this.merge(e),this},s.prototype._find=async function(){const e=this._conditions,t=this._optionsForExec();return this.$useProjection?t.projection=this._fieldsForExec():t.fields=this._fieldsForExec(),i("_find",this._collection.collectionName,e,t),this._collection.find(e,t)},s.prototype.cursor=function(e){if(this.op){if("find"!==this.op)throw new TypeError(".cursor only support .find method")}else this.find(e);const t=this._conditions,n=this._optionsForExec();return this.$useProjection?n.projection=this._fieldsForExec():n.fields=this._fieldsForExec(),i("findCursor",this._collection.collectionName,t,n),this._collection.findCursor(t,n)},s.prototype.findOne=function(e){return this.op="findOne",s.canMerge(e)&&this.merge(e),this},s.prototype._findOne=async function(){const e=this._conditions,t=this._optionsForExec();return this.$useProjection?t.projection=this._fieldsForExec():t.fields=this._fieldsForExec(),i("findOne",this._collection.collectionName,e,t),this._collection.findOne(e,t)},s.prototype.count=function(e){return this.op="count",this._validate(),s.canMerge(e)&&this.merge(e),this},s.prototype._count=async function(){const e=this._conditions,t=this._optionsForExec();return i("count",this._collection.collectionName,e,t),this._collection.count(e,t)},s.prototype.distinct=function(e,t){return this.op="distinct",this._validate(),t||"string"!=typeof e||(t=e,e=void 0),"string"==typeof t&&(this._distinctDoc=t),s.canMerge(e)&&this.merge(e),this},s.prototype._distinct=async function(){if(!this._distinctDoc)throw new Error("No value for `distinct` has been declared");const e=this._conditions,t=this._optionsForExec();return i("distinct",this._collection.collectionName,e,t),this._collection.distinct(this._distinctDoc,e,t)},s.prototype.updateMany=function(e,t,n){return 1===arguments.length&&(t=e,e=n=void 0),h(this,"updateMany",e,t,n)},s.prototype._updateMany=async function(){return p(this,"updateMany")},s.prototype.updateOne=function(e,t,n){return 1===arguments.length&&(t=e,e=n=void 0),h(this,"updateOne",e,t,n)},s.prototype._updateOne=async function(){return p(this,"updateOne")},s.prototype.replaceOne=function(e,t,n){return 1===arguments.length&&(t=e,e=n=void 0),this.setOptions({overwrite:!0}),h(this,"replaceOne",e,t,n)},s.prototype._replaceOne=async function(){return p(this,"replaceOne")},s.prototype.deleteOne=function(e){return this.op="deleteOne",s.canMerge(e)&&this.merge(e),this},s.prototype._deleteOne=async function(){const e=this._optionsForExec();delete e.justOne;const t=this._conditions;return i("deleteOne",this._collection.collectionName,t,e),this._collection.deleteOne(t,e)},s.prototype.deleteMany=function(e){return this.op="deleteMany",s.canMerge(e)&&this.merge(e),this},s.prototype._deleteMany=async function(){const e=this._optionsForExec();delete e.justOne;const t=this._conditions;return i("deleteOne",this._collection.collectionName,t,e),this._collection.deleteMany(t,e)},s.prototype.findOneAndUpdate=function(e,t,n){return this.op="findOneAndUpdate",this._validate(),1===arguments.length&&(t=e,e=n=void 0),s.canMerge(e)&&this.merge(e),t&&this._mergeUpdate(t),n&&this.setOptions(n),this},s.prototype._findOneAndUpdate=async function(){const e=this._conditions,t=this._updateForExec(),n=this._optionsForExec();return this._collection.findOneAndUpdate(e,t,n)},s.prototype.findOneAndRemove=s.prototype.findOneAndDelete=function(e,t){return this.op="findOneAndRemove",this._validate(),s.canMerge(e)&&this.merge(e),t&&this.setOptions(t),this},s.prototype._findOneAndRemove=async function(){const e=this._optionsForExec(),t=this._conditions;return this._collection.findOneAndDelete(t,e)},s.prototype.setTraceFunction=function(e){return this._traceFunction=e,this},s.prototype.exec=async function(e){"string"==typeof e&&(this.op=e),t.ok(this.op,"Missing query type: (find, etc)");const n="_"+this.op;if("function"!=typeof this[n])throw new TypeError(`this[${n}] is not a function`);return this[n]()},s.prototype.then=async function(e,t){return this.exec().then(e,t)},s.prototype.cursor=function(){if("find"!=this.op)throw new Error("cursor() is only available for find");const e=this._conditions,t=this._optionsForExec();return this.$useProjection?t.projection=this._fieldsForExec():t.fields=this._fieldsForExec(),i("cursor",this._collection.collectionName,e,t),this._collection.findCursor(e,t)},s.prototype.selected=function(){return!!(this._fields&&Object.keys(this._fields).length>0)},s.prototype.selectedInclusively=function(){if(!this._fields)return!1;const e=Object.keys(this._fields);if(0===e.length)return!1;for(let t=0;t<e.length;++t){const n=e[t];if(0===this._fields[n])return!1;if(this._fields[n]&&"object"==typeof this._fields[n]&&this._fields[n].$meta)return!1}return!0},s.prototype.selectedExclusively=function(){if(!this._fields)return!1;const e=Object.keys(this._fields);if(0===e.length)return!1;for(let t=0;t<e.length;++t){const n=e[t];if(0===this._fields[n])return!0}return!1},s.prototype._mergeUpdate=function(e){this._updateDoc||(this._updateDoc={}),e instanceof s?e._updateDoc&&o.mergeClone(this._updateDoc,e._updateDoc):o.mergeClone(this._updateDoc,e)},s.prototype._optionsForExec=function(){return o.clone(this.options)},s.prototype._fieldsForExec=function(){return o.clone(this._fields)},s.prototype._updateForExec=function(){const e=o.clone(this._updateDoc),t=o.keys(e),n={};for(const r of t)this.options.overwrite?n[r]=e[r]:"$"!==r[0]?(n.$set||(e.$set?n.$set=e.$set:n.$set={}),n.$set[r]=e[r],~t.indexOf("$set")||t.push("$set")):"$set"===r&&n.$set||(n[r]=e[r]);return this._compiledUpdate=n,n},s.prototype._ensurePath=function(e){if(!this._path){throw new Error(e+"() must be used after where() when called with these arguments")}},
/*!
		 * Permissions
		 */
s.permissions=(IA||(IA=1,function(){const e=RA;e.distinct=function(t){if(t._fields&&Object.keys(t._fields).length>0)return"field selection and slice";let n;return Object.keys(e.distinct).every((function(e){return!t.options[e]||(n=e,!1)})),n},e.distinct.select=e.distinct.slice=e.distinct.sort=e.distinct.limit=e.distinct.skip=e.distinct.batchSize=e.distinct.hint=e.distinct.tailable=!0,e.findOneAndUpdate=e.findOneAndRemove=function(t){let n;return Object.keys(e.findOneAndUpdate).every((function(e){return!t.options[e]||(n=e,!1)})),n},e.findOneAndUpdate.limit=e.findOneAndUpdate.skip=e.findOneAndUpdate.batchSize=e.findOneAndUpdate.tailable=!0,e.count=function(t){if(t._fields&&Object.keys(t._fields).length>0)return"field selection and slice";let n;return Object.keys(e.count).every((function(e){return!t.options[e]||(n=e,!1)})),n},e.count.slice=e.count.batchSize=e.count.tailable=!0}()),RA),s._isPermitted=function(e,t){const n=s.permissions[t];return!n||!0!==n[e]},s.prototype._validate=function(e){let t,n;if(void 0===e){if(n=s.permissions[this.op],"function"!=typeof n)return!0;t=n(this)}else s._isPermitted(e,this.op)||(t=e);if(t)throw new Error(t+" cannot be used with "+this.op)},s.canMerge=function(e){return e instanceof s||o.isObject(e)},s.setGlobalTraceFunction=function(e){s.traceFunction=e},
/*!
		 * Exports.
		 */
s.utils=o,s.env=LA(),s.Collection=hb(),s.BaseCollection=lb(),e.exports=s}(gA)),gA.exports}function db(){return HA?GA:(HA=1,GA=function(e,t){if("string"===typeof e&&(e=e.split(/\s+/)),!Array.isArray(e)&&"[object Arguments]"!==Object.prototype.toString.call(e))return e;const n=e.length,r={};for(let o=0;o<n;++o){let n=e[o];if(!n)continue;const i="-"==n[0]?0:1;t||0!==i||(n=n.substring(1)),r[n]=i}return r})}function fb(){if(YA)return KA;function e(t,n){const r=Object.keys(t)[0];if("$and"===r||"$or"===r)return!!Array.isArray(t[r])&&null!=t[r].find((t=>e(t,n)));const o=r.indexOf("."),i=-1===o?r:r.slice(0,o);return null!=n.find((e=>e.includes("$["+i+"]")))}return YA=1,KA=function(t,n){const r=Object.keys(t).map((e=>Object.keys(t[e]))).reduce(((e,t)=>e.concat(t)),[]);return n.filter((t=>e(t,r)))},KA}function mb(){return JA?QA:(JA=1,
/*!
	 * ignore
	 */
QA=function(e){if("object"!=typeof e||null===e)return!1;const t=Object.keys(e),n=t.length;for(let e=0;e<n;++e)if("$"===t[e][0])return!0;return!1})}function yb(){if(ZA)return XA;ZA=1;const e=mb(),{trustedSymbol:t}=rc();return XA=function n(r){if(null==r||"object"!=typeof r)return r;if(Array.isArray(r)){for(const e of r)n(e);return r}const o=Object.keys(r);for(const i of o){const o=r[i];if(null==o||!o[t])if("$and"!==i&&"$or"!==i){if(e(o)){const e=Object.keys(o);if(1===e.length&&"$eq"===e[0])continue;r[i]={$eq:r[i]}}}else n(o)}return r}}function gb(){return tb?eb:(tb=1,eb=function(e){if(null==e)return;const t=Object.keys(e);for(let n=0;n<t.length;++n)"string"==typeof e[t[n]]&&(e[t[n]]=1)})}function Eb(){if(rb)return nb;rb=1;const e=Fp(),t=fA();
/*!
	 * ignore
	 */
function n(e,t){const n=t.split("."),r=n.length;let o=n[0];for(let t=1;t<r;++t){if(null!=e[o]||null!=e[o+".$"])return!0;o+="."+n[t]}return null!=e[o]||null!=e[o+".$"]}
/*!
	 * ignore
	 */
return nb=function(r,o,i){if(null==i)return;const s=Object.keys(i);if(o=o||{},t(r))for(const e of s){n(o,e)?0===o[e]&&delete r[e]:r[e]=1;const t=i[e]?.refPath;"string"==typeof t&&(n(o,t)?0===o[t]&&delete r[t]:r[t]=1)}else if(e(r))for(const e of s){null==o[e]&&delete r[e];const t=i[e]?.refPath;"string"==typeof t&&null==o[t]&&delete r[t]}},nb}function Ab(){if(ib)return ob;ib=1;
/*!
	 * Module dependencies.
	 */
const e=tl(),t=Af(),n=Cp().flatten,r=Cp().modifiedPaths;return ob=function(o,i,s,u,a){const c=Object.keys(s||{});let l={},h={};const p={},d={},f=c.length;let m=!1;const y={};let g,E,A;for(A=0;A<f;++A)if(c[A].startsWith("$")){if(m=!0,"$push"===c[A]||"$addToSet"===c[A]){const e=Object.keys(s[c[A]]);for(let t=0;t<e.length;++t)g=s[c[A]][e[t]],g&&g.$each?d[e[t]]=(d[e[t]]||[]).concat(g.$each):d[e[t]]=(d[e[t]]||[]).concat([g]);continue}r(s[c[A]],"",y);const e=n(s[c[A]],null,null,i),o=Object.keys(e),u=o.length;for(let n=0;n<u;++n){const r=t(o[n]);E=c[A],r.includes("$")||("$set"===E||"$setOnInsert"===E||"$pull"===E||"$pullAll"===E?(h[r]=e[o[n]],p[r]="$pull"===E||"$pullAll"===E):"$unset"===E&&(h[r]=void 0),l[r]=!0)}}m||(r(s,"",y),h=n(s,null,null,i),l=Object.keys(h));const b=Object.keys(h),_=b.length,O=[],C=[],w=[],S=o;function v(t,n){const r=i._getSchema(b[t]);if(null!=r&&("Mixed"!==r.instance||r.path===b[t]))if(n&&Array.isArray(n.$in))n.$in.forEach(((e,t)=>{O.push((function(n){r.doValidate(e,(function(e){e&&(e.path=b[t]+".$in."+t,C.push(e)),n(null)}),S,{updateValidator:!0})}))}));else{if(p[b[t]]&&r.$isMongooseArray)return;r.$isMongooseDocumentArrayElement&&null!=n&&null!=n.$__?(w.push(b[t]),O.push((function(e){r.doValidate(n,(function(n){if(n)if(n.errors)for(const e of Object.keys(n.errors)){const r=n.errors[e];r.path=b[t]+"."+e,C.push(r)}else n.path=b[t],C.push(n);return e(null)}),S,{updateValidator:!0})}))):O.push((function(o){for(const e of w)if(b[t].startsWith(e+"."))return o(null);r.doValidate(n,(function(n){if(null!=r.schema&&!1===r.schema.options.storeSubdocValidationError&&n instanceof e)return o(null);n&&(n.path=b[t],C.push(n)),o(null)}),S,{updateValidator:!0})}))}}for(A=0;A<_;++A)v(A,h[b[A]]);const D=Object.keys(d);for(const e of D){let t=i._getSchema(e);if(t&&t.$isMongooseDocumentArray)O.push((function(n){t.doValidate(d[e],T(e,C,n),u&&"query"===u.context?o:null)}));else{t=i._getSchema(e+".0");for(const n of d[e])O.push((function(r){t.doValidate(n,T(e,C,r),u&&"query"===u.context?o:null,{updateValidator:!0})}))}}if(null==a)return function(e){let t=O.length;if(0===t)return M(e);for(const n of O)n((function(){--t<=0&&M(e)}))};{let e=O.length;if(0===e)return M(a);for(const t of O)t((function(){--e<=0&&M(a)}))}function M(t){if(C.length){const n=new e(null);for(const e of C)n.addError(e.path,e);return t(n)}t(null)}function T(e,t,n){return function(r){r&&(r.path=e,t.push(r)),n(null)}}},ob}function bb(){if(ub)return sb;ub=1;
/*!
	 * Module dependencies.
	 */
const r=Zc(),o=Xc(),i=lc(),s=pa(),u=kh(),a=function(){if(zE)return VE;zE=1;const r=pa(),o=e.Readable,i=uA(),s=td(),u=lc(),a=ha(),{once:c}=t,l=n;function h(e){o.call(this,{autoDestroy:!0,objectMode:!0}),this.cursor=null,this.skipped=!1,this.query=e,this._closed=!1;const t=e.model;this._mongooseOptions={},this._transforms=[],this.model=t,this.options={},t.hooks.execPre("find",e,(n=>{if(null!=n){if(n instanceof u.skipWrappedFunction){const e=n.args[0];if(null!=e&&(!Array.isArray(e)||e.length)){const t=new r('Cannot `skipMiddlewareFunction()` with a value when using `.find().cursor()`, value must be nullish or empty array, got "'+l.inspect(e)+'".');return this._markError(t),void(this.listeners("error").length>0&&this.emit("error",t))}return this.skipped=!0,void this.emit("cursor",null)}return this._markError(n),void(this.listeners("error").length>0&&this.emit("error",n))}Object.assign(this.options,e._optionsForExec()),this._transforms=this._transforms.concat(e._transforms.slice()),this.options.transform&&this._transforms.push(this.options.transform),this.options.batchSize&&(this.options._populateBatchSize=Math.min(this.options.batchSize,5e3)),t.collection._shouldBufferCommands()&&t.collection.buffer?t.collection.queue.push([()=>p(e,this)]):p(e,this)}))}
/*!
	 * ignore
	 */
function p(e,t){try{const n=e.model.collection.find(e._conditions,t.options);t.cursor=n,t.emit("cursor",n)}catch(e){t._markError(e),t.listeners("error").length>0&&t.emit("error",t._error)}}
/*!
	 * ignore
	 */
function d(e){return null==e?{done:!0}:{value:e,done:!1}}function f(e,t){let n=t;return e._transforms.length&&(n=function(n,r){if(n||null===r&&!e._mongooseOptions.transformNull)return t(n,r);t(n,e._transforms.reduce((function(t,n){return n.call(e,t)}),r))}),e._error?a((function(){n(e._error)})):e.skipped?a((()=>n(null,null))):e.cursor?(e.query._mongooseOptions.populate&&!e._pop&&(e._pop=s.preparePopulationOptionsMQ(e.query,e.query._mongooseOptions),e._pop.__noPromise=!0),e.query._mongooseOptions.populate&&e.options._populateBatchSize>1?e._batchDocs&&e._batchDocs.length?g(e,e._batchDocs.shift(),e._pop,n):e._batchExhausted?n(null,null):(e._batchDocs=[],void e.cursor.next().then((t=>{m.call({ctx:e,callback:n},null,t)}),(t=>{m.call({ctx:e,callback:n},t)}))):e.cursor.next().then((t=>{if(t)return e.query._mongooseOptions.populate?void e.query.model.populate(t,e._pop).then((t=>{g(e,t,e._pop,n)}),(e=>{n(e)})):g(e,t,null,n);n(null,null)}),(e=>{n(e)}))):(e.once("error",t),void e.once("cursor",(function(n){if(e.removeListener("error",t),null==n)return e.skipped?t(null,null):void 0;f(e,t)})))}
/*!
	 * ignore
	 */function m(e,t){return e?this.callback(e):t?(this.ctx._batchDocs.push(t),void(this.ctx._batchDocs.length<this.ctx.options._populateBatchSize?a((()=>this.ctx.cursor.next().then((e=>{m.call(this,null,e)}),(e=>{m.call(this,e)})))):y.call(this))):(this.ctx._batchExhausted=!0,y.call(this))}
/*!
	 * ignore
	 */function y(){if(!this.ctx._batchDocs.length)return this.callback(null,null);this.ctx.query.model.populate(this.ctx._batchDocs,this.ctx._pop).then((()=>{g(this.ctx,this.ctx._batchDocs.shift(),this.ctx._pop,this.callback)}),(e=>{this.callback(e)}))}
/*!
	 * ignore
	 */function g(e,t,n,r){if(e.query._mongooseOptions.lean)return e.model.hooks.execPost("find",e.query,[[t]],(e=>{if(null!=e)return r(e);r(null,t)}));const{model:o,_fields:i,_userProvidedFields:u,options:a}=e.query;s.createModelAndInit(o,t,i,u,a,n,((t,n)=>{if(null!=t)return r(t);e.model.hooks.execPost("find",e.query,[[n]],(e=>{if(null!=e)return r(e);r(null,n)}))}))}
/*!
	 * ignore
	 */function E(e,t){if(e.cursor)return t();e.once("cursor",(function(e){null!=e&&t()}))}return l.inherits(h,o),h.prototype._read=function(){f(this,((e,t)=>e?this.emit("error",e):t?void this.push(t):(this.push(null),void this.cursor.close((function(e){if(e)return this.emit("error",e)})))))},h.prototype.getDriverCursor=async function(){return this.cursor||await c(this,"cursor"),this.cursor},Object.defineProperty(h.prototype,"map",{value:function(e){return this._transforms.push(e),this},enumerable:!0,configurable:!0,writable:!0}),h.prototype._markError=function(e){return this._error=e,this},h.prototype.close=async function(){if("function"==typeof arguments[0])throw new r("QueryCursor.prototype.close() no longer accepts a callback");try{await this.cursor.close(),this._closed=!0,this.emit("close")}catch(e){throw this.listeners("error").length>0&&this.emit("error",e),e}},h.prototype._destroy=function(e,t){let n=null;return n=this.cursor?Promise.resolve():new Promise((e=>{this.once("cursor",e)})),n.then((()=>{this.cursor.close()})).then((()=>{this._closed=!0,t()})).catch((e=>{t(e)})),this},h.prototype.rewind=function(){return E(this,(()=>{this.cursor.rewind()})),this},h.prototype.next=async function(){if("function"==typeof arguments[0])throw new r("QueryCursor.prototype.next() no longer accepts a callback");if(this._closed)throw new r("Cannot call `next()` on a closed cursor");return new Promise(((e,t)=>{f(this,(function(n,r){if(n)return t(n);e(r)}))}))},h.prototype.eachAsync=function(e,t){if("function"==typeof arguments[2])throw new r("QueryCursor.prototype.eachAsync() no longer accepts a callback");return"function"==typeof t&&(t={}),i((e=>f(this,e)),e,t=t||{})},h.prototype.options,h.prototype.addCursorFlag=function(e,t){return E(this,(()=>{this.cursor.addCursorFlag(e,t)})),this},
/*!
	 * ignore
	 */
h.prototype.transformNull=function(e){return 0===arguments.length&&(e=!0),this._mongooseOptions.transformNull=e,this},
/*!
	 * ignore
	 */
h.prototype._transformForAsyncIterator=function(){return-1===this._transforms.indexOf(d)&&this.map(d),this},null!=Symbol.asyncIterator&&(h.prototype[Symbol.asyncIterator]=function(){return this.transformNull()._transformForAsyncIterator()}),VE=h}(),c=tl(),{applyGlobalMaxTimeMS:l,applyGlobalDiskUse:h}=aA(),p=yf(),d=cA(),f=lA(),m=hm(),y=dA(),g=sm(),E=AE(),A=oc(),b=Zp(),_=td(),O=Ma().internalToObjectOptions,C=Fp(),w=fA(),S=ed(),v=mA(),D=Kl(),M=pb(),T=db(),B=fb(),F=yb(),$=gb(),x=Eb(),P=_E(),N=Ba(),I=Ab(),R=n,k=uf(),j=Tf().queryMiddlewareFunctions,L=new Set(["allowDiskUse","batchSize","collation","comment","explain","hint","j","lean","limit","maxTimeMS","populate","projection","read","select","skip","slice","sort","tailable","w","writeConcern","wtimeout"]),U=new Map([["countDocuments","_countDocuments"],["distinct","__distinct"],["estimatedDocumentCount","_estimatedDocumentCount"],["find","_find"],["findOne","_findOne"],["findOneAndReplace","_findOneAndReplace"],["findOneAndUpdate","_findOneAndUpdate"],["replaceOne","_replaceOne"],["updateMany","_updateMany"],["updateOne","_updateOne"],["deleteMany","_deleteMany"],["deleteOne","_deleteOne"],["findOneAndDelete","_findOneAndDelete"]]);function V(e,t,n,r){this._mongooseOptions||(this._mongooseOptions={}),t=t||{},this._transforms=[],this._hooks=new i,this._executionStack=null;const o=Object.keys(t);for(const e of o)this._mongooseOptions[e]=t[e];r&&(this.mongooseCollection=r),n&&(this.model=n,this.schema=n.schema),this.model&&this.model._mapreduce&&this.lean(),M.call(this,null,t),r&&this.collection(r),e&&this.find(e),this.options=this.options||{},this.$useProjection=!0;const s=this&&this.schema&&this.schema.options&&this.schema.options.collation||null;null!=s&&(this.options.collation=s)}
/*!
	 * inherit mquery
	 */V.prototype=new M,V.prototype.constructor=V,V.prototype.count=void 0,V.prototype.findOneAndRemove=void 0,V.base=M.prototype,
/*!
	 * Overwrite mquery's `_distinct`, because Mongoose uses that name
	 * to store the field to apply distinct on.
	 */
Object.defineProperty(V.prototype,"_distinct",{configurable:!0,writable:!0,enumerable:!0,value:void 0}),V.use$geoWithin=M.use$geoWithin,V.prototype.toConstructor=function(){const e=this.model,t=this.mongooseCollection,n=function(o,i){if(!(this instanceof n))return new n(o,i);this._mongooseOptions=A(r._mongooseOptions),V.call(this,o,i||null,e,t)};R.inherits(n,e.Query);const r=n.prototype;r.options={};const o=Object.assign({},this.options);return null!=o.sort&&(r.sort(o.sort),delete o.sort),r.setOptions(o),r.op=this.op,r._validateOp(),r._conditions=A(this._conditions),r._fields=A(this._fields),r._update=A(this._update,{flattenDecimals:!1}),r._path=this._path,r._distinct=this._distinct,r._collection=this._collection,r._mongooseOptions=this._mongooseOptions,n},V.prototype.clone=function(){const e=this.model,t=this.mongooseCollection,n=new this.model.Query({},{},e,t),r=Object.assign({},this.options);return null!=r.sort&&(n.sort(r.sort),delete r.sort),n.setOptions(r),n.op=this.op,n._validateOp(),n._conditions=A(this._conditions),n._fields=A(this._fields),n._update=A(this._update,{flattenDecimals:!1}),n._path=this._path,n._distinct=this._distinct,n._collection=this._collection,n._mongooseOptions=this._mongooseOptions,n},V.prototype.slice=function(){if(0===arguments.length)return this;let e,t;if(this._validate("slice"),1===arguments.length){const n=arguments[0];if("object"==typeof n&&!Array.isArray(n)){const e=Object.keys(n),t=e.length;for(let r=0;r<t;++r)this.slice(e[r],n[e[r]]);return this}this._ensurePath("slice"),e=this._path,t=arguments[0]}else 2===arguments.length?"number"==typeof arguments[0]?(this._ensurePath("slice"),e=this._path,t=[arguments[0],arguments[1]]):(e=arguments[0],t=arguments[1]):3===arguments.length&&(e=arguments[0],t=[arguments[1],arguments[2]]);const n={};return n[e]={$slice:t},this.select(n),this};
/*!
	 * ignore
	 */
const z=new Set(j);
/*!
	 * ignore
	 */
function W(e){try{y(e)}catch(t){e.error(t)}}
/*!
	 * Convert sort values
	 */
function q(e,t){if(1===e||"asc"===e||"ascending"===e)return 1;if(-1===e||"desc"===e||"descending"===e)return-1;if(null!=e?.$meta)return{$meta:e.$meta};throw new TypeError("Invalid sort value: { "+t+": "+e+" }")}function G(e,t,n,r,o,i,s,u){if(r.includeResultMetadata&&null==t)return a(null),null;function a(e,o){return e?u(e):r.includeResultMetadata?(t&&o?(null!=r.session&&o.$session(r.session),n.value=o):n.value=null,u(null,n)):(null!=r.session&&o.$session(r.session),void u(null,o))}_.createModelAndInit(e,t,o,i,r,s,a)}function H(e){if(!e||!e.model||!e.model.schema)return;const t=e.model.schema;t&&t.discriminatorMapping&&!t.discriminatorMapping.isRoot&&(e._conditions[t.discriminatorMapping.key]=t.discriminatorMapping.value)}function K(e){"new"in e&&(e.returnDocument=e.new?"after":"before",delete e.new),"returnOriginal"in e&&(e.returnDocument=e.returnOriginal?"before":"after",delete e.returnOriginal),"string"==typeof e.returnDocument&&(e.returnOriginal="before"===e.returnDocument)}function Y(e,t,n){const r=e._optionsForExec(e.model);return t in r?r[t]:t in e.model.base.options?e.model.base.options[t]:n}
/*!
	 * ignore
	 */function Q(e,t,n,r,o,i){if(o.lean&&"function"==typeof o.lean.transform){o.lean.transform(t);for(let i=0;i<e.childSchemas.length;i++){const s=n?n+"."+e.childSchemas[i].model.path:e.childSchemas[i].model.path,u=e.childSchemas[i].schema,a=D.get(s,t);if(null!=a){if(Array.isArray(a))for(let e=0;e<a.length;e++)o.lean.transform(a[e]);else o.lean.transform(a);Q(u,a,s,r,o)}}return i?i(null,t):void 0}return o.includeResultMetadata?i(null,r):i(null,t)}
/*!
	 * ignore
	 */function J(e,t,n,r){if(r.lean&&"function"==typeof r.lean.transform){for(const e of t)r.lean.transform(e);for(let o=0;o<e.childSchemas.length;o++){const i=n?n+"."+e.childSchemas[o].model.path:e.childSchemas[o].model.path,s=e.childSchemas[o].schema;let u=D.get(i,t);if(null!=u){u=u.flat();for(let e=0;e<u.length;e++)r.lean.transform(u[e]);J(s,u,i,r)}}}return t}
/*!
	 * ignore
	 */
async function X(e){if(this._applyTranslateAliases(),this._castConditions(),W(this),null!=this.error())throw this.error();const t=this._conditions,n=this._optionsForExec(this.model);this._update=A(this._update,n);const r="replaceOne"===e;if(r)this._update=new this.model(this._update,null,!0);else{if(this._update=this._castUpdate(this._update),null==this._update||0===Object.keys(this._update).length)return{acknowledged:!1};const e=Object.assign({},n,{setDefaultsOnInsert:this._mongooseOptions.setDefaultsOnInsert});this._update=P(this._conditions,this.model.schema,this._update,e)}Array.isArray(n.arrayFilters)&&(n.arrayFilters=B(this._update,n.arrayFilters));return Y(this,"runValidators",!1)&&await this.validate(this._update,n,r),this._update.toBSON&&(this._update=this._update.toBSON()),this.mongooseCollection[e](t,this._update,n)}function Z(e,t,n,r,o,i){return e.op=t,e._validateOp(),r=r||{},null!=o&&"strict"in o&&(e._mongooseOptions.strict=o.strict),n instanceof V||null==n||"[object Object]"===n.toString()?e.merge(n):e.error(new u(n,"filter",t)),k.isObject(o)&&e.setOptions(o),e._mergeUpdate(r),i?(e.exec(i),e):e}function ee(e,t){return"function"==typeof e&&(e=e.call(t)),null==e&&(e=new o(t.getQuery(),t.model.modelName)),e}
/*!
	 * ignore
	 */
function te(e,t,n,r){if(null==e._queryMiddleware){if(null!=n)throw n;return t}return new Promise(((o,i)=>{const s=n?{error:n}:{};e._queryMiddleware.execPost(r||e.op,e,[t],s,((e,t)=>{if(e)return i(e);o(t)}))}))}
/*!
	 * ignore
	 */
/*!
	 * ignore
	 */
function ne(e,t){if(null!=e._queryMiddleware)return new Promise(((n,r)=>{e._queryMiddleware.execPre(t||e.op,e,[],(e=>{if(null!=e)return r(e);n()}))}))}
/*!
	 * ignore
	 */
function re(e,t,n){for(const r of t)e.push(n+r.path),Array.isArray(r.populate)&&re(e,r.populate,n+r.path+".")}return V.prototype._validateOp=function(){null==this.op||z.has(this.op)||this.error(new Error('Query has invalid `op`: "'+this.op+'"'))},V.prototype.mod=function(){let e,t;1===arguments.length?(this._ensurePath("mod"),e=arguments[0],t=this._path):2!==arguments.length||Array.isArray(arguments[1])?3===arguments.length?(e=[arguments[1],arguments[2]],t=arguments[0]):(e=arguments[1],t=arguments[0]):(this._ensurePath("mod"),e=[arguments[0],arguments[1]],t=this._path);return(this._conditions[t]||(this._conditions[t]={})).$mod=e,this},V.prototype.limit=function(e){if(this._validate("limit"),"string"==typeof e)try{e=g(e)}catch(t){throw new r("Number",e,"limit")}return this.options.limit=e,this},V.prototype.skip=function(e){if(this._validate("skip"),"string"==typeof e)try{e=g(e)}catch(t){throw new r("Number",e,"skip")}return this.options.skip=e,this},V.prototype.projection=function(e){return 0===arguments.length||(this._fields={},this._userProvidedFields={},this.select(e)),this._fields},V.prototype.select=function(){let e=arguments[0];if(!e)return this;if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");this._validate("select");const t=this._fields||(this._fields={}),n=this._userProvidedFields||(this._userProvidedFields={});let r;function o(e){return"string"==typeof e&&r?e=1:e}if(r=null!=this.model&&k.hasUserDefinedProperty(this.model.db.options,"sanitizeProjection")?this.model.db.options.sanitizeProjection:null!=this.model&&k.hasUserDefinedProperty(this.model.base.options,"sanitizeProjection")?this.model.base.options.sanitizeProjection:this._mongooseOptions.sanitizeProjection,e=T(e,!0),k.isObject(e)){if(this.selectedInclusively())Object.entries(e).forEach((([e,r])=>{r?(null!=t["-"+e]&&delete t["-"+e],t[e]=n[e]=o(r)):Object.keys(n).forEach((r=>{v(e,r)&&(delete t[r],delete n[r])}))}));else if(this.selectedExclusively())Object.entries(e).forEach((([e,r])=>{r?Object.keys(n).forEach((r=>{v(e,r)&&(delete t[r],delete n[r])})):(null!=t["+"+e]&&delete t["+"+e],t[e]=n[e]=o(r))}));else{const r=Object.keys(e);for(let i=0;i<r.length;++i){const s=e[r[i]],u=r[i];t[u]=o(s),n[u]=o(s)}}return this}throw new TypeError("Invalid select() argument. Must be string or object.")},V.prototype.schemaLevelProjections=function(e){return this._mongooseOptions.schemaLevelProjections=e,this},V.prototype.sanitizeProjection=function(e){return this._mongooseOptions.sanitizeProjection=e,this},V.prototype.read=function(e,t){return"string"==typeof e?(e=p(e),this.options.readPreference={mode:e,tags:t}):this.options.readPreference=e,this},V.prototype.toString=function(){return"count"===this.op||"countDocuments"===this.op||"find"===this.op||"findOne"===this.op||"deleteMany"===this.op||"deleteOne"===this.op||"findOneAndDelete"===this.op||"remove"===this.op?`${this.model.modelName}.${this.op}(${R.inspect(this._conditions)})`:"distinct"===this.op?`${this.model.modelName}.distinct('${this._distinct}', ${R.inspect(this._conditions)})`:"findOneAndReplace"===this.op||"findOneAndUpdate"===this.op||"replaceOne"===this.op||"update"===this.op||"updateMany"===this.op||"updateOne"===this.op?`${this.model.modelName}.${this.op}(${R.inspect(this._conditions)}, ${R.inspect(this._update)})`:`${this.model.modelName}.${this.op}()`},V.prototype.session=function(e){return null==e&&delete this.options.session,this.options.session=e,this},V.prototype.writeConcern=function(e){return null==e?(delete this.options.writeConcern,this):(this.options.writeConcern=e,this)},V.prototype.w=function(e){return null==e&&delete this.options.w,null!=this.options.writeConcern?this.options.writeConcern.w=e:this.options.w=e,this},V.prototype.j=function(e){return null==e&&delete this.options.j,null!=this.options.writeConcern?this.options.writeConcern.j=e:this.options.j=e,this},V.prototype.wtimeout=function(e){return null==e&&delete this.options.wtimeout,null!=this.options.writeConcern?this.options.writeConcern.wtimeout=e:this.options.wtimeout=e,this},V.prototype.getOptions=function(){return this.options},V.prototype.setOptions=function(e,t){if(t)return this._mongooseOptions=e&&A(e)||{},this.options=e||{},"populate"in e&&this.populate(this._mongooseOptions),this;if(null==e)return this;if("object"!=typeof e)throw new Error('Options must be an object, got "'+e+'"');if(e=Object.assign({},e),Array.isArray(e.populate)){const t=e.populate;delete e.populate;const n=t.length;for(let e=0;e<n;++e)this.populate(t[e])}if("setDefaultsOnInsert"in e&&(this._mongooseOptions.setDefaultsOnInsert=e.setDefaultsOnInsert,delete e.setDefaultsOnInsert),"overwriteDiscriminatorKey"in e&&(this._mongooseOptions.overwriteDiscriminatorKey=e.overwriteDiscriminatorKey,delete e.overwriteDiscriminatorKey),"overwriteImmutable"in e&&(this._mongooseOptions.overwriteImmutable=e.overwriteImmutable,delete e.overwriteImmutable),"sanitizeProjection"in e&&(e.sanitizeProjection&&!this._mongooseOptions.sanitizeProjection&&$(this._fields),this._mongooseOptions.sanitizeProjection=e.sanitizeProjection,delete e.sanitizeProjection),"sanitizeFilter"in e&&(this._mongooseOptions.sanitizeFilter=e.sanitizeFilter,delete e.sanitizeFilter),"timestamps"in e&&(this._mongooseOptions.timestamps=e.timestamps,delete e.timestamps),"defaults"in e&&(this._mongooseOptions.defaults=e.defaults),"translateAliases"in e&&(this._mongooseOptions.translateAliases=e.translateAliases,delete e.translateAliases),"schemaLevelProjections"in e&&(this._mongooseOptions.schemaLevelProjections=e.schemaLevelProjections,delete e.schemaLevelProjections),null==e.lean&&this.schema&&"lean"in this.schema.options&&(this._mongooseOptions.lean=this.schema.options.lean),"string"==typeof e.limit)try{e.limit=g(e.limit)}catch(t){throw new r("Number",e.limit,"limit")}if("string"==typeof e.skip)try{e.skip=g(e.skip)}catch(t){throw new r("Number",e.skip,"skip")}for(const t of Object.keys(e))if(L.has(t)){const n=Array.isArray(e[t])?e[t]:[e[t]];this[t].apply(this,n)}else this.options[t]=e[t];return this},V.prototype.explain=function(e){return 0===arguments.length?this.options.explain=!0:!1===e?delete this.options.explain:this.options.explain=e,this},V.prototype.allowDiskUse=function(e){return 0===arguments.length?this.options.allowDiskUse=!0:!1===e?delete this.options.allowDiskUse:this.options.allowDiskUse=e,this},V.prototype.maxTimeMS=function(e){return this.options.maxTimeMS=e,this},V.prototype.getFilter=function(){return this._conditions},V.prototype.getQuery=function(){return this._conditions},V.prototype.setQuery=function(e){this._conditions=e},V.prototype.getUpdate=function(){return this._update},V.prototype.setUpdate=function(e){this._update=e},V.prototype._fieldsForExec=function(){return null==this._fields||0===Object.keys(this._fields).length?null:A(this._fields)},V.prototype._updateForExec=function(){const e=A(this._update,{transform:!1,depopulate:!0}),t=Object.keys(e);let n=t.length;const r={};for(;n--;){const o=t[n];"$"!==o[0]?(r.$set||(e.$set?r.$set=e.$set:r.$set={}),r.$set[o]=e[o],t.splice(n,1),~t.indexOf("$set")||t.push("$set")):"$set"===o&&r.$set||(r[o]=e[o])}return r},V.prototype._optionsForExec=function(e){const t=A(this.options);if(delete t.populate,!(e=e||this.model))return t;d(e.schema,t),f(e.schema,t);const n=this.model?.db?.base.transactionAsyncLocalStorage?.getStore();this.options.hasOwnProperty("session")||null==n?.session||(t.session=n.session);const r=e&&e.schema&&e.schema.options&&e.schema.options.read;if(!("readPreference"in t)&&r&&(t.readPreference=r),void 0!==t.upsert&&(t.upsert=!!t.upsert),t.writeConcern&&(t.j&&(t.writeConcern.j=t.j,delete t.j),t.w&&(t.writeConcern.w=t.w,delete t.w),t.wtimeout&&(t.writeConcern.wtimeout=t.wtimeout,delete t.wtimeout)),this._applyPaths(),null!=this._fields){this._fields=this._castFields(this._fields);const e=this._fieldsForExec();null!=e&&(t.projection=e)}return t},V.prototype.lean=function(e){return this._mongooseOptions.lean=!arguments.length||e,this},V.prototype.set=function(e,t){if("object"==typeof e){const t=Object.keys(e);for(const n of t)this.set(n,e[n]);return this}return this._update=this._update||{},e in this._update&&delete this._update[e],this._update.$set=this._update.$set||{},this._update.$set[e]=t,this},V.prototype.get=function(e){const t=this._update;if(null==t)return;const n=t.$set;return null==n||k.hasUserDefinedProperty(t,e)?t[e]:k.hasUserDefinedProperty(n,e)?n[e]:void 0},V.prototype.error=function(e){return 0===arguments.length?this._error:(this._error=e,this)},V.prototype._unsetCastError=function(){if(null!=this._error&&this._error instanceof r)return this.error(null)},V.prototype.mongooseOptions=function(e){return arguments.length>0&&(this._mongooseOptions=e),this._mongooseOptions},V.prototype._castConditions=function(){let e;e=null!=this.model?.db.options?.sanitizeFilter?this.model.db.options.sanitizeFilter:null!=this.model?.base.options?.sanitizeFilter?this.model.base.options.sanitizeFilter:this._mongooseOptions.sanitizeFilter,e&&F(this._conditions);try{this.cast(this.model),this._unsetCastError()}catch(e){this.error(e)}},V.prototype._find=async function(){if(this._applyTranslateAliases(),this._castConditions(),null!=this.error())throw this.error();const e=this._mongooseOptions,t=this._userProvidedFields||{};l(this.options,this.model.db.options,this.model.base.options),h(this.options,this.model.db.options,this.model.base.options);const n={session:this&&this.options&&this.options.session||null,lean:e.lean||null},r=this._optionsForExec(),o=this._conditions,i=r.projection,s=await this.mongooseCollection.find(o,r);if(r.explain)return s.explain();let u=await s.toArray();if(0===u.length)return u;if(!e.populate){const r=this.schema.options.versionKey;return e.lean&&!1===e.lean.versionKey&&r&&u.forEach((e=>{r in e&&delete e[r]})),e.lean?J(this.model.schema,u,null,n):this._completeMany(u,i,t,n)}const a=_.preparePopulationOptionsMQ(this,e);return e.lean?this.model.populate(u,a):(u=await this._completeMany(u,i,t,n),await this.model.populate(u,a),u)},V.prototype.find=function(e){if("function"==typeof e||"function"==typeof arguments[1])throw new s("Query.prototype.find() no longer accepts a callback");return this.op="find",M.canMerge(e)?(this.merge(e),H(this)):null!=e&&this.error(new u(e,"filter","find")),this},V.prototype.merge=function(e){if(!e)return this;const t={overwrite:!0};return e instanceof V?(e._conditions&&(t.omit={},this._conditions&&this._conditions.$and&&e._conditions.$and&&(t.omit.$and=!0,this._conditions.$and=this._conditions.$and.concat(e._conditions.$and)),this._conditions&&this._conditions.$or&&e._conditions.$or&&(t.omit.$or=!0,this._conditions.$or=this._conditions.$or.concat(e._conditions.$or)),k.merge(this._conditions,e._conditions,t)),e._fields&&(this._fields||(this._fields={}),k.merge(this._fields,e._fields,t)),e.options&&(this.options||(this.options={}),k.merge(this.options,e.options,t)),e._update&&(this._update||(this._update={}),k.mergeClone(this._update,e._update)),e._distinct&&(this._distinct=e._distinct),k.merge(this._mongooseOptions,e._mongooseOptions),this):null!=this.model&&e instanceof this.model.base.Types.ObjectId?(k.merge(this._conditions,{_id:e},t),this):(e&&e.$__&&(e=e.toObject(O)),t.omit={},Array.isArray(e.$and)&&(t.omit.$and=!0,this._conditions||(this._conditions={}),this._conditions.$and=(this._conditions.$and||[]).concat(e.$and.map((e=>k.isPOJO(e)?k.merge({},e):e)))),Array.isArray(e.$or)&&(t.omit.$or=!0,this._conditions||(this._conditions={}),this._conditions.$or=(this._conditions.$or||[]).concat(e.$or.map((e=>k.isPOJO(e)?k.merge({},e):e)))),k.merge(this._conditions,e,t),this)},V.prototype.collation=function(e){return null==this.options&&(this.options={}),this.options.collation=e,this},V.prototype._completeOne=function(e,t,n,r){if(!e&&!this.options.includeResultMetadata)return r(null,null);const o=this.model,i=this._userProvidedFields||{},s=this._mongooseOptions,u=this.options;if(!u.lean&&s.lean&&(u.lean=s.lean),u.explain)return r(null,e);if(!s.populate){const a=this.schema.options.versionKey;return s.lean&&!1===s.lean.versionKey&&a&&a in e&&delete e[a],s.lean?Q(o.schema,e,null,t,u,r):G(o,e,t,u,n,i,null,r)}const a=_.preparePopulationOptionsMQ(this,this._mongooseOptions);if(s.lean)return o.populate(e,a).then((e=>{Q(o.schema,e,null,t,u,r)}),(e=>{r(e)}));G(o,e,t,u,n,i,[],((e,t)=>{if(null!=e)return r(e);o.populate(t,a).then((e=>{r(null,e)}),(e=>{r(e)}))}))},V.prototype._completeMany=async function(e,t,n,r){const o=this.model;return Promise.all(e.map((e=>new Promise(((i,s)=>{const u=e;e=_.createModel(o,e,t,n),null!=r.session&&e.$session(r.session),e.$init(u,r,(t=>{if(null!=t)return s(t);i(e)}))})))))},V.prototype._findOne=async function(){if(this._applyTranslateAliases(),this._castConditions(),this.error()){throw this.error()}l(this.options,this.model.db.options,this.model.base.options),h(this.options,this.model.db.options,this.model.base.options);const e=this._optionsForExec(),t=await this.mongooseCollection.findOne(this._conditions,e);return new Promise(((n,r)=>{this._completeOne(t,null,e.projection,((e,t)=>{if(e)return r(e);n(t)}))}))},V.prototype.findOne=function(e,t,n){if("function"==typeof e||"function"==typeof t||"function"==typeof n||"function"==typeof arguments[3])throw new s("Query.prototype.findOne() no longer accepts a callback");return this.op="findOne",this._validateOp(),n&&this.setOptions(n),t&&this.select(t),M.canMerge(e)?(this.merge(e),H(this)):null!=e&&this.error(new u(e,"filter","findOne")),this},V.prototype._countDocuments=async function(){this._applyTranslateAliases();try{this.cast(this.model)}catch(e){this.error(e)}if(this.error())throw this.error();l(this.options,this.model.db.options,this.model.base.options),h(this.options,this.model.db.options,this.model.base.options);const e=this._optionsForExec(),t=this._conditions;return this.mongooseCollection.countDocuments(t,e)},
/*!
	 * If `translateAliases` option is set, call `Model.translateAliases()`
	 * on the following query properties: filter, projection, update, distinct.
	 */
V.prototype._applyTranslateAliases=function(){let e=!1;"translateAliases"in this._mongooseOptions?e=this._mongooseOptions.translateAliases:null!=this.model?.schema?._userProvidedOptions?.translateAliases?e=this.model.schema._userProvidedOptions.translateAliases:null!=this.model?.base?.options?.translateAliases&&(e=this.model.base.options.translateAliases),e&&this.model?.schema?.aliases&&Object.keys(this.model.schema.aliases).length>0&&(this.model.translateAliases(this._conditions,!0),this.model.translateAliases(this._fields,!0),this.model.translateAliases(this._update,!0),null!=this._distinct&&null!=this.model.schema.aliases[this._distinct]&&(this._distinct=this.model.schema.aliases[this._distinct]))},V.prototype._estimatedDocumentCount=async function(){if(this.error())throw this.error();const e=this._optionsForExec();return this.mongooseCollection.estimatedDocumentCount(e)},V.prototype.estimatedDocumentCount=function(e){if("function"==typeof e||"function"==typeof arguments[1])throw new s("Query.prototype.estimatedDocumentCount() no longer accepts a callback");return this.op="estimatedDocumentCount",this._validateOp(),null!=e&&this.setOptions(e),this},V.prototype.countDocuments=function(e,t){if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new s("Query.prototype.countDocuments() no longer accepts a callback");return this.op="countDocuments",this._validateOp(),M.canMerge(e)&&this.merge(e),null!=t&&this.setOptions(t),this},V.prototype.__distinct=async function(){if(this._applyTranslateAliases(),this._castConditions(),this.error())throw this.error();l(this.options,this.model.db.options,this.model.base.options),h(this.options,this.model.db.options,this.model.base.options);const e=this._optionsForExec();return this.mongooseCollection.distinct(this._distinct,this._conditions,e)},V.prototype.distinct=function(e,t,n){if("function"==typeof e||"function"==typeof t||"function"==typeof n||"function"==typeof arguments[3])throw new s("Query.prototype.distinct() no longer accepts a callback");return this.op="distinct",this._validateOp(),M.canMerge(t)?(this.merge(t),H(this)):null!=t&&this.error(new u(t,"filter","distinct")),null!=e&&(this._distinct=e),null!=n&&this.setOptions(n),this},V.prototype.sort=function(e,t){if(arguments.length>2)throw new Error("sort() takes at most 2 arguments");if(null!=t&&"object"!=typeof t)throw new Error("sort() options argument must be an object or nullish");null==this.options.sort&&(this.options.sort={}),t&&t.override&&(this.options.sort={});const n=this.options.sort;if("string"==typeof e){const t=-1===e.indexOf(" ")?[e]:e.split(" ");for(let e of t){const t="-"==e[0]?-1:1;-1===t&&(e=e.slice(1)),N.has(e)||(n[e]=t)}}else if(Array.isArray(e))for(const t of e){if(!Array.isArray(t))throw new TypeError("Invalid sort() argument, must be array of arrays");const e=""+t[0];N.has(e)||(n[e]=q(t[1],e))}else if("object"!=typeof e||null==e||e instanceof Map){if(e instanceof Map)for(let t of e.keys())t=""+t,N.has(t)||(n[t]=q(e.get(t),t));else if(null!=e)throw new TypeError("Invalid sort() argument. Must be a string, object, array, or map.")}else for(const t of Object.keys(e))N.has(t)||(n[t]=q(e[t],t));return this},V.prototype.deleteOne=function(e,t){if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new s("Query.prototype.deleteOne() no longer accepts a callback");return this.op="deleteOne",this.setOptions(t),M.canMerge(e)?(this.merge(e),H(this)):null!=e&&this.error(new u(e,"filter","deleteOne")),this},V.prototype._deleteOne=async function(){if(this._applyTranslateAliases(),this._castConditions(),null!=this.error())throw this.error();const e=this._optionsForExec();return this.mongooseCollection.deleteOne(this._conditions,e)},V.prototype.deleteMany=function(e,t){if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new s("Query.prototype.deleteMany() no longer accepts a callback");return this.setOptions(t),this.op="deleteMany",M.canMerge(e)?(this.merge(e),H(this)):null!=e&&this.error(new u(e,"filter","deleteMany")),this},V.prototype._deleteMany=async function(){if(this._applyTranslateAliases(),this._castConditions(),null!=this.error())throw this.error();const e=this._optionsForExec();return this.mongooseCollection.deleteMany(this._conditions,e)},V.prototype.findOneAndUpdate=function(e,t,n){if("function"==typeof e||"function"==typeof t||"function"==typeof n||"function"==typeof arguments[3])throw new s("Query.prototype.findOneAndUpdate() no longer accepts a callback");switch(this.op="findOneAndUpdate",this._validateOp(),this._validate(),arguments.length){case 2:n=void 0;break;case 1:t=e,e=n=void 0}M.canMerge(e)?this.merge(e):null!=e&&this.error(new u(e,"filter","findOneAndUpdate")),t&&this._mergeUpdate(t),(n=n?A(n):{}).projection&&(this.select(n.projection),delete n.projection),n.fields&&(this.select(n.fields),delete n.fields);const r=this&&this.model&&this.model.base&&this.model.base.options&&this.model.base.options.returnOriginal;return null==n.new&&null==n.returnDocument&&null==n.returnOriginal&&null!=r&&(n.returnOriginal=r),this.setOptions(n),this},V.prototype._findOneAndUpdate=async function(){if(this._applyTranslateAliases(),this._castConditions(),W(this),this.error())throw this.error();l(this.options,this.model.db.options,this.model.base.options),h(this.options,this.model.db.options,this.model.base.options),"strict"in this.options&&(this._mongooseOptions.strict=this.options.strict);const e=this._optionsForExec(this.model);K(e),this._update=this._castUpdate(this._update);const t=Object.assign({},e,{setDefaultsOnInsert:this._mongooseOptions.setDefaultsOnInsert});if(this._update=P(this._conditions,this.model.schema,this._update,t),this._update&&0!==Object.keys(this._update).length){if(this._update instanceof Error)throw this._update;this._update.$set&&0===Object.keys(this._update.$set).length&&delete this._update.$set}else{if(!e.upsert){this._executionStack=null;return await this._findOne()}{const e=A(this._update);delete e._id,this._update={$set:e}}}Y(this,"runValidators",!1)&&await this.validate(this._update,e,!1),this._update.toBSON&&(this._update=this._update.toBSON());let n=await this.mongooseCollection.findOneAndUpdate(this._conditions,this._update,e);for(const e of this._transforms)n=e(n);const r=e.includeResultMetadata?n.value:n;return new Promise(((t,o)=>{this._completeOne(r,n,e.projection,((e,n)=>{if(e)return o(e);t(n)}))}))},V.prototype.findOneAndDelete=function(e,t){if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new s("Query.prototype.findOneAndDelete() no longer accepts a callback");return this.op="findOneAndDelete",this._validateOp(),this._validate(),M.canMerge(e)&&this.merge(e),t&&this.setOptions(t),this},V.prototype._findOneAndDelete=async function(){if(this._applyTranslateAliases(),this._castConditions(),null!=this.error())throw this.error();const e=this.options.includeResultMetadata,t=this._conditions,n=this._optionsForExec(this.model);let r=await this.mongooseCollection.findOneAndDelete(t,n);for(const e of this._transforms)r=e(r);const o=e?r.value:r;return new Promise(((e,t)=>{this._completeOne(o,r,n.projection,((n,r)=>{if(n)return t(n);e(r)}))}))},V.prototype.findOneAndReplace=function(e,t,n){if("function"==typeof e||"function"==typeof t||"function"==typeof n||"function"==typeof arguments[4])throw new s("Query.prototype.findOneAndReplace() no longer accepts a callback");this.op="findOneAndReplace",this._validateOp(),this._validate(),M.canMerge(e)?this.merge(e):null!=e&&this.error(new u(e,"filter","findOneAndReplace")),null!=t&&this._mergeUpdate(t),n=n||{};const r=this&&this.model&&this.model.base&&this.model.base.options&&this.model.base.options.returnOriginal;return null==n.new&&null==n.returnDocument&&null==n.returnOriginal&&null!=r&&(n.returnOriginal=r),this.setOptions(n),this},V.prototype._findOneAndReplace=async function(){if(this._applyTranslateAliases(),this._castConditions(),null!=this.error())throw this.error();"strict"in this.options&&(this._mongooseOptions.strict=this.options.strict,delete this.options.strict);const e=this._conditions,t=this._optionsForExec();K(t);const n=this.options.includeResultMetadata,r={skipId:!0};"strict"in this._mongooseOptions&&(r.strict=this._mongooseOptions.strict);const o=Y(this,"runValidators",!1);try{const e=new this.model(this._update,null,r);if(o)await e.validate();else if(e.$__.validationError)throw e.$__.validationError;this._update=e.toBSON()}catch(e){if(e instanceof c)throw e;const t=new c;throw t.errors[e.path]=e,t}let i=await this.mongooseCollection.findOneAndReplace(e,this._update,t);for(const e of this._transforms)i=e(i);const s=n?i.value:i;return new Promise(((e,n)=>{this._completeOne(s,i,t.projection,((t,r)=>{if(t)return n(t);e(r)}))}))},V.prototype._mergeUpdate=function(e){if(this._update||(this._update=Array.isArray(e)?[]:{}),null!=e&&("object"!=typeof e||0!==Object.keys(e).length))if(e instanceof V){if(Array.isArray(this._update))throw new Error("Cannot mix array and object updates");e._update&&k.mergeClone(this._update,e._update)}else if(Array.isArray(e)){if(!Array.isArray(this._update))throw new Error("Cannot mix array and object updates");this._update=this._update.concat(e)}else{if(Array.isArray(this._update))throw new Error("Cannot mix array and object updates");k.mergeClone(this._update,e)}},V.prototype.validate=async function(e,t,n){if("function"==typeof arguments[3])throw new s("Query.prototype.validate() no longer accepts a callback");await ne(this,"validate"),n?await e.$validate():await new Promise(((n,r)=>{I(this,this.model.schema,e,t,(e=>{if(null!=e)return r(e);n()}))})),await te(this,null,null,"validate")},V.prototype._updateMany=async function(){return X.call(this,"updateMany")},V.prototype._updateOne=async function(){return X.call(this,"updateOne")},V.prototype._replaceOne=async function(){return X.call(this,"replaceOne")},V.prototype.updateMany=function(e,t,n,r){return"function"==typeof n?(r=n,n=null):"function"==typeof t?(r=t,t=e,e={},n=null):"function"==typeof e?(r=e,e=void 0,t=void 0,n=void 0):"object"!=typeof e||t||n||r||(t=e,e=void 0,n=void 0,r=void 0),Z(this,"updateMany",e,t,n,r)},V.prototype.updateOne=function(e,t,n,r){return"function"==typeof n?(r=n,n=null):"function"==typeof t?(r=t,t=e,e={},n=null):"function"==typeof e?(r=e,e=void 0,t=void 0,n=void 0):"object"!=typeof e||t||n||r||(t=e,e=void 0,n=void 0,r=void 0),Z(this,"updateOne",e,t,n,r)},V.prototype.replaceOne=function(e,t,n,r){return"function"==typeof n?(r=n,n=null):"function"==typeof t?(r=t,t=e,e={},n=null):"function"==typeof e?(r=e,e=void 0,t=void 0,n=void 0):"object"!=typeof e||t||n||r||(t=e,e=void 0,n=void 0,r=void 0),Z(this,"replaceOne",e,t,n,r)},V.prototype.transform=function(e){return this._transforms.push(e),this},V.prototype.orFail=function(e){return this.transform((t=>{switch(this.op){case"find":if(0===t.length)throw ee(e,this);break;case"findOne":if(null==t)throw ee(e,this);break;case"replaceOne":case"updateMany":case"updateOne":if(t&&0===t.matchedCount)throw ee(e,this);break;case"findOneAndDelete":case"findOneAndUpdate":case"findOneAndReplace":if(this.options.includeResultMetadata&&null!=t&&null==t.value)throw ee(e,this);if(!this.options.includeResultMetadata&&null==t)throw ee(e,this);break;case"deleteMany":case"deleteOne":if(0===t.deletedCount)throw ee(e,this)}return t})),this},V.prototype.isPathSelectedInclusive=function(e){return S(this._fields,e)},V.prototype.exec=async function(e){if("function"==typeof e||arguments.length>=2&&"function"==typeof arguments[1])throw new s("Query.prototype.exec() no longer accepts a callback");if("string"==typeof e&&(this.op=e),null==this.op)throw new s("Query must have `op` before executing");if(null==this.model)throw new s("Query must have an associated model before executing");const t=U.get(this.op);if(!t)throw new s('Query has invalid `op`: "'+this.op+'"');if(this.options&&this.options.sort&&"object"==typeof this.options.sort&&this.options.sort.hasOwnProperty(""))throw new Error('Invalid field "" passed to sort()');if(null!=this._executionStack){let e=this.toString();e.length>60&&(e=e.slice(0,60)+"...");const t=new s("Query was already executed: "+e);throw t.originalStack=this._executionStack,t}this._executionStack=(new Error).stack;let n,r=null;try{await function(e){return new Promise(((t,n)=>{e._hooks.execPre("exec",e,[],(e=>{if(null!=e)return n(e);t()}))}))}(this)}catch(e){if(!(e instanceof i.skipWrappedFunction))throw e;r=e}let o=null;try{await ne(this),n=r?r.args[0]:await this[t]();for(const e of this._transforms)n=e(n)}catch(e){e instanceof i.skipWrappedFunction?n=e.args[0]:o=e,o=this.model.schema._transformDuplicateKeyError(o)}return n=await te(this,n,o),
/*!
	 * ignore
	 */
await function(e){return new Promise(((t,n)=>{e._hooks.execPost("exec",e,[],{},(e=>{if(e)return n(e);t()}))}))}(this),n},V.prototype.then=function(e,t){return this.exec().then(e,t)},V.prototype.catch=function(e){return this.exec().then(null,e)},V.prototype.finally=function(e){return this.exec().finally(e)},V.prototype[Symbol.toStringTag]=function(){return`Query { ${this.op} }`},V.prototype.pre=function(e){return this._hooks.pre("exec",e),this},V.prototype.post=function(e){return this._hooks.post("exec",e),this},V.prototype._castUpdate=function(e){let t=this.schema;const n=t.options.discriminatorKey,r=t._baseSchema?t._baseSchema:t;if(this._mongooseOptions.overwriteDiscriminatorKey&&null!=e[n]&&r.discriminators){const o=Object.values(r.discriminators).find((t=>t.discriminatorMapping.value===e[n]));null!=o&&(t=o)}let o;return"upsert"in this.options&&(o=this.options.upsert),E(t,e,{strict:this._mongooseOptions.strict,upsert:o,arrayFilters:this.options.arrayFilters,overwriteDiscriminatorKey:this._mongooseOptions.overwriteDiscriminatorKey,overwriteImmutable:this._mongooseOptions.overwriteImmutable},this,this._conditions)},V.prototype.populate=function(){const e=Array.from(arguments);if(!e.some(Boolean))return this;const t=k.populate.apply(null,e);if(null!=this.options){const e=this.options.readConcern,n=this.options.readPreference;for(const r of t)null!=e&&null==(r&&r.options&&r.options.readConcern)&&(r.options=r.options||{},r.options.readConcern=e),null!=n&&null==(r&&r.options&&r.options.readPreference)&&(r.options=r.options||{},r.options.readPreference=n)}const n=this._mongooseOptions;if(null!=n.lean){const e=n.lean;for(const n of t)null==(n&&n.options&&n.options.lean)&&(n.options=n.options||{},n.options.lean=e)}k.isObject(n.populate)||(n.populate={});const r=n.populate;for(const e of t){const t=e.path;r[t]&&r[t].populate&&e.populate&&(e.populate=r[t].populate.concat(e.populate)),r[e.path]=e}return this},V.prototype.getPopulatedPaths=function(){const e=this._mongooseOptions.populate||{},t=Object.keys(e);for(const n of Object.keys(e)){const r=e[n];Array.isArray(r.populate)&&re(t,r.populate,n+".")}return t},V.prototype.cast=function(e,t){t||(t=this._conditions);const n=(e=e||this.model).schema.options.discriminatorKey;null!=t&&t.hasOwnProperty(n)&&(e=b(e.discriminators,t[n])||e);const r={upsert:this.options&&this.options.upsert};this.options&&("strict"in this.options&&(r.strict=this.options.strict),"strictQuery"in this.options&&(r.strictQuery=this.options.strictQuery)),"sanitizeFilter"in this._mongooseOptions&&(r.sanitizeFilter=this._mongooseOptions.sanitizeFilter);try{return m(e.schema,t,r,this)}catch(t){throw"function"==typeof t.setModel&&t.setModel(e),t}},V.prototype._castFields=function(e){let t,n,r,o,i;if(e){r=Object.keys(e),n=[];for(let i=0;i<r.length;++i)o=r[i],e[o].$elemMatch&&(t||(t={}),t[o]=e[o],n.push(o))}if(t){try{i=this.cast(this.model,t)}catch(e){return e}for(let t=0;t<n.length;++t)o=n[t],e[o]=i[o]}return e},V.prototype._applyPaths=function(){if(!this.model)return;let e;this._fields=this._fields||{},e=null!=this.model&&k.hasUserDefinedProperty(this.model.db.options,"sanitizeProjection")?this.model.db.options.sanitizeProjection:null!=this.model&&k.hasUserDefinedProperty(this.model.base.options,"sanitizeProjection")?this.model.base.options.sanitizeProjection:this._mongooseOptions.sanitizeProjection;(this._mongooseOptions.schemaLevelProjections??!0)&&_.applyPaths(this._fields,this.model.schema,e);let t=!0;"selectPopulatedPaths"in this.model.base.options&&(t=this.model.base.options.selectPopulatedPaths),"selectPopulatedPaths"in this.model.schema.options&&(t=this.model.schema.options.selectPopulatedPaths),t&&x(this._fields,this._userProvidedFields,this._mongooseOptions.populate)},V.prototype.cursor=function(e){e&&this.setOptions(e);try{this.cast(this.model)}catch(e){return new a(this)._markError(e)}return new a(this)},V.prototype.tailable=function(e,t){if(null!=e&&"function"==typeof e.constructor&&"Object"===e.constructor.name&&(t=e,e=!0),void 0===e&&(e=!0),t&&"object"==typeof t)for(const e of Object.keys(t))"awaitData"===e||"awaitdata"===e?this.options.awaitData=!!t[e]:this.options[e]=t[e];return this.options.tailable=!arguments.length||!!e,this},V.prototype.near=function(){const e=[],t=this._mongooseOptions.nearSphere;if(1===arguments.length)if(Array.isArray(arguments[0]))e.push({center:arguments[0],spherical:t});else if("string"==typeof arguments[0])e.push(arguments[0]);else{if(!k.isObject(arguments[0]))throw new TypeError("invalid argument");"boolean"!=typeof arguments[0].spherical&&(arguments[0].spherical=t),e.push(arguments[0])}else if(2===arguments.length)if("number"==typeof arguments[0]&&"number"==typeof arguments[1])e.push({center:[arguments[0],arguments[1]],spherical:t});else if("string"==typeof arguments[0]&&Array.isArray(arguments[1]))e.push(arguments[0]),e.push({center:arguments[1],spherical:t});else{if("string"!=typeof arguments[0]||!k.isObject(arguments[1]))throw new TypeError("invalid argument");e.push(arguments[0]),"boolean"!=typeof arguments[1].spherical&&(arguments[1].spherical=t),e.push(arguments[1])}else{if(3!==arguments.length)throw new TypeError("invalid argument");if("string"!=typeof arguments[0]||"number"!=typeof arguments[1]||"number"!=typeof arguments[2])throw new TypeError("invalid argument");e.push(arguments[0]),e.push({center:[arguments[1],arguments[2]],spherical:t})}return V.base.near.apply(this,e)},V.prototype.nearSphere=function(){return this._mongooseOptions.nearSphere=!0,this.near.apply(this,arguments),this},null!=Symbol.asyncIterator&&(V.prototype[Symbol.asyncIterator]=function(){return this.cursor().transformNull()._transformForAsyncIterator()}),V.prototype.box=function(e,t){return!Array.isArray(e)&&k.isObject(e)&&(t=e.ur,e=e.ll),V.base.box.call(this,e,t)},V.prototype.center=V.base.circle,V.prototype.centerSphere=function(){null!=arguments[0]&&"function"==typeof arguments[0].constructor&&"Object"===arguments[0].constructor.name&&(arguments[0].spherical=!0),null!=arguments[1]&&"function"==typeof arguments[1].constructor&&"Object"===arguments[1].constructor.name&&(arguments[1].spherical=!0),V.base.circle.apply(this,arguments)},V.prototype.selectedInclusively=function(){return w(this._fields)},V.prototype.selectedExclusively=function(){return C(this._fields)},V.prototype.model,
/*!
	 * Export
	 */
sb=V}var _b,Ob,Cb,wb,Sb,vb,Db,Mb,Tb,Bb,Fb,$b,xb,Pb,Nb,Ib,Rb,kb,jb,Lb,Ub,Vb,zb,Wb,qb,Gb,Hb,Kb,Yb,Qb,Jb,Xb,Zb,e_,t_,n_,r_,o_,i_={exports:{}};
/*!
 * Module dependencies.
 */function s_(){if(Ob)return _b;Ob=1;const t=pa(),r=e.Readable,o=uA(),i=ha(),s=lc(),u=n;function a(e){r.call(this,{autoDestroy:!0,objectMode:!0}),this.cursor=null,this.agg=e,this._transforms=[];const t=e._connection,n=e._model;delete e.options.cursor.useMongooseAggCursor,this._mongooseOptions={},t?(this.cursor=t.db.aggregate(e._pipeline,e.options||{}),setImmediate((()=>this.emit("cursor",this.cursor)))):
/*!
	 * ignore
	 */
function(e,t,n){e.collection.buffer?e.collection.emitter.once("queue",(function(){e.hooks.execPre("aggregate",n,(function(r){null==r?("function"==typeof n.options?.cursor?.transform&&t._transforms.push(n.options.cursor.transform),t.cursor=e.collection.aggregate(n._pipeline,n.options||{}),t.emit("cursor",t.cursor)):c(t,r)}))})):e.hooks.execPre("aggregate",n,(function(r){null==r?("function"==typeof n.options?.cursor?.transform&&t._transforms.push(n.options.cursor.transform),t.cursor=e.collection.aggregate(n._pipeline,n.options||{}),t.emit("cursor",t.cursor)):c(t,r)}))}(n,this,e)}function c(e,n){if(n instanceof s.skipWrappedFunction){const r=n.args[0];if(null!=r&&(!Array.isArray(r)||r.length)){const n=new t('Cannot `skipMiddlewareFunction()` with a value when using `.aggregate().cursor()`, value must be nullish or empty array, got "'+u.inspect(r)+'".');return e._markError(n),void(e.listeners("error").length>0&&e.emit("error",n))}e.emit("cursor",null)}else e._markError(n),e.listeners("error").length>0&&e.emit("error",n)}if(u.inherits(a,r),a.prototype._read=function(){const e=this;h(this,(function(t,n){return t?e.emit("error",t):n?void e.push(n):(e.push(null),void e.cursor.close((function(t){if(t)return e.emit("error",t)})))}))},null!=Symbol.asyncIterator){const e="Mongoose does not support using async iterators with an existing aggregation cursor. See https://bit.ly/mongoose-async-iterate-aggregation";a.prototype[Symbol.asyncIterator]=function(){throw new t(e)}}
/*!
	 * ignore
	 */
function l(e){return null==e?{done:!0}:{value:e,done:!1}}function h(e,t){let n=t;return e._transforms.length&&(n=function(n,r){if(n||null===r&&!e._mongooseOptions.transformNull)return t(n,r);t(n,e._transforms.reduce((function(e,t){return t(e)}),r))}),e._error?i((function(){n(e._error)})):e.cursor?e.cursor.next().then((e=>{if(!e)return n(null,null);n(null,e)}),(e=>n(e))):(e.once("error",t),void e.once("cursor",(function(){h(e,t)})))}return Object.defineProperty(a.prototype,"map",{value:function(e){return this._transforms.push(e),this},enumerable:!0,configurable:!0,writable:!0}),a.prototype._markError=function(e){return this._error=e,this},a.prototype.close=async function(){if("function"==typeof arguments[0])throw new t("AggregationCursor.prototype.close() no longer accepts a callback");try{await this.cursor.close()}catch(e){throw this.listeners("error").length>0&&this.emit("error",e),e}this.emit("close")},a.prototype._destroy=function(e,t){let n=null;return n=this.cursor?Promise.resolve():new Promise((e=>{this.once("cursor",e)})),n.then((()=>this.cursor.close())).then((()=>{this._closed=!0,t()})).catch((e=>{t(e)})),this},a.prototype.next=async function(){if("function"==typeof arguments[0])throw new t("AggregationCursor.prototype.next() no longer accepts a callback");return new Promise(((e,t)=>{h(this,((n,r)=>{if(null!=n)return t(n);e(r)}))}))},a.prototype.eachAsync=function(e,n){if("function"==typeof arguments[2])throw new t("AggregationCursor.prototype.eachAsync() no longer accepts a callback");const r=this;return"function"==typeof n&&(n={}),o((function(e){return h(r,e)}),e,n=n||{})},null!=Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this.transformNull()._transformForAsyncIterator()})
/*!
	 * ignore
	 */,a.prototype._transformForAsyncIterator=function(){return-1===this._transforms.indexOf(l)&&this.map(l),this},
/*!
	 * ignore
	 */
a.prototype.transformNull=function(e){return 0===arguments.length&&(e=!0),this._mongooseOptions.transformNull=e,this},a.prototype.addCursorFlag=function(e,t){const n=this;
/*!
	 * ignore
	 */
return function(e,t){if(e.cursor)return t();e.once("cursor",(function(){t()}))}(this,(function(){n.cursor.addCursorFlag(e,t)})),this},_b=a}function u_(){return wb||(wb=1,Cb=function(e,t,n){const r=t&&t.discriminatorMapping;if(n=n||"",r&&!r.isRoot){const t=e,o=(n.length>0?n+".":n)+r.key,i=r.value;if(null==t[0]||!t[0].$match||void 0!==t[0].$match[o]&&t[0].$match[o]!==i)if(null!=t[0]&&t[0].$geoNear)t[0].$geoNear.query=t[0].$geoNear.query||{},t[0].$geoNear.query[o]=i;else if(null!=t[0]&&t[0].$search)if(t[1]&&null!=t[1].$match)t[1].$match[o]=t[1].$match[o]||i;else{const e={};e[o]=i,t.splice(1,0,{$match:e})}else{const e={};e[o]=i,t.unshift({$match:e})}else t[0].$match[o]=i}}),Cb}function a_(){if(vb)return Sb;function e(e){if(null!=e&&null!=e.$accumulator)for(const t of["init","accumulate","merge","finalize"])"function"==typeof e.$accumulator[t]&&(e.$accumulator[t]=String(e.$accumulator[t]))}return vb=1,Sb=function t(n){if(Array.isArray(n))for(const r of n){if(null==r)continue;const n=r.$group||r.$bucket||r.$bucketAuto;if(null!=n)for(const t of Object.keys(n))e(n[t]);const o=Object.keys(r)[0];if(o&&"object"==typeof r[o]){const e=r[o];for(const t of Object.keys(e))null!=e[t]&&null!=e[t].$function&&"function"==typeof e[t].$function.body&&(e[t].$function.body=e[t].$function.body.toString())}if(null!=r.$facet)for(const e of Object.keys(r.$facet))t(r.$facet[e])}}}function c_(){if(Mb)return Db;Mb=1;
/*!
	 * Module dependencies
	 */
const e=s_(),t=pa(),n=bb(),{applyGlobalMaxTimeMS:r,applyGlobalDiskUse:o}=aA(),i=oc(),s=_a(),u=u_(),a=a_(),c=uf(),{modelSymbol:l}=Aa(),h=n.prototype.read,p=n.prototype.readConcern,d=new Set(["$$DESCEND","$$PRUNE","$$KEEP"]);function f(e,t){this._pipeline=[],null==t||t[l]?this._model=t:this._connection=t,this.options={},1===arguments.length&&Array.isArray(e)&&this.append.apply(this,e)}
/*!
	 * Helpers
	 */
function m(e){if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&"$"===t[0][0]}return f.prototype.options,f.prototype._optionsForExec=function(){const e=this.options||{},t=this.model()?.db?.base.transactionAsyncLocalStorage?.getStore();return e.hasOwnProperty("session")||null==t?.session||(e.session=t.session),e},f.prototype.model=function(e){return 0===arguments.length?this._model:(this._model=e,null!=e.schema&&(null==this.options.readPreference&&null!=e.schema.options.read&&(this.options.readPreference=e.schema.options.read),null==this.options.collation&&null!=e.schema.options.collation&&(this.options.collation=e.schema.options.collation)),e)},f.prototype.append=function(){const e=1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:[...arguments];if(!e.every(m))throw new Error("Arguments must be aggregate pipeline operators");return this._pipeline=this._pipeline.concat(e),this},f.prototype.addFields=function(e){if("object"!=typeof e||null===e||Array.isArray(e))throw new Error("Invalid addFields() argument. Must be an object");return this.append({$addFields:Object.assign({},e)})},f.prototype.project=function(e){const t={};if("object"!=typeof e||Array.isArray(e)){if(1!==arguments.length||"string"!=typeof e)throw new Error("Invalid project() argument. Must be string or object");e.split(/\s+/).forEach((function(e){if(!e)return;const n="-"===e[0]?0:1;0===n&&(e=e.substring(1)),t[e]=n}))}else Object.keys(e).forEach((function(n){t[n]=e[n]}));return this.append({$project:t})},f.prototype.near=function(e){if(null==e)throw new t("Aggregate `near()` must be called with non-nullish argument");if(null==e.near)throw new t("Aggregate `near()` argument must have a `near` property");const n=Array.isArray(e.near)?e.near:e.near.coordinates;if("object"==typeof e.near&&(!Array.isArray(n)||n.length<2||n.find((e=>"number"!=typeof e))))throw new t(`Aggregate \`near()\` argument has invalid coordinates, got "${n}"`);const r={};return r.$geoNear=e,this.append(r)},
/*!
	 * define methods
	 */
"group match skip limit out densify fill".split(" ").forEach((function(e){f.prototype[e]=function(t){const n={};return n["$"+e]=t,this.append(n)}})),f.prototype.unwind=function(){const e=[...arguments],t=[];for(const n of e)if(n&&"object"==typeof n)t.push({$unwind:n});else{if("string"!=typeof n)throw new Error('Invalid arg "'+n+'" to unwind(), must be string or object');t.push({$unwind:"$"===n[0]?n:"$"+n})}return this.append.apply(this,t)},f.prototype.replaceRoot=function(e){let t;return t="string"==typeof e?e.startsWith("$")?e:"$"+e:e,this.append({$replaceRoot:{newRoot:t}})},f.prototype.count=function(e){return this.append({$count:e})},f.prototype.sortByCount=function(e){if(e&&"object"==typeof e)return this.append({$sortByCount:e});if("string"==typeof e)return this.append({$sortByCount:"$"===e[0]?e:"$"+e});throw new TypeError('Invalid arg "'+e+'" to sortByCount(), must be string or object')},f.prototype.lookup=function(e){return this.append({$lookup:e})},f.prototype.graphLookup=function(e){const t={};if(e){if(!c.isObject(e))throw new TypeError("Invalid graphLookup() argument. Must be an object.");c.mergeClone(t,e);const n=t.startWith;n&&"string"==typeof n&&(t.startWith=t.startWith.startsWith("$")?t.startWith:"$"+t.startWith)}return this.append({$graphLookup:t})},f.prototype.sample=function(e){return this.append({$sample:{size:e}})},f.prototype.sort=function(e){const t={};if("Object"===s(e)){const n=["desc","descending",-1];Object.keys(e).forEach((function(r){e[r]instanceof Object&&e[r].$meta?t[r]=e[r]:t[r]=-1===n.indexOf(e[r])?1:-1}))}else{if(1!==arguments.length||"string"!=typeof e)throw new TypeError("Invalid sort() argument. Must be a string or object.");e.split(/\s+/).forEach((function(e){if(!e)return;const n="-"===e[0]?-1:1;-1===n&&(e=e.substring(1)),t[e]=n}))}return this.append({$sort:t})},f.prototype.unionWith=function(e){return this.append({$unionWith:e})},f.prototype.read=function(e,t){return h.call(this,e,t),this},f.prototype.readConcern=function(e){return p.call(this,e),this},f.prototype.redact=function(e,t,n){if(3===arguments.length){if("string"==typeof t&&!d.has(t)||"string"==typeof n&&!d.has(n))throw new Error("If thenExpr or elseExpr is string, it must be either $$DESCEND, $$PRUNE or $$KEEP");e={$cond:{if:e,then:t,else:n}}}else if(1!==arguments.length)throw new TypeError("Invalid arguments");return this.append({$redact:e})},f.prototype.explain=async function(e){if("function"==typeof e||"function"==typeof arguments[1])throw new t("Aggregate.prototype.explain() no longer accepts a callback");const n=this._model;if(!this._pipeline.length)throw new Error("Aggregate has empty pipeline");u(this._pipeline,this._model.schema),await new Promise(((e,t)=>{n.hooks.execPre("aggregate",this,(r=>{if(r){const e={error:r};return n.hooks.execPost("aggregate",this,[null],e,(e=>{t(e)}))}e()}))}));const r=n.collection.aggregate(this._pipeline,this.options);null==e&&(e=!0);let o=null;try{o=await r.explain(e)}catch(e){await new Promise(((t,r)=>{const o={error:e};n.hooks.execPost("aggregate",this,[null],o,(e=>e?r(e):t()))}))}const i={error:null};return await new Promise(((e,t)=>{n.hooks.execPost("aggregate",this,[o],i,(n=>n?t(n):e()))})),o},f.prototype.allowDiskUse=function(e){return this.options.allowDiskUse=e,this},f.prototype.hint=function(e){return this.options.hint=e,this},f.prototype.session=function(e){return null==e?delete this.options.session:this.options.session=e,this},f.prototype.option=function(e){for(const t in e)this.options[t]=e[t];return this},f.prototype.cursor=function(t){return this._optionsForExec(),this.options.cursor=t||{},new e(this)},f.prototype.collation=function(e){return this.options.collation=e,this},f.prototype.facet=function(e){return this.append({$facet:e})},f.prototype.search=function(e){return this.append({$search:e})},f.prototype.pipeline=function(){return this._pipeline},f.prototype.exec=async function(){if(!this._model&&!this._connection)throw new Error("Aggregate not bound to any Model");if("function"==typeof arguments[0])throw new t("Aggregate.prototype.exec() no longer accepts a callback");if(this._connection){if(!this._pipeline.length)throw new t("Aggregate has empty pipeline");this._optionsForExec();const e=await this._connection.client.db().aggregate(this._pipeline,this.options);return await e.toArray()}const n=this._model,s=this._model.collection;if(r(this.options,n.db.options,n.base.options),o(this.options,n.db.options,n.base.options),this._optionsForExec(),this.options&&this.options.cursor)return new e(this);if(u(this._pipeline,this._model.schema),a(this._pipeline),await new Promise(((e,t)=>{n.hooks.execPre("aggregate",this,(r=>{if(r){const e={error:r};return n.hooks.execPost("aggregate",this,[null],e,(e=>{t(e)}))}e()}))})),!this._pipeline.length)throw new t("Aggregate has empty pipeline");const c=i(this.options||{});let l;try{const e=await s.aggregate(this._pipeline,c);l=await e.toArray()}catch(e){await new Promise(((t,r)=>{const o={error:e};n.hooks.execPost("aggregate",this,[null],o,(e=>{if(e)return r(e);t()}))}))}const h={error:null};return await new Promise(((e,t)=>{n.hooks.execPost("aggregate",this,[l],h,(n=>n?t(n):e()))})),l},f.prototype.then=function(e,t){return this.exec().then(e,t)},f.prototype.catch=function(e){return this.exec().then(null,e)},f.prototype.finally=function(e){return this.exec().finally(e)},null!=Symbol.asyncIterator&&(f.prototype[Symbol.asyncIterator]=function(){return this.cursor({useMongooseAggCursor:!0}).transformNull()._transformForAsyncIterator()}),f._prepareDiscriminatorPipeline=u,
/*!
	 * Exports
	 */
Db=f}function l_(){return $b||($b=1,Fb=function e(t,n){const r=Object.keys(n.paths),o=r.length;for(let i=0;i<o;++i){let o="";const s=r[i],u=n.paths[s],a=u.splitPath(),c=a.length;let l=t;for(let n=0;n<c&&null!=l;++n){const r=a[n];if(o+=(o.length?".":"")+r,n===c-1){if(void 0!==l[r]){u.$isSingleNested?e(l[r],u.caster.schema):u.$isMongooseDocumentArray&&Array.isArray(l[r])&&l[r].forEach((t=>e(t,u.schema)));break}const n=u.getDefault(t,!1,{skipCast:!0});void 0!==n&&(l[r]=n,u.$isSingleNested?e(n,u.caster.schema):u.$isMongooseDocumentArray&&Array.isArray(n)&&n.forEach((t=>e(t,u.schema))))}else null==l[r]&&(l[r]={}),l=l[r]}}}),Fb}function h_(){if(Pb)return xb;return Pb=1,xb=function e(t,n=new WeakSet,r=!1){if(n.has(t))return;n.add(t);for(const o of Object.keys(t.paths)){const i=t.paths[o];if(i.schema&&(e(i.schema,n),i.schema._applyDiscriminators&&(!i._appliedDiscriminators||r))){for(const t of i.schema._applyDiscriminators.keys()){const{schema:o,options:s}=i.schema._applyDiscriminators.get(t);e(o,n),i.discriminator(t,o,r?{...s,overwriteExisting:!0}:s)}i._appliedDiscriminators=!0}}},xb}function p_(){if(Ib)return Nb;Ib=1;const e=wp(),t=uf();return Nb=function n(r,o){const i=dC();function s(e,t){Object.defineProperty(r.prototype,e,{get:function(){const n={};for(const r in t.methods[e])n[r]=t.methods[e][r].bind(this);return n},configurable:!0})}for(const n of Object.keys(o.methods)){const u=o.methods[n];if(o.tree.hasOwnProperty(n))throw new Error('You have a method and a property in your schema both named "'+n+'"');"function"!=typeof u||i.prototype[n]!==u?(o.reserved[n]&&!e(o,`methodOptions.${n}.suppressWarning`,!1)&&t.warn(`mongoose: the method name "${n}" is used by mongoose internally, overwriting it may cause bugs. If you're sure you know what you're doing, you can suppress this error by using \`schema.method('${n}', fn, { suppressWarning: true })\`.`),"function"==typeof u?r.prototype[n]=u:s(n,o)):delete o.methods[n]}r.$appliedMethods=!0;for(const e of Object.keys(o.paths)){const t=o.paths[e];t.$isSingleNested&&!t.caster.$appliedMethods&&n(t.caster,t.schema),t.$isMongooseDocumentArray&&!t.Constructor.$appliedMethods&&n(t.Constructor,t.schema)}},Nb}function d_(){if(kb)return Rb;kb=1;const e=jh(),t=Fp(),n=fA(),r=uf().isPOJO;function o(e,t,n,i,s){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((e=>o(e,t,n,i,s)));const u={...e};i=s?i||{}:t;for(const e of Object.keys(u)){const a=s?s+"."+e:e;t.hasOwnProperty(a)||i.hasOwnProperty(e)?r(t[a])||r(i[e])?u[e]=o(u[e],t,n,i[e],a):delete u[e]:n[a]&&(u[e]=o(u[e],t,n,i[e],a))}return u}function i(e,t,n,o,s){if(null==e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((e=>i(e,t,n,o,s)));const u={...e};o=s?o||{}:t;for(const e of Object.keys(u)){const a=s?s+"."+e:e;t.hasOwnProperty(a)||o.hasOwnProperty(e)?(r(t[a])||r(o[e]))&&(u[e]=i(u[e],t,n,o[e],a)):n[a]?u[e]=i(u[e],t,n,o[e],a):delete u[e]}return u}return Rb=function(r,s,u){if(null==s)return r;if(null==r)return r;let a=null;return n(s)?a=!1:t(s)&&(a=!0),null==a?r:a?o(r,s,u=u||e(s)):i(r,s,u=u||e(s))}}function f_(){return Lb?jb:(Lb=1,jb=function(e){let t=!1;for(const n of Object.keys(e))"text"===e[n]&&(t=!0);return t})}function m_(){if(Vb)return Ub;Vb=1;const e=f_();return Ub=function(t,n,r){e(t)||r.hasOwnProperty("collation")&&!n.hasOwnProperty("collation")&&(n.collation=r.collation)}}function y_(){if(Wb)return zb;Wb=1;const e=rh(),{queryMiddlewareFunctions:t,aggregateMiddlewareFunctions:n,modelMiddlewareFunctions:r,documentMiddlewareFunctions:o}=Tf(),i=Array.from(new Set([...t,...n,...r,...o]));return zb=function(t,n,r){t.$__insertMany=n.createWrapper("insertMany",t.$__insertMany,t,{useErrorHandlers:!0,numCallbackParams:1}),n=n.filter((e=>-1!==i.indexOf(e.name)?!!e.model:!1!==e.model));for(const o of Object.keys(r))if(n.hasHooks(o)){const r=t[o];t[o]=function(){const i=arguments.length,s=i>0?arguments[i-1]:null,u="function"==typeof s?s:null,a=Array.prototype.slice.call(arguments,0,null==u?i:i-1);return e(u,(e=>{n.execPre(o,t,a,(function(i){if(null!=i)return e(i);let s=0;const u=r.apply(t,a.concat(c));function c(r,i){if(!(s++>0))return null!=r?e(r):void n.execPost(o,t,[i],(function(t){if(null!=t)return e(t);e(null,i)}))}null!=u&&"function"==typeof u.then&&u.then((e=>c(null,e)),(e=>c(e)))}))}),t.events)}}},zb}function g_(){return Gb||(Gb=1,qb=function(e,t){for(const n in t.statics)e[n]=t.statics[n]}),qb}function E_(){if(Kb)return Hb;Kb=1;const e=bf(),t=Kl();function n(e,o,i){return null==o?o:(function(e,r,o){for(const i of e.childSchemas){const e=i.model.path,s=i.schema;if(!e)continue;const u=t.get(e,r);null==u||Array.isArray(u)&&0===u.flat(1/0).length||n(s,u,o)}}(e,o,i),r(e,o,i))}function r(t,n,o){if(null==n||"object"!=typeof n)return;if(Array.isArray(n)){for(const e of n)r(t,e,o);return}if(t.discriminators&&Object.keys(t.discriminators).length>0)for(const e of Object.keys(t.discriminators)){const r=t.discriminators[e],o=r.discriminatorMapping.key,i=r.discriminatorMapping.value;if(n[o]==i){t=r;break}}const i=e(t.options.timestamps,"createdAt"),s=e(t.options.timestamps,"updatedAt"),u=o?.currentTime;let a=null;a=null!=u?u():t.base?.now?t.base.now():new Date,i&&null==n[i]&&!o?.isUpdate&&(n[i]=a),s&&(n[s]=a)}return Hb=n}function A_(){if(Qb)return Yb;Qb=1;const e=Kl();function t(r,o,i){if(null==o)return o;let s=i,u=null;if(Array.isArray(i)){s=[],u=[];for(const e of i)1===e.length?u.push(e[0]):s.push(e)}return function(r,o,i){let s=!1;for(const n of r.childSchemas){const r=n.model.path,u=n.schema;if(!r)continue;const a=e.get(r,o);if(null==a||Array.isArray(a)&&0===a.flat(1/0).length)continue;let c=null;if(Array.isArray(i)){c=[];for(const e of i)e[0]==r&&c.push(e.slice(1));if(0===c.length)continue}t(u,a,c),s=!0}i&&i.length&&!s&&n(r,o,i)}(r,o,s),n(r,o,u)}function n(e,t,r){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const o of t)n(e,o,r);else{if(e.discriminators&&Object.keys(e.discriminators).length>0)for(const n of Object.keys(e.discriminators)){const r=e.discriminators[n],o=r.discriminatorMapping.key,i=r.discriminatorMapping.value;if(t[o]==i){e=r;break}}null==r&&(r=Object.keys(e.virtuals));for(const n of r){if(null==e.virtuals[n])continue;const r=e.virtuals[n],o=Array.isArray(n)?n:-1===n.indexOf(".")?[n]:n.split(".");let i=t;for(let e=0;e<o.length-1;++e)i[o[e]]=o[e]in i?i[o[e]]:{},i=i[o[e]];let s=r.applyGetters(i[o[o.length-1]],t);r.options&&(r.options.ref||r.options.refPath)&&void 0===s&&(s=r.options.justOne?null:[]),i[o[o.length-1]]=s}}}return Yb=t}function b_(){return Xb?Jb:(Xb=1,Jb=function e(t){return this instanceof e?(this.val=t,this):new e(t)})}function __(){return e_?Zb:(e_=1,
/*!
	 * ignore
	 */
Zb=new WeakMap)}function O_(){if(o_)return r_;return o_=1,r_=
/*!
	 * ignore
	 */
function e(t,n){if(t.virtuals[n])return{virtual:t.virtuals[n],path:void 0};const r=n.split(".");let o="",i="";for(let s=0;s<r.length;++s)if(o+=(o.length>0?".":"")+r[s],t.virtuals[o]){if(s===r.length-1)return{virtual:t.virtuals[o],path:i}}else if(!t.nested[o]){if(!t.paths[o]||!t.paths[o].schema){if(t.discriminators)for(const r of Object.keys(t.discriminators)){const o=e(t.discriminators[r],n);if(o)return o}return null}{t=t.paths[o].schema;const n=r.slice(s+1).join(".");if(t.virtuals[n]){if(s===r.length-2)return{virtual:t.virtuals[n],nestedSchemaPath:[i,o].filter((e=>!!e)).join(".")};continue}if(s+1<r.length&&t.discriminators)for(const r of Object.keys(t.discriminators)){const s=e(t.discriminators[r],n);if(null!=s){const e=[i,o,s.nestedSchemaPath].filter((e=>!!e)).join(".");return{virtual:s.virtual,nestedSchemaPath:e}}}i+=(i.length>0?".":"")+o,o=""}}},r_}var C_=function(e,t){return C_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},C_(e,t)};function w_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}C_(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}"function"==typeof SuppressedError&&SuppressedError;var S_,v_,D_,M_,T_,B_,F_,$_,x_,P_,N_,I_,R_,k_,j_,L_,U_,V_,z_,W_,q_,G_,H_,K_,Y_,Q_=function(e){var t="[object "+e+"]";return function(e){return J_(e)===t}},J_=function(e){return Object.prototype.toString.call(e)},X_=function(e){return e instanceof Date?e.getTime():Z_(e)?e.map(X_):e&&"function"==typeof e.toJSON?e.toJSON():e},Z_=Q_("Array"),eO=Q_("Object"),tO=Q_("Function"),nO=function(e,t){if(null==e&&e==t)return!0;if(e===t)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))return!1;if(Z_(e)){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(!nO(e[n],t[n]))return!1;return!0}if(eO(e)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var o in e)if(!nO(e[o],t[o]))return!1;return!0}return!1},rO=function(e,t,n,r,o,i){var s=t[r];if(Z_(e)&&isNaN(Number(s))&&!function(e,t){return e.hasOwnProperty(t)&&!tO(e[t])}(e,s))for(var u=0,a=e.length;u<a;u++)if(!rO(e[u],t,n,r,u,e))return!1;return r===t.length||null==e?n(e,o,i,0===r,r===t.length):rO(e[s],t,n,r+1,s,e)},oO=function(){function e(e,t,n,r){this.params=e,this.owneryQuery=t,this.options=n,this.name=r,this.init()}return e.prototype.init=function(){},e.prototype.reset=function(){this.done=!1,this.keep=!1},e}(),iO=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r)||this;return i.children=o,i}return w_(t,e),t.prototype.reset=function(){this.keep=!1,this.done=!1;for(var e=0,t=this.children.length;e<t;e++)this.children[e].reset()},t.prototype.childrenNext=function(e,t,n,r,o){for(var i=!0,s=!0,u=0,a=this.children.length;u<a;u++){var c=this.children[u];if(c.done||c.next(e,t,n,r,o),c.keep||(s=!1),c.done){if(!c.keep)break}else i=!1}this.done=i,this.keep=s},t}(oO),sO=function(e){function t(t,n,r,o,i){var s=e.call(this,t,n,r,o)||this;return s.name=i,s}return w_(t,e),t}(iO),uO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.next=function(e,t,n,r){this.childrenNext(e,t,n,r)},t}(iO),aO=function(e){function t(t,n,r,o,i){var s=e.call(this,n,r,o,i)||this;return s.keyPath=t,s.propop=!0,s._nextNestedValue=function(e,t,n,r,o){return s.childrenNext(e,t,n,r,o),!s.done},s}return w_(t,e),t.prototype.next=function(e,t,n){rO(e,this.keyPath,this._nextNestedValue,0,t,n)},t}(iO),cO=function(e,t){if(e instanceof Function)return e;if(e instanceof RegExp)return function(t){var n="string"==typeof t&&e.test(t);return e.lastIndex=0,n};var n=X_(e);return function(e){return t(n,X_(e))}},lO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){this._test=cO(this.params,this.options.compare)},t.prototype.next=function(e,t,n){Array.isArray(n)&&!n.hasOwnProperty(t)||this._test(e,t,n)&&(this.done=!0,this.keep=!0)},t}(oO),hO=function(e){return t=function(t,n,r,o){var i=typeof X_(t),s=e(t);return new lO((function(e){var t,n=null==(t=e)?null:t;return typeof X_(n)===i&&s(n)}),n,r,o)},function(e,n,r,o){return t(e,n,r,o)};var t},pO=function(e,t,n,r){var o=r.operations[e];return o||dO(e),o(t,n,r,e)},dO=function(e){throw new Error("Unsupported operation: ".concat(e))},fO=function(e,t){for(var n in e)if(t.operations.hasOwnProperty(n)||"$"===n.charAt(0))return!0;return!1},mO=function(e,t,n,r,o){if(fO(t,o)){var i=gO(t,n,o),s=i[0];if(i[1].length)throw new Error("Property queries must contain only operations, or exact objects.");return new aO(e,t,r,o,s)}return new aO(e,t,r,o,[new lO(t,r,o)])},yO=function(e,t,n){void 0===t&&(t=null);var r=void 0===n?{}:n,o=r.compare,i=r.operations,s={compare:o||nO,operations:Object.assign({},i||{})},u=gO(e,null,s),a=u[0],c=u[1],l=[];return a.length&&l.push(new aO([],e,t,s,a)),l.push.apply(l,c),1===l.length?l[0]:new uO(e,t,s,l)},gO=function(e,t,n){var r,o=[],i=[];if(!(r=e)||r.constructor!==Object&&r.constructor!==Array&&"function Object() { [native code] }"!==r.constructor.toString()&&"function Array() { [native code] }"!==r.constructor.toString()||r.toJSON)return o.push(new lO(e,e,n)),[o,i];for(var s in e)if(n.operations.hasOwnProperty(s)){var u=pO(s,e[s],e,n);if(u&&!u.propop&&t&&!n.operations[t])throw new Error("Malformed query. ".concat(s," cannot be matched against property."));null!=u&&o.push(u)}else"$"===s.charAt(0)?dO(s):i.push(mO(s.split("."),e[s],s,e,n));return[o,i]},EO=function(e){return function(t,n,r){return e.reset(),e.next(t,n,r),e.keep}},AO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){this._test=cO(this.params,this.options.compare)},t.prototype.reset=function(){e.prototype.reset.call(this),this.keep=!0},t.prototype.next=function(e){this._test(e)&&(this.done=!0,this.keep=!1)},t}(oO),bO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){if(!this.params||"object"!=typeof this.params)throw new Error("Malformed query. $elemMatch must by an object.");this._queryOperation=yO(this.params,this.owneryQuery,this.options)},t.prototype.reset=function(){e.prototype.reset.call(this),this._queryOperation.reset()},t.prototype.next=function(e){if(Z_(e)){for(var t=0,n=e.length;t<n;t++){this._queryOperation.reset();var r=e[t];this._queryOperation.next(r,t,e,!1),this.keep=this.keep||this._queryOperation.keep}this.done=!0}else this.done=!1,this.keep=!1},t}(oO),_O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){this._queryOperation=yO(this.params,this.owneryQuery,this.options)},t.prototype.reset=function(){e.prototype.reset.call(this),this._queryOperation.reset()},t.prototype.next=function(e,t,n,r){this._queryOperation.next(e,t,n,r),this.done=this._queryOperation.done,this.keep=!this._queryOperation.keep},t}(oO),OO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){},t.prototype.next=function(e){Z_(e)&&e.length===this.params&&(this.done=!0,this.keep=!0)},t}(oO),CO=function(e){if(0===e.length)throw new Error("$and/$or/$nor must be a nonempty array")},wO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!1,t}return w_(t,e),t.prototype.init=function(){var e=this;CO(this.params),this._ops=this.params.map((function(t){return yO(t,null,e.options)}))},t.prototype.reset=function(){this.done=!1,this.keep=!1;for(var e=0,t=this._ops.length;e<t;e++)this._ops[e].reset()},t.prototype.next=function(e,t,n){for(var r=!1,o=!1,i=0,s=this._ops.length;i<s;i++){var u=this._ops[i];if(u.next(e,t,n),u.keep){r=!0,o=u.keep;break}}this.keep=o,this.done=r},t}(oO),SO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!1,t}return w_(t,e),t.prototype.next=function(t,n,r){e.prototype.next.call(this,t,n,r),this.keep=!this.keep},t}(wO),vO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.init=function(){var e=this,t=Array.isArray(this.params)?this.params:[this.params];this._testers=t.map((function(t){if(fO(t,e.options))throw new Error("cannot nest $ under ".concat(e.name.toLowerCase()));return cO(t,e.options.compare)}))},t.prototype.next=function(e,t,n){for(var r=!1,o=!1,i=0,s=this._testers.length;i<s;i++){if((0,this._testers[i])(e)){r=!0,o=!0;break}}this.keep=o,this.done=r},t}(oO),DO=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.propop=!0,i._in=new vO(t,n,r,o),i}return w_(t,e),t.prototype.next=function(e,t,n,r){this._in.next(e,t,n),Z_(n)&&!r?this._in.keep?(this.keep=!1,this.done=!0):t==n.length-1&&(this.keep=!0,this.done=!0):(this.keep=!this._in.keep,this.done=!0)},t.prototype.reset=function(){e.prototype.reset.call(this),this._in.reset()},t}(oO),MO=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propop=!0,t}return w_(t,e),t.prototype.next=function(e,t,n,r,o){o?n.hasOwnProperty(t)===this.params&&(this.done=!0,this.keep=!0):(this.done=!0,this.keep=!this.params)},t}(oO),TO=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,t.map((function(e){return yO(e,n,r)})),o)||this;return i.propop=!1,CO(t),i}return w_(t,e),t.prototype.next=function(e,t,n,r){this.childrenNext(e,t,n,r)},t}(sO),BO=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,t.map((function(e){return yO(e,n,r)})),o)||this;return i.propop=!0,i}return w_(t,e),t.prototype.next=function(e,t,n,r){this.childrenNext(e,t,n,r)},t}(sO),FO=function(e,t,n){return new lO(e,t,n)},$O=function(e,t,n,r){return new AO(e,t,n,r)},xO=function(e,t,n,r){return new wO(e,t,n,r)},PO=function(e,t,n,r){return new SO(e,t,n,r)},NO=function(e,t,n,r){return new bO(e,t,n,r)},IO=function(e,t,n,r){return new DO(e,t,n,r)},RO=function(e,t,n,r){return new vO(e,t,n,r)},kO=hO((function(e){return function(t){return null!=t&&t<e}})),jO=hO((function(e){return function(t){return t===e||t<=e}})),LO=hO((function(e){return function(t){return null!=t&&t>e}})),UO=hO((function(e){return function(t){return t===e||t>=e}})),VO=function(e,t,n){var r=e[0],o=e[1];return new lO((function(e){return X_(e)%r===o}),t,n)},zO=function(e,t,n,r){return new MO(e,t,n,r)},WO=function(e,t,n){return new lO(new RegExp(e,t.$options),t,n)},qO=function(e,t,n,r){return new _O(e,t,n,r)},GO={number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},bool:function(e){return"boolean"==typeof e},array:function(e){return Array.isArray(e)},null:function(e){return null===e},timestamp:function(e){return e instanceof Date}},HO=function(e,t,n){return new lO((function(t){if("string"==typeof e){if(!GO[e])throw new Error("Type alias does not exist");return GO[e](t)}return null!=t&&(t instanceof e||t.constructor===e)}),t,n)},KO=function(e,t,n,r){return new TO(e,t,n,r)},YO=function(e,t,n,r){return new BO(e,t,n,r)},QO=function(e,t,n){return new OO(e,t,n,"$size")},JO=function(){return null},XO=function(e,t,n){var r;if(tO(e))r=e;else{if(process.env.CSP_ENABLED)throw new Error('In CSP mode, sift does not support strings in "$where" condition');r=new Function("obj","return "+e)}return new lO((function(e){return r.bind(e)(e)}),t,n)},ZO=Object.freeze({__proto__:null,$Size:OO,$all:YO,$and:KO,$elemMatch:NO,$eq:FO,$exists:zO,$gt:LO,$gte:UO,$in:RO,$lt:kO,$lte:jO,$mod:VO,$ne:$O,$nin:IO,$nor:PO,$not:qO,$options:JO,$or:xO,$regex:WO,$size:QO,$type:HO,$where:XO}),eC=function(e,t,n){var r=void 0===n?{}:n,o=r.compare,i=r.operations;return yO(e,t,{compare:o,operations:Object.assign({},ZO,i||{})})},tC=Object.freeze({__proto__:null,$Size:OO,$all:YO,$and:KO,$elemMatch:NO,$eq:FO,$exists:zO,$gt:LO,$gte:UO,$in:RO,$lt:kO,$lte:jO,$mod:VO,$ne:$O,$nin:IO,$nor:PO,$not:qO,$options:JO,$or:xO,$regex:WO,$size:QO,$type:HO,$where:XO,EqualsOperation:lO,createDefaultQueryOperation:eC,createEqualsOperation:function(e,t,n){return new lO(e,t,n)},createOperationTester:EO,createQueryOperation:yO,createQueryTester:function(e,t){return void 0===t&&(t={}),EO(yO(e,null,t))},default:function(e,t){void 0===t&&(t={});var n=eC(e,null,t);return EO(n)}}),nC=O(tC);function rC(){if(v_)return S_;v_=1;const e=jf(),t=b_(),n=function(){if(n_)return t_;n_=1;const e=oc(),t=__(),n=Aa().modelSymbol,r=uf();t_=function i(s,u,a,c,l){const h=[],p=!(c.isVirtual&&c.justOne&&s.length>1)&&c.sort&&s.length>1,d=c.$nullIfNotFound;let f,m,y;r.isMongooseArray(s)&&(s=s.__array);let g=0;const E=s.length;if(p&&l&&void 0===c[o]){c[o]=!1;for(const e in a)if(Array.isArray(a[e])){c[o]=!0;break}}for(g=0;g<E;++g)if(y=s[g],Array.isArray(y))i(y,u,a,c,!0),h.push(y);else if(null!==y||!1!==p){if(m="Binary"===y?.constructor?.name&&4===y.sub_type&&"function"==typeof y.toUUID?String(y.toUUID()):String(y),f=u[m],c.clone&&null!=f)if(c.lean){const n=t.get(f);f=e(f),t.set(f,n)}else f=f.constructor.hydrate(f._doc);if(l)if(f)if(p){const e=a[m];c[o]?h.push(f):h[e]=f}else h.push(f);else null!=y&&null!=y[n]?h.push(y):h.push(c.retainNullValues||d?null:y);else h[g]=f||null}else h.push(y);s.length=0,h.length&&h.forEach((function(e,t){s[t]=e}))};const o=Symbol("mongoose#assignRawDocsToIdStructure#hasArray");return t_}(),r=wp(),o=O_(),i=__(),s=lf(),u=xp(),a=Kl(),c=nC.default,l=uf(),{populateModelSymbol:h}=Aa();function p(e){return Array.isArray(e)?e.some((e=>Array.isArray(e)||null===e))?e.map((e=>null==e?0:Array.isArray(e)?e.filter((e=>null!=e)).length:1)):e.filter((e=>null!=e)).length:null==e?0:1}function d(e,t,n,r){const o="function"==typeof n.transform,i=o?n.transform:e=>e;if(Array.isArray(e)){const s=[],u=e.length;for(let a=0;a<u;++a){let u=e[a];const c=Array.isArray(r)?r[a]:r;if((m(u)||n.retainNullValues&&null==u||o)&&((n.retainNullValues||null!=u)&&(o&&(u=i(m(u)?u:null,c)),f(u,t),s.push(u),t.originalLimit&&s.length>=t.originalLimit)))break}const a=s.length;for(;e.length>a;)Array.prototype.pop.apply(e,[]);let c=0;if(l.isMongooseArray(e))for(c=0;c<a;++c)e.set(c,s[c],!0);else for(c=0;c<a;++c)e[c]=s[c];return e}return m(e)||l.isPOJO(e)?(f(e,t),i(e,r)):e instanceof Map?e:!1===n.justOne?[]:i(null==e?e:null,r)}function f(e,t){null!=e&&t.excludeId&&("function"==typeof e.$__setValue?delete e._doc._id:delete e._id)}function m(e){return null!=e&&(Array.isArray(e)||e.$isMongooseMap||null!=e.$__||i.has(e))}return S_=function(f){const m=Object.assign({},r(f,"allOptions.options.options"),r(f,"allOptions.options")),y=Object.assign({},f.options,m,{justOne:f.justOne,isVirtual:f.isVirtual});y.$nullIfNotFound=f.isVirtual;const g=f.populatedModel,E=[].concat(f.rawIds);f.allIds=[].concat(f.allIds),n(f.rawIds,f.rawDocs,f.rawOrder,y);const A=f.docs,b=f.rawIds,_=f.options,O=f.count&&f.isVirtual;let C,w=0;function S(e){if(++w,O)return e;if(e instanceof t)return e.val;if(void 0===e)return e;const n=f.allIds[C];if(f.path.endsWith(".$*"))return d(e,_,y,n);if(!0===f.justOne&&Array.isArray(e)){const t=[];for(const n of e){const e=i.get(n);null!=e&&e!==g||t.push(n)}for(;e.length>t.length;)Array.prototype.pop.apply(e,[]);for(let n=0;n<t.length;++n)e[n]=t[n];return d(e[0],_,y,n)}return!1!==f.justOne||Array.isArray(e)?!0===f.justOne&&!Array.isArray(e)&&Array.isArray(n)?d(e,_,y,null==e?e:n[w-1]):d(e,_,y,n):d([e],_,y,n)}for(C=0;C<A.length;++C){w=0;const t=f.path.endsWith(".$*")?f.path.slice(0,-3):f.path,n=a.get(t,A[C],s);if(null==n&&!o(f.originalModel.schema,t))continue;let i;i=O?p(b[C]):Array.isArray(f.match)?Array.isArray(b[C])?b[C].filter((e=>null==e||c(f.match[C])(e))):[b[C]].filter((e=>null==e||c(f.match[C])(e)))[0]:b[C];const d=f.originalModel.schema,m=null!=r(A[C],"$__",null);let y=m?n instanceof Map:l.isPOJO(n);if(y=y&&r(d._getSchema(t),"$isSchemaMap"),!f.isVirtual&&y){const e=n instanceof Map?Array.from(n.keys()):Object.keys(n);i=i.reduce(((t,n,r)=>(t.set(e[r],n),t)),new Map)}if(m&&Array.isArray(i))for(const e of i)null!=e&&null!=e.$__&&(e.$__.parent=A[C]);else m&&null!=i&&null!=i.$__&&(i.$__.parent=A[C]);if(f.isVirtual&&m){A[C].$populated(t,f.justOne?E[0]:E,f.allOptions),Array.isArray(i)&&(i=i.map((e=>null==e?void 0:e))),a.set(t,i,A[C],void 0,S,!1);continue}const g=t.split(".");let _=A[C];for(let e=0;e<g.length-1&&(!Array.isArray(_)||l.isArrayIndex(g[e]))&&"$*"!==g[e];++e){if(null==_[g[e]]){const t=g.slice(0,e+1).join("."),n=d._getSchema(t);if(null==i&&null!=n&&n.$isMongooseArray)break;_[g[e]]={}}if(_=_[g[e]],"object"!=typeof _)break}A[C].$__&&(f.allOptions.options[h]=f.allOptions.model,A[C].$populated(t,f.unpopulatedValues[C],f.allOptions.options),null!=i&&null!=i.$__&&(i.$__.wasPopulated={value:f.unpopulatedValues[C]}),i instanceof Map&&!i.$isMongooseMap&&(i=new e(i,t,A[C],A[C].schema.path(t).$__schemaType))),a.set(t,i,A[C],s,S,!1),A[C].$__&&u(A[C],[f.allOptions.options])}},S_}function oC(){if(M_)return D_;M_=1;const e=b_(),t=Np(),{trusted:n}=rc(),r=mb();function o(t,n,r){return t=t.filter((t=>!(t instanceof e))),r?t.filter((e=>{try{return n.cast(e),!0}catch(e){return!1}})):t}return D_=function(e,i,s,u,a){const c=function(e){if(Array.isArray(e))return e.length>1?{$or:[].concat(e.map((e=>Object.assign({},e))))}:Object.assign({},e[0]);return Object.assign({},e)}(i);if(1===s.size){const i=Array.from(s)[0],l=u.schema.path(i);if("_id"===i&&c._id){if("_id"===i&&c._id){const t=r(c[i])?c[i]:{$eq:c[i]};c[i]={...n({$in:e}),...t}}}else e=o(e,l,a),c[i]=n({$in:e});const h=t(i);for(let t=0;t<h.length-1;++t){const r=h[t];if(null!=c[r]&&null!=c[r].$elemMatch){c[r].$elemMatch[i.slice(r.length+1)]=n({$in:e}),delete c[i];break}}}else{const t=[];Array.isArray(c.$or)?(c.$and=[{$or:c.$or},{$or:t}],delete c.$or):c.$or=t;for(const i of s)if("_id"===i&&c._id){if("_id"===i&&c._id){const t=r(c[i])?c[i]:{$eq:c[i]};c[i]={...n({$in:e}),...t}}}else{e=o(e,u.schema.path(i),a),t.push({[i]:{$in:e}})}}return c},D_}function iC(){if(B_)return T_;B_=1;
/*!
	 * ignore
	 */
const e=Ih(),t=wp(),n=Zp(),r=__(),o=Kl(),i=Aa().populateModelSymbol;return T_=function s(u,a,c,l){const h=a.path(l),p=c;if(h)return h;const d=a.discriminatorMapping&&a.discriminatorMapping.key;if(d&&null!=u)if(null!=c&&null!=c[d]){const e=n(u.discriminators,c[d]);a=e?e.schema:a}else if(null!=u.discriminators)return Object.keys(u.discriminators).reduce(((e,t)=>{const n=u.discriminators[t];return e.concat(s(n,n.schema,null,l))}),[]);const f=l.split(".");for(let e=0;e<f.length;++e)"$"===f[e]&&(f[e]="0");return function n(s,u,a,l){let h,d,f=s.length+1;for(;f--;){if(d=s.slice(0,f).join("."),h=u.path(d),null==h)continue;if(h.caster){if(h.caster instanceof e)return h.caster;let t=null;if(null!=h.schema&&null!=h.schema.discriminators){const e=h.schema.discriminators,n=d+"."+h.schema.options.discriminatorKey,r=a&&o.get(n,a)||[];t=Object.keys(e).reduce((function(t,n){const o=e[n].discriminatorMapping.value;return null!=c&&-1===r.indexOf(n)&&-1===r.indexOf(o)||t.push(e[n]),t}),[])}if(f!==s.length&&h.schema){let e;if("$"===s[f])return f+1===s.length?h:(e=n(s.slice(f+1),u,a?o.get(d,a):null,l.concat(s.slice(0,f))),e&&(e.$parentSchemaDocArray=e.$parentSchemaDocArray||(h.schema.$isSingleNested?null:h)),e);if(null!=t&&t.length>0){e=[];for(const r of t){const t=n(s.slice(f),r,a?o.get(d,a):null,l.concat(s.slice(0,f)));null!=t&&(t.$parentSchemaDocArray=t.$parentSchemaDocArray||(h.schema.$isSingleNested?null:h),t.$parentSchemaDocArray&&(e.$parentSchemaDocArray=t.$parentSchemaDocArray),e.push(t))}return e}return e=n(s.slice(f),h.schema,a?o.get(d,a):null,l.concat(s.slice(0,f))),e&&(e.$parentSchemaDocArray=e.$parentSchemaDocArray||(h.schema.$isSingleNested?null:h)),e}if(f!==s.length&&h.$isMongooseArray&&h.casterConstructor.$isMongooseArray){let e=h;for(;e.$isMongooseArray&&!e.$isMongooseDocumentArray;)e=e.casterConstructor;const t=n(s.slice(f),e.schema,null,l.concat(s.slice(0,f)));if(null!=t)return t;if(e.schema.discriminators){const t=[];for(const r of Object.keys(e.schema.discriminators)){const o=e.schema.discriminators[r]||e.schema,i=n(s.slice(f),o,null,l.concat(s.slice(0,f)));null!=i&&t.push(i)}if(t.length>0)return t}}}else if(h.$isSchemaMap&&h.$__schemaType instanceof e)return h.$__schemaType;const m=l.concat([d]).join(".");if(null!=p&&p.$__&&p.$populated(m,!0)&&f<s.length){const e=p.$populated(m,!0).options[i];if(null!=e){return n(s.slice(f),e.schema,a?o.get(d,a):null,l.concat(s.slice(0,f)))}}const y=t(p,d);if(null!=y){const e=Array.isArray(y)&&y.length>0?r.get(y[0]):r.get(y),t=null!=e?e.schema:null;if(null!=t){const e=n(s.slice(f),t,a?o.get(d,a):null,l.concat(s.slice(0,f)));if(null!=e)return e.$parentSchemaDocArray=e.$parentSchemaDocArray||(t.$isSingleNested?null:t),e}}return h}}(f,a,c,[])},T_}function sC(){if($_)return F_;$_=1;const e=dl(),t=b_(),n=oc(),r=wp(),o=Zp(),i=_a(),s=iC(),u=O_(),a=lf(),c=Kl(),l=hf(),h=uf(),p=Aa().modelSymbol,d=Aa().populateModelSymbol,f=Nh().schemaMixedSymbol,m=pl();
/*!
	 * ignore
	 */
function y(e,t,o,i,s,u,a,c,l,f){const m=null!=s.connection?s.connection:e.db;if(f=void 0===f?a:f,Array.isArray(f)&&(f=h.cloneArrays(f)),null==i)return;const y=h.array.flatten(i);let A=y.length;for(;A--;){let e,b=y[A];if(null==b)continue;if(s.model&&s.model[p])e=s.model;else if(b[p])e=b,b=e.modelName;else try{e=g(m,b)}catch(t){if(void 0!==a)throw t;e=null}let _=a;const O=u.modelNamesInOrder?u.modelNamesInOrder:i;u.isRefPath&&Array.isArray(a)&&a.length===O.length&&(_=E(a,O,b));const C=null==s.perDocumentLimit?r(s,"options.perDocumentLimit",null):s.perDocumentLimit;if(o[b]&&null==C)o[b].localField.add(u.localField),o[b].foreignField.add(u.foreignField),o[b].docs.push(c),o[b].ids.push(_),o[b].allIds.push(a),o[b].unpopulatedValues.push(f),u.hasMatchFunction&&o[b].match.push(u.match);else{const i={model:e};u.isVirtual&&r(u.virtual,"options.options")?i.options=n(u.virtual.options.options):null!=l&&(i.options=Object.assign({},l)),h.merge(i,s),s[d]=e,i[d]=e,o[b]={model:e,options:i,match:u.hasMatchFunction?[u.match]:u.match,docs:[c],ids:[_],allIds:[a],unpopulatedValues:[f],localField:new Set([u.localField]),foreignField:new Set([u.foreignField]),justOne:u.justOne,isVirtual:u.isVirtual,virtual:u.virtual,count:u.count,[d]:e},t.push(o[b])}}}function g(e,t){return null==e.models[t]&&null!=e._parent?g(e._parent,t):e.model(t)}function E(e,t,n){return Array.isArray(t)?Array.isArray(e)&&Array.isArray(t)?e.flatMap(((e,r)=>E(e,t[r],n))):[]:t===n?Array.isArray(e)?h.array.flatten(e):[e]:[]}
/*!
	 * ignore
	 */function A(e,t){return"function"!=typeof e||e[p]?e:e.call(t,t)}
/*!
	 * ignore
	 */function b(e,t,n,o,i,s){const u=n.schema._getPathType(t),l="real"===u?n.schema.path(t):u.schema,p=l&&l.getters?l.getters:[];t=null!=l&&"Embedded"===l.instance?t+"._id":t;const d=r(o,"options",{}),f="getters"in d?d.getters:r(i,"options.getters",!1);if(0!==p.length&&f){const r=null!=e.$__?e:n.hydrate(e),o=h.getValue(t,e);if(Array.isArray(o)){const e=h.getValue(t.split(".").slice(0,-1),r);return o.map(((t,n)=>l.applyGetters(t,e[n])))}return l.applyGetters(o,r)}return _(c.get(t,e,a),s)}function _(e,t){if(null!=e&&null!=e.$__)return e._doc._id;if(null!=e&&null!=e._id&&(null==t||!t.$isSchemaMap))return e._id;if(Array.isArray(e)){const t=null!=e.__array?e.__array:e;for(let e=0;e<t.length;++e)null!=t[e]&&null!=t[e].$__&&(t[e]=t[e]._doc._id);return h.isMongooseArray(e)&&e.$schema()?e.$schema()._castForPopulate(e,e.$parent()):[].concat(e)}if("Object"===i(e)&&(null==t||null==t[f])){const t=[];for(const n of Object.keys(e))t.push(e[n]);return t}return e instanceof Map?Array.from(e.values()):e}
/*!
	 * ignore
	 */function O(e,n,r,o,i,s){if(!r.isRefPath||null==i)return;const u=i.split(".");let a,c="";for(let i=0;i<u.length;++i){const l=u[i];c=c+(0===c.length?"":".")+l;const p=n.path(c);if(null!=p&&p.$isMongooseArray&&null!=p.caster.discriminators&&0!==Object.keys(p.caster.discriminators).length){const n=h.getValue(c,e),l=o.path.substring(c.length+1),d=p.caster.schema.options.discriminatorKey;a=[];for(const e of n){const n=h.getValue(d,e),o=p.caster.discriminators[n],f=o&&o.schema;if(null==f)continue;const m=f.path(l);if(null==m||null==m.options.refPath){const n=h.getValue(r.localField.substring(c.length+1),e);s.forEach(((e,r)=>{e===n&&(s[r]=t(e))}));continue}const y=h.getValue(u.slice(i+1).join("."),e);a.push(y)}}}return a}function C(t){if(null!=t&&"object"==typeof t)for(const n of Object.keys(t)){if("$where"===n)throw new e("Cannot use $where filter with populate() match");null!=t[n]&&"object"==typeof t[n]&&C(t[n])}}return F_=function(t,n,i){let p;const d=n.length,E=[],w=i.model&&i.model.modelName||i.model;let S,v,D;const M={},T=t.schema;if(null!=i._localModel&&i._localModel.schema.nested[i.path])return[];const B=u(t.schema,i.path);if(null!=(null==B?null:B.virtual))
/*!
	 * ignore
	 */
return function(t,n,o,i){const s=[],u={},l=i.virtual;for(const h of n){let n=null;const p={};let d;const f=i.nestedSchemaPath?i.nestedSchemaPath+".":"";d="string"==typeof o.localField?o.localField:"function"==typeof l.options.localField?f+l.options.localField.call(h,h):Array.isArray(l.options.localField)?l.options.localField.map((e=>f+e)):f+l.options.localField,p.count=l.options.count,null==l.options.skip||o.hasOwnProperty("skip")||(o.skip=l.options.skip),null==l.options.limit||o.hasOwnProperty("limit")||(o.limit=l.options.limit),null==l.options.perDocumentLimit||o.hasOwnProperty("perDocumentLimit")||(o.perDocumentLimit=l.options.perDocumentLimit);let m=l.options.foreignField;if(!d||!m)return new e(`Cannot populate virtual \`${o.path}\` on model \`${t.modelName}\`, because options \`localField\` and / or \`foreignField\` are missing`);"function"==typeof d&&(d=d.call(h,h)),"function"==typeof m&&(m=m.call(h,h)),p.isRefPath=!1;let g=null;"justOne"in o&&void 0!==o.justOne&&(g=o.justOne),n=l._getModelNamesForPopulate(h),l.options.refPath?(g=!!l.options.justOne,p.isRefPath=!0):l.options.ref&&(g=!!l.options.justOne),p.isVirtual=!0,p.virtual=l,p.justOne=g;const E=r(p,"virtual.options.match",null)||r(p,"virtual.options.options.match",null);let A=r(o,"match",null)||E,O="function"==typeof A;if(O&&(A=A.call(h,h,p.virtual)),Array.isArray(d)&&Array.isArray(m)&&d.length===m.length){A=Object.assign({},A);for(let e=1;e<d.length;++e)A[m[e]]=_(c.get(d[e],h,a),t.schema),O=!0;d=d[0],m=m[0]}p.localField=d,p.foreignField=m,p.match=A,p.hasMatchFunction=O,C(A);const w=b(h,d,t,o,l);try{y(t,s,u,n,o,p,w,h)}catch(e){return e}}return s}(t,n,i,B);let F=s(t,T,null,i.path);F=Array.isArray(F)?F:[F].filter((e=>null!=e));if(!(!1===i.strictPopulate||!1===i.options?.strictPopulate)&&0===F.length&&null!=i._localModel)return new m(i._fullPath||i.path);for(let o=0;o<d;o++){p=n[o];let u=null;if(null!=p.$__&&p.populated(i.path)){if(!1===(null!=i.forceRepopulate?i.forceRepopulate:p.constructor.base.options.forceRepopulate))continue}const a=null!=p&&null!=p.$__?p.$__schema:T;if(S=s(t,a,p,i.path),null!=S&&S.$isMongooseDocumentArray&&null==S.options.ref&&null==S.options.refPath)continue;if(S&&S.$parentSchemaDocArray&&null!=r(i,"options.sort"))return new e("Cannot populate with `sort` on path "+i.path+" because it is a subproperty of a document array");D=null;let l=!1,d=null,m=null,g=null;if(null!=S&&"Embedded"===S.instance){if(S.options.ref){const e={localField:i.path+"._id",foreignField:"_id",justOne:!0},n=$(p,S,w,t),r=c.get(i.path,p),o=c.get("_id",r);y(t,E,M,n.modelNames,i,e,o,p,m,r)}continue}if(Array.isArray(S)){const e=S;for(const n of e){let e,r;try{r=$(p,n,w,t),e=r.modelNames,l=l||r.isRefPath,d=d||r.refPath,u=r.justOne}catch(e){return e}if((!l||r.isRefPath)&&e){D=D||[];for(const t of e)-1===D.indexOf(t)&&D.push(t)}}}else{try{const e=$(p,S,w,t);D=e.modelNames,l=e.isRefPath,d=d||e.refPath,u=e.justOne,m=r(S,"options.populate",null),l&&(g=D,D=Array.from(new Set(D)))}catch(e){return e}if(!D)continue}const A={},_=i.path,v="_id";if("justOne"in i&&void 0!==i.justOne?u=i.justOne:S&&!S[f]&&(i.path.endsWith("."+S.path)||i.path===S.path)&&(u=Array.isArray(S)?S.every((e=>!e.$isMongooseArray)):!S.$isMongooseArray),!D)continue;A.isVirtual=!1,A.justOne=u,A.localField=_,A.foreignField=v;const B=b(p,_,t,i,null,S),F=String(h.getValue(v,p));i._docs[F]=Array.isArray(B)?B.slice():B;let x=r(i,"match",null);const P="function"==typeof x;if(P&&(x=x.call(p,p)),C(x),A.match=x,A.hasMatchFunction=P,A.isRefPath=l,A.modelNamesInOrder=g,l){D=O(p,T,A,i,d,B)||D}try{y(t,E,M,D,i,A,B,p,m)}catch(e){return e}}return E;function $(e,t,n,s){let u,p=!1,d=null;const m=t;t&&"Array"===t.instance&&(t=t.caster),t&&t.$isSchemaMap&&(t=t.$__schemaType);const y=t&&t.options&&t.options.ref;if(v=t&&t.options&&t.options.refPath,null!=t&&t[f]&&!y&&!v&&!n)return{modelNames:null};if(n)u=[n];else if(null!=v){if("function"==typeof v){const n=i.path.slice(0,i.path.length-t.path.length-1),r=c.get(n,e,a),o=Array.isArray(r)?h.array.flatten(r):r?[r]:[];u=new Set;for(const t of o)v=v.call(t,t,i.path),l(v,e,i.path,T,i._queryProjection).forEach((e=>u.add(e)));u=Array.from(u)}else u=l(v,e,i.path,T,i._queryProjection);p=!0}else{let n,f,y,E,b=s;const _=s.schema.options.discriminatorKey;if(!t&&_&&(E=h.getValue(_,e))){const e=o(s.discriminators,E)||s;if(null!=e)b=e;else try{b=g(s.db,E)}catch(e){return e}y=b.schema._getSchema(i.path),y&&y.caster&&(y=y.caster)}else y=t;if(m&&m.path.endsWith(".$*")?d=!m.$isMongooseArray&&!m._arrayPath:null!=y&&(d=!y.$isMongooseArray&&!y._arrayPath),null!=(n=r(y,"options.ref")))if(null!=y&&"function"==typeof n&&i.path.endsWith("."+y.path)){u=new Set;const t=i.path.slice(0,i.path.length-y.path.length-1),r=c.get(t,e,a),o=Array.isArray(r)?h.array.flatten(r):r?[r]:[];for(const e of o)u.add(A(n,e));u=0===o.length?[A(n,e)]:Array.from(u)}else n=A(n,e),u=[n];else null!=(y=r(t,"options.refPath"))&&(p=!0,u=l(f,e,i.path,T,i._queryProjection))}if(!u){if(null!=i._localModel)return{modelNames:u,justOne:d,isRefPath:p,refPath:v};u=[s.modelName]}return Array.isArray(u)||(u=[u]),{modelNames:u,justOne:d,isRefPath:p,refPath:v}}},F_}function uC(){if(P_)return x_;P_=1;const e=wp();return x_=function(t){if(Array.isArray(t)){const e=Object.keys(t[0]);return 1===e.length&&"_id"===e[0]&&"hashed"!==t[0]._id}if("object"!=typeof t)return!1;const n=e(t,"key",{});return 1===Object.keys(n).length&&n.hasOwnProperty("_id")}}function aC(){if(I_)return N_;I_=1;const e=wp(),t=uf();return N_=function(n,r,o){if(null!=o.textIndexVersion){delete o.key._fts,delete o.key._ftsx;const t={...o.weights,...o.key};if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const o of Object.keys(t)){if(!(o in n))return!1;const i=t[o];if(i!==e(r,"weights."+o)&&(1!==i||null!=e(r,"weights."+o)))return!1}return r.default_language===o.default_language||"english"===o.default_language&&null==r.default_language}const i=["unique","partialFilterExpression","sparse","expireAfterSeconds","collation"];for(const n of i)if(n in r||n in o)if("collation"===n){if(null==r[n]||null==o[n])return null==r[n]&&null==o[n];const t=Object.keys(r.collation),i=r.collation,s=o.collation;for(const n of t)if(e(i,n)!==e(s,n))return!1}else if(!t.deepEqual(r[n],o[n]))return!1;const s=Object.keys(n),u=Object.keys(o.key);if(s.length!==u.length)return!1;for(let e=0;e<s.length;++e){if(s[e]!==u[e])return!1;if(!t.deepEqual(n[s[e]],o.key[u[e]]))return!1}return!0},N_}function cC(){return k_?R_:(k_=1,R_=function(e,t){if(null==t.timeseries)return!1;const{timeField:n,metaField:r}=t.timeseries;return"string"==typeof n&&"string"==typeof r&&(2===Object.keys(e.key).length&&1===e.key[n]&&1===e.key[r])})}function lC(){if(V_)return U_;return V_=1,U_=
/*!
	 * ignore
	 */
function(e,t,n){let r=0,o=0,i=null;if(t<=0)throw new Error("Limit must be positive");if(0===e.length)return n(null,[]);for(let n=0;n<e.length&&n<t;++n)s();function s(){var t;e[o+r]((t=o+r,(a,c)=>{if(--r,++o,null==i){if(null!=a)return i=a,n(i);if(u[t]=c,o===e.length)return n(null,u);o+r<e.length&&s()}})),++r}const u=[]},U_}function hC(){return W_?z_:(W_=1,z_=function e(t,n,r){if(null!=n)for(let o=0;o<n.length;++o)Array.isArray(n[o])?e(t,n[o],r+"."+o):t.push(r+"."+o)})}function pC(){if(G_)return q_;G_=1;const e=wp(),t=Kl(),n=db();
/*!
	 * ignore
	 */
return q_=function(r,o,i){const s=n(e(o,"select",null),!0)||n(e(o,"options.select",null),!0);if(null!=s)for(const e of r)if(s.hasOwnProperty("-"+e))for(const n of i)null!=n.$__?t.unset(e,n._doc):t.unset(e,n)},q_}
/*!
 * Module dependencies.
 */function dC(){return Y_||(Y_=1,function(e){
/*!
		 * Module dependencies.
		 */
const r=c_(),o=sc(),i=sf(),s=Xc(),u=t.EventEmitter,a=lc(),c=xg(),l=dl(),h=kh(),p=il(),d=bb(),f=function(){if(Bb)return Tb;Bb=1;const e=oc();class t{constructor(t){null!=t&&Object.assign(this,e(t))}}return t.prototype.__subdocs=null,Tb=t}(),m=$g(),y=tl(),g=rl(),E=ol(),A=Uh(),_=l_(),O=h_(),C=Bf(),w=p_(),S=d_(),v=cA(),D=m_(),M=y_(),T=g_(),B=E_(),F=lA(),$=A_(),x=rC(),P=OE(),N=oc(),I=oC(),R=bE(),k=Vg(),j=vp(),L=Zy(),U=cy(),V=wp(),z=_a(),W=Zp(),q=sC(),G=ha(),H=Ma().internalToObjectOptions,K=uC(),Y=aC(),Q=cC(),{getRelatedDBIndexes:J,getRelatedSchemaIndexes:X}=function(){if(L_)return j_;L_=1;const e=mb();function t({baseModelName:t,discriminatorMapping:r,indexes:o,indexesType:i}){const s=r&&r.key,u=r&&r.value;return s?Boolean(t)?o.filter((e=>{const t=n(e,i);return t&&t[s]===u})):o.filter((t=>{const r=n(t,i);return!r||!r[s]||e(r[s])&&!("$eq"in r[s])})):o}function n(e,t){if("schema"===t){const t=e[1];return t&&t.partialFilterExpression}return e.partialFilterExpression}return j_={getRelatedSchemaIndexes:function(e,n){return t({baseModelName:e.baseModelName,discriminatorMapping:e.schema.discriminatorMapping,indexes:n,indexesType:"schema"})},getRelatedDBIndexes:function(e,n){return t({baseModelName:e.baseModelName,discriminatorMapping:e.schema.discriminatorMapping,indexes:n,indexesType:"db"})}},j_}(),Z=ff(),ee=ed(),te=__(),ne=lC(),re=u_(),oe=hC(),ie=pC(),se=EE(),ue=n,ae=uf(),ce=Pp(),le=function(){if(K_)return H_;K_=1;const e=pa();class t extends e{constructor(e,t,n){const r=n?.matchedCount??0,o=n?.insertedCount??0;let i=t.map((e=>e._id)).join(", ");i.length>100&&(i=i.slice(0,100)+"...");const s=t.length-r-o;super(`${e}.bulkSave() was not able to update ${s} of the given documents due to incorrect version or optimistic concurrency, document ids: ${i}`),this.modelName=e,this.documents=t,this.bulkWriteResult=n,this.numDocumentsNotUpdated=s}}return Object.defineProperty(t.prototype,"name",{value:"MongooseBulkSaveIncompleteError"}),
/*!
	 * exports
	 */
H_=t}(),he=Rh(),pe=CE(),de=Symbol("mongoose#Model#collection"),fe=Symbol("mongoose#Model#db"),me=Aa().modelSymbol,ye=Symbol("mongoose#Model#subclassed"),{VERSION_INC:ge,VERSION_WHERE:Ee,VERSION_ALL:Ae}=i,be=Object.assign({},H,{bson:!0});function _e(e,t,n){if(t instanceof m)throw new TypeError("2nd argument to `Model` constructor must be a POJO or string, **not** a schema. Make sure you're calling `mongoose.model()`, not `mongoose.Model()`.");if("string"==typeof e)throw new TypeError("First argument to `Model` constructor must be an object, **not** a string. Make sure you're calling `mongoose.model()`, not `mongoose.Model()`.");i.call(this,e,t,n)}
/*!
		 * ignore
		 */
function Oe(e,t){if(null!=e.$where)for(const n of Object.keys(e.$where))t[n]=e.$where[n]}
/*!
		 * ignore
		 */function Ce(e,t){if(null==e||e===b)throw new l("`Model."+t+"()` cannot run without a model as `this`. Make sure you are calling `MyModel."+t+"()` where `MyModel` is a Mongoose model.");if(null==e[me])throw new l("`Model."+t+"()` cannot run without a model as `this`. Make sure you are not calling `new Model."+t+"()`")}
/*!
		 * Give the constructor the ability to emit events.
		 */Object.setPrototypeOf(_e.prototype,i.prototype),_e.prototype.$isMongooseModelPrototype=!0,_e.prototype.db,_e.useConnection=function(e){if(!e)throw new Error("Please provide a connection.");this.db&&(delete this.db.models[this.modelName],delete this.prototype.db,delete this.prototype[fe],delete this.prototype.collection,delete this.prototype.$collection,delete this.prototype[de]),this.db=e;const t=e.collection(this.modelName,e.options);return this.prototype.collection=t,this.prototype.$collection=t,this.prototype[de]=t,this.prototype.db=e,this.prototype[fe]=e,this.collection=t,this.$__collection=t,e.models[this.modelName]=this,this},_e.prototype.collection,_e.prototype.$__collection,_e.prototype.modelName,_e.prototype.$where,_e.prototype.baseModelName,_e.events,_e._middleware,_e.prototype.$__handleSave=function(e,t){const n={};F(this.$__schema,e),void 0!==e.writeConcern?(n.writeConcern={},"w"in e.writeConcern&&(n.writeConcern.w=e.writeConcern.w),"j"in e.writeConcern&&(n.writeConcern.j=e.writeConcern.j),"wtimeout"in e.writeConcern&&(n.writeConcern.wtimeout=e.writeConcern.wtimeout)):("w"in e&&(n.w=e.w),"j"in e&&(n.j=e.j),"wtimeout"in e&&(n.wtimeout=e.wtimeout)),"checkKeys"in e&&(n.checkKeys=e.checkKeys);const r=this.$session(),o=this[fe].base.transactionAsyncLocalStorage?.getStore();if(null!=r?n.session=r:e.hasOwnProperty("session")||null==o?.session||(n.session=o.session),this.$isNew){const e=this.toObject(be);return void 0===(e||{})._id?void G((function(){t(new l("document must have an _id before saving"))})):(this.$__version(!0,e),this[de].insertOne(e,n).then((e=>t(null,e)),(e=>{Se(this,!0),t(e,null)})),this.$__reset(),Se(this,!1),void(this.$__.inserting=!0))}this.$__.inserting=!1;const i=this.$__delta();if(e.pathsToSave)for(const t in i[1].$set)e.pathsToSave.includes(t)||e.pathsToSave.some((e=>t.slice(0,e.length)===e&&"."===t.charAt(e.length)))||delete i[1].$set[t];if(i){{if(i instanceof l)return void t(i);const e=this.$__where(i[0]);if(e instanceof l)return void t(e);Oe(this,e);const r=i[1];if(this.$__schema.options.minimize)for(const e of Object.values(r))if(null!=e)for(const t of Object.keys(e))null!=e[t]&&"object"==typeof e[t]&&ae.isPOJO(e[t])&&(ce(e[t]),0===Object.keys(e[t]).length&&(delete e[t],r.$unset=r.$unset||{},r.$unset[t]=1));this[de].updateOne(e,r,n).then((n=>{null==n?n={$where:e}:n.$where=e,t(null,n)}),(e=>{this.$__undoReset(),t(e)}))}this.$__.modifiedPaths=this.modifiedPaths(),this.$__reset(),Se(this,!1)}else(function(){const r=Object.assign({},e,n),o=this.$__where(),i=this.$__schema.options.optimisticConcurrency;if(i&&!Array.isArray(i)){const e=this.$__schema.options.versionKey,t=this.$__getValue(e);null!=t&&(o[e]=t)}v(this.$__schema,r),this.constructor.collection.findOne(o,r).then((e=>{t(null,{$where:o,matchedCount:e?1:0})})).catch(t)}).call(this)},
/*!
		 * ignore
		 */
_e.prototype.$__save=function(e,t){this.$__handleSave(e,((n,r)=>{if(n){n=this.$__schema._transformDuplicateKeyError(n);return this.$__schema.s.hooks.execPost("save:error",this,[this],{error:n},(e=>{t(e,this)}))}let o=0;if(0!==(null!=e?null!=e.writeConcern?e.writeConcern.w:e.w:0)){null!=r&&(o=Array.isArray(r)?r.length:null!=r.matchedCount?r.matchedCount:r);if(this.$__.version&&!this.$__.inserting){const e=ge===(ge&this.$__.version);this.$__.version=void 0;const n=this.$__schema.options.versionKey,r=this.$__getValue(n)||0;if(o<=0){this.$__undoReset();const e=this.$__.$versionError||new g(this,r,this.$__.modifiedPaths);return t(e)}e&&this.$__setValue(n,r+1)}if(null!=r&&o<=0){this.$__undoReset(),n=new s(r.$where,this.constructor.modelName,o,r);return this.$__schema.s.hooks.execPost("save:error",this,[this],{error:n},(e=>{t(e,this)}))}}this.$__.saving=void 0,this.$__.savedState={},this.$emit("save",this,o),this.constructor.emit("save",this,o),t(null,this)}))},_e.prototype.save=async function(e){if("function"==typeof e||"function"==typeof arguments[1])throw new l("Model.prototype.save() no longer accepts a callback");let t;if(this.$op="save",this.$__.saving?t=new E(this):this.$__.saving=new E(this),(e=new f(e)).hasOwnProperty("session")&&this.$session(e.session),null!=this.$__.timestamps&&(e.timestamps=this.$__.timestamps),this.$__.$versionError=
/*!
		 * ignore
		 */
function(e,t){const n=e.$__schema.options.versionKey;if(!n)return null;const r=e.$__getValue(n)||0;return new g(e,r,t)}(this,this.modifiedPaths()),t)throw this.$__handleReject(t),t;return this.$__.saveOptions=e,await new Promise(((t,n)=>{this.$__save(e,(e=>{if(this.$__.saving=null,this.$__.saveOptions=null,this.$__.$versionError=null,this.$op=null,null!=e)return this.$__handleReject(e),n(e);t()}))})),this},_e.prototype.$save=_e.prototype.save,_e.prototype.$__version=function(e,t){const n=this.$__schema.options.versionKey;if(!0!==e){if(!1!==n&&this.$__isSelected(n)){if(Ee===(Ee&this.$__.version)){const t=this.$__getValue(n);null!=t&&(e[n]=t)}ge===(ge&this.$__.version)&&(null!=V(t.$set,n,null)?++t.$set[n]:(t.$inc=t.$inc||{},t.$inc[n]=1))}}else n&&(se(t,n,0),this.$__setValue(n,0))},_e.prototype.increment=function(){return this.$__.version=Ae,this},_e.prototype.$__where=function(e){return e||(e={}),e._id||(e._id=this._doc._id),void 0===this._doc._id?new l("No _id found on document!"):e},_e.prototype.deleteOne=function(e){if("function"==typeof e||"function"==typeof arguments[1])throw new l("Model.prototype.deleteOne() no longer accepts a callback");e||(e={}),e.hasOwnProperty("session")&&this.$session(e.session);const t=this,n=this.$__where();if(n instanceof Error)throw n;const r=t.constructor.deleteOne(n,e);return null!=this.$session()&&("session"in r.options||(r.options.session=this.$session())),r.pre((function(e){t.constructor._middleware.execPre("deleteOne",t,[t],e)})),r.pre((function(e){U(t.$getAllSubdocs(),((e,t)=>{e.constructor._middleware.execPre("deleteOne",e,[e],t)}),e)})),r.pre((function(e){return t.$__.isDeleted?e(a.skipWrappedFunction()):e()})),r.post((function(e){U(t.$getAllSubdocs(),((e,t)=>{e.constructor._middleware.execPost("deleteOne",e,[e],{},t)}),e)})),r.post((function(e){t.constructor._middleware.execPost("deleteOne",t,[t],{},e)})),r},_e.prototype.$model=function(e){return 0===arguments.length?this.constructor:this[fe].model(e)},_e.prototype.model=_e.prototype.$model,_e.exists=function(e,t){if(Ce(this,"exists"),"function"==typeof arguments[2])throw new l("Model.exists() no longer accepts a callback");return this.findOne(e).select({_id:1}).lean().setOptions(t)},_e.discriminator=function(e,t,n){let r;if("function"==typeof e&&(r=e,e=ae.getFunctionName(r),!(r.prototype instanceof _e)))throw new l("The provided class "+e+" must extend Model");n=n||{};const o=ae.isPOJO(n)?n.value:n,i="boolean"!=typeof n.clone||n.clone,s="boolean"!=typeof n.mergePlugins||n.mergePlugins,u="boolean"==typeof n.overwriteModels&&n.overwriteModels;if(Ce(this,"discriminator"),ae.isObject(t)&&!t.instanceOfSchema&&(t=new m(t)),t instanceof m&&i&&(t=t.clone()),t=L(this,e,t,o,s,n.mergeHooks,u),this.db.models[e]&&!t.options.overwriteModels&&!u)throw new p(e);t.$isRootDiscriminator=!0,t.$globalPluginsApplied=!0,r=this.db.model(r||e,t,this.$__collection.name),this.discriminators[e]=r;const a=this.discriminators[e];if(Object.setPrototypeOf(a.prototype,this.prototype),Object.defineProperty(a,"baseModelName",{value:this.modelName,configurable:!0,writable:!1}),w(a,t),T(a,t),null!=this[ye])for(const n of this[ye])n.discriminators=n.discriminators||{},n.discriminators[e]=r.__subclass(r.db,t,n.collection.name);return a};for(const e in u.prototype)_e[e]=u.prototype[e];async function we(e,t,n){if(0===e.length)return[];const r=t.$__collection;return n&&n.hideIndexes?await Promise.all(e.map((e=>t.db.db.command({collMod:r.collectionName,index:{name:e,hidden:!0}})))):await Promise.all(e.map((e=>r.dropIndex(e)))),e}
/*!
		 * ignore
		 */
function Se(e,t){e.$isNew=t,e.$emit("isNew",t),e.constructor.emit("isNew",t);const n=e.$getAllSubdocs({useCache:!0});for(const e of n)e.$isNew=t,e.$emit("isNew",t)}function ve(e,t,n,r,o){const s=new e.Query({},{},e,e.collection);n=n instanceof i?n.toObject():N(n),o="function"==typeof o?o:N(o);const u=e&&e.schema&&e.schema.options&&e.schema.options.versionKey||null;return R(r,o,u),s[t](n,r,o)}_e.init=function(){if(Ce(this,"init"),"function"==typeof arguments[0])throw new l("Model.init() no longer accepts a callback");if(this.schema.emit("init",this),null!=this.$init)return this.$init;const e=this.db,t=async()=>{if(ae.getOption("autoIndex",this.schema.options,e.config,e.base.options))return await this.ensureIndexes({_automatic:!0})},n=async()=>{if(!ae.getOption("autoSearchIndex",this.schema.options,e.config,e.base.options))return;const t=[];for(const e of this.schema._searchIndexes)t.push(await this.createSearchIndex(e));return t};this.$init=(async()=>{let t=ae.getOption("autoCreate",this.schema.options,e.config);if(null==t&&(await e._waitForConnect(!0),t=ae.getOption("autoCreate",this.schema.options,e.config,e.base.options)),t)return await this.createCollection()})().then((()=>t())).then((()=>n()));const r=this.$init.catch,o=this;return this.$init.catch=function(){return o.$caught=!0,r.apply(o.$init,arguments)},this.$init},_e.createCollection=async function(e){if(Ce(this,"createCollection"),"function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.createCollection() no longer accepts a callback");const t=await new Promise(((t,n)=>{this.hooks.execPre("createCollection",this,[e],(e=>{if(null!=e)return e instanceof a.skipWrappedFunction?t(!0):n(e);t()}))})),n=this&&this.schema&&this.schema.options&&this.schema.options.collectionOptions;null!=n&&(e=Object.assign({},n,e));const r=this&&this.schema&&this.schema.options&&this.schema.options.collation;null!=r&&(e=Object.assign({collation:r},e));const o=this&&this.schema&&this.schema.options&&this.schema.options.capped;null!=o&&("number"==typeof o?e=Object.assign({capped:!0,size:o},e):"object"==typeof o&&(e=Object.assign({capped:!0},o,e)));const i=this&&this.schema&&this.schema.options&&this.schema.options.timeseries;null!=i&&(null!=(e=Object.assign({timeseries:i},e)).expireAfterSeconds||(null!=e.expires?ae.expires(e):null!=this.schema.options.expireAfterSeconds?e.expireAfterSeconds=this.schema.options.expireAfterSeconds:null!=this.schema.options.expires&&(e.expires=this.schema.options.expires,ae.expires(e))));const s=this&&this.schema&&this.schema.options&&this.schema.options.clusteredIndex;null!=s&&(e=Object.assign({clusteredIndex:{...s,unique:!0}},e));try{t||await this.db.createCollection(this.$__collection.collectionName,e)}catch(e){null==e||"MongoServerError"===e.name&&48===e.code||await new Promise(((t,n)=>{const r={error:e};this.hooks.execPost("createCollection",this,[null],r,(e=>{if(null!=e)return n(e);t()}))}))}return await new Promise(((e,t)=>{this.hooks.execPost("createCollection",this,[this.$__collection],(n=>{if(null!=n)return t(n);e()}))})),this.$__collection},_e.syncIndexes=async function(e){if(Ce(this,"syncIndexes"),"function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.syncIndexes() no longer accepts a callback");if(e?.autoCreate??this.schema.options?.autoCreate??this.db.config.autoCreate??!0)try{await this.createCollection()}catch(e){if(null!=e&&("MongoServerError"!==e.name||48!==e.code))throw e}const t=await this.diffIndexes({indexOptionsToCreate:!0}),n=await this.cleanIndexes({...e,toDrop:t.toDrop});return await this.createIndexes({...e,toCreate:t.toCreate}),n},_e.createSearchIndex=async function(e){return Ce(this,"createSearchIndex"),await this.$__collection.createSearchIndex(e)},_e.updateSearchIndex=async function(e,t){return Ce(this,"updateSearchIndex"),await this.$__collection.updateSearchIndex(e,t)},_e.dropSearchIndex=async function(e){return Ce(this,"dropSearchIndex"),await this.$__collection.dropSearchIndex(e)},_e.listSearchIndexes=async function(e){Ce(this,"listSearchIndexes");const t=await this.$__collection.listSearchIndexes(e);return await t.toArray()},_e.diffIndexes=async function(e){if("function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.syncIndexes() no longer accepts a callback");const t=this;let n=await t.listIndexes().catch((e=>{if("NamespaceNotFound"!=e.codeName)throw e}));void 0===n&&(n=[]),n=J(t,n);const r=t.schema,o=X(t,r.indexes()),i=function(e,t,n){const r=[];for(const o of n){let n=!1;if(!K(o)&&!Q(o,e.options)){for(const[r,i]of t){const t=Z(e,N(i));if(D(r,t,e.options),Y(r,t,o)){n=!0;break}}n||r.push(o.name)}}return r}(r,o,n),s=function(e,t,n,r,o){const i=[],s=o?.indexOptionsToCreate??!1;for(const[o,u]of t){let t=!1;const a=Z(e,N(u));for(const e of n)if(!K(e)&&Y(o,a,e)&&!r.includes(e.name)){t=!0;break}t||(s?i.push([o,u]):i.push(o))}return i}(r,o,n,i,e);return{toDrop:i,toCreate:s}},_e.cleanIndexes=async function(e){if(Ce(this,"cleanIndexes"),"function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.cleanIndexes() no longer accepts a callback");const t=this;if(Array.isArray(e&&e.toDrop)){return await we(e.toDrop,t,e)}const n=await t.diffIndexes();return await we(n.toDrop,t,e)},_e.listIndexes=async function(){if(Ce(this,"listIndexes"),"function"==typeof arguments[0])throw new l("Model.listIndexes() no longer accepts a callback");return this.$__collection.buffer&&await new Promise((e=>{this.$__collection.addQueue(e)})),this.$__collection.listIndexes().toArray()},_e.ensureIndexes=async function(e){if(Ce(this,"ensureIndexes"),"function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.ensureIndexes() no longer accepts a callback");await new Promise(((t,n)=>{!
/*!
		 * ignore
		 */
function(e,t,n){const r=Array.isArray(t?.toCreate)?t.toCreate:e.schema.indexes();let o;t=t||{};const i=function(t){t&&!e.$caught&&e.emit("error",t),e.emit("index",t||o),n&&n(t||o)};for(const t of r)K(t)&&ae.warn('mongoose: Cannot specify a custom index on `_id` for model name "'+e.modelName+'", MongoDB does not allow overwriting the default `_id` index. See https://bit.ly/mongodb-id-index');if(!r.length)return void G((function(){i()}));const s=function(t,n,r,o){e.emit("index-single-done",t,n,r,o)},u=function(t,n){e.emit("index-single-start",t,n)},a=e.schema._baseSchema,c=a?a.indexes():[];function l(){if(t._automatic&&(!1===e.schema.options.autoIndex||null==e.schema.options.autoIndex&&!1===e.db.config.autoIndex))return i();const n=r.shift();if(!n)return i();if(t._automatic&&!1===n[1]._autoIndex)return l();if(c.find((e=>ae.deepEqual(e,n))))return l();const a=N(n[0]),h=N(n[1]);delete h._autoIndex,Z(e.schema,h),F(e.schema,h),D(a,h,e.schema.options),u(a,t),"background"in t&&(h.background=t.background);let p=null;try{p=e.collection.createIndex(a,h)}catch(t){return o||(o=t),e.$caught||e.emit("error",t),s(t,a,h),void l()}p.then((e=>{s(null,a,h,e),l()}),(t=>{o||(o=t),e.$caught||e.emit("error",t),s(t,a,h),l()}))}G((function(){t._automatic&&!e.collection.collection?e.collection.addQueue(l,[]):l()}))}(this,e,(e=>{if(null!=e)return n(e);t()}))}))},_e.createIndexes=async function(e){if(Ce(this,"createIndexes"),"function"==typeof arguments[0]||"function"==typeof arguments[1])throw new l("Model.createIndexes() no longer accepts a callback");return this.ensureIndexes(e)},_e.schema,_e.db,_e.collection,_e.$__collection,_e.base,_e.discriminators,_e.translateAliases=function(e,t){Ce(this,"translateAliases");const n=(n,r)=>{let o;const i=[],s=n.split(".");let u=this.schema;for(const n in s){const r=s[n];if(u&&u.aliases[r]){if(o=u.aliases[r],t&&o in e)throw new l(`Provided object has both field "${r}" and its alias "${o}"`);i.push(o)}else o=r,i.push(r);u=u&&u.paths[o]?u.paths[o].schema:null}const a=i.join(".");return e instanceof Map?e.set(a,r):e[a]=r,a!==n&&(e instanceof Map?e.delete(n):delete e[n]),e};if("object"==typeof e){if(e instanceof Map)for(const t of new Map(e))e=n(t[0],t[1]);else for(const t of Object.keys(e))if(e=n(t,e[t]),"$"===t[0])if(Array.isArray(e[t]))for(const n in e[t])e[t][n]=this.translateAliases(e[t][n]);else this.translateAliases(e[t]);return e}return e},_e.deleteOne=function(e,t){if(Ce(this,"deleteOne"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.prototype.deleteOne() no longer accepts a callback");const n=new this.Query({},{},this,this.$__collection);return n.setOptions(t),n.deleteOne(e)},_e.deleteMany=function(e,t){if(Ce(this,"deleteMany"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.deleteMany() no longer accepts a callback");const n=new this.Query({},{},this,this.$__collection);return n.setOptions(t),n.deleteMany(e)},_e.find=function(e,t,n){if(Ce(this,"find"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2]||"function"==typeof arguments[3])throw new l("Model.find() no longer accepts a callback");const r=new this.Query({},{},this,this.$__collection);return r.select(t),r.setOptions(n),r.find(e)},_e.findById=function(e,t,n){if(Ce(this,"findById"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.findById() no longer accepts a callback");return void 0===e&&(e=null),this.findOne({_id:e},t,n)},_e.findOne=function(e,t,n){if(Ce(this,"findOne"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.findOne() no longer accepts a callback");const r=new this.Query({},{},this,this.$__collection);return r.select(t),r.setOptions(n),r.findOne(e)},_e.estimatedDocumentCount=function(e){Ce(this,"estimatedDocumentCount");return new this.Query({},{},this,this.$__collection).estimatedDocumentCount(e)},_e.countDocuments=function(e,t){if(Ce(this,"countDocuments"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.countDocuments() no longer accepts a callback");const n=new this.Query({},{},this,this.$__collection);return null!=t&&n.setOptions(t),n.countDocuments(e)},_e.distinct=function(e,t,n){if(Ce(this,"distinct"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.distinct() no longer accepts a callback");const r=new this.Query({},{},this,this.$__collection);return null!=n&&r.setOptions(n),r.distinct(e,t)},_e.where=function(e,t){Ce(this,"where");const n=new this.Query({},{},this,this.$__collection).find({});return n.where.apply(n,arguments)},_e.$where=function(){Ce(this,"$where");const e=new this.Query({},{},this,this.$__collection).find({});return e.$where.apply(e,arguments)},_e.findOneAndUpdate=function(e,t,n){if(Ce(this,"findOneAndUpdate"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2]||"function"==typeof arguments[3])throw new l("Model.findOneAndUpdate() no longer accepts a callback");let r;1===arguments.length&&(t=e,e=null,n=null),n&&(r=n.fields||n.projection),t=N(t,{depopulate:!0,_isNested:!0}),R(t,n,this.schema.options.versionKey);const o=new this.Query({},{},this,this.$__collection);return o.select(r),o.findOneAndUpdate(e,t,n)},_e.findByIdAndUpdate=function(e,t,n){if(Ce(this,"findByIdAndUpdate"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2]||"function"==typeof arguments[3])throw new l("Model.findByIdAndUpdate() no longer accepts a callback");return e instanceof i&&(e=e._doc._id),this.findOneAndUpdate.call(this,{_id:e},t,n)},_e.findOneAndDelete=function(e,t){if(Ce(this,"findOneAndDelete"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.findOneAndDelete() no longer accepts a callback");let n;t&&(n=t.select,t.select=void 0);const r=new this.Query({},{},this,this.$__collection);return r.select(n),r.findOneAndDelete(e,t)},_e.findByIdAndDelete=function(e,t){if(Ce(this,"findByIdAndDelete"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2])throw new l("Model.findByIdAndDelete() no longer accepts a callback");return this.findOneAndDelete({_id:e},t)},_e.findOneAndReplace=function(e,t,n){if(Ce(this,"findOneAndReplace"),"function"==typeof arguments[0]||"function"==typeof arguments[1]||"function"==typeof arguments[2]||"function"==typeof arguments[3])throw new l("Model.findOneAndReplace() no longer accepts a callback");let r;n&&(r=n.select,n.select=void 0);const o=new this.Query({},{},this,this.$__collection);return o.select(r),o.findOneAndReplace(e,t,n)},_e.create=async function(e,t){if("function"==typeof t||"function"==typeof arguments[2])throw new l("Model.create() no longer accepts a callback");let n;Ce(this,"create");const r=this.schema.options.discriminatorKey;if(Array.isArray(e))n=e,t=null!=t&&"object"==typeof t?t:{};else{const e=arguments[arguments.length-1];t={};if("function"==typeof e||"function"==typeof t||"function"==typeof arguments[2])throw new l("Model.create() no longer accepts a callback");n=[...arguments],n.length>1&&!e&&n.pop(),2===n.length&&null!=n[0]&&null!=n[1]&&null==n[0].session&&e&&"ClientSession"===z(e.session)&&!this.schema.path("session")&&ae.warn("WARNING: to pass a `session` to `Model.create()` in Mongoose, you **must** pass an array as the first argument. See: https://mongoosejs.com/docs/api/model.html#Model.create()")}if(0===n.length)return Array.isArray(e)?[]:null;let o=[];const i="boolean"!=typeof t.aggregateErrors||!t.aggregateErrors;if(delete t.aggregateErrors,t.session&&!t.ordered&&n.length>1)throw new l("Cannot call `create()` with a session and multiple documents unless `ordered: true` is set");if(t.ordered){for(let e=0;e<n.length;e++)try{const i=n[e],s=this.discriminators&&null!=i[r]?this.discriminators[i[r]]||W(this.discriminators,i[r]):this;if(null==s)throw new l(`Discriminator "${i[r]}" not found for model "${this.modelName}"`);let u=i;u instanceof s||(u=new s(u)),await u.$save(t),o.push(u)}catch(e){if(i)throw e;o.push(e)}return o}if(i){let e=null;if(o=await Promise.all(n.map((async n=>{const o=this.discriminators&&null!=n[r]?this.discriminators[n[r]]||W(this.discriminators,n[r]):this;if(null==o)throw new l(`Discriminator "${n[r]}" not found for model "${this.modelName}"`);try{let e=n;return e instanceof o||(e=new o(e)),await e.$save(t),e}catch(t){e||(e=t)}}))),e)throw e}else o=await Promise.allSettled(n.map((async e=>{const n=this.discriminators&&null!=e[r]?this.discriminators[e[r]]||W(this.discriminators,e[r]):this;if(null==n)throw new l(`Discriminator "${e[r]}" not found for model "${this.modelName}"`);let o=e;return o instanceof n||(o=new n(o)),await o.$save(t),o}))),o=o.map((e=>"fulfilled"===e.status?e.value:e.reason));return Array.isArray(e)||1!==n.length?o:o[0]},_e.insertOne=async function(e,t){Ce(this,"insertOne");const n=this.schema.options.discriminatorKey,r=this.discriminators&&null!=e[n]?this.discriminators[e[n]]||W(this.discriminators,e[n]):this;if(null==r)throw new l(`Discriminator "${e[n]}" not found for model "${this.modelName}"`);return e instanceof r||(e=new r(e)),await e.$save(t)},_e.watch=function(e,t){Ce(this,"watch");return(t=t||{}).model=this,new o((n=>{if(re(e=e||[],this.schema,"fullDocument"),this.$__collection.buffer)this.$__collection.addQueue((()=>{if(this.closed)return;const r=this.$__collection.watch(e,t);n(null,r)}));else{const r=this.$__collection.watch(e,t);n(null,r)}}),e,t)},_e.startSession=function(){return Ce(this,"startSession"),this.db.startSession.apply(this.db,arguments)},_e.insertMany=async function(e,t){if(Ce(this,"insertMany"),"function"==typeof t||"function"==typeof arguments[2])throw new l("Model.insertMany() no longer accepts a callback");return new Promise(((n,r)=>{this.$__insertMany(e,t,((e,t)=>{if(null!=e)return r(e);n(t)}))}))},_e.$__insertMany=function(e,t,n){const r=this;"function"==typeof t&&(n=t,t=null),n=n||ae.noop;const o=(t=t||{}).limit||1e3,i=!!t.rawResult,s="boolean"!=typeof t.ordered||t.ordered,u="boolean"==typeof t.throwOnValidationError&&t.throwOnValidationError,a=!!t.lean,l=this.db.base.transactionAsyncLocalStorage?.getStore();t&&t.hasOwnProperty("session")||null==l?.session||(t={...t,session:l.session}),Array.isArray(e)||(e=[e]);const p=[],d=new Map,f=s?null:new Array(e.length),m=e.map(((e,n)=>o=>{if(a)return G((()=>o(null,e)));let i=!1;if(!(e instanceof r)){if(null!=e&&"object"!=typeof e)return o(new h(e,"arr."+n,"insertMany"));try{e=new r(e),i=!0}catch(e){return o(e)}}if(null!=t.session&&e.$session(t.session),a)return G((()=>o(null,e)));e.$validate(i?{_skipParallelValidateCheck:!0}:null).then((()=>{o(null,e)}),(e=>{if(!1===s)return p.push(e),d.set(e,n),f[n]=e,o(null,null);o(e)}))}));ne(m,o,(function(e,o){if(e)return void n(e,null);const l=new Map,h=new Map;for(let e=0;e<o.length;++e)l.set(o[e],e);const m=o.filter((function(e){return null!=e}));for(let e=0;e<m.length;++e)h.set(e,l.get(m[e]));if(p.length>0&&p.sort(((e,t)=>d.get(e)-d.get(t))),0===m.length){if(u)return n(new c(p,f,null,"insertMany"));if(i){const e={acknowledged:!0,insertedCount:0,insertedIds:{}};return pe(e,p,p),n(null,e)}return void n(null,[])}const y=a?m:m.map((function(e){e.$__schema.options.versionKey&&(e[e.$__schema.options.versionKey]=0);return(!t||!1!==t.timestamps)&&e.initializeTimestamps&&(!e.$__||!1!==e.$__.timestamps)&&e.initializeTimestamps(),e.$__hasOnlyPrimitiveValues()?e.$__toObjectShallow():e.toObject(H)}));r.$__collection.insertMany(y,t).then((e=>{if(!a)for(const e of m)e.$__reset(),Se(e,!1);if(!1===s&&u&&p.length>0){for(let e=0;e<f.length;++e)void 0===f[e]&&(f[e]=o[e]);return n(new c(p,f,e,"insertMany"))}if(i){if(!1===s){for(let e=0;e<f.length;++e)void 0===f[e]&&(f[e]=o[e]);pe(e,p,f)}return n(null,e)}if(null!=t.populate)return r.populate(m,t.populate).then((e=>{n(null,e)}),(e=>{throw null!=e&&(e.insertedDocs=m),e}));n(null,m)}),(e=>{null==e.writeErrors&&null!=(e.result&&e.result.result&&e.result.result.writeErrors)&&(e.writeErrors=e.result.result.writeErrors);const t=e&&e.writeErrors,r=new Set((e&&e.writeErrors||[]).map((e=>e.index)));if(null!=e.writeErrors)for(let t=0;t<e.writeErrors.length;++t){const n=h.get(e.writeErrors[t].index);e.writeErrors[t]={...e.writeErrors[t],index:n},s||(f[n]=e.writeErrors[t])}if(!s){for(let e=0;e<f.length;++e)void 0===f[e]&&(f[e]=o[e]);e.results=f}let u=-1;e.insertedDocs=m.filter(((e,n)=>{const o=!t||r.has(n);if(s){if(u>-1)return n<u;o&&(u=n)}return!o})).map((function(e){return a||(e.$__reset(),Se(e,!1)),e})),i&&!1===s&&pe(e,p,f),n(e,null)}))}))},_e.bulkWrite=async function(e,t){if(Ce(this,"bulkWrite"),"function"==typeof t||"function"==typeof arguments[2])throw new l("Model.bulkWrite() no longer accepts a callback");t=t||{};const n=await new Promise(((n,r)=>{this.hooks.execPre("bulkWrite",this,[e,t],(e=>{if(null!=e)return e instanceof a.skipWrappedFunction?n(e):r(e);n()}))}));if(n)return n.args[0];const r=null==t.ordered||t.ordered;if(0===e.length){const e=new(0,this.base.driver.get().BulkWriteResult)(k(),!1);return e.n=0,pe(e,[],[]),e}const o=e.map((e=>P(this,e,t))),i=this.db.base.transactionAsyncLocalStorage?.getStore();t&&t.hasOwnProperty("session")||null==i?.session||(t={...t,session:i.session});let s=null;if(r){await new Promise(((e,t)=>{U(o,((e,t)=>e(t)),(n=>{if(n)return t(n);e()}))}));try{s=await this.$__collection.bulkWrite(e,t)}catch(e){await new Promise(((t,n)=>{const r={error:e};this.hooks.execPost("bulkWrite",this,[null],r,(e=>{if(null!=e)return n(e);t()}))}))}}else{let n=o.length,r=[],i=[];const u=[];await new Promise((e=>{for(let t=0;t<o.length;++t)o[t]((o=>{null==o?r.push(t):(i.push({index:t,error:o}),u[t]=o),--n<=0&&e()}))})),i=i.sort(((e,t)=>e.index-t.index)).map((e=>e.error));const a=r;if(r=r.sort().map((t=>e[t])),0===r.length){if(t.throwOnValidationError&&i.length)throw new c(i,u,s,"bulkWrite");const e=new(0,this.base.driver.get().BulkWriteResult)(k(),!1);return e.result=k(),pe(e,i,u),e}let l;[s,l]=await this.$__collection.bulkWrite(r,t).then((e=>[e,null])).catch((e=>[null,e]));const h={};if(l?.writeErrors)for(const e of l.writeErrors)h[e.err.index]=e;for(let e=0;e<a.length;++e)u[a[e]]=h[e]??null;if(l&&(i.length>0&&pe(l,i,u),await new Promise(((e,t)=>{const n={error:l};this.hooks.execPost("bulkWrite",this,[null],n,(n=>{if(null!=n)return t(n);e()}))}))),i.length>0){if(t.throwOnValidationError)throw new c(i,u,s,"bulkWrite");pe(s,i,u)}}return await new Promise(((e,t)=>{this.hooks.execPost("bulkWrite",this,[s],(n=>{if(null!=n)return t(n);e()}))})),s},_e.bulkSave=async function(e,t){if(null!=(t=t||{}).timestamps)for(const n of e)n.$__.saveOptions=n.$__.saveOptions||{},n.$__.saveOptions.timestamps=t.timestamps;else for(const t of e)null!=t.$__.timestamps&&(t.$__.saveOptions=t.$__.saveOptions||{},t.$__.saveOptions.timestamps=t.$__.timestamps);await Promise.all(e.map((e=>function(e,t){return new Promise(((n,r)=>{e.schema.s.hooks.execPre("save",e,[t],(e=>{e?r(e):n()}))}))}(e,t))));const n=this.buildBulkWriteOperations(e,{skipValidation:!0,timestamps:t.timestamps}),{bulkWriteResult:r,bulkWriteError:o}=await this.bulkWrite(n,{skipValidation:!0,...t}).then((e=>({bulkWriteResult:e,bulkWriteError:null})),(e=>({bulkWriteResult:null,bulkWriteError:e})));if(null!=o&&"MongoBulkWriteError"!==o.name)throw o;const i=r?.matchedCount??0,s=r?.insertedCount??0;if(n.length>0&&i+s<n.length&&!o)throw new le(this.modelName,e,r);const u=[];for(let t=0;t<e.length;t++){const n=e[t];null==(o&&o.writeErrors.find((e=>(e.err.op._id||e.err.op.q._id).toString()===n._doc._id.toString())))&&u.push(n)}if(await Promise.all(u.map((e=>function(e){return new Promise(((t,n)=>{e.$isNew&&Se(e,!1),e.$__reset(),e.schema.s.hooks.execPost("save",e,[e],{},(e=>{e?n(e):t()}))}))}(e)))),null!=o)throw o;return r},_e.applyDefaults=function e(t){if(null==t)return t;if(null!=t.$__){A(t,t.$__.fields,t.$__.exclude);for(const n of t.$getAllSubdocs())e(n,n.$__.fields,n.$__.exclude);return t}return _(t,this.schema),t},_e.applyVirtuals=function(e,t){return null==e||null!=e.$__||$(this.schema,e,t),e},_e.applyTimestamps=function(e,t){return null==e||null!=e.$__||B(this.schema,e,t),e},_e.castObject=function(e,t){t=t||{};const n={};let r=this.schema;const o=r.options.discriminatorKey;null!=r.discriminators&&null!=e&&null!=e[o]&&(r=j(r,e[o])||r);const i=Object.keys(r.paths);for(const t of i){const n=r.path(t);if(!n||!n.$isMongooseArray)continue;const o=V(e,t);oe(i,o,t)}let s=null;for(const o of i){const i=r.path(o);if(null==i)continue;let u=V(e,o,void 0);if(null==u)continue;const a=-1===o.indexOf(".")?[o]:o.split(".");let c=n;for(let e=0;e<a.length-1;++e)null==c[a[e]]&&(c[a[e]]=isNaN(a[e+1])?{}:[]),c=c[a[e]];if(i.$isMongooseDocumentArray){const e=i.options?.castNonArrays??i.constructor.options.castNonArrays;if(!Array.isArray(u)){e?c[a[a.length-1]]=[_e.castObject.call(i.caster,u)]:t.ignoreCastErrors||(s=s||new y,s.addError(o,new he(o,u)));continue}}if(i.$isSingleNested||i.$isMongooseDocumentArrayElement){try{u=_e.castObject.call(i.caster,u)}catch(e){t.ignoreCastErrors||(s=s||new y,s.addError(o,e));continue}c[a[a.length-1]]=u}else try{u=i.cast(u),c[a[a.length-1]]=u}catch(e){t.ignoreCastErrors||(s=s||new y,s.addError(o,e));continue}}if(null!=s)throw s;return n},_e.buildBulkWriteOperations=function(e,t){if(!Array.isArray(e))throw new Error(`bulkSave expects an array of documents to be passed, received \`${e}\` instead`);null==(t=t||{}).skipValidation&&(t.skipValidation=!1);const n=this.schema.options.discriminatorKey;return e.reduce(((e,r,o)=>{if(!t.skipValidation){if(!(r instanceof i))throw new Error(`documents.${o} was not a mongoose document, documents must be an array of mongoose documents (instanceof mongoose.Document).`);const e=r.validateSync();if(e)throw e}if(r.isNew){const n={insertOne:{document:r}};return ae.injectTimestampsOption(n.insertOne,t.timestamps),e.push(n),e}const s=r.$__delta();if(null!=s&&!ae.isEmptyObject(s[0])){const o=r.$__where(s[0]),i=s[1];Oe(r,o);const u=this.schema.options.shardKey;if(u){const e=Object.keys(u),t=e.length;for(let n=0;n<t;++n)o[e[n]]=r[e[n]]}null==r[n]||n in o||(o[n]=r[n]),r.$__version(o,s);const a={updateOne:{filter:o,update:i}};return ae.injectTimestampsOption(a.updateOne,t.timestamps),e.push(a),e}return e}),[])},_e.hydrate=function(e,t,n){Ce(this,"hydrate"),null!=t&&(null!=e&&null!=e.$__&&(e=e.toObject(H)),e=S(e,t));const r=td().createModel(this,e,t);return r.$init(e,n),r},_e.updateMany=function(e,t,n){if(Ce(this,"updateMany"),null==t)throw new l("updateMany `update` parameter cannot be nullish");return ve(this,"updateMany",e,t,n)},_e.updateOne=function(e,t,n){return Ce(this,"updateOne"),ve(this,"updateOne",e,t,n)},_e.replaceOne=function(e,t,n){Ce(this,"replaceOne");const r=this&&this.schema&&this.schema.options&&this.schema.options.versionKey||null;return r&&!t[r]&&(t[r]=0),ve(this,"replaceOne",e,t,n)},_e.aggregate=function(e,t){if(Ce(this,"aggregate"),"function"==typeof t||"function"==typeof arguments[2])throw new l("Model.aggregate() no longer accepts a callback");const n=new r(e||[]);return n.model(this),null!=t&&n.option(t),n},_e.validate=async function(e,t,n){if((arguments.length<3||3===arguments.length&&"function"==typeof arguments[2])&&(n=e),"function"==typeof n||"function"==typeof arguments[3])throw new l("Model.validate() no longer accepts a callback");let r=this.schema;const o=r.options.discriminatorKey;null!=r.discriminators&&null!=e&&null!=e[o]&&(r=j(r,e[o])||r);let i=Object.keys(r.paths);if(null!=t){const e="string"==typeof t?new Set(t.split(" ")):Array.isArray(t)?new Set(t):new Set(i);i=i.filter((n=>{if(t.pathsToSkip)if(Array.isArray(t.pathsToSkip)){if(t.pathsToSkip.find((e=>e==n)))return!1}else if("string"==typeof t.pathsToSkip&&t.pathsToSkip.includes(n))return!1;const r=n.split(".");let o=r[0];for(const t of r){if(e.has(o))return!0;o+="."+t}return e.has(n)}))}for(const t of i){const n=r.path(t);if(!n||!n.$isMongooseArray||n.$isMongooseDocumentArray)continue;const o=V(e,t);oe(i,o,t)}let s=null;i=new Set(i);try{e=this.castObject(e)}catch(e){s=e;for(const e of Object.keys(s.errors||{}))i.delete(e)}let u=i.size;return new Promise(((t,o)=>{for(const t of i){const o=r.path(t);if(null==o){a();continue}const i=-1===t.indexOf(".")?[t]:t.split(".");let u=e;for(let e=0;e<i.length-1;++e)u=u[i[e]];const c=V(e,t,void 0);o.doValidate(c,(e=>{e&&(s=s||new y,s.addError(t,e)),a()}),n,{path:t})}function a(){--u<=0&&(s?o(s):t(e))}}))},_e.populate=async function(e,t){if(Ce(this,"populate"),"function"==typeof t||"function"==typeof arguments[2])throw new l("Model.populate() no longer accepts a callback");if(0===(t=ae.populate(t)).length)return e;if(t.find((e=>e.ordered)))for(const n of t)await Te(this,e,n);else{const n=[];for(const r of t)n.push(Te(this,e,r));await Promise.all(n)}return e};
/*!
		 * Populates `docs` for a single `populateOptions` instance.
		 */
const De=/\s?-_id\s?/,Me=/\s?-_id\s?/g;async function Te(e,t,n){if(null==n.strictPopulate&&(null!=n._localModel&&null!=n._localModel.schema._userProvidedOptions.strictPopulate?n.strictPopulate=n._localModel.schema._userProvidedOptions.strictPopulate:(null!=n._localModel&&null!=e.base.options.strictPopulate||null!=e.base.options.strictPopulate)&&(n.strictPopulate=e.base.options.strictPopulate)),Array.isArray(t)||(t=[t]),0===t.length||t.every(ae.isNullOrUndefined))return;const r=q(e,t,n);if(r instanceof l)throw r;const o=r.length;let i=[];function s(e){return void 0!==e}let u=!1;const a=[];for(let t=0;t<o;++t){const o=r[t];let i=o.options.select,c=ae.array.flatten(o.ids,s);c=ae.array.unique(c);const l={};if(l.sort=o&&o.options&&o.options.options&&o.options.options.sort||void 0,l.excludeId=De.test(i)||i&&0===i._id,o.options&&o.options.options&&o.options.options.lean&&o.options.options.lean.transform&&(o.options.options._leanTransform=o.options.options.lean.transform,o.options.options.lean=!0),0===c.length||c.every(ae.isNullOrUndefined)){Fe(e,[],o,l);continue}u=!0,"string"==typeof n.foreignField&&(o.foreignField.clear(),o.foreignField.add(n.foreignField));const h=I(c,o.match,o.foreignField,o.model,o.options.skipInvalidIds);l.excludeId&&("string"==typeof i?i=i.replace(Me," "):Array.isArray(i)?i=i.filter((e=>"-_id"!==e)):(i={...i},delete i._id)),o.options.options&&null!=o.options.options.limit?l.originalLimit=o.options.options.limit:null!=o.options.limit&&(l.originalLimit=o.options.limit),a.push([o,h,i,l])}if(u){if(n.ordered)for(const e of a)await Be.apply(null,e).then((e=>{i=i.concat(e)}));else{const e=[];for(const t of a)e.push(Be.apply(null,t).then((e=>{i=i.concat(e)})));await Promise.all(e)}for(const t of a){const n=t[0],r=t[3];for(const e of i)n.options._childDocs.push(e);Fe(e,i,n,r)}for(const e of a)ie(e[0].foreignField,e[0].options,i);for(const e of a){const t=e[0];if(t.options&&t.options.options&&t.options.options._leanTransform)for(const e of i)t.options.options._leanTransform(e)}}else{if(0!==r.length)return;if(null!=n.populate){const r=ae.populate(n.populate).map((e=>Object.assign({},e,{path:n.path+"."+e.path})));return e.populate(t,r)}}}
/*!
		 * ignore
		 */function Be(e,t,n){let r=N(e.options.populate);const o=Object.assign({skip:e.options.skip,limit:e.options.limit,perDocumentLimit:e.options.perDocumentLimit},e.options.options);e.count&&delete o.skip,null!=o.perDocumentLimit?(o.limit=o.perDocumentLimit,delete o.perDocumentLimit):null!=o.limit&&(o.limit=o.limit*e.ids.length);const i=e.model.find(t,n,o);for(const t of e.foreignField)"_id"!==t&&i.selectedInclusively()&&!ee(i._fields,t)&&i.select(t);if(e.count)for(const t of e.foreignField)i.select(t);if(r){null!=e.model.baseModelName&&(Array.isArray(r)?r.forEach((e=>{e.strictPopulate=!1})):"string"==typeof r?r={path:r,strictPopulate:!1}:r.strictPopulate=!1);const t=e.options._fullPath||e.options.path;if(Array.isArray(r))for(const e of r)e._fullPath=t+"."+e.path;else"object"==typeof r&&(r._fullPath=t+"."+r.path);i.populate(r)}return i.exec().then((t=>{for(const n of t)te.set(n,e.model);return t}))}
/*!
		 * ignore
		 */function Fe(e,t,n,r){const o=n.options,s=n.isVirtual,u=n.justOne;let a;const c=o&&o.options&&o.options.lean||!1,l=t.length,h={},p={};let d,f;const m=N(n.allIds);for(let e=0;e<l;e++)if(f=t[e],null!=f)for(const t of n.foreignField){if(a=ae.getValue(t,f),Array.isArray(a)){a=ae.array.unique(ae.array.flatten(a));for(let t of a)t instanceof i&&(t=t._doc._id),d=String(t),p[d]?Array.isArray(p[d])?(p[d].push(f),h[d].push(e)):(p[d]=[p[d],f],h[d]=[h[d],e]):s&&!u?(p[d]=[f],h[d]=[e]):(p[d]=f,h[d]=e)}else a instanceof i&&(a=a._doc._id),d=String(a),p[d]?Array.isArray(p[d])?(p[d].push(f),h[d].push(e)):(s||p[d].constructor!==f.constructor||(p[d]instanceof i?String(p[d]._doc._id):String(p[d]._id))!==String(f instanceof i?f._doc._id:f._id))&&(p[d]=[p[d],f],h[d]=[h[d],e]):(p[d]=f,h[d]=e);c||(f.$__.wasPopulated=f.$__.wasPopulated||{value:a})}x({originalModel:e,rawIds:n.isVirtual?m:n.allIds,allIds:m,unpopulatedValues:n.unpopulatedValues,foreignField:n.foreignField,rawDocs:p,rawOrder:h,docs:n.docs,path:o.path,options:r,justOne:n.justOne,isVirtual:n.isVirtual,allOptions:n,populatedModel:n.model,lean:c,virtual:n.virtual,count:n.count,match:n.match})}_e.compile=function(e,t,n,r,o){if(!1!==t.options.versionKey&&!t.paths[t.options.versionKey]){const e={};e[t.options.versionKey]=Number,t.add(e)}let i;"function"==typeof e&&e.prototype instanceof _e?(i=e,e=i.name,t.loadClass(i,!1),i.prototype.$isMongooseModelPrototype=!0):i=function e(t,n,r){if(e.hooks.execPreSync("createModel",t),!(this instanceof e))return new e(t,n,r);const o=e.schema.options.discriminatorKey;if(null==e.discriminators||null==t||null==t[o])return void _e.call(this,t,n,r);const i=e.discriminators[t[o]]||W(e.discriminators,t[o]);if(null!=i)return new i(t,n,r);_e.call(this,t,n,r)},i.hooks=t.s.hooks.clone(),i.base=o,i.modelName=e,i.prototype instanceof _e||(Object.setPrototypeOf(i,_e),Object.setPrototypeOf(i.prototype,_e.prototype)),i.model=function(e){return this.db.model(e)},i.db=r,i.prototype.db=r,i.prototype[fe]=r,i.discriminators=i.prototype.discriminators=void 0,i[me]=!0,i.events=new u,t._preCompile();const s={schemaUserProvidedOptions:t._userProvidedOptions||{},capped:t.options.capped,Promise:i.base.Promise,modelName:e};void 0!==t.options.autoCreate&&(s.autoCreate=t.options.autoCreate);const a=r.collection(n,s);return i.prototype.collection=a,i.prototype.$collection=a,i.prototype[de]=a,i.prototype.$__setSchema(t),w(i,t),T(i,t),C(i,t),M(i,t.s.hooks,t.statics),i.schema=i.prototype.$__schema,i.collection=a,i.$__collection=a,i.Query=function(){d.apply(this,arguments)},Object.setPrototypeOf(i.Query.prototype,d.prototype),i.Query.base=d.base,i.Query.prototype.constructor=d,i._applyQueryMiddleware(),function(e,t){for(const n in t)e.Query.prototype[n]=t[n]}(i,t.query),i},_e.$__updateConnection=function(e){this.db=e,this.prototype.db=e,this.prototype[fe]=e;const t=e.collection(this.collection.collectionName,this.collection.opts);this.prototype.collection=t,this.prototype.$collection=t,this.prototype[de]=t,this.collection=t,this.$__collection=t},_e.__subclass=function(e,t,n){const r=this,o=function e(t,n,o){if(!(this instanceof e))return new e(t,n,o);r.call(this,t,n,o)};if(Object.setPrototypeOf(o,r),Object.setPrototypeOf(o.prototype,r.prototype),o.db=e,o.prototype.db=e,o.prototype[fe]=e,r[ye]=r[ye]||[],r[ye].push(o),null!=r.discriminators){o.discriminators={};for(const e of Object.keys(r.discriminators))o.discriminators[e]=r.discriminators[e].__subclass(r.db,r.discriminators[e].schema,n)}const i=t&&"string"!=typeof t?t:r.prototype.$__schema,s=i.options||{},u=i._userProvidedOptions||{};n||(n=r.prototype.$__schema.get("collection")||ae.toCollectionName(r.modelName,this.base.pluralize()));const a={schemaUserProvidedOptions:u,capped:i&&s.capped};return o.prototype.collection=e.collection(n,a),o.prototype.$collection=o.prototype.collection,o.prototype[de]=o.prototype.collection,o.collection=o.prototype.collection,o.$__collection=o.collection,o.init().catch((()=>{})),o},_e.recompileSchema=function(){if(this.prototype.$__setSchema(this.schema),null!=this.schema._applyDiscriminators)for(const e of this.schema._applyDiscriminators.keys())this.discriminator(e,this.schema._applyDiscriminators.get(e));delete this.schema._defaultToObjectOptionsMap,O(this.schema,new WeakSet,!0)},_e.inspect=function(){return`Model { ${this.modelName} }`},_e.namespace=function(){return this.db.name+"."+this.collection.collectionName},ue.inspect.custom&&(_e[ue.inspect.custom]=_e.inspect)
/*!
		 * Applies query middleware from this model's schema to this model's
		 * Query constructor.
		 */,_e._applyQueryMiddleware=function(){const e=this.Query,t=this.schema.s.hooks.filter((e=>{const t=function(e){const t={};e.hasOwnProperty("query")&&(t.query=e.query);e.hasOwnProperty("document")&&(t.document=e.document);return t}
/*!
		 * Module exports.
		 */(e);return"validate"===e.name?!!t.query:"deleteOne"===e.name||"updateOne"===e.name?!!t.query||0===Object.keys(t).length:null==e.query&&null==e.document||!!e.query}));e.prototype._queryMiddleware=t},e.exports=_e}(i_)),i_.exports}var fC,mC,yC,gC={exports:{}};var EC,AC={};var bC,_C,OC,CC,wC,SC,vC={exports:{}},DC={exports:{}};function MC(){if(_C)return vC.exports;_C=1;
/*!
	 * Module dependencies.
	 */
const e=sf(),n=(bC||(bC=1,function(e){const n=sf(),r=t.EventEmitter,o=dl(),i=$g(),s=ba(),u=o.ValidationError,a=Bf(),c=Ha();function l(e,t,r,u,h){if(!(this instanceof l))return new l(e,t,r,u,h);if(c(t)&&!t.instanceOfSchema&&(t=new i(t)),t=this.schema||t,!this.schema&&t.options._id&&void 0===(e=e||{})._id&&(e._id=new s),!t)throw new o.MissingSchemaError;this.$__setSchema(t),n.call(this,e,r,u,h),a(this,t,{decorateDoc:!0});for(const e in t.methods)this[e]=t.methods[e];for(const e in t.statics)this[e]=t.statics[e]}
/*!
		 * Inherit from the NodeJS document
		 */l.prototype=Object.create(n.prototype),l.prototype.constructor=l,
/*!
		 * ignore
		 */
l.events=new r,
/*!
		 * Browser doc exposes the event emitter API
		 */
l.$emitter=new r,["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"].forEach((function(e){l[e]=function(){return l.$emitter[e].apply(l.$emitter,arguments)}})),
/*!
		 * Module exports.
		 */
l.ValidationError=u,e.exports=l}(DC)),DC.exports);let r=!1;return vC.exports=function(){return r?n:e},
/*!
	 * ignore
	 */
vC.exports.setBrowser=function(e){r=e},vC.exports}function TC(){return OC||(OC=1,function(e){
/*!
		 * Module dependencies.
		 */
const r=sf(),o=t.EventEmitter,i=lc(),s=$g(),u=af(),a=Fg(),c=pf(),l=la(),h=function(){if(RE)return IE;RE=1;const e=Object.freeze(["allowDiskUse","applyPluginsToChildSchemas","applyPluginsToDiscriminators","autoCreate","autoIndex","autoSearchIndex","bufferCommands","bufferTimeoutMS","cloneSchemas","createInitialConnection","debug","forceRepopulate","id","timestamps.createdAt.immutable","maxTimeMS","objectIdGetter","overwriteModels","returnOriginal","runValidators","sanitizeFilter","sanitizeProjection","selectPopulatedPaths","setDefaultsOnInsert","strict","strictPopulate","strictQuery","toJSON","toObject","transactionAsyncLocalStorage","translateAliases"]);return IE=e}
/*!
 * Module dependencies.
 */(),p=Lf(),d=bb(),f=dC(),m=Pg(),y=Qy(),g=Ug(),E=(fC||(fC=1,function(e,t){gC.exports=function(e){let t;return e=e.toLowerCase(),!~r.indexOf(e)&&(t=n.filter((function(t){return e.match(t[0])})),t[0])?e.replace(t[0][0],t[0][1]):e},t.pluralization=[[/human$/gi,"humans"],[/(m)an$/gi,"$1en"],[/(pe)rson$/gi,"$1ople"],[/(child)$/gi,"$1ren"],[/^(ox)$/gi,"$1en"],[/(ax|test)is$/gi,"$1es"],[/(octop|vir)us$/gi,"$1i"],[/(alias|status)$/gi,"$1es"],[/(bu)s$/gi,"$1ses"],[/(buffal|tomat|potat)o$/gi,"$1oes"],[/([ti])um$/gi,"$1a"],[/sis$/gi,"ses"],[/(?:([^f])fe|([lr])f)$/gi,"$1$2ves"],[/(hive)$/gi,"$1s"],[/([^aeiouy]|qu)y$/gi,"$1ies"],[/(x|ch|ss|sh)$/gi,"$1es"],[/(matr|vert|ind)ix|ex$/gi,"$1ices"],[/([m|l])ouse$/gi,"$1ice"],[/(kn|w|l)ife$/gi,"$1ives"],[/(quiz)$/gi,"$1zes"],[/^goose$/i,"geese"],[/s$/gi,"s"],[/([^a-z])$/,"$1"],[/$/gi,"s"]];const n=t.pluralization;t.uncountables=["advice","energy","excretion","digestion","cooperation","health","justice","labour","machinery","equipment","information","pollution","sewage","paper","money","species","series","rain","rice","fish","sheep","moose","deer","news","expertise","status","media"];const r=t.uncountables}(0,gC.exports)),gC.exports),b=uf(),_=DE,O=hm(),C=c_(),w=rc().trusted,S=yb(),v=Ga(),D=pa(),M=function(){if(yC)return mC;yC=1;const e=pa(),t=n,r=el();class o extends e{constructor(){super(""),this.errors={}}toString(){return r(this)}inspect(){return Object.assign(new Error(this.message),this)}addError(e,t){if(t instanceof o){const{errors:e}=t;for(const t of Object.keys(e))this.addError(t,e[t])}else this.errors[e]=t,this.message=r(this)}}return t.inspect.custom&&(o.prototype[t.inspect.custom]=o.prototype.inspect),Object.defineProperty(o.prototype,"toJSON",{enumerable:!1,writable:!1,configurable:!0,value:function(){return Object.assign({},this,{name:this.name,message:this.message})}}),Object.defineProperty(o.prototype,"name",{value:"SetOptionError"}),o.SetOptionInnerError=class extends e{constructor(e){super(`"${e}" is not a valid option to set`)}},
/*!
	 * Module exports
	 */
mC=o}(),T=h_(),B=Symbol.for("mongoose:default"),F=Symbol("mongoose:defaultConnection");!function(){if(EC)return AC;EC=1;const e=uf();"undefined"==typeof jest||process.env.SUPPRESS_JEST_WARNINGS||("undefined"!=typeof window&&e.warn("Mongoose: looks like you're trying to test a Mongoose app with Jest's default jsdom test environment. Please make sure you read Mongoose's docs on configuring Jest to test Node.js apps: https://mongoosejs.com/docs/jest.html. Set the SUPPRESS_JEST_WARNINGS to true to hide this warning."),null!=setTimeout.clock&&"function"==typeof setTimeout.clock.Date&&e.warn("Mongoose: looks like you're trying to test a Mongoose app with Jest's mock timers enabled. Please make sure you read Mongoose's docs on configuring Jest to test Node.js apps: https://mongoosejs.com/docs/jest.html. Set the SUPPRESS_JEST_WARNINGS to true to hide this warning."))}();const $=/^[0-9A-Fa-f]{24}$/,{AsyncLocalStorage:x}=A;function P(e){this.connections=[],this.nextConnectionId=0,this.models={},this.events=new o,this.__driver=g.get(),this.options=Object.assign({pluralization:!0,autoIndex:!0,autoCreate:!0,autoSearchIndex:!1},e);if((b.getOption("createInitialConnection",this.options)??!0)&&null!=this.__driver&&N(this),this.options.pluralization&&(this._pluralize=E),e&&e[B])for(const e of["Schema","model"])this[e]=P.prototype[e];else{const e=this;this.Schema=function(){return this.base=e,s.apply(this,arguments)},this.Schema.prototype=Object.create(s.prototype),Object.assign(this.Schema,s),this.Schema.base=this,this.Schema.Types=Object.assign({},s.Types)}this.Schema.prototype.base=this,e?.transactionAsyncLocalStorage&&(this.transactionAsyncLocalStorage=new x),Object.defineProperty(this,"plugins",{configurable:!1,enumerable:!0,writable:!1,value:Object.values(y).map((e=>[e,{deduplicate:!0}]))})}
/*!
		 * Create a new default connection (`mongoose.connection`) for a Mongoose instance.
		 * No-op if there is already a default connection.
		 */
function N(e){if(e.connection)return;const t=e.createConnection();t[F]=!0,t.models=e.models}P.prototype.cast=O,P.prototype.STATES=l,P.prototype.ConnectionStates=l,P.prototype.driver=g,P.prototype.setDriver=function(e){const t=this instanceof P?this:I;if(t.__driver===e)return t;if(t.connections&&t.connections.find((e=>e.readyState!==l.disconnected))){throw new D("Cannot modify Mongoose driver if a connection is already open. Call `mongoose.disconnect()` before modifying the driver")}if(t.__driver=e,Array.isArray(e.plugins))for(const n of e.plugins)"function"==typeof n&&t.plugin(n);null!=e.SchemaTypes&&Object.assign(I.Schema.Types,e.SchemaTypes);const n=e.Connection,r=t.connections[0];if(t.connections=[new n(t)],t.connections[0].models=t.models,null==r)return t;for(const e of Object.values(t.models))e.db===r&&e.$__updateConnection(t.connections[0]);return t},P.prototype.set=function(e,t){const n=this instanceof P?this:I;if(1===arguments.length&&"object"!=typeof e){if(-1===h.indexOf(e)){const t=new M;throw t.addError(e,new M.SetOptionInnerError(e)),t}return n.options[e]}let r,o={};2===arguments.length&&(o={[e]:t}),1===arguments.length&&"object"==typeof e&&(o=e);for(const[e,t]of Object.entries(o))-1!==h.indexOf(e)?(n.options[e]=t,"objectIdGetter"===e?t?Object.defineProperty(n.Types.ObjectId.prototype,"_id",{enumerable:!1,configurable:!0,get:function(){return this}}):delete n.Types.ObjectId.prototype._id:"transactionAsyncLocalStorage"===e?t&&!n.transactionAsyncLocalStorage?n.transactionAsyncLocalStorage=new x:!t&&n.transactionAsyncLocalStorage&&delete n.transactionAsyncLocalStorage:"createInitialConnection"===e&&(t&&!n.connection?N(n):!1===t&&n.connection&&n.connection[F]&&n.connection.readyState===l.disconnected&&0===Object.keys(n.connection.models).length&&n.connections.shift())):(r||(r=new M),r.addError(e,new M.SetOptionInnerError(e)));if(r)throw r;return n},P.prototype.get=P.prototype.set,P.prototype.createConnection=function(e,t){const n=this instanceof P?this:I,r=new(0,n.__driver.Connection)(n);return n.connections.push(r),n.nextConnectionId++,n.events.emit("createConnection",r),arguments.length>0&&r.openUri(e,{...t,_fireAndForget:!0}),r},P.prototype.connect=async function(e,t){if("function"==typeof t||arguments.length>=3&&"function"==typeof arguments[2])throw new D("Mongoose.prototype.connect() no longer accepts a callback");const n=this instanceof P?this:I;null==n.connection&&N(n);return n.connection.openUri(e,t).then((()=>n))},P.prototype.disconnect=async function(){if(arguments.length>=1&&"function"==typeof arguments[0])throw new D("Mongoose.prototype.disconnect() no longer accepts a callback");const e=this instanceof P?this:I;e.connections.length<=0||await Promise.all(e.connections.map((e=>e.close())))},P.prototype.startSession=function(){const e=this instanceof P?this:I;return e.connection.startSession.apply(e.connection,arguments)},P.prototype.pluralize=function(e){const t=this instanceof P?this:I;return arguments.length>0&&(t._pluralize=e),t._pluralize},P.prototype.model=function(e,t,n,r){const o=this instanceof P?this:I;if("string"==typeof t&&(n=t,t=!1),1===arguments.length){const t=o.models[e];if(!t)throw new o.Error.MissingSchemaError(e);return t}if(!b.isObject(t)||t instanceof s||(t=new s(t)),t&&!(t instanceof s))throw new o.Error("The 2nd parameter to `mongoose.model()` should be a schema or a POJO");r=r||{};const i=t;t&&(o.get("cloneSchemas")&&(t=t.clone()),o._applyPlugins(t));const u=o.options.hasOwnProperty("overwriteModels")?o.options.overwriteModels:r.overwriteModels;if(o.models.hasOwnProperty(e)&&!1!==r.cache&&!0!==u){if(i&&i.instanceOfSchema&&i!==o.models[e].schema)throw new o.Error.OverwriteModelError(e);if(n&&n!==o.models[e].collection.name){const r=o.models[e];t=r.prototype.schema;return r.__subclass(o.connection,t,n)}return o.models[e]}if(null==t)throw new o.Error.MissingSchemaError(e);const a=o._model(e,t,n,r);return o.connection.models[e]=a,o.models[e]=a,a},
/*!
		 * ignore
		 */
P.prototype._model=function(e,t,n,r){const o=this instanceof P?this:I;let i;if("function"==typeof e&&(i=e,e=i.name,!(i.prototype instanceof f)))throw new o.Error("The provided class "+e+" must extend Model");t&&(o.get("cloneSchemas")&&(t=t.clone()),o._applyPlugins(t)),null!=t&&"pluralization"in t.options||(t.options.pluralization=o.options.pluralization),n||(n=t.get("collection")||b.toCollectionName(e,o.pluralize())),T(t);const s=r.connection||o.connection;if(i=o.Model.compile(i||e,t,n,s,o),i.init().catch((function(){})),s.emit("model",i),null!=t._applyDiscriminators)for(const e of t._applyDiscriminators.keys()){const{schema:n,options:r}=t._applyDiscriminators.get(e);i.discriminator(e,n,r)}return i},P.prototype.deleteModel=function(e){const t=this instanceof P?this:I;return t.connection.deleteModel(e),delete t.models[e],t},P.prototype.modelNames=function(){const e=this instanceof P?this:I;return Object.keys(e.models)},P.prototype._applyPlugins=function(e,t){const n=this instanceof P?this:I;(t=t||{}).applyPluginsToDiscriminators=n.options&&n.options.applyPluginsToDiscriminators||!1,t.applyPluginsToChildSchemas="boolean"!=typeof(n.options&&n.options.applyPluginsToChildSchemas)||n.options.applyPluginsToChildSchemas,m(e,n.plugins,t,"$globalPluginsApplied")},P.prototype.plugin=function(e,t){const n=this instanceof P?this:I;return n.plugins.push([e,t]),n},P.prototype.__defineGetter__("connection",(function(){return this.connections[0]})),P.prototype.__defineSetter__("connection",(function(e){e instanceof this.__driver.Connection&&(this.connections[0]=e,this.models=e.models)})),P.prototype.connections,P.prototype.nextConnectionId,P.prototype.Aggregate=C,Object.defineProperty(P.prototype,"Collection",{get:function(){return this.__driver.Collection},set:function(e){this.__driver.Collection=e}}),Object.defineProperty(P.prototype,"Connection",{get:function(){return this.__driver.Connection},set:function(e){e!==this.__driver.Connection&&(this.__driver.Connection=e)}}),P.prototype.version=_.version,P.prototype.Mongoose=P,P.prototype.Schema=s,P.prototype.SchemaType=u,P.prototype.SchemaTypes=s.Types,P.prototype.VirtualType=c,P.prototype.Types=p,P.prototype.Query=d,P.prototype.Model=f,P.prototype.Document=r,P.prototype.DocumentProvider=MC(),P.prototype.ObjectId=a.ObjectId,P.prototype.isValidObjectId=function(e){return(this instanceof P?this:I).Types.ObjectId.isValid(e)},P.prototype.isObjectIdOrHexString=function(e){return v(e,"ObjectId")||"string"==typeof e&&$.test(e)},P.prototype.syncIndexes=function(e){return(this instanceof P?this:I).connection.syncIndexes(e)},P.prototype.Decimal128=a.Decimal128,P.prototype.Mixed=a.Mixed,P.prototype.Date=a.Date,P.prototype.Number=a.Number,P.prototype.Error=D,P.prototype.MongooseError=D,P.prototype.now=function(){return new Date},P.prototype.CastError=D.CastError,P.prototype.SchemaTypeOptions=ml(),P.prototype.mquery=pb(),P.prototype.sanitizeFilter=S,P.prototype.trusted=w,P.prototype.skipMiddlewareFunction=i.skipWrappedFunction,P.prototype.overwriteMiddlewareResult=i.overwriteResult,P.prototype.omitUndefined=um();const I=e.exports=new P({[B]:!0})}(sA)),sA.exports}var BC=function(){if(SC)return S.exports;SC=1;const e=function(){if(wC)return CC;wC=1;
/*!
	 * Module dependencies.
	 */
const e=NE();Ug().set(e);const t=TC();return t.setDriver(e),t.Mongoose.prototype.mongo=Mu(),CC=t}();return S.exports=e,S.exports.default=e,S.exports.mongoose=e,S.exports.cast=e.cast,S.exports.STATES=e.STATES,S.exports.setDriver=e.setDriver,S.exports.set=e.set,S.exports.get=e.get,S.exports.createConnection=e.createConnection,S.exports.connect=e.connect,S.exports.disconnect=e.disconnect,S.exports.startSession=e.startSession,S.exports.pluralize=e.pluralize,S.exports.model=e.model,S.exports.deleteModel=e.deleteModel,S.exports.modelNames=e.modelNames,S.exports.plugin=e.plugin,S.exports.connections=e.connections,S.exports.version=e.version,S.exports.Aggregate=e.Aggregate,S.exports.Mongoose=e.Mongoose,S.exports.Schema=e.Schema,S.exports.SchemaType=e.SchemaType,S.exports.SchemaTypes=e.SchemaTypes,S.exports.VirtualType=e.VirtualType,S.exports.Types=e.Types,S.exports.Query=e.Query,S.exports.Model=e.Model,S.exports.Document=e.Document,S.exports.ObjectId=e.ObjectId,S.exports.isValidObjectId=e.isValidObjectId,S.exports.isObjectIdOrHexString=e.isObjectIdOrHexString,S.exports.syncIndexes=e.syncIndexes,S.exports.Decimal128=e.Decimal128,S.exports.Mixed=e.Mixed,S.exports.Date=e.Date,S.exports.Number=e.Number,S.exports.Error=e.Error,S.exports.MongooseError=e.MongooseError,S.exports.now=e.now,S.exports.CastError=e.CastError,S.exports.SchemaTypeOptions=e.SchemaTypeOptions,S.exports.mongo=e.mongo,S.exports.mquery=e.mquery,S.exports.sanitizeFilter=e.sanitizeFilter,S.exports.trusted=e.trusted,S.exports.skipMiddlewareFunction=e.skipMiddlewareFunction,S.exports.overwriteMiddlewareResult=e.overwriteMiddlewareResult,S.exports}(),FC=_(BC);const $C=new FC.Schema({appName:{type:String,required:!0},level:{type:String,required:!0},message:{type:String,required:!0},timestamp:{type:Date,default:Date.now},method:{type:String},url:{type:String},statusCode:{type:Number},responseTime:{type:Number},requestBody:{type:Object},requestHeaders:{type:Object},responseBody:{type:Object},error:{type:Object}}),xC=FC.model("Log",$C),PC=async e=>{try{await FC.connect(e,{useNewUrlParser:!0,useUnifiedTopology:!0}),console.log("MongoDB connected")}catch(e){throw console.error("MongoDB connection error:",e),e}},NC=e=>async(t,n,r)=>{const o=Date.now(),i={appName:e,level:"info",message:"API Logs",method:t.method,url:t.originalUrl,requestBody:t.body,requestHeaders:t.headers,timestamp:new Date};try{const e=n.send,t=n.json;let s=null;n.send=t=>{s=t,n.setHeader("Content-Type","application/json"),e.call(n,t)},n.json=e=>{s=e,n.setHeader("Content-Type","application/json"),t.call(n,e)},n.on("finish",(async()=>{const e=Date.now()-o,t=n.statusCode,r={...i,statusCode:t,responseTime:e,responseHeaders:n.getHeaders(),responseBody:s},u=new xC(r);await u.save(),console.log("Response logged to MongoDB")})),r()}catch(e){const t=Date.now()-o,s=n.statusCode,u={...i,statusCode:s,responseTime:t,error:e.message,responseHeaders:n.getHeaders()},a=new xC(u);await a.save(),console.error("Error logged to MongoDB:",e.message),r(e)}},IC=async(e,t="info",n,r={})=>{const o=new xC({appName:e,level:t,message:n,timestamp:new Date,...r});try{await o.save(),console.log(`[${t.toUpperCase()}] ${n}`)}catch(e){console.error("Error saving log to MongoDB:",e)}};export{NC as apiRequestLogger,PC as connectMongoDB,IC as logData};
//# sourceMappingURL=my-library.esm.js.map
